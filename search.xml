<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š(æ¯›ç»ç’ƒ/ç£¨ç ‚)æ•ˆæœ]]></title>
      <url>http://marktony.github.io/2017/01/12/%E4%BD%BF%E7%94%A8RenderScript%E5%AE%9E%E7%8E%B0%E9%AB%98%E6%96%AF%E6%A8%A1%E7%B3%8A-%E6%AF%9B%E7%8E%BB%E7%92%83-%E7%A3%A8%E7%A0%82-%E6%95%88%E6%9E%9C/</url>
      <content type="html"><![CDATA[<p>æäº‹æƒ…ï¼Œå®ç°Instagramå¯¹è¯æ¡†èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>é€›insçš„æ—¶å€™ï¼Œå¶ç„¶å‘ç°ï¼Œinstagramçš„å¯¹è¯æ¡†è®¾è®¡çš„å¾ˆæœ‰æ„æ€ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/ins.jpeg" alt="instagram" title="instagram">
<p>å®ƒçš„dialogçš„èƒŒæ™¯ç«Ÿç„¶æ˜¯æ¯›ç»ç’ƒæ•ˆæœçš„ï¼Œåœ¨æˆ‘çœ‹æ¥çœŸæ¼‚äº®ï¼Œæ©ï¼Œå¯¹è¯æ¡†å’Œè¿ªä¸½çƒ­å·´éƒ½æ¼‚äº®ğŸ˜‚ã€‚çœ‹åˆ°è¿™ä¹ˆå¥½çš„æ•ˆæœï¼Œå½“ç„¶å°±è¦å¼€å§‹æäº‹æƒ…äº†ï¼Œè‡ªå·±åŠ¨æ‰‹å®ç°å·®ä¸å¤šçš„æ•ˆæœã€‚æœ€ç»ˆçš„å®ç°æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p>
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/demo.png" alt="æ•ˆæœ" title="æ•ˆæœ">
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/demo1.jpeg" alt="æ‰‹åŠ¨è°ƒèŠ‚" title="æ‰‹åŠ¨è°ƒèŠ‚">
<p>åˆ†åˆ«å®ç°äº†å¯¹è¯æ¡†èƒŒæ™¯çš„è™šåŒ–å’Œæ‰‹åŠ¨è°ƒèŠ‚è™šåŒ–ç¨‹åº¦ã€‚</p>
<h3 id="å®ç°æ–¹æ³•å¯¹æ¯”"><a href="#å®ç°æ–¹æ³•å¯¹æ¯”" class="headerlink" title="å®ç°æ–¹æ³•å¯¹æ¯”"></a>å®ç°æ–¹æ³•å¯¹æ¯”</h3><p>æœ€å¼€å§‹æƒ³è¦å®ç°æ¯›ç»ç’ƒæ•ˆæœæ—¶ï¼Œæˆ‘æ˜¯ä¸€è„¸æ‡µé€¼çš„ï¼Œä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ã€‚å¹¸äºï¼Œæœ‰ä¸‡èƒ½çš„Googleã€‚æœç´¢ä¹‹åå‘ç°å¸¸è§çš„å®ç°æ–¹æ³•æœ‰4ç§ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>RenderScript</li>
<li>Javaç®—æ³•</li>
<li>NDKç®—æ³•</li>
<li>openGL</li>
</ul>
<p>å¤„ç†ä¸€æ•´å¼ å›¾ç‰‡è¿™ä¹ˆå¤§è®¡ç®—é‡çš„å·¥ä½œï¼ŒopenGLçš„æ€§èƒ½æœ€å¥½ï¼Œè€Œç”¨javaå®ç°è‚¯å®šæ˜¯æœ€å·®çš„äº†ã€‚è€ŒRenderScriptå’ŒNDKçš„æ€§èƒ½ç›¸å½“ï¼Œä½†æ˜¯ä½ æ‡‚å¾—ï¼ŒNDKå’ŒopenGLæˆ‘æ— å¯å¥ˆä½•ï¼Œç»¼åˆè€ƒè™‘ï¼ŒRenderScriptåº”è¯¥æ˜¯æœ€é€‚åˆçš„ã€‚</p>
<p>ä½†å¹¶ä¸æ˜¯è¯´RenderScriptå°±æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ï¼š</p>
<ol>
<li>æ¨¡ç³ŠåŠå¾„(radius)è¶Šå¤§ï¼Œæ€§èƒ½è¦æ±‚è¶Šé«˜ï¼Œæ¨¡ç³ŠåŠå¾„ä¸èƒ½è¶…è¿‡25ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½å¾—åˆ°æ¨¡ç³Šåº¦éå¸¸é«˜çš„å›¾ç‰‡ã€‚</li>
<li>ScriptIntrinsicBluråœ¨API 17æ—¶æ‰è¢«å¼•å…¥ï¼Œå¦‚æœéœ€è¦åœ¨Android 4.2ä»¥ä¸‹çš„è®¾å¤‡ä¸Šå®ç°ï¼Œå°±éœ€è¦å¼•å…¥RenderScript Support Libraryï¼Œå½“ç„¶ï¼Œå®‰è£…åŒ…ä½“ç§¯ä¼šç›¸åº”çš„å¢å¤§ã€‚ </li>
</ol>
<h3 id="RenderScriptå®ç°"><a href="#RenderScriptå®ç°" class="headerlink" title="RenderScriptå®ç°"></a>RenderScriptå®ç°</h3><p>é¦–å…ˆåœ¨<code>app</code>ç›®å½•ä¸‹<code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">defaultConfig &#123;</div><div class="line">        applicationId &quot;io.github.marktony.gaussianblur&quot;</div><div class="line">        minSdkVersion 19</div><div class="line">        targetSdkVersion 25</div><div class="line">        versionCode 1</div><div class="line">        versionName &quot;1.0&quot;</div><div class="line">        renderscriptTargetApi 19</div><div class="line">        renderscriptSupportModeEnabled true</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>RenderScriptIntrinsicsæä¾›äº†ä¸€äº›å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®ç°å„ç§å›¾ç‰‡å¤„ç†çš„æ“ä½œç±»ï¼Œä¾‹å¦‚ï¼Œ<code>ScriptIntrinsicBlur</code>ï¼Œå¯ä»¥ç®€å•é«˜æ•ˆå®ç°    é«˜æ–¯æ¨¡ç³Šæ•ˆæœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.github.marktony.gaussianblur;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.graphics.Bitmap;</div><div class="line"><span class="keyword">import</span> android.support.annotation.IntRange;</div><div class="line"><span class="keyword">import</span> android.support.annotation.NonNull;</div><div class="line"><span class="keyword">import</span> android.support.v8.renderscript.Allocation;</div><div class="line"><span class="keyword">import</span> android.support.v8.renderscript.Element;</div><div class="line"><span class="keyword">import</span> android.support.v8.renderscript.RenderScript;</div><div class="line"><span class="keyword">import</span> android.support.v8.renderscript.ScriptIntrinsicBlur;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RenderScriptGaussianBlur</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> RenderScript renderScript;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RenderScriptGaussianBlur</span><span class="params">(@NonNull Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.renderScript = RenderScript.create(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Bitmap <span class="title">gaussianBlur</span><span class="params">(@IntRange(from = <span class="number">1</span>, to = <span class="number">25</span>)</span> <span class="keyword">int</span> radius, Bitmap original) </span>&#123;</div><div class="line">        Allocation input = Allocation.createFromBitmap(renderScript, original);</div><div class="line">        Allocation output = Allocation.createTyped(renderScript, input.getType());</div><div class="line">        ScriptIntrinsicBlur scriptIntrinsicBlur = ScriptIntrinsicBlur.create(renderScript, Element.U8_4(renderScript));</div><div class="line">        scriptIntrinsicBlur.setRadius(radius);</div><div class="line">        scriptIntrinsicBlur.setInput(input);</div><div class="line">        scriptIntrinsicBlur.forEach(output);</div><div class="line">        output.copyTo(original);</div><div class="line">        <span class="keyword">return</span> original;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨RenderScriptGaussianBlurï¼Œæ„‰å¿«åœ°æ ¹æ®SeekBarçš„å€¼ï¼Œå®ç°ä¸åŒç¨‹åº¦çš„æ¨¡ç³Šäº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> io.github.marktony.gaussianblur;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.DialogInterface;</div><div class="line"><span class="keyword">import</span> android.graphics.Bitmap;</div><div class="line"><span class="keyword">import</span> android.graphics.BitmapFactory;</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AlertDialog;</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.View;</div><div class="line"><span class="keyword">import</span> android.view.Window;</div><div class="line"><span class="keyword">import</span> android.view.WindowManager;</div><div class="line"><span class="keyword">import</span> android.widget.FrameLayout;</div><div class="line"><span class="keyword">import</span> android.widget.ImageView;</div><div class="line"><span class="keyword">import</span> android.widget.LinearLayout;</div><div class="line"><span class="keyword">import</span> android.widget.SeekBar;</div><div class="line"><span class="keyword">import</span> android.widget.TextView;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ImageView imageView;</div><div class="line">    <span class="keyword">private</span> ImageView container;</div><div class="line">    <span class="keyword">private</span> LinearLayout layout;</div><div class="line">    <span class="keyword">private</span> TextView textViewProgress;</div><div class="line">    <span class="keyword">private</span> RenderScriptGaussianBlur blur;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        imageView = (ImageView) findViewById(R.id.imageView);</div><div class="line">        container = (ImageView) findViewById(R.id.container);</div><div class="line"></div><div class="line">        container.setVisibility(View.GONE);</div><div class="line"></div><div class="line">        layout = (LinearLayout) findViewById(R.id.layout);</div><div class="line"></div><div class="line">        layout.setVisibility(View.VISIBLE);</div><div class="line"></div><div class="line">        SeekBar seekBar = (SeekBar) findViewById(R.id.seekBar);</div><div class="line">        textViewProgress = (TextView) findViewById(R.id.textViewProgress);</div><div class="line">        TextView textViewDialog = (TextView) findViewById(R.id.textViewDialog);</div><div class="line">        blur = <span class="keyword">new</span> RenderScriptGaussianBlur(MainActivity.<span class="keyword">this</span>);</div><div class="line"></div><div class="line">        seekBar.setMax(<span class="number">25</span>);</div><div class="line">        seekBar.setOnSeekBarChangeListener(<span class="keyword">new</span> SeekBar.OnSeekBarChangeListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProgressChanged</span><span class="params">(SeekBar seekBar, <span class="keyword">int</span> progress, <span class="keyword">boolean</span> fromUser)</span> </span>&#123;</div><div class="line">                textViewProgress.setText(String.valueOf(progress));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartTrackingTouch</span><span class="params">(SeekBar seekBar)</span> </span>&#123;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStopTrackingTouch</span><span class="params">(SeekBar seekBar)</span> </span>&#123;</div><div class="line">                <span class="keyword">int</span> radius = seekBar.getProgress();</div><div class="line">                <span class="keyword">if</span> (radius &lt; <span class="number">1</span>) &#123;</div><div class="line">                    radius = <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.image);</div><div class="line">                imageView.setImageBitmap(blur.gaussianBlur(radius, bitmap));</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        textViewDialog.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line"></div><div class="line">                container.setVisibility(View.VISIBLE);</div><div class="line"></div><div class="line">                layout.setDrawingCacheEnabled(<span class="keyword">true</span>);</div><div class="line">                layout.setDrawingCacheQuality(View.DRAWING_CACHE_QUALITY_LOW);</div><div class="line"></div><div class="line">                Bitmap bitmap = layout.getDrawingCache();</div><div class="line"></div><div class="line">                container.setImageBitmap(blur.gaussianBlur(<span class="number">25</span>, bitmap));</div><div class="line"></div><div class="line">                layout.setVisibility(View.INVISIBLE);</div><div class="line"></div><div class="line">                AlertDialog dialog = <span class="keyword">new</span> AlertDialog.Builder(MainActivity.<span class="keyword">this</span>).create();</div><div class="line">                dialog.setTitle(<span class="string">"Title"</span>);</div><div class="line">                dialog.setMessage(<span class="string">"Message"</span>);</div><div class="line">                dialog.setButton(DialogInterface.BUTTON_POSITIVE, <span class="string">"OK"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line">                        dialog.dismiss();</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">                dialog.setButton(DialogInterface.BUTTON_NEGATIVE, <span class="string">"Cancel"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line"></div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">                dialog.setOnCancelListener(<span class="keyword">new</span> DialogInterface.OnCancelListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCancel</span><span class="params">(DialogInterface dialog)</span> </span>&#123;</div><div class="line"></div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line"></div><div class="line">                dialog.setOnCancelListener(<span class="keyword">new</span> DialogInterface.OnCancelListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCancel</span><span class="params">(DialogInterface dialog)</span> </span>&#123;</div><div class="line">                        container.setVisibility(View.GONE);</div><div class="line">                        layout.setVisibility(View.VISIBLE);</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line"></div><div class="line">                dialog.show();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ä»£ç é‡Œåšäº†ä¸€äº›viewçš„å¯è§æ€§çš„æ“ä½œï¼Œæ¯”è¾ƒç®€å•ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹æ‡‚çš„ã€‚å’Œinstagramä¸­dialogçš„å®ç°æœ‰ä¸€ç‚¹ä¸åŒçš„æ˜¯ï¼Œæˆ‘æ²¡æœ‰æˆªå–æ•´ä¸ªé¡µé¢çš„bitmapï¼Œåªæ˜¯æˆªå–äº†actionbarä¸‹çš„å†…å®¹ï¼Œå¦‚æœä¸€å®šè¦å®ç°ä¸€æ ·çš„æ•ˆæœï¼Œè°ƒæ•´ä¸€ä¸‹é¡µé¢çš„å¸ƒå±€å°±å¯ä»¥äº†ã€‚è¿™é‡Œä¸å¤šè¯´äº†ã€‚</p>
<p>æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿ</p>
<h3 id="è½®å­"><a href="#è½®å­" class="headerlink" title="è½®å­"></a>è½®å­</h3><p>é™¤äº†RenderScriptå¤–ï¼Œè¿˜æœ‰ä¸€äº›ä¼˜ç§€çš„è½®å­ï¼š</p>
<ul>
<li><a href="https://github.com/500px/500px-android-blur" target="_blank" rel="external">500px-android-blur</a></li>
<li><a href="https://github.com/wasabeef/Blurry" target="_blank" rel="external">Blurry</a></li>
<li><a href="https://github.com/kikoso/android-stackblur" target="_blank" rel="external">android-stackblur</a></li>
<li><a href="https://github.com/paveldudka/blurring/blob/master/app/src/main/java/com/paveldudka/util/FastBlur.java" target="_blank" rel="external">FastBlur</a>:Javaç®—æ³•å®ç°</li>
</ul>
<p><a href="https://github.com/patrickfav/BlurTestAndroid" target="_blank" rel="external">BlurTestAndroid</a>å¯¹ä¸åŒç±»åº“çš„å®ç°æ–¹å¼ã€é‡‡å–çš„ç®—æ³•å’Œæ‰€è€—è´¹çš„æ—¶é—´åšäº†ç»Ÿè®¡å’Œæ¯”è¾ƒï¼Œä½ ä¹Ÿå¯ä»¥ä¸‹è½½å®ƒçš„demo appï¼Œè‡ªè¡Œæµ‹è¯•ã€‚</p>
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/BlurTestAndroid.png" alt="BlurTestAndroid" title="BlurTestAndroid">
<p>ç¤ºä¾‹ä»£ç åœ¨è¿™é‡Œï¼š<a href="https://github.com/marktony/GaussianBlur" target="_blank" rel="external">GaussianBlur</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[æˆ‘çš„2016]]></title>
      <url>http://marktony.github.io/2017/01/10/%E6%88%91%E7%9A%842016/</url>
      <content type="html"><![CDATA[<p>å¼€æºï¼Œåšå®¢ï¼Œæ•°ç ï¼Œç”µå½±ä¸ç”µè§†å‰§ã€‚<br><a id="more"></a><br>æ—¶é—´èµ°ç€èµ°ç€ï¼Œæˆ‘è¯»å®Œäº†å¤§ä¸‰ç¬¬ä¸€ä¸ªå­¦æœŸï¼Œè·ç¦»å…¬å…ƒ2016å¹´ä¹Ÿå·²ç»è¿‡å»äº†10å¤©ï¼Œæ˜¯æ—¶å€™å¯¹è¿‡å»çš„ä¸€å¹´åšä¸€ä¸ªæ€»ç»“äº†ã€‚æœ¬æ¥è¿˜æƒ³ç€1å·çš„æ—¶å€™å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œç»“æœï¼Œæ­£å¼åº”äº†é‚£å¥è¯ï¼š</p>
<blockquote>
<p>åœ¨è®©è‡ªå·±å¤±æœ›è¿™ä»¶äº‹æƒ…ä¸Šï¼Œæˆ‘ä»æ²¡è®©è‡ªå·±å¤±æœ›è¿‡ã€‚</p>
</blockquote>
<p>ä¸€æ‹–å°±æ‹–åˆ°äº†10å·æ‰å¼€å§‹åŠ¨ç¬”ï¼Œä¸å¯¹ï¼ŒåŠ¨é”®ç›˜ï¼Œæ­£å¼çš„å¯¹è¿‡å»ä¸€å¹´è¿›è¡Œä¸€ä¸ªå°½é‡å®Œæ•´çš„æ€»ç»“ï¼ˆä»¥ä¸‹æ‰€æœ‰çš„ç»Ÿè®¡æ—¥æœŸå‡ä¸ºæˆªæ­¢è‡³2017å¹´1æœˆ10æ—¥ï¼‰ã€‚</p>
<h3 id="é¡¹ç›®"><a href="#é¡¹ç›®" class="headerlink" title="é¡¹ç›®"></a>é¡¹ç›®</h3><p>è¯´åˆ°é¡¹ç›®å°±ä¸å¾—ä¸è¯´<a href="https://github.com/marktony" target="_blank" rel="external">GitHub</a>, è™½ç„¶åœ¨15å¹´çš„æ—¶å€™æ³¨å†Œäº†è´¦å·ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šæ²¡æœ‰æäº¤æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼ŒçœŸæ­£å¼€å§‹ç”¨å¿ƒçš„ç»´æŠ¤è¿˜æ˜¯åœ¨16å¹´ã€‚</p>
<img src="/2017/01/10/æˆ‘çš„2016/github_contribution.png" alt="GitHub Contributions" title="GitHub Contributions">
<p>ä¸€å…±æœ‰422æ¬¡contributionã€‚</p>
<p>staræ¯”è¾ƒå¤šçš„é¡¹ç›®:</p>
<img src="/2017/01/10/æˆ‘çš„2016/github_pop_repos.png" alt="GitHub pop repos" title="GitHub pop repos">
<p>æ‰€æœ‰çš„é¡¹ç›®ä¸€å…±æ”¶è·535ä¸ªstar(ä»æ— åˆ°æœ‰)ï¼Œè¢«fork140æ¬¡(ä»æ— åˆ°æœ‰)ï¼Œfollower96(ä»æ— åˆ°æœ‰)ã€‚</p>
<p>å…¶ä¸­æ¯”è¾ƒåœ¨æˆ‘çœ‹æ¥æ¯”è¾ƒä¼˜ç§€çš„æœ‰ï¼š</p>
<ul>
<li><a href="https://github.com/marktony/PaperPlane" target="_blank" rel="external">çº¸é£æœº(çŸ¥ä¹å°æŠ¥ PaperPlane)</a>,é‡‡ç”¨MVPæ¶æ„ï¼Œé›†åˆäº†çŸ¥ä¹æ—¥æŠ¥ã€æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„ç»¼åˆæ€§é˜…è¯»å®¢æˆ·ç«¯ï¼Œåœ¨<a href="https://play.google.com/store/apps/details?id=com.marktony.zhihudaily" target="_blank" rel="external">Google Play</a>ä¸Šä¸‹è½½é‡ä¸º13354æ¬¡ï¼Œç»¼åˆè¯„åˆ†4.62ï¼ˆæ»¡åˆ†5ï¼‰ï¼›<a href="http://app.mi.com/detail/312703?ref=search" target="_blank" rel="external">å°ç±³åº”ç”¨å•†åº—</a>ä¸‹è½½é‡ä¸º12602æ¬¡ï¼›<a href="http://app.flyme.cn/apps/public/detail?package_name=com.marktony.zhihudaily" target="_blank" rel="external">é­…æ—åº”ç”¨å•†åº—</a>ä¸‹è½½é‡ä¸º5208ï¼Œç»¼åˆè¯„åˆ†9.6ï¼ˆæ»¡åˆ†ä¸º10ï¼‰ï¼›<a href="http://www.coolapk.com/apk/com.marktony.zhihudaily" target="_blank" rel="external">é…·å¸‚åœº</a>ä¸‹è½½é‡ä¸º4.3ä¸‡ï¼Œç»¼åˆè¯„åˆ†4.5ï¼ˆæ»¡åˆ†ä¸º5ï¼‰ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/paper_plane.png" alt="Paper Plane" title="Paper Plane">
<ul>
<li><a href="https://github.com/marktony/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ APPåŠAPIåˆ†æ</a>ï¼Œç”±äºç‰ˆæƒé—®é¢˜ï¼ŒAPPå·²ç»åœæ­¢ç»´æŠ¤ï¼ŒAPIåˆ†æéƒ¨åˆ†å¯ä»¥æŸ¥çœ‹<a href="https://github.com/marktony/zhuanlan/wiki" target="_blank" rel="external">wiki</a>æˆ–è€…<a href="https://marktony.github.io/2016/05/14/%E7%9F%A5%E4%B9%8E%E4%B8%93%E6%A0%8FAPI%E5%88%86%E6%9E%90/">æˆ‘çš„åšå®¢</a></li>
<li><a href="https://github.com/marktony/FanfouHandpick" target="_blank" rel="external">é¥­å¦ç²¾é€‰</a>,ä½¿ç”¨Kotlinå¼€å‘çš„é¥­å¦ç²¾é€‰å®¢æˆ·ç«¯ã€‚è¿™ä¸ªé¡¹ç›®ä¸»è¦æ˜¯ç»ƒæ‰‹ï¼Œå°é²œä½¿ç”¨Kotlinï¼Œç°é˜¶æ®µåœ¨é¡¹ç›®ä¸­ä½¿ç”¨Kotlinçš„å¯èƒ½æ€§è¿˜æ˜¯è›®å°çš„ã€‚</li>
<li><a href="https://github.com/marktony/Translator" target="_blank" rel="external">ç®€å•ç¿»è¯‘</a></li>
<li><a href="https://github.com/marktony/Reader" target="_blank" rel="external">Reader</a>ï¼šå†…å®¹åŒ…å«äº†ç³—äº‹ç™¾ç§‘ï¼Œç…è›‹ï¼Œå’Œå†…æ¶µæ®µå­</li>
</ul>
<p>æ‰€æœ‰é¡¹ç›®å‡ç”±æˆ‘è‡ªå·±å®Œæˆè®¾è®¡ï¼Œç¼–ç ï¼Œæµ‹è¯•ï¼Œä¸Šçº¿åŠè¿­ä»£ç»´æŠ¤å·¥ä½œã€‚</p>
<h3 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h3><ul>
<li><a href="https://marktony.github.io">Tonnyâ€™s Blog</a>ï¼Œä½¿ç”¨GitHub Pageså’ŒHexoæ­å»ºçš„åšå®¢ï¼Œæ‰€æœ‰æ–‡ç« éƒ½é¦–å‘äºæ­¤ï¼Œä¹Ÿæ˜¯åœ¨16å¹´ä¸­æ‰æ­å»ºå®Œæˆï¼Œä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ˜¯<a href="https://github.com/A-limon/pacman" target="_blank" rel="external">Pacman</a>ä¸»é¢˜ï¼Œå¹´åº•å‰æ¢äº†<a href="https://github.com/viosey/hexo-theme-material" target="_blank" rel="external">Material</a>ä¸»é¢˜ï¼Œæ„Ÿè§‰ç¾è§‚äº†å¾ˆå¤š(è°è®©æˆ‘æ˜¯Googleçš„ç²‰ä¸å‘¢)ã€‚ä¸€å…±å®Œæˆäº†21ç¯‡æ–‡ç« ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/Tonny%27sBlog.png" alt="Tonny's Blog" title="Tonny's Blog">
<ul>
<li><p><a href="http://www.jianshu.com/u/49606f4d970f" target="_blank" rel="external">ç®€ä¹¦-TonnyL</a>:åŠå¹´æ—¶é—´ï¼Œä¸€å…±å†™äº†10ç¯‡æ–‡ç« ï¼Œ17898ä¸ªå­—ï¼Œæ”¶è·äº†195ä¸ªå–œæ¬¢ï¼Œ64ä¸ªç²‰ä¸ã€‚</p>
</li>
<li><p><a href="https://gold.xitu.io/user/582c81cb128fe10069509b49" target="_blank" rel="external">ç¨€åœŸæ˜é‡‘-Tonny</a>:ä½¿ç”¨æ—¶é—´ä¸€ä¸ªæœˆï¼Œåˆ†äº«6ç¯‡æ–‡ç« ï¼Œæ”¶è·734ä¸ªå–œæ¬¢ã€‚</p>
</li>
</ul>
<h3 id="è®¾å¤‡"><a href="#è®¾å¤‡" class="headerlink" title="è®¾å¤‡"></a>è®¾å¤‡</h3><ul>
<li>ç”µè„‘ï¼šå•Šå“ˆå“ˆå“ˆå“ˆï¼Œç»ˆäºåœ¨ä»Šå¹´åæœˆä»½çš„æ—¶å€™ï¼ŒæŠŠåŸæ¥çš„åç¡•A550å–äº†ï¼Œä¹°äº†ç°åœ¨çš„MBPï¼ŒåŸæ¥çš„åç¡•çš„çœŸçš„å¤ªåšäº†ï¼Œè€Œä¸”é‡ï¼Œå¸¦ç€èµ°å¤ªä¸æ–¹ä¾¿äº†ã€‚ç¬¬ä¸€æ¬¡æ‹¿åˆ°MBPçš„æ—¶å€™ï¼ŒçœŸçš„ä¸ç”±è‡ªä¸»çš„æ„Ÿå¹ï¼ŒåŸæ¥ç”Ÿäº§åŠ›å·¥å…·æ˜¯å¯ä»¥è¿™ä¹ˆè–„çš„ã€‚å½“ç„¶ï¼Œæ¢ç”µè„‘çš„ä»£ä»·å°±æ˜¯åƒäº†ä¸€ä¸ªå­¦æœŸçš„åœŸï¼ˆæ‰‹åŠ¨å¾®ç¬‘è„¸ï¼‰ã€‚</li>
<li>é”®ç›˜ï¼šé˜¿ç±³æ´›VA87MèŒ¶è½´ï¼Œå¤§æ¦‚5æœˆä»½çš„æ—¶å€™ï¼Œå–æ‰äº†ä¹‹å‰RK68ï¼Œæ²¡æœ‰æ–¹å‘é”®çš„é”®ç›˜ï¼Œç”¨ç€å¤ªåˆ«æ‰­ã€‚</li>
<li>æ‰‹æœºï¼šä¸€åŠ 3ã€‚è¿˜åœ¨åˆ†æœŸä¸­ã€‚</li>
</ul>
<p>ï¼ˆæ±‚åœŸè±ªä¸å–·ï¼Œæˆ‘ç©·é€¼ä¸€ä¸ªã€‚ï¼‰</p>
<h3 id="è¯»ä¹¦"><a href="#è¯»ä¹¦" class="headerlink" title="è¯»ä¹¦"></a>è¯»ä¹¦</h3><p>ç”±äºæˆ‘ä¸å–œæ¬¢çœ‹ç”µå­ä¹¦ï¼Œæ‰€ä»¥ä¹¦åŸºæœ¬ä¸Šéƒ½æ˜¯çœ‹çš„çº¸è´¨çš„ä¹¦ï¼ˆä¹°ä¸èµ·Kindleï¼‰ã€‚å¤§æ¦‚çœ‹äº†ï¼š</p>
<ul>
<li>ç¬¬ä¸€è¡Œä»£ç Androidï¼Œå…¥é—¨å¿…å¤‡ï¼Œå¹´æœ«çš„æ—¶å€™åˆå…¥æ‰‹äº†ç¬¬äºŒç‰ˆçš„ï¼Œå·©å›ºåŸºç¡€è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</li>
<li>Androidå¼€å‘è‰ºæœ¯æ¢ç´¢ï¼Œæå‡ï¼Œè¿˜åœ¨ç ”è¯»ã€‚</li>
<li>Thinking in Javaï¼Œå·©å›ºåŸºç¡€ä¸æå‡éƒ½é ä»–ï¼ŒJavaç•Œçš„é‡‘å·åƒã€‚</li>
</ul>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>çœ‹äº†ä¸€äº›ç”µå½±å’Œç”µè§†å‰§ã€‚</p>
<ul>
<li>åŒ—äº¬é‡ä¸Šè¥¿é›…å›¾ä¹‹ä¸äºŒæƒ…ä¹¦ï¼Œè™½ç„¶è¿˜æ˜¯å•èº«ç‹—ä¸€ä¸ªï¼Œè¿˜æ˜¯å’ŒåŒå­¦ä¸€èµ·å»çœ‹äº†è¿™éƒ¨ç”µå½±ï¼Œæ±¤å”¯å¥½å¸…ï¼</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/buerqingshu.jpg" alt="ä¸äºŒæƒ…ä¹¦" title="ä¸äºŒæƒ…ä¹¦">
<ul>
<li>é©´å¾—æ°´ï¼Œç¬‘ç€ç¬‘ç€å°±å“­çš„ç”µå½±ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/lvdeshui.jpg" alt="é©´å¾—æ°´" title="é©´å¾—æ°´">
<ul>
<li>The Big Bang Theory S10,Sheltonéƒ½å’ŒAmyåœ¨ä¸€èµ·äº†ï¼Œæˆ‘è¿˜æ˜¯æ²¡å¥³æœ‹å‹ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/tbbt.jpg" alt="ç”Ÿæ´»å¤§çˆ†ç‚¸" title="ç”Ÿæ´»å¤§çˆ†ç‚¸">
<ul>
<li>Westworld S1ï¼ŒHBOå‡ºå“ï¼Œå¿…å±ç²¾å“ã€‚çƒ§è„‘çš„ç”µè§†å‰§ï¼Œè€Œä¸”Deloriså¥½æ¼‚äº®å•Šã€‚ä¸è¿‡æˆ‘è§‰å¾—æœ‰ç‚¹å‘çˆ¹çš„ï¼Œæˆ‘å–œæ¬¢çš„Halseyæ€ä¹ˆè¯´æ²¡å°±æ²¡äº†å‘¢ï¼Ÿä¸è¿‡å¥½æ¶ˆæ¯æ˜¯ï¼ŒHalseyä¼šåœ¨S2å›å½’ï¼Œè¿™æ‰ç¨å¾®å®‰æ…°äº†ä¸€ä¸‹æˆ‘å—ä¼¤çš„å¿ƒçµã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/westworld.jpg" alt="è¥¿éƒ¨ä¸–ç•Œ" title="è¥¿éƒ¨ä¸–ç•Œ">
<ul>
<li>è¯·å›ç­”1988ï¼Œæš‘å‡çš„æ—¶å€™æ‰çœ‹å®Œï¼Œæˆ‘çš„è¯„ä»·æ˜¯ï¼Œç¥å‰§ã€‚çœŸçš„ç¥ï¼Œæ„Ÿè§‰ä»–ä»¬ä¸æ˜¯ç”Ÿæ´»åœ¨åŒé—¨æ´ï¼Œè€Œæ˜¯ç”Ÿæ´»åœ¨æˆ‘èº«è¾¹ã€‚ä»£å…¥æ„Ÿå¤ªå¼ºï¼Œè¿˜æœ‰å„ç§ç¥ç»†èŠ‚ï¼Œå„ç§ä¸åšä½œçš„ç…½æƒ…ï¼Œæ„ŸåŠ¨åœ°æµæ³ªã€‚çœ‹å®Œäº†å‰¯ä½œç”¨ä¹ŸæŒºæ˜æ˜¾çš„ï¼Œé‚£å°±æ˜¯ç°åœ¨æˆ‘é€¢äººå°±å®‰åˆ©è¿™éƒ¨å‰§ï¼ˆå¾®ç¬‘è„¸ï¼‰ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/qinghuida1988.jpg" alt="è¯·å›ç­”1988" title="è¯·å›ç­”1988">
<ul>
<li>è¾©æŠ¤äººï¼Œè¿™ä¸æ˜¯16å¹´å‡ºå“çš„ç”µå½±ï¼Œä½†æ˜¯çœŸçš„å¯¹æˆ‘çš„å¯å‘å¤ªå¤§äº†ã€‚ç²¾å“ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/bianhuren.jpg" alt="è¾©æŠ¤äºº" title="è¾©æŠ¤äºº">
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><blockquote>
<p>é©å‘½å°šæœªæˆåŠŸï¼ŒåŒå¿—ä»éœ€åŠªåŠ›ã€‚</p>
</blockquote>
<h3 id="å°ç›®æ ‡"><a href="#å°ç›®æ ‡" class="headerlink" title="å°ç›®æ ‡"></a>å°ç›®æ ‡</h3><p>2017å¹´ï¼Œå…ˆç»™è‡ªå·±å®šä¸€ä¸ªå°ç›®æ ‡ï¼Œæ¯”å¦‚ï¼Œå‡è‚¥5kgï¼ˆå¾®ç¬‘è„¸ï¼‰ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Lambdaåœ¨Androidä¸­çš„ä½¿ç”¨]]></title>
      <url>http://marktony.github.io/2017/01/06/Lambda%E5%9C%A8Android%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>æç®€ä¸»ä¹‰ã€‚<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Androidæ”¯æŒå®Œæ•´çš„Java7ç‰¹æ€§ï¼Œè€Œå‡çº§åˆ°Android Nougat(API Level 24)ä¹‹åï¼Œæ”¯æŒäº†Java8è¯­è¨€çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼š</p>
<ul>
<li><a href="https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html" target="_blank" rel="external">é»˜è®¤å’Œé™æ€æ¥å£æ–¹æ³•</a></li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html" target="_blank" rel="external">Lambdaè¡¨è¾¾å¼</a>(åœ¨ API çº§åˆ« 23 åŠæ›´ä½ç‰ˆæœ¬ä¸­ä¹Ÿå¯ç”¨)</li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/annotations/repeating.html" target="_blank" rel="external">é‡å¤æ³¨è§£</a></li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html" target="_blank" rel="external">æ–¹æ³•å¼•ç”¨</a>(åœ¨ API çº§åˆ« 23 åŠæ›´ä½ç‰ˆæœ¬ä¸­ä¹Ÿå¯ç”¨)</li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/annotations/type_annotations.html" target="_blank" rel="external">ç±»å‹æ³¨è§£</a>(åœ¨ API çº§åˆ« 23 åŠæ›´ä½ç‰ˆæœ¬ä¸­ä¹Ÿå¯ç”¨)</li>
</ul>
<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>ä½¿ç”¨è¿™ä¸€éƒ¨åˆ†æ”¯æŒçš„åŠŸèƒ½éœ€è¦ä¸€ä¸ªåä¸º<a href="https://source.android.com/source/jack.html" target="_blank" rel="external">Jack</a>çš„æ–°ç¼–è¯‘ã€‚è€ŒJackè¦æ±‚Android Studio 2.1æˆ–æ›´é«˜ï¼Œæ‰€ä»¥ï¼Œæ²¡æœ‰å‡çº§åˆ°2.1æˆ–ä»¥ä¸Šçš„ç«¥é‹ï¼Œéœ€è¦å…ˆå‡çº§æ‰èƒ½æ”¯æŒä½¿ç”¨Jackå“Ÿã€‚</p>
<blockquote>
<p><a href="https://developer.android.com/tools/building/building-studio.html#instant-run" target="_blank" rel="external">Instant Run</a>ç›®å‰ä¸èƒ½åº”ç”¨äºJack</p>
</blockquote>
<p>åœ¨<code>app</code>ç›®å½•ä¸‹<code>build.gradle</code>æ–‡ä»¶ä¸‹æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">  ...</div><div class="line">  defaultConfig &#123;</div><div class="line">    ...</div><div class="line">    jackOptions &#123;</div><div class="line">      enabled true</div><div class="line">    &#125;</div><div class="line">    // åœ¨æ›´è€çš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨</div><div class="line">    // useJack true</div><div class="line">    // å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ</div><div class="line">  &#125;</div><div class="line">  compileOptions &#123;</div><div class="line">    sourceCompatibility JavaVersion.VERSION_1_8</div><div class="line">    targetCompatibility JavaVersion.VERSION_1_8</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h3><p>Lambdaçš„è¯­æ³•æ ¼å¼å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(arg1, arg2...) -&gt; &#123; body &#125;</div><div class="line"></div><div class="line">(type1 arg1, type2 arg2...) -&gt; &#123; body &#125;</div></pre></td></tr></table></figure>
<p>åœ¨æœªä½¿ç”¨Lambdaè¡¨è¾¾å¼ä¹‹å‰ï¼Œæˆ‘ä»¬è®¾ç½®ç›‘å¬å™¨çš„ä»£ç æ˜¯è¿™æ ·çš„:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">fab.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">        <span class="comment">// blah, blah</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è€Œä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œä»£ç æ˜¯è¿™æ ·çš„:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fab.setOnClickListener(v -&gt; &#123;</div><div class="line">	<span class="comment">// blah, blah            </span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ˜¯ä¸æ˜¯æ›´ç®€æ´äº†å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹<code>OnClickListener</code>çš„æºç ï¼Œå‘ç°è¿™ä¸ªæ¥å£ä¸­åªæœ‰ä¸€ä¸ªå¾…å®ç°çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Interface definition for a callback to be invoked when a view is clicked.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnClickListener</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Called when a view has been clicked.</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> v The view that was clicked.</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åƒè¿™ç§åªæœ‰ä¸€ä¸ªå¾…å®ç°æ–¹æ³•çš„æ¥å£ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œç®€åŒ–ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ¥å£ï¼Œç„¶åç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œå®ç°ã€‚</p>
<h3 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h3><p>æœ‰æ—¶ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼ŒLambdaè¡¨è¾¾å¼ä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼Œä»…ä»…æ˜¯è°ƒç”¨äº†å·²ç»å­˜åœ¨çš„æ–¹æ³•ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç å°±èƒ½è¿›ä¸€æ­¥ç²¾ç®€äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fab.setOnClickListener( view2 -&gt; showSnackBar(view2));</div><div class="line"></div><div class="line">private void showSnackBar(View view) &#123;</div><div class="line">        Snackbar.make(view, &quot;blah, blah&quot;, Snackbar.LENGTH_SHORT).show();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ–¹æ³•å¼•ç”¨ä¹‹åï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fab.setOnClickListener(this::showSnackBar);</div></pre></td></tr></table></figure>
<h3 id="ä¸Šä¸‹æ–‡æ¨æ–­"><a href="#ä¸Šä¸‹æ–‡æ¨æ–­" class="headerlink" title="ä¸Šä¸‹æ–‡æ¨æ–­"></a>ä¸Šä¸‹æ–‡æ¨æ–­</h3><p>ä¸‹é¢æ¥å®ç°ä¸€äº›ä¾‹å­æ¥äº†è§£Lambdaçš„ä¸Šä¸‹æ–‡æ¨æ–­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TestOp</span> </span>&#123;</div><div class="line">   <span class="function">String <span class="title">operate</span> <span class="params">(String s, <span class="keyword">int</span> i)</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œå®ç°</span></div><div class="line"><span class="comment">// é€šè¿‡ä¸Šä¸‹æ–‡ï¼Œlambdaè¡¨è¾¾å¼å¯ä»¥æ¨æ–­å‡ºsä¸ºStringç±»å‹ï¼Œè€Œiä¸ºintç±»å‹</span></div><div class="line"><span class="comment">// è¿”å›å€¼ä¸ºString</span></div><div class="line">TestOp myOp = (s,i) -&gt; s + i;</div></pre></td></tr></table></figure>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Lambdaè¡¨è¾¾å¼ä½¿ç”¨è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œèƒ½å¤Ÿå‡å°‘ç¼–å†™å’Œç»´æŠ¤çš„ä»£ç æ•°é‡ã€‚ä½†æ˜¯ï¼Œè¿™ç§æç®€ä¸»ä¹‰çš„å†™æ³•ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½æ¥å—çš„ã€‚å¯¹äºæˆ‘è€Œè¨€ï¼ŒæŠ€å¤šä¸å‹èº«ï¼Œå­¦ä¹ ä¸€ä¸‹ï¼Œæé«˜å§¿åŠ¿è¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[æå‡ä½“éªŒ-Chrome Custom Tabs]]></title>
      <url>http://marktony.github.io/2017/01/05/%E6%8F%90%E5%8D%87%E4%BD%93%E9%AA%8C-Chrome-Custom-Tabs/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨Chrome Custom TabsåŠ è½½ç½‘é¡µå¯ä»¥æœ‰æ•ˆçš„æå‡ç”¨æˆ·çš„ä½“éªŒ<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ–‡ç« æ¯”è¾ƒé•¿ï¼Œå…ˆæ”¾é¡¹ç›®åœ°å€:<a href="https://github.com/marktony/PaperPlane" target="_blank" rel="external">PaperPlane</a></p>
<p>ä¿—è¯è¯´ï¼Œæ²¡å›¾è¯´ä¸ªé‚£å•¥ï¼Œå…ˆçœ‹å®é™…æ•ˆæœã€‚<br><img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/telegram.gif" alt="telegram" title="telegram"><br><img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/paper_plane.gif" alt="paper plane" title="paper plane"></p>
<h3 id="ä»€ä¹ˆæ˜¯Custom-Tabs"><a href="#ä»€ä¹ˆæ˜¯Custom-Tabs" class="headerlink" title="ä»€ä¹ˆæ˜¯Custom Tabs?"></a>ä»€ä¹ˆæ˜¯Custom Tabs?</h3><p>æ‰€æœ‰çš„APPå¼€å‘è€…éƒ½é¢ä¸´è¿™æ ·ä¸€ä¸ªé€‰æ‹©ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªURLæ—¶ï¼Œæ˜¯åº”è¯¥ç”¨æµè§ˆå™¨æ‰“å¼€è¿˜æ˜¯åº”è¯¥ç”¨åº”ç”¨å†…ç½®çš„WebViewæ‰“å¼€å‘¢ï¼Ÿ</p>
<p>ä¸¤ä¸ªé€‰é¡¹éƒ½é¢ä¸´ç€ä¸€äº›é—®é¢˜ã€‚é€šè¿‡æµè§ˆå™¨æ‰“å¼€æ˜¯ä¸€ä¸ªéå¸¸é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¹¶ä¸”æ˜¯æ— æ³•å®šåˆ¶çš„ã€‚è€ŒWebViewä¸èƒ½å’Œæµè§ˆå™¨å…±äº«æ•°æ®å¹¶ä¸”éœ€è¦éœ€è¦æ‰‹åŠ¨å»å¤„ç†æ›´å¤šçš„åœºæ™¯ã€‚</p>
<p>Chrome Custom Tabsè®©APPåœ¨è¿›è¡Œç½‘é¡µæµè§ˆæ—¶æ›´å¤šçš„æ§åˆ¶æƒé™ï¼Œåœ¨ä¸é‡‡ç”¨WebViewçš„æƒ…å†µä¸‹ï¼Œè¿™æ—¢èƒ½ä¿è¯Native APPå’Œç½‘é¡µä¹‹é—´æµç•…çš„åˆ‡æ¢ï¼Œåˆå…è®¸APPå®šåˆ¶Chromeçš„å¤–è§‚å’Œæ“ä½œã€‚å¯å®šä¹‰çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>toolbarçš„é¢œè‰²</li>
<li>è¿›åœºå’Œé€€åœºåŠ¨ç”»</li>
<li>ç»™Chromeçš„toolbarã€overflow menuå’Œbottom toolbaræ·»åŠ è‡ªå®šä¹‰æ“ä½œ</li>
</ul>
<p>å¹¶ä¸”ï¼ŒChrome Custom Tabså…è®¸å¼€å‘è€…å¯¹Chromeè¿›è¡Œé¢„å¯åŠ¨å’Œç½‘é¡µå†…å®¹çš„é¢„åŠ è½½ï¼Œä»¥æ­¤æå‡åŠ è½½çš„é€Ÿåº¦ã€‚<br><img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/performance.gif" alt="preformance" title="preformance"></p>
<h3 id="Chrome-Custom-Tabs-VS-WebView-æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ"><a href="#Chrome-Custom-Tabs-VS-WebView-æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ" class="headerlink" title="Chrome Custom Tabs VS WebView, æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ"></a>Chrome Custom Tabs VS WebView, æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</h3><p>å¦‚æœé¡µé¢çš„å†…å®¹æ˜¯ç”±æˆ‘ä»¬è‡ªå·±æ§åˆ¶çš„ï¼Œå¯ä»¥å’ŒAndroidç»„ä»¶è¿›è¡Œäº¤äº’ï¼Œé‚£ä¹ˆ,WebViewæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Œå¦‚æœæˆ‘ä»¬çš„åº”ç”¨éœ€è¦æ‰“å¼€å¤–éƒ¨çš„ç½‘ç«™ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨Chrome Custom Tabsï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¼å…¥éå¸¸ç®€å•ã€‚ä¸éœ€è¦ç¼–å†™é¢å¤–çš„ä»£ç æ¥ç®¡ç†è¯·æ±‚ï¼Œæˆäºˆæƒé™æˆ–è€…å­˜å‚¨cookie</li>
<li>å®šåˆ¶UIï¼š<ul>
<li>Toolbar é¢œè‰²</li>
<li>åŠ¨ä½œæŒ‰é’® (Action Button)</li>
<li>å®šåˆ¶èœå•é¡¹</li>
<li>å®šåˆ¶è¿›åœºé€€åœºåŠ¨ç”»</li>
<li>Bottom Toolbar</li>
</ul>
</li>
<li>å¯¼èˆªæ„ŸçŸ¥ï¼šæµè§ˆå™¨é€šçŸ¥å›è°ƒæ¥å£é€šçŸ¥åº”ç”¨ç½‘é¡µçš„å¯¼èˆªæƒ…å†µ</li>
<li>å®‰å…¨æ€§ï¼šæµè§ˆå™¨ä½¿ç”¨äº†Googleâ€™s Safe Browsingï¼Œç”¨äºä¿æŠ¤ç”¨æˆ·å’Œè®¾å¤‡å…å—å±é™©ç½‘ç«™çš„ä¾µå®³</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼š<ul>
<li>æµè§ˆå™¨ä¼šåœ¨åå°è¿›è¡Œé¢„çƒ­ï¼Œé¿å…äº†åº”ç”¨å ç”¨å¤§é‡èµ„æºçš„æƒ…å†µ</li>
<li>æå‰å‘æµè§ˆå™¨å‘é€å¯èƒ½çš„URLï¼Œæé«˜äº†é¡µé¢åŠ è½½é€Ÿåº¦</li>
</ul>
</li>
<li>ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šåœ¨ç”¨æˆ·ä¸Custom Tabsè¿›è¡Œäº¤äº’æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†åº”ç”¨æ ‡ç¤ºä¸ºå‰å°åº”ç”¨ï¼Œé¿å…äº†åº”ç”¨è¢«ç³»ç»Ÿæ‰€å›æ”¶</li>
<li>å…±äº«cookieæ•°æ®å’Œæƒé™ï¼Œè¿™æ ·ï¼Œç”¨æˆ·åœ¨å·²ç»æˆæƒè¿‡çš„ç½‘ç«™ï¼Œå°±ä¸éœ€è¦é‡æ–°ç™»å½•æˆ–è€…æˆæƒæƒé™äº†</li>
<li>å¦‚æœç”¨æˆ·å¼€å¯äº†æ•°æ®èŠ‚çœåŠŸèƒ½ï¼Œåœ¨è¿™é‡Œä»ç„¶å¯ä»¥ä»ä¸­å—ç›Š</li>
<li>åŒæ­¥çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</li>
<li>ä»…ä»…éœ€è¦ç‚¹å‡»ä¸€ä¸‹å·¦ä¸Šè§’æŒ‰é’®å°±å¯ä»¥ç›´æ¥è¿”å›åŸåº”ç”¨</li>
<li>æƒ³è¦åœ¨Lollipopä¹‹å‰çš„è®¾å¤‡ä¸Šæœ€æ–°å¼•å…¥çš„æµè§ˆå™¨(Auto updating WebView),è€Œä¸æ˜¯æ—§ç‰ˆæœ¬çš„WebView</li>
</ul>
<h3 id="ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ</h3><p>ä»Chrome 45ç‰ˆæœ¬å¼€å§‹ï¼Œæ‰€æœ‰çš„Chromeç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ï¼Œç›®å‰ä»…æ”¯æŒAndroidç³»ç»Ÿã€‚</p>
<h3 id="å¼€å‘æŒ‡å—"><a href="#å¼€å‘æŒ‡å—" class="headerlink" title="å¼€å‘æŒ‡å—"></a>å¼€å‘æŒ‡å—</h3><p>å®Œæ•´çš„ç¤ºä¾‹å¯ä»¥æŸ¥çœ‹<a href="https://github.com/GoogleChrome/custom-tabs-client" target="_blank" rel="external">https://github.com/GoogleChrome/custom-tabs-client</a>ã€‚åŒ…å«äº†å®šåˆ¶UIã€è¿æ¥åå°æœåŠ¡ã€å¤„ç†åº”ç”¨å’ŒCustom Tab Activityç”Ÿå‘½å‘¨æœŸçš„å¯å¤ç”¨çš„ç±»ã€‚</p>
<p>ç¬¬ä¸€æ­¥å½“ç„¶æ˜¯å°†<a href="http://developer.android.com/tools/support-library/features.html#custom-tabs" target="_blank" rel="external"> Custom Tabs Support Library </a>æ·»åŠ åˆ°å·¥ç¨‹ä¸­æ¥ã€‚æ‰“å¼€<code>build.gradle</code>æ–‡ä»¶ï¼Œæ·»åŠ support libraryçš„ä¾èµ–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    ...</div><div class="line">    compile &apos;com.android.support:customtabs:23.3.0&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€æ—¦Support Libraryæ·»åŠ é¡¹ç›®æˆåŠŸäº†ï¼Œæˆ‘ä»¬å°±æœ‰ä¸¤ç§å¯èƒ½çš„å®šåˆ¶æ“ä½œäº†ï¼š</p>
<ul>
<li>å®šåˆ¶UIå’Œä¸Chrome Custom Tabsçš„äº¤äº’</li>
<li>ä½¿é¡µé¢åŠ è½½æ›´å¿«é€Ÿï¼Œä¿æŒåº”ç”¨æ¿€æ´»</li>
</ul>
<p>UIçš„å®šåˆ¶æ˜¯é€šè¿‡ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html" target="_blank" rel="external"> CustomTabsIntent </a>å’Œ<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html" target="_blank" rel="external"> CustomTabsIntent.Builder</a>ç±»å®Œæˆçš„ï¼›è€Œé€Ÿåº¦çš„æå‡åˆ™æ˜¯é€šè¿‡ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html" target="_blank" rel="external"> CustomTabsClient </a>é“¾æ¥Custom TabsæœåŠ¡ï¼Œé¢„çƒ­Chromeå’Œè®©ChromeçŸ¥æ™“å°†è¦æ‰“å¼€çš„URLå®ç°çš„ã€‚</p>
<h4 id="æ‰“å¼€ä¸€ä¸ªChrome-Custom-Tab"><a href="#æ‰“å¼€ä¸€ä¸ªChrome-Custom-Tab" class="headerlink" title="æ‰“å¼€ä¸€ä¸ªChrome Custom Tab"></a>æ‰“å¼€ä¸€ä¸ªChrome Custom Tab</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä½¿ç”¨CustomTabsIntent.Builderé…ç½®CustomTabsIntent</span></div><div class="line"><span class="comment">// å‡†å¤‡å®Œæˆåï¼Œè°ƒç”¨CustomTabsIntent.Builder.build()æ–¹æ³•åˆ›å»ºä¸€ä¸ªCustomTabsIntent</span></div><div class="line"><span class="comment">// å¹¶é€šè¿‡CustomTabsIntent.launchUrl()æ–¹æ³•åŠ è½½å¸Œæœ›åŠ è½½çš„url</span></div><div class="line"></div><div class="line">String url = Â¨https:<span class="comment">//github.com/marktonyÂ¨;</span></div><div class="line">CustomTabsIntent.Builder builder = <span class="keyword">new</span> CustomTabsIntent.Builder();</div><div class="line">CustomTabsIntent customTabsIntent = builder.build();</div><div class="line">customTabsIntent.launchUrl(<span class="keyword">this</span>, Uri.parse(url));</div></pre></td></tr></table></figure>
<h4 id="é…ç½®åœ°å€æ çš„é¢œè‰²"><a href="#é…ç½®åœ°å€æ çš„é¢œè‰²" class="headerlink" title="é…ç½®åœ°å€æ çš„é¢œè‰²"></a>é…ç½®åœ°å€æ çš„é¢œè‰²</h4><p>Chrome Custom Tabsä¸€ä¸ªå¾ˆé‡è¦çš„åŠŸèƒ½å°±æ˜¯æˆ‘ä»¬èƒ½å¤Ÿæ”¹å˜åœ°å€æ çš„é¢œè‰²ï¼Œä½¿ä¹‹å’Œæˆ‘ä»¬åº”ç”¨çš„é¢œè‰²åè°ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ”¹å˜toolbarçš„èƒŒæ™¯è‰²ã€‚colorIntå°±æ˜¯æƒ³è¦æŒ‡å®šçš„intå€¼</span></div><div class="line"></div><div class="line">builder.setToolbarColor(colorInt);</div></pre></td></tr></table></figure>
<h4 id="é…ç½®å®šåˆ¶åŒ–çš„action-button"><a href="#é…ç½®å®šåˆ¶åŒ–çš„action-button" class="headerlink" title="é…ç½®å®šåˆ¶åŒ–çš„action button"></a>é…ç½®å®šåˆ¶åŒ–çš„action button</h4><p>ä½œä¸ºåº”ç”¨çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬å¯¹å‘ˆç°åœ¨ç”¨æˆ·çœ¼å‰çš„Chrome Custom Tabå†…çš„Action Buttonæ‹¥æœ‰å®Œå…¨çš„æ§åˆ¶æƒã€‚</p>
<p>åœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·ä¼šæ‰§è¡Œæœ€åŸºç¡€çš„æ“ä½œåƒåˆ†äº«ï¼Œæˆ–è€…æ˜¯å…¶ä»–å…¬å…±çš„Activityã€‚</p>
<p>Action Buttonè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªaction buttonçš„å›¾æ ‡å’Œç”¨æˆ·ç‚¹å‡»action buttonä¹‹åChromeå°†è¦æ‰§è¡Œçš„pendingIntentã€‚å›¾æ ‡çš„é«˜åº¦ä¸€èˆ¬ä¸º24dpï¼Œå®½åº¦ä¸€èˆ¬ä¸º24-48dpã€‚</p>
<img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/tumblr_action.png" alt="actions" title="actions">
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‘toolbaræ·»åŠ ä¸€ä¸ªAction Button</span></div><div class="line"><span class="comment">// â€˜iconâ€™æ˜¯ä¸€å¼ ä½å›¾(Bitmap)ï¼Œä½œä¸ºaction buttonçš„å›¾ç‰‡èµ„æºä½¿ç”¨</span></div><div class="line"></div><div class="line"><span class="comment">// 'description'æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½œä¸ºæŒ‰é’®çš„æ— éšœç¢æè¿°æ‰€ä½¿ç”¨</span></div><div class="line"></div><div class="line"><span class="comment">// 'pendingIntent' æ˜¯ä¸€ä¸ªPendingIntentï¼Œå½“action buttonæˆ–è€…èœå•é¡¹è¢«ç‚¹å‡»æ—¶è°ƒç”¨ã€‚</span></div><div class="line"><span class="comment">// åœ¨urlä½œä¸ºdataè¢«æ·»åŠ ä¹‹åï¼ŒChrome ä¼šè°ƒç”¨PendingIntent#send()æ–¹æ³•ã€‚</span></div><div class="line"><span class="comment">// å®¢æˆ·ç«¯åº”ç”¨ä¼šé€šè¿‡è°ƒç”¨Intent#getDataString()è·å–åˆ°URL</span></div><div class="line"></div><div class="line"><span class="comment">// 'tint'æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå®šä¹‰äº†Action Buttonæ˜¯å¦åº”è¯¥è¢«ç€è‰²</span></div><div class="line"></div><div class="line">builder.setActionButton(icon, description, pendingIntent, tint);</div></pre></td></tr></table></figure>
<h4 id="é…ç½®å®šåˆ¶åŒ–èœå•"><a href="#é…ç½®å®šåˆ¶åŒ–èœå•" class="headerlink" title="é…ç½®å®šåˆ¶åŒ–èœå•"></a>é…ç½®å®šåˆ¶åŒ–èœå•</h4><p>Chromeæµè§ˆå™¨æ‹¥æœ‰éå¸¸å…¨é¢çš„actionèœå•ï¼Œç”¨æˆ·åœ¨æµè§ˆå™¨å†…æ“ä½œéå¸¸é¡ºç•…ã€‚ç„¶è€Œï¼Œå¯¹äºæˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ï¼Œå¯èƒ½å°±ä¸é€‚åˆäº†ã€‚</p>
<p>Chrome Custom Tabsé¡¶éƒ¨æœ‰ä¸‰ä¸ªæ¨ªå‘æ’åˆ—çš„å›¾æ ‡ï¼Œåˆ†åˆ«æ˜¯â€œå‰è¿›â€ã€â€é¡µé¢ä¿¡æ¯â€å’Œâ€åˆ·æ–°â€œã€‚åœ¨èœå•çš„åº•éƒ¨åˆ†åˆ«æ˜¯â€æŸ¥æ‰¾é¡µé¢â€å’Œâ€œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€â€ã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬æœ€å¤šå¯ä»¥åœ¨é¡¶éƒ¨æ¨ªå‘å›¾æ ‡å’Œåº•éƒ¨èœå•ä¹‹é—´æ·»åŠ 5ä¸ªè‡ªå®šä¹‰èœå•é€‰é¡¹ã€‚</p>
<p>èœå•é¡¹é€šè¿‡è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html#addMenuItem(java.lang.String, android.app.PendingIntent" target="_blank" rel="external">CustomTabsIntent.Builder#addMenuItem</a>)æ·»åŠ ï¼Œtitleå’Œç”¨æˆ·ç‚¹å‡»èœå•é€‰é¡¹åChromeè°ƒç”¨çš„pendingIntentéœ€è¦ä½œä¸ºå‚æ•°è¢«ä¼ å…¥ã€‚</p>
<img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/twitter_menu.png" alt="menu" title="menu">
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">builder.addMenuItem(menuItemTitle, menuItemPendingIntent);</div></pre></td></tr></table></figure>
<h4 id="é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»"><a href="#é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»" class="headerlink" title="é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»"></a>é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»</h4><p>è®¸å¤šçš„Androidéƒ½ä¼šåœ¨Activityä¹‹é—´åˆ‡æ¢æ—¶ä½¿ç”¨è‡ªå®šä¹‰çš„è§†å›¾è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»ã€‚Chrome Custom Tabsä¹Ÿä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»ï¼Œä»¥æ­¤ä¿æŒChrome Custom Tabså’Œåº”ç”¨å…¶ä»–å†…å®¹çš„åè°ƒæ€§å’Œä¸€è‡´æ€§ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">builder.setStartAnimations(<span class="keyword">this</span>, R.anim.slide_in_right, R.anim.slide_out_left);</div><div class="line">builder.setExitAnimations(<span class="keyword">this</span>, R.anim.slide_in_left, R.anim.slide_out_right);</div></pre></td></tr></table></figure>
<h4 id="é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦"><a href="#é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦" class="headerlink" title="é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦"></a>é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html#launchUrl(android.app.Activity, android.net.Uri" target="_blank" rel="external"> CustomTabsIntent#launchUrl </a>)è¢«è°ƒç”¨æ—¶ä¼šæ¿€æ´»Chromeï¼ŒåŠ è½½URLã€‚è¿™ä¼šèŠ±è´¹æˆ‘ä»¬å®è´µçš„æ—¶é—´å¹¶ä¸”å½±å“æµç•…åº¦ã€‚</p>
<p>Chromeå›¢é˜Ÿäº†è§£ç”¨æˆ·å¯¹äºæµç•…ä½“éªŒçš„æ¸´æœ›ï¼Œæ‰€ä»¥ä»–ä»¬åœ¨Chromeä¸­æä¾›äº†ä¸€ä¸ªServiceä½¿æˆ‘ä»¬çš„APPèƒ½å¤Ÿè¿æ¥å¹¶ä¸”é¢„çƒ­æµè§ˆå™¨å’ŒåŸç”Ÿç»„ä»¶ã€‚ä»–ä»¬ä¹ŸæŠŠè¿™ç§èƒ½åŠ›åˆ†äº«ç»™äº†æˆ‘ä»¬æ™®é€šå¼€å‘è€…ï¼Œå¼€å‘è€…èƒ½å¤Ÿå‘ŠçŸ¥Chromeç”¨æˆ·è®¿é—®é¡µé¢çš„å¯èƒ½æ€§ã€‚ç„¶åï¼ŒChromeå°±èƒ½å®Œæˆå¦‚ä¸‹çš„æ“ä½œï¼š</p>
<ul>
<li>ä¸»åŸŸåçš„DNSé¢„è§£æ</li>
<li>æœ€æœ‰å¯èƒ½åŠ è½½çš„èµ„æºçš„DNSé¢„è§£æ</li>
<li>åŒ…æ‹¬HTTPS/TLSéªŒè¯åœ¨å†…çš„é¢„è¿æ¥</li>
</ul>
<p>é¢„çƒ­Chromeçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService(android.content.Context, java.lang.String, android.support.customtabs.CustomTabsServiceConnection" target="_blank" rel="external">CustomTabsClient#bindCustomTabsService</a>)è¿æ¥service</li>
<li>ä¸€æ—¦serviceè¿æ¥æˆåŠŸï¼Œåå°è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup(long" target="_blank" rel="external"> CustomTabsClient#warmup</a>)å¯åŠ¨Chrome</li>
<li>è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#newSession(android.support.customtabs.CustomTabsCallback" target="_blank" rel="external"> CustomTabsClient#newSession </a>)åˆ›å»ºä¸€ä¸ªæ–°çš„session.è¿™ä¸ªsessionè¢«ç”¨ä½œæ‰€æœ‰çš„APIè¯·æ±‚</li>
<li>æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºsessionæ—¶é€‰æ‹©æ€§çš„æ·»åŠ ä¸€ä¸ª<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsCallback.html" target="_blank" rel="external"> CustomTabsCallback</a>ä½œä¸ºå‚æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½çŸ¥é“é¡µé¢æ˜¯å¦è¢«åŠ è½½å®Œæˆ</li>
<li>é€šè¿‡<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl(android.net.Uri, android.os.Bundle, java.util.List&lt;android.os.Bundle" target="_blank" rel="external"> CustomTabsSession#mayLaunchUrl</a>)å‘ŠçŸ¥Chromeç”¨æˆ·æœ€æœ‰å¯èƒ½åŠ è½½çš„é¡µé¢</li>
<li>è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html" target="_blank" rel="external"> CustomTabsIntent.Builder </a>æ„é€ æ–¹æ³•ï¼Œå¹¶ä¼ å…¥å·²ç»åˆ›å»ºå¥½çš„<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html" target="_blank" rel="external">CustomTabsSession</a>ä½œä¸ºå‚æ•°ä¼ å…¥</li>
</ul>
<h4 id="è¿æ¥ChromeæœåŠ¡"><a href="#è¿æ¥ChromeæœåŠ¡" class="headerlink" title="è¿æ¥ChromeæœåŠ¡"></a>è¿æ¥ChromeæœåŠ¡</h4><p><a href="("> CustomTabsClient#bindCustomTabsService </a><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService(android.content.Context" target="_blank" rel="external">http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService(android.content.Context</a>, java.lang.String, android.support.customtabs.CustomTabsServiceConnectio)) æ–¹æ³•ç®€åŒ–äº†è¿æ¥Custom TabsæœåŠ¡çš„è¿‡ç¨‹ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsServiceConnection.html" target="_blank" rel="external">CustomTabsServiceConnection</a>çš„ç±»å¹¶ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsServiceConnection.html#onCustomTabsServiceConnected(android.content.ComponentName, android.support.customtabs.CustomTabsClient" target="_blank" rel="external">onCustomTabsServiceConnected </a>)æ–¹æ³•è·å–<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html" target="_blank" rel="external"> CustomTabsClient</a>çš„å®ä¾‹ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ä¼šç”¨åˆ°æ­¤å®ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å®˜æ–¹ç¤ºä¾‹</span></div><div class="line"><span class="comment">// å®¢æˆ·ç«¯éœ€è¦è¿æ¥çš„Chromeçš„åŒ…åï¼Œå–å†³äºchannelçš„åç§°</span></div><div class="line"><span class="comment">// Stable(å‘è¡Œç‰ˆ) = com.android.chrome</span></div><div class="line"><span class="comment">// Beta(æµ‹è¯•ç‰ˆ) = com.chrome.beta</span></div><div class="line"><span class="comment">// Dev(å¼€å‘ç‰ˆ) = com.chrome.dev</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CUSTOM_TAB_PACKAGE_NAME = <span class="string">"com.android.chrome"</span>;  <span class="comment">// Change when in stable</span></div><div class="line"></div><div class="line">CustomTabsServiceConnection connection = <span class="keyword">new</span> CustomTabsServiceConnection() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCustomTabsServiceConnected</span><span class="params">(ComponentName name, CustomTabsClient client)</span> </span>&#123;</div><div class="line">        mCustomTabsClient = client;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceDisconnected</span><span class="params">(ComponentName name)</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">boolean</span> ok = CustomTabsClient.bindCustomTabsService(<span class="keyword">this</span>, mPackageNameToBind, connection);</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æˆ‘çš„ç¤ºä¾‹</span></div><div class="line"><span class="keyword">package</span> com.marktony.zhihudaily.customtabs;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.support.customtabs.CustomTabsServiceConnection;</div><div class="line"><span class="keyword">import</span> android.content.ComponentName;</div><div class="line"><span class="keyword">import</span> android.support.customtabs.CustomTabsClient;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by Lizhaotailang on 2016/9/4.</div><div class="line"> * Implementation for the CustomTabsServiceConnection that avoids leaking the</div><div class="line"> * ServiceConnectionCallback</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceConnection</span> <span class="keyword">extends</span> <span class="title">CustomTabsServiceConnection</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// A weak reference to the ServiceConnectionCallback to avoid leaking it.</span></div><div class="line">    <span class="keyword">private</span> WeakReference&lt;ServiceConnectionCallback&gt; mConnectionCallback;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ServiceConnection</span><span class="params">(ServiceConnectionCallback connectionCallback)</span> </span>&#123;</div><div class="line">        mConnectionCallback = <span class="keyword">new</span> WeakReference&lt;&gt;(connectionCallback);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCustomTabsServiceConnected</span><span class="params">(ComponentName name, CustomTabsClient client)</span> </span>&#123;</div><div class="line">        ServiceConnectionCallback connectionCallback = mConnectionCallback.get();</div><div class="line">        <span class="keyword">if</span> (connectionCallback != <span class="keyword">null</span>) connectionCallback.onServiceConnected(client);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceDisconnected</span><span class="params">(ComponentName name)</span> </span>&#123;</div><div class="line">        ServiceConnectionCallback connectionCallback = mConnectionCallback.get();</div><div class="line">        <span class="keyword">if</span> (connectionCallback != <span class="keyword">null</span>) connectionCallback.onServiceDisconnected();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="é¢„çƒ­æµè§ˆå™¨"><a href="#é¢„çƒ­æµè§ˆå™¨" class="headerlink" title="é¢„çƒ­æµè§ˆå™¨"></a>é¢„çƒ­æµè§ˆå™¨</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup(long" target="_blank" rel="external">boolean warmup(long flags)</a>)</p>
<p>é¢„çƒ­æµè§ˆå™¨è¿›ç¨‹å¹¶åŠ é‡åŸç”Ÿåº“æ–‡ä»¶ã€‚é¢„çƒ­æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œè¿”å›å€¼è¡¨ç¤ºè¯·æ±‚æ˜¯å¦è¢«æ¥æ”¶ã€‚å¤šä¸ªæˆåŠŸçš„è¯·æ±‚éƒ½ä¼šè¿”å›trueã€‚</p>
<p><code>true</code>ä»£è¡¨ç€æˆåŠŸã€‚</p>
<h4 id="åˆ›å»ºæ–°çš„tab-sessioin"><a href="#åˆ›å»ºæ–°çš„tab-sessioin" class="headerlink" title="åˆ›å»ºæ–°çš„tab sessioin"></a>åˆ›å»ºæ–°çš„tab sessioin</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#newSession(android.support.customtabs.CustomTabsCallback" target="_blank" rel="external">boolean newSession(CustomTabsCallback callback)</a>)</p>
<p>sessionç”¨äºåœ¨è¿ç»­è¯·æ±‚ä¸­é“¾æ¥mayLaunchUrlæ–¹æ³•ã€‚CustomTabsIntentå’Œtabäº’ç›¸è”ç³»ã€‚è¿™é‡Œæ‰€æä¾›çš„å›è°ƒå’Œå·²ç»åˆ›å»ºæˆåŠŸçš„sessionç›¸å…³ã€‚é€šè¿‡è¿™ä¸ªå›è°ƒï¼Œä»»ä½•å…³äºå·²ç»æˆåŠŸåˆ›å»ºçš„sessionçš„æ›´æ–°éƒ½ä¼šè¢«æ¥æ”¶åˆ°ã€‚è¿”å›sessionæ˜¯å¦è¢«æˆåŠŸåˆ›å»ºã€‚å¤šä¸ªå…·æœ‰ç›¸åŒCustomTabsCallbackæˆ–è€…nullå€¼çš„è¯·æ±‚éƒ½ä¼šè¿”å›falseã€‚</p>
<h4 id="å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥"><a href="#å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥" class="headerlink" title="å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥"></a>å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl(android.net.Uri, android.os.Bundle, java.util.List&lt;android.os.Bundle" target="_blank" rel="external">boolean mayLaunchUrl(Uri url, Bundle extras, List otherLikelyBundles)</a>)</p>
<p>CustomTabsSessionæ–¹æ³•å‘ŠçŸ¥æµè§ˆå™¨æœªæ¥å¯èƒ½å¯¼èˆªåˆ°çš„urlã€‚<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup(long" target="_blank" rel="external">warmup()</a>)æ–¹æ³•åº”è¯¥å…ˆè¢«è°ƒç”¨ã€‚æœ€æœ‰å¯èƒ½çš„urlåº”è¯¥æœ€å…ˆè¢«æŒ‡å‡ºã€‚ä¹Ÿå¯ä»¥é€‰æ‹©æ€§çš„æä¾›å¯èƒ½åŠ è½½çš„urlçš„åˆ—è¡¨ã€‚åˆ—è¡¨ä¸­çš„æ•°æ®è¢«è®¤ä¸ºè¢«åŠ è½½çš„å¯èƒ½æ€§å°äºæœ€åˆçš„é‚£ä¸€ä¸ªï¼Œè€Œä¸”å¿…é¡»æŒ‰ç…§ä¼˜å…ˆçº§é™åºæ’åˆ—ã€‚è¿™äº›é¢å¤–çš„urlå¯èƒ½è¢«å¿½ç•¥æ‰ã€‚æ‰€æœ‰ä¹‹å‰å¯¹äºè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè¢«å»ä¼˜å…ˆåŒ–ã€‚è¿”å›æ“ä½œæ˜¯å¦æˆåŠŸå®Œæˆã€‚</p>
<h4 id="Custom-Tabsè¿æ¥å›è°ƒ"><a href="#Custom-Tabsè¿æ¥å›è°ƒ" class="headerlink" title="Custom Tabsè¿æ¥å›è°ƒ"></a>Custom Tabsè¿æ¥å›è°ƒ</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsCallback.html#onNavigationEvent(int, android.os.Bundle" target="_blank" rel="external">void onNavigationEvent(int navigationEvent, Bundle extras)</a>)</p>
<p>åœ¨custom tabä¸­ï¼Œå¯¼èˆªäº‹ä»¶å‘ç”Ÿæ—¶è¢«è°ƒç”¨ã€‚â€˜navigationEvent intâ€™æ˜¯å…³äºé¡µé¢å†…çš„6ä¸ªçŠ¶æ€å€¼ä¹‹ä¸€ã€‚6ä¸ªçŠ¶æ€å€¼å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* é¡µé¢å¼€å§‹åŠ è½½æ—¶è¢«å‘é€</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NAVIGATION_STARTED = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* é¡µé¢å®ŒæˆåŠ è½½æ—¶è¢«å‘é€</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NAVIGATION_FINISHED = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* ç”±äºé”™è¯¯tabä¸èƒ½å®ŒæˆåŠ è½½æ—¶è¢«å‘é€</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NAVIGATION_FAILED = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* åœ¨åŠ è½½å®Œæˆä¹‹å‰ï¼ŒåŠ è½½å› ä¸ºç”¨æˆ·åŠ¨ä½œä¾‹å¦‚ç‚¹å‡»äº†å¦å¤–ä¸€ä¸ªé“¾æ¥æˆ–è€…åˆ·æ–°é¡µé¢</div><div class="line">* åŠ è½½è¢«ä¸­æ­¢æ—¶è¢«å‘é€</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NAVIGATION_ABORTED = <span class="number">4</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* tabçŠ¶æ€å˜ä¸ºå¯è§æ—¶å‘é€</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TAB_SHOWN = <span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* tabçŠ¶æ€å˜ä¸ºä¸å¯è§æ—¶å‘é€</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TAB_HIDDEN = <span class="number">6</span>;</div></pre></td></tr></table></figure>
<h4 id="å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ"><a href="#å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ"></a>å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</h4><p>Custom Tabsé€šè¿‡å¸¦æœ‰key Extrasçš„ ACTION_VIEW Intentæ¥å®šåˆ¶UIã€‚è¿™å°±æ„å‘³ç€å°†è¦æ‰“å¼€çš„é¡µé¢ä¼šé€šè¿‡ç³»ç»Ÿæµè§ˆå™¨æˆ–è€…ç”¨æˆ·é»˜è®¤æµè§ˆå™¨æ‰“å¼€ã€‚</p>
<p>å¦‚æœç”¨æˆ·å·²ç»å®‰è£…äº†Chromeå¹¶ä¸”æ˜¯é»˜è®¤æµè§ˆå™¨ï¼Œå®ƒä¼šè‡ªåŠ¨çš„è·å–EXTRASçš„å€¼å¹¶æä¾›ä¸€ä¸ªå®šåˆ¶åŒ–çš„UIã€‚å…¶ä»–çš„æµè§ˆå™¨ä½¿ç”¨Intent extrasæä¾›ç›¸åŒçš„å®šåˆ¶UIä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ã€‚</p>
<h4 id="æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome-Custom-Tabs"><a href="#æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome-Custom-Tabs" class="headerlink" title="æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome Custom Tabs?"></a>æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome Custom Tabs?</h4><p>æ‰€æœ‰æ”¯æŒChrome Custom Tabsçš„Chromeæµè§ˆå™¨éƒ½æš´éœ²äº†ä¸€ä¸ªserviceã€‚ä¸ºäº†æ£€æµ‹æ˜¯å¦æ”¯æŒChrome Custom Tabsï¼Œå¯ä»¥å°è¯•ç€ç»‘å®šserviceï¼Œå¦‚æœæˆåŠŸçš„è¯ï¼Œé‚£ä¹ˆCustoms Tabså¯ä»¥æˆåŠŸçš„ä½¿ç”¨ã€‚</p>
<h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><p>å¯ç”¨Chrome Custom Tabså,æˆ‘ä»¬çœ‹åˆ°äº†å„ç§ä¸åŒè´¨é‡ç•Œåˆ«çš„å®ç°æ•ˆæœã€‚è¿™é‡Œä»‹ç»ä¸€ç»„å®ç°ä¼˜ç§€é›†æˆçš„æœ€ä½³å®è·µã€‚ </p>
<h4 id="è¿æ¥Custome-Tabs-Serviceå¹¶å‘èµ·é¢„çƒ­"><a href="#è¿æ¥Custome-Tabs-Serviceå¹¶å‘èµ·é¢„çƒ­" class="headerlink" title="è¿æ¥Custome Tabs Serviceå¹¶å‘èµ·é¢„çƒ­"></a>è¿æ¥Custome Tabs Serviceå¹¶å‘èµ·é¢„çƒ­</h4><p>è¿æ¥åˆ°Custom Tabs Serviceå¹¶é¢„åŠ è½½Chromeä¹‹åï¼Œé€šè¿‡Custom Tabsæ‰“å¼€é“¾æ¥ <strong>æœ€å¤šå¯ä»¥èŠ‚çœ700ms</strong> ã€‚</p>
<p>åœ¨æˆ‘ä»¬æ‰“ç®—å¯ç”¨Custom Tabsçš„Activityçš„ <a href="http://developer.android.com/reference/android/app/Activity.html#onStart(" target="_blank" rel="external">onStart()</a>) æ–¹æ³•ä¸­è¿æ¥ Custom Tabs serviceã€‚è¿æ¥æˆåŠŸåï¼Œè°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup%28long%29" target="_blank" rel="external">warmup()</a>æ–¹æ³•ã€‚</p>
<p>Custom Tabsä½œä¸ºä¸€ä¸ªéå¸¸ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ <strong>å®ƒä¸ä¼šå¯¹æˆ‘ä»¬çš„åº”ç”¨ä¸ä¼šæœ‰ä»»ä½•çš„è´Ÿé¢çš„å½±å“</strong>ï¼Œä½†æ˜¯å½“åŠ è½½é“¾æ¥æ—¶ï¼Œä¼šè·å¾—éå¸¸å¥½çš„å¯åŠ¨æ€§èƒ½ã€‚</p>
<h4 id="å†…å®¹é¢„æ¸²æŸ“"><a href="#å†…å®¹é¢„æ¸²æŸ“" class="headerlink" title="å†…å®¹é¢„æ¸²æŸ“"></a>å†…å®¹é¢„æ¸²æŸ“</h4><p>é¢„æ¸²æŸ“è®©å†…å®¹æ‰“å¼€éå¸¸è¿…é€Ÿã€‚æ‰€ä»¥ï¼Œå¦‚æœç”¨æˆ· <strong>è‡³å°‘æœ‰50%çš„å¯èƒ½æ€§</strong> æ‰“å¼€æŸä¸ªé“¾æ¥ï¼Œè°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl%28android.net.Uri,%20android.os.Bundle,%20java.util.List%3Candroid.os.Bundle%3E%29" target="_blank" rel="external">mayLaunchUrl()</a><br>æ–¹æ³•ã€‚</p>
<p>è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl%28android.net.Uri,%20android.os.Bundle,%20java.util.List%3Candroid.os.Bundle%3E%29" target="_blank" rel="external">mayLaunchUrl()</a><br>æ–¹æ³•æ–¹æ³•èƒ½ä½¿Custom Tabsé¢„è·å–ä¸»é¡µé¢æ‰€æ”¯æŒçš„å†…å®¹å¹¶é¢„æ¸²æŸ“ã€‚è¿™ä¼šæœ€å¤§ç¨‹åº¦çš„åŠ å¿«é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€‚ä½†æ˜¯ä¼šä¸å¯é¿å…çš„æœ‰ <strong>ä¸€ç‚¹æµé‡å’Œç”µé‡çš„æ¶ˆè€—</strong>ã€‚</p>
<p>Custom Tabséå¸¸çš„æ™ºèƒ½ï¼Œèƒ½å¤Ÿæ„ŸçŸ¥ç”¨æˆ·æ˜¯å¦åœ¨ä½¿ç”¨æ”¶è´¹çš„ç½‘ç»œæˆ–è€…è®¾å¤‡ç”µé‡ä¸è¶³ï¼Œé¢„æ¸²æŸ“å¯¹è®¾å¤‡çš„æ•´ä½“æ€§èƒ½æœ‰è´Ÿé¢çš„å½±å“ï¼Œåœ¨è¿™æ ·çš„åœºæ™¯ä¸‹ï¼ŒCustom Tabså°±ä¸ä¼šè¿›è¡Œé¢„è·å–æˆ–è€…é¢„æ¸²æŸ“ã€‚æ‰€ä»¥ï¼Œä¸ç”¨æ‹…å¿ƒåº”ç”¨çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h4 id="å½“Custom-Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ"><a href="#å½“Custom-Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ" class="headerlink" title="å½“Custom Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ"></a>å½“Custom Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ</h4><p>å°½ç®¡Custom Tabså¯¹äºå¤§å¤šæ•°ç”¨æˆ·éƒ½æ˜¯é€‚ç”¨çš„ï¼Œä»ç„¶æœ‰ä¸€äº›åœºæ™¯ä¸é€‚ç”¨ï¼Œä¾‹å¦‚è®¾å¤‡ä¸Šæ²¡æœ‰å®‰è£…æ”¯æŒCustom Tabsçš„æµè§ˆå™¨æˆ–è€…æ˜¯è®¾å¤‡ä¸Šçš„æµè§ˆå™¨ç‰ˆæœ¬ä¸æ”¯æŒCustom Tabsã€‚</p>
<p><strong>ç¡®ä¿æä¾›äº†å¤‡é€‰æ–¹æ¡ˆä»¥æä¾›å¥½çš„åº”ç”¨ä½“éªŒ</strong>ã€‚æ‰“å¼€é»˜è®¤æµè§ˆå™¨æˆ–è€…å¼•å…¥WebViewéƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p>
<h4 id="å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer-å¼•èæ¥æº"><a href="#å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer-å¼•èæ¥æº" class="headerlink" title="å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer(å¼•èæ¥æº)"></a>å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer(å¼•èæ¥æº)</h4><p>é€šå¸¸ï¼Œå¯¹äºç½‘ç«™è€Œè¨€ï¼Œè¿½ç”¨è®¿é—®çš„æ¥æºéå¸¸åœ°é‡è¦ã€‚å½“åŠ è½½äº†Custom Tabsæ—¶ï¼Œé€šè¿‡è®¾ç½®referrerï¼Œè®©ä»–ä»¬çŸ¥æ™“æˆ‘ä»¬æ­£åœ¨ç»™ä»–ä»¬æé«˜è®¿é—®é‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">intent.putExtra(Intent.EXTRA_REFERRER, </div><div class="line">        Uri.parse(Intent.URI_ANDROID_APP_SCHEME + <span class="string">"//"</span> + context.getPackageName()));</div></pre></td></tr></table></figure>
<h4 id="æ·»åŠ å®šåˆ¶åŠ¨ç”»"><a href="#æ·»åŠ å®šåˆ¶åŠ¨ç”»" class="headerlink" title="æ·»åŠ å®šåˆ¶åŠ¨ç”»"></a>æ·»åŠ å®šåˆ¶åŠ¨ç”»</h4><p>å®šåˆ¶çš„åŠ¨ç”»èƒ½å¤Ÿä½¿æˆ‘ä»¬çš„åº”ç”¨åˆ‡æ¢åˆ°ç½‘é¡µå†…å®¹æ—¶æ›´åŠ åœ°é¡ºç•…ã€‚ ç¡®ä¿è¿›åœºåŠ¨ç”»å’Œå‡ºå‚åŠ¨ç”»æ˜¯åå‘çš„ï¼Œè¿™æ ·èƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·ç†è§£è·³è½¬çš„å…³ç³»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®å®šåˆ¶çš„è¿›å…¥/é€€å‡ºåŠ¨ç”»</span></div><div class="line"> CustomTabsIntent.Builder intentBuilder = <span class="keyword">new</span> CustomTabsIntent.Builder();</div><div class="line"> intentBuilder.setStartAnimations(<span class="keyword">this</span>, R.anim.slide_in_right, R.anim.slide_out_left);</div><div class="line"> intentBuilder.setExitAnimations(<span class="keyword">this</span>, android.R.anim.slide_in_left,</div><div class="line">     android.R.anim.slide_out_right);</div><div class="line"></div><div class="line"> <span class="comment">//æ‰“å¼€Custom Tab        </span></div><div class="line"> intentBuilder.build().launchUrl(context, Uri.parse(<span class="string">"https://github.com/marktony"</span>));</div></pre></td></tr></table></figure>
<h4 id="ä¸ºAction-Buttoné€‰æ‹©ä¸€ä¸ªicon"><a href="#ä¸ºAction-Buttoné€‰æ‹©ä¸€ä¸ªicon" class="headerlink" title="ä¸ºAction Buttoné€‰æ‹©ä¸€ä¸ªicon"></a>ä¸ºAction Buttoné€‰æ‹©ä¸€ä¸ªicon</h4><p>æ·»åŠ ä¸€ä¸ªAction Buttonèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´åŠ ç†è§£APPçš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ²¡æœ‰å¥½çš„iconä»£è¡¨Action Buttonå°†è¦æ‰§è¡Œçš„æ“ä½œï¼Œæœ‰å¿…è¦åˆ›å»ºä¸€ä¸ªå¸¦æ“ä½œæ–‡å­—æè¿°çš„ä½å›¾ã€‚</p>
<p>ç‰¢è®°ä½å›¾çš„æœ€å¤§å°ºå¯¸ä¸ºé«˜åº¦24dpï¼Œå®½åº¦48dpã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">  String shareLabel = getString(R.string.label_action_share);</div><div class="line">  Bitmap icon = BitmapFactory.decodeResource(getResources(),</div><div class="line">          android.R.drawable.ic_menu_share);</div><div class="line"></div><div class="line">  <span class="comment">// ä¸ºæˆ‘ä»¬çš„BroadCastReceiveråˆ›å»ºä¸€ä¸ªPendingIntent</span></div><div class="line">  Intent actionIntent = <span class="keyword">new</span> Intent(</div><div class="line">          <span class="keyword">this</span>.getApplicationContext(), ShareBroadcastReceiver.class);</div><div class="line">  PendingIntent pendingIntent = </div><div class="line">          PendingIntent.getBroadcast(getApplicationContext(), <span class="number">0</span>, actionIntent, <span class="number">0</span>);	        </div><div class="line"></div><div class="line"><span class="comment">// è®¾ç½®pendingIntentä½œä¸ºæŒ‰é’®è¢«ç‚¹å‡»åå°†è¦æ‰§è¡Œçš„æ“ä½œ    </span></div><div class="line">  intentBuilder.setActionButton(icon, shareLabel, pendingIntent);</div></pre></td></tr></table></figure>
<h4 id="ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡"><a href="#ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡" class="headerlink" title="ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡"></a>ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡</h4><p>ç‰¢è®°ç”¨æˆ·å®‰è£…çš„æµè§ˆå™¨ä¸­ï¼Œæ”¯æŒCustom Tabsçš„æ•°é‡å¯èƒ½ä¸æ­¢ä¸€ä¸ªã€‚å¦‚æœæœ‰ä¸æ­¢ä¸€ä¸ªæµè§ˆå™¨æ”¯æŒCustom Tabsï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•ä¸€ä¸ªæµè§ˆå™¨è¢«è®¾ç½®ä¸ºåå¥½æµè§ˆå™¨ï¼Œéœ€è¦è¯¢é—®ç”¨æˆ·å¦‚ä½•æ‰“å¼€é“¾æ¥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * è¿”å›æ”¯æŒCustom Tabsçš„åº”ç”¨çš„åŒ…å</div><div class="line"> */	</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList <span class="title">getCustomTabsPackages</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">    PackageManager pm = context.getPackageManager();</div><div class="line">    <span class="comment">// Get default VIEW intent handler.</span></div><div class="line">    Intent activityIntent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW, Uri.parse(<span class="string">"http://www.example.com"</span>));</div><div class="line"></div><div class="line">    <span class="comment">// è·å–æ‰€æœ‰èƒ½å¤Ÿå¤„ç†VIEW intentsçš„åº”ç”¨</span></div><div class="line">    List resolvedActivityList = pm.queryIntentActivities(activityIntent, <span class="number">0</span>);</div><div class="line">    ArrayList packagesSupportingCustomTabs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    <span class="keyword">for</span> (ResolveInfo info : resolvedActivityList) &#123;</div><div class="line">        Intent serviceIntent = <span class="keyword">new</span> Intent();</div><div class="line">        serviceIntent.setAction(ACTION_CUSTOM_TABS_CONNECTION);</div><div class="line">        serviceIntent.setPackage(info.activityInfo.packageName);</div><div class="line">        <span class="comment">// Check if this package also resolves the Custom Tabs service.</span></div><div class="line">        <span class="keyword">if</span> (pm.resolveService(serviceIntent, <span class="number">0</span>) != <span class="keyword">null</span>) &#123;</div><div class="line">            packagesSupportingCustomTabs.add(info);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> packagesSupportingCustomTabs;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom-Tabs"><a href="#å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom-Tabs" class="headerlink" title="å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom Tabs"></a>å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom Tabs</h4><p>ä¸ºåº”ç”¨æ·»åŠ ä¸€ä¸ªè®¾ç½®é€‰é¡¹ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡é»˜è®¤æµè§ˆå™¨è€Œä¸æ˜¯Custom Tabæ‰“å¼€é“¾æ¥ã€‚å¦‚æœæˆ‘ä»¬çš„åº”ç”¨åœ¨æ·»åŠ Custom Tabsä¹‹å‰ï¼Œéƒ½æ˜¯é€šè¿‡é»˜è®¤æµè§ˆå™¨æ‰“å¼€é“¾æ¥æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p>
<h4 id="å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL"><a href="#å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL" class="headerlink" title="å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL"></a>å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL</h4><p>Nativeåº”ç”¨å¯ä»¥å¤„ç†ä¸€äº›urlã€‚å¦‚æœç”¨æˆ·å®‰è£…äº†Twitter APPï¼Œåœ¨ç‚¹å‡»tweetå†…çš„é“¾æ¥æ—¶ï¼Œå¥¹æ›´åŠ å¸Œæœ›Twitteråº”ç”¨èƒ½å¤Ÿå¤„ç†è¿™äº›é“¾æ¥ã€‚</p>
<p>åœ¨åº”ç”¨å†…æ‰“å¼€é“¾æ¥ä¹‹å‰ï¼Œæ£€æŸ¥æ‰‹æœºé‡Œæœ‰æ²¡æœ‰å…¶ä»–APPèƒ½å¤Ÿå¤„ç†è¿™äº›urlã€‚</p>
<h4 id="å®šåˆ¶Toolbarçš„é¢œè‰²"><a href="#å®šåˆ¶Toolbarçš„é¢œè‰²" class="headerlink" title="å®šåˆ¶Toolbarçš„é¢œè‰²"></a>å®šåˆ¶Toolbarçš„é¢œè‰²</h4><p>å¦‚æœæƒ³è¦è®©ç”¨æˆ·æ„Ÿè§‰ç½‘é¡µå†…å®¹æ˜¯æˆ‘ä»¬åº”ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œå°†toolbarçš„é¢œè‰²è®¾ç½®ä¸ºprimaryColorã€‚</p>
<p>å¦‚æœæƒ³è¦è®©ç”¨æˆ·æ¸…æ¥šçš„äº†è§£åˆ°å·²ç»ç¦»å¼€äº†æˆ‘ä»¬çš„åº”ç”¨ï¼Œé‚£å°±å®Œå…¨ä¸è¦å®šä¹‰toolbarçš„é¢œè‰²ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®¾ç½®è‡ªå®šä¹‰çš„toolbarçš„é¢œè‰²</span></div><div class="line">CustomTabsIntent.Builder intentBuilder = <span class="keyword">new</span> CustomTabsIntent.Builder();</div><div class="line">intentBuilder.setToolbarColor(Color.BLUE);</div></pre></td></tr></table></figure>
<h4 id="å¢åŠ åˆ†äº«æŒ‰é’®"><a href="#å¢åŠ åˆ†äº«æŒ‰é’®" class="headerlink" title="å¢åŠ åˆ†äº«æŒ‰é’®"></a>å¢åŠ åˆ†äº«æŒ‰é’®</h4><p>ç¡®ä¿åœ¨overflowèœå•ä¸­æ·»åŠ äº†ä¸€ä¸ªåˆ†äº«çš„æ“ä½œï¼Œåœ¨å¤§å¤šæ•°çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¸Œæœ›èƒ½å¤Ÿåˆ†äº«å½“å‰æ‰€è§ç½‘é¡µå†…å®¹çš„é“¾æ¥ï¼ŒCustom Tabsé»˜è®¤æ²¡æœ‰æ·»åŠ åˆ†äº«çš„æŒ‰é’®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åœ¨BroadCastReceiverä¸­åˆ†äº«æ¥è‡ªCustomTabsçš„å†…å®¹</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</div><div class="line">    String url = intent.getDataString();</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (url != <span class="keyword">null</span>) &#123;</div><div class="line">        Intent shareIntent = <span class="keyword">new</span> Intent(Intent.ACTION_SEND);</div><div class="line">        shareIntent.setType(<span class="string">"text/plain"</span>);</div><div class="line">        shareIntent.putExtra(Intent.EXTRA_TEXT, url);</div><div class="line"></div><div class="line">        Intent chooserIntent = Intent.createChooser(shareIntent, <span class="string">"Share url"</span>);</div><div class="line">        chooserIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</div><div class="line"></div><div class="line">        context.startActivity(chooserIntent);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="å®šåˆ¶å…³é—­æŒ‰é’®"><a href="#å®šåˆ¶å…³é—­æŒ‰é’®" class="headerlink" title="å®šåˆ¶å…³é—­æŒ‰é’®"></a>å®šåˆ¶å…³é—­æŒ‰é’®</h4><p>è‡ªå®šä¹‰å…³é—­æŒ‰é’®ä½¿CustomTabsçœ‹èµ·æ¥åƒåº”ç”¨çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>å¦‚æœå¸Œæœ›CustomTabsåœ¨ç”¨æˆ·çœ‹æ¥åƒä¸€ä¸ªDialog, ä½¿ç”¨â€™xâ€™(å‰å‰)æŒ‰é’®ã€‚å¦‚æœå¸Œæœ›Custom Tabæ˜¯ç”¨æˆ·çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨è¿”å›ç®­å¤´ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®è‡ªå®šä¹‰çš„å…³é—­æŒ‰é’®</span></div><div class="line">CustomTabsIntent.Builder intentBuilder = <span class="keyword">new</span> CustomTabsIntent.Builder();</div><div class="line">intentBuilder.setCloseButtonIcon(BitmapFactory.decodeResource(</div><div class="line">    getResources(), R.drawable.ic_arrow_back));</div></pre></td></tr></table></figure>
<h4 id="å¤„ç†å†…éƒ¨é“¾æ¥"><a href="#å¤„ç†å†…éƒ¨é“¾æ¥" class="headerlink" title="å¤„ç†å†…éƒ¨é“¾æ¥"></a>å¤„ç†å†…éƒ¨é“¾æ¥</h4><p>å½“ç›‘å¬åˆ°é“¾æ¥æ˜¯ç”±<a href="http://developer.android.com/reference/android/widget/TextView.html#attr_android:autoLink" target="_blank" rel="external">android:autoLink</a>ç”Ÿæˆçš„æˆ–è€…åœ¨WebViewä¸­å¤å†™äº†clickæ–¹æ³•ï¼Œç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨å¤„ç†äº†è¿™äº›å†…å®¹çš„é“¾æ¥ï¼Œè®©CustomTabså¤„ç†å¤–éƒ¨é“¾æ¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">WebView webView = (WebView)findViewById(R.id.webview);</div><div class="line">webView.setWebViewClient(<span class="keyword">new</span> WebViewClient() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoadResource</span><span class="params">(WebView view, String url)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (url.startsWith(<span class="string">"http://www.example.com"</span>)) &#123;</div><div class="line">            <span class="comment">//Handle Internal Link...</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">//Open Link in a Custom Tab</span></div><div class="line">            Uri uri = Uri.parse(url);</div><div class="line">            CustomTabsIntent.Builder intentBuilder =</div><div class="line">                    <span class="keyword">new</span> CustomTabsIntent.Builder(mCustomTabActivityHelper.getSession());</div><div class="line">           <span class="comment">//Open the Custom Tab        </span></div><div class="line">            intentBuilder.build().launchUrl(context, url));                            </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="å¤„ç†è¿å‡»"><a href="#å¤„ç†è¿å‡»" class="headerlink" title="å¤„ç†è¿å‡»"></a>å¤„ç†è¿å‡»</h4><p>å¦‚æœå¸Œæœ›åœ¨ç”¨æˆ·ç‚¹å‡»é“¾æ¥å’Œæ‰“å¼€CustomTabsä¹‹é—´åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œç¡®ä¿æ‰€èŠ±è´¹çš„æ—¶é—´ä¸è¶…è¿‡100msã€‚å¦åˆ™ç”¨æˆ·ä¼šè®¤ä¸ºAPPæ²¡æœ‰å“åº”ï¼Œå¯èƒ½æ˜¯è¯•ç€ç‚¹å‡»é“¾æ¥å¤šæ¬¡ã€‚</p>
<p>å¦‚æœä¸èƒ½é¿å…å»¶è¿Ÿï¼Œç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨å¯¹å¯èƒ½çš„æƒ…å†µåšå¥½å‡†å¤‡ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ç›¸åŒçš„é“¾æ¥å¤šæ¬¡æ—¶ï¼Œä¸è¦å¤šæ¬¡æ‰“å¼€CustomTabã€‚</p>
<h3 id="ä½ç‰ˆæœ¬API"><a href="#ä½ç‰ˆæœ¬API" class="headerlink" title="ä½ç‰ˆæœ¬API"></a>ä½ç‰ˆæœ¬API</h3><p>å°½ç®¡æ•´åˆCustom Tabsçš„æ¨èæ–¹å¼æ˜¯ä½¿ç”¨Custom Tabs Support Libraryï¼Œä½APIç‰ˆæœ¬çš„ç³»ç»Ÿä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚</p>
<p>å®Œæ•´çš„Support Libraryçš„å¯¼å…¥æ–¹æ³•å¯ä»¥å‚è§<a href="https://github.com/GoogleChrome/custom-tabs-client/tree/master/customtabs" target="_blank" rel="external">GitHub</a>,å¹¶å¯ä»¥åšä¸ºä¸€ä¸ªèµ·ç‚¹ã€‚è¿æ¥serviceçš„<a href="http://developer.android.com/guide/components/aidl.html" target="_blank" rel="external">AIDLæ–‡ä»¶</a>ä¹Ÿè¢«åŒ…å«åœ¨å…¶ä¸­ï¼ŒChromiumä»“åº“ä¸­ä¹ŸåŒ…å«äº†è¿™äº›æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶åœ¨Android Studioä¸­æ˜¯ä¸èƒ½ç›´æ¥è¢«ä½¿ç”¨çš„ã€‚</p>
<h4 id="åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom-Tabsçš„åŸºæœ¬æ–¹æ³•"><a href="#åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom-Tabsçš„åŸºæœ¬æ–¹æ³•" class="headerlink" title="åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom Tabsçš„åŸºæœ¬æ–¹æ³•"></a>åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom Tabsçš„åŸºæœ¬æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">String url = Â¨https:<span class="comment">//github.com/marktonyÂ¨;</span></div><div class="line">Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW, Uri.parse(url)); </div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String EXTRA_CUSTOM_TABS_SESSION = <span class="string">"android.support.customtabs.extra.SESSION"</span>;</div><div class="line">Bundle extras = <span class="keyword">new</span> Bundle;</div><div class="line">extras.putBinder(EXTRA_CUSTOM_TABS_SESSION, </div><div class="line">   sessionICustomTabsCallback.asBinder() <span class="comment">/* ä¸éœ€è¦sessionæ—¶è®¾ç½®ä¸ºnull */</span>);</div><div class="line">intent.putExtras(extras);</div></pre></td></tr></table></figure>
<h4 id="å®šåˆ¶UI"><a href="#å®šåˆ¶UI" class="headerlink" title="å®šåˆ¶UI"></a>å®šåˆ¶UI</h4><p>UIå®šåˆ¶æ˜¯é€šè¿‡å‘ACTION_VIEW Intentæ·»åŠ Extraså®ç°çš„ã€‚ç”¨äºå®šåˆ¶UIçš„å®Œæ•´çš„extras keysçš„åˆ—è¡¨å¯ä»¥åœ¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html" target="_blank" rel="external"> CustomTabsIntent docs </a>æ‰¾åˆ°ã€‚ä¸‹é¢æ˜¯æ·»åŠ è‡ªå®šä¹‰çš„toolbarçš„é¢œè‰²çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String EXTRA_CUSTOM_TABS_TOOLBAR_COLOR = <span class="string">"android.support.customtabs.extra.TOOLBAR_COLOR"</span>;</div><div class="line">intent.putExtra(EXTRA_CUSTOM_TABS_TOOLBAR_COLOR, colorInt);</div></pre></td></tr></table></figure>
<h4 id="è¿æ¥Custom-Tabs-Service"><a href="#è¿æ¥Custom-Tabs-Service" class="headerlink" title="è¿æ¥Custom Tabs Service"></a>è¿æ¥Custom Tabs Service</h4><p>Custom Tabs serviceå’Œå…¶ä»–Android Serviceçš„ä½¿ç”¨æ–¹æ³•ç›¸åŒã€‚æ¥å£é€šè¿‡AIDLåˆ›å»ºå¹¶ä¸”ä»£ç†serviceç±»ä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// å®¢æˆ·ç«¯éœ€è¦è¿æ¥çš„Chromeçš„åŒ…åï¼Œå–å†³äºchannelçš„åç§°</div><div class="line">// Stable(å‘è¡Œç‰ˆ) = com.android.chrome</div><div class="line">// Beta(æµ‹è¯•ç‰ˆ) = com.chrome.beta</div><div class="line">// Dev(å¼€å‘ç‰ˆ) = com.chrome.dev</div><div class="line">public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.chrome.dev&quot;;  // Change when in stable</div><div class="line"></div><div class="line">public static final String ACTION_CUSTOM_TABS_CONNECTION =</div><div class="line">       &quot;android.support.customtabs.action.CustomTabsService&quot;;</div><div class="line">Intent serviceIntent = new Intent(ACTION_CUSTOM_TABS_CONNECTION);</div><div class="line"></div><div class="line">serviceIntent.setPackage(CUSTOM_TAB_PACKAGE_NAME);</div><div class="line">context.bindService(serviceIntent, mServiceConnection,</div><div class="line">                    Context.BIND_AUTO_CREATE | Context.BIND_WAIVE_PRIORITY);</div></pre></td></tr></table></figure>
<h3 id="ä¸€äº›æœ‰ç”¨çš„ç½‘å€"><a href="#ä¸€äº›æœ‰ç”¨çš„ç½‘å€" class="headerlink" title="ä¸€äº›æœ‰ç”¨çš„ç½‘å€"></a>ä¸€äº›æœ‰ç”¨çš„ç½‘å€</h3><ul>
<li><a href="https://github.com/GoogleChrome/custom-tabs-client" target="_blank" rel="external">Github Demo</a></li>
<li><a href="http://stackoverflow.com/questions/tagged/chrome-custom-tabs" target="_blank" rel="external">Chrome Custom Tabs on StackOverflow</a></li>
<li>æˆ‘çš„é¡¹ç›®åœ°å€:<a href="https://github.com/marktony/PaperPlane" target="_blank" rel="external">PaperPlane</a></li>
</ul>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ˜¯é¢å‘å›½å¤–ç”¨æˆ·çš„ï¼Œé‚£ç†æ‰€å½“ç„¶çš„ï¼Œåº”è¯¥åŠ å…¥Chrome Custom Tabsçš„æ”¯æŒï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿæå‡ç”¨æˆ·çš„ä½“éªŒã€‚å¦‚æœæˆ‘ä»¬çš„åº”ç”¨åªæ˜¯é¢å‘å›½å†…ç”¨æˆ·ï¼Œæˆ‘çš„å»ºè®®è¿˜æ˜¯åº”è¯¥åŠ ä¸Šè¿™é¡¹åŠŸèƒ½ï¼Œæ¯•ç«Ÿï¼Œè¿˜æ˜¯æœ‰éƒ¨åˆ†ç”¨æˆ·å®‰è£…äº†Chromeæµè§ˆå™¨ï¼Œå½“ç”¨æˆ·æµè§ˆåˆ°Custom Tabé¡µé¢ï¼Œåº”è¯¥ä¹Ÿä¼šåƒæˆ‘ä¸€æ ·ï¼Œæ„Ÿè§‰åˆ°çœ¼å‰ä¸€äº®å§ã€‚</p>
<p>æ–‡ç« æ¯”è¾ƒé•¿ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼]]></title>
      <url>http://marktony.github.io/2016/12/31/%E7%AE%80%E6%B4%81%E4%BC%98%E9%9B%85%E5%9C%B0%E5%AE%9E%E7%8E%B0%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨å®˜æ–¹Support Libraryå®ç°æ—¥é—´ä¸å¤œé—´æ¨¡å¼<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Android 6.0 Marshmallow é¢„è§ˆç‰ˆä¸­æ›¾ç»çŸ­æš‚å‡ºç°è¿‡ç›¸å…³çš„å¤œé—´æ¨¡å¼çš„åŠŸèƒ½ï¼Œåªæ˜¯åœ¨æ­£å¼ç‰ˆä¸­è¢«ç§»é™¤äº†ï¼Œåœ¨Android 7.0 Nougatä¸Šï¼Œç”¨æˆ·ä»¬å†æ¬¡ç»å†äº†ã€Œå¾—è€Œå¤å¤±ã€çš„é—æ†¾ï¼Œåœ¨å¼€å‘è€…é¢„è§ˆç‰ˆä¸­ï¼Œå¤œé—´æ¨¡å¼å’Œæš—è‰²æ¨¡å¼å…ˆæ˜¯å¼€å¯ï¼Œç„¶åæœ‰å†æ¬¡è¢«ç§»é™¤ã€‚è€Œåœ¨æ­£å¼ç‰ˆä¸­ï¼Œå¤œé—´æ¨¡å¼ä¹Ÿæ²¡æœ‰å‡ºç°ã€‚ä½†å…¶å®ç›¸å…³çš„ä»£ç ä¸€ç›´å­˜åœ¨äºç³»ç»Ÿä¸­ï¼Œåªæ˜¯é»˜è®¤æ²¡æœ‰è¢«å¼€å¯ã€‚å¦‚ä½•å¼€å¯è¿™é¡¹åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒå°‘æ•°æ´¾çš„è¿™ä¸€ç¯‡æ–‡ç« ï¼Œ<a href="http://sspai.com/35273" target="_blank" rel="external">å¸®ä½ æ‰¾å› Android 7.0 å¤œé—´æ¨¡å¼çš„ 2 æ¬¾åº”ç”¨</a>ã€‚</p>
<p>ä¸è¿‡ï¼Œä»Šå¤©è¦ä»‹ç»çš„ä¸»è¦å†…å®¹å¹¶ä¸æ˜¯å…³äºç³»ç»Ÿçš„å¤œé—´æ¨¡å¼ï¼Œè€Œæ˜¯å¦‚ä½•ç»™æˆ‘ä»¬å¼€å‘çš„APPæ·»åŠ å¤œé—´æ¨¡å¼çš„åŠŸèƒ½ã€‚æ¯«ä¸å¤¸å¼ çš„è¯´ï¼Œå¤œé—´æ¨¡å¼ç°åœ¨å·²ç»æ˜¯é˜…è¯»ç±»Appçš„æ ‡é…äº†ã€‚äº‹å®ä¸Šï¼Œæ—¥é—´æ¨¡å¼ä¸å¤œé—´æ¨¡å¼å°±æ˜¯ç»™APPå®šä¹‰å¹¶åº”ç”¨ä¸¤å¥—ä¸åŒé¢œè‰²çš„ä¸»é¢˜ã€‚ç”¨æˆ·å¯ä»¥è‡ªåŠ¨æˆ–è€…æ‰‹åŠ¨çš„å¼€å¯ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸¤ä¸ªæˆ‘è®¤ä¸ºå®ç°åœ°å¾ˆä¼˜é›…çš„ä¾‹å­ï¼šçŸ¥ä¹å’ŒTwitterã€‚</p>
<img src="/2016/12/31/ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼/zhihu_twitter_nightmode.gif" alt="zhihu_twitter_nightmode" title="zhihu_twitter_nightmode">
<p>è¿™ä¸¤ä¸ªAPPåœ¨åˆ‡æ¢çš„å·¥ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰å‡ºç°é—ªç°é»‘å±çš„æƒ…å†µï¼Œåˆ‡æ¢ä¹Ÿæ¯”è¾ƒé¡ºæ»‘ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åˆ©ç”¨Support Libraryå®ç°åŒæ ·çš„æ•ˆæœã€‚</p>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h3 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile &apos;com.android.support:appcompat-v7:25.1.0&apos;</div></pre></td></tr></table></figure>
<p>ç”±äºSupport Libraryåœ¨23.2.0çš„ç‰ˆæœ¬ä¸­æ‰æ·»åŠ äº†Theme.AppCompat.DayNightä¸»é¢˜ï¼Œæ‰€ä»¥ä¾èµ–çš„ç‰ˆæœ¬å¿…é¡»æ˜¯é«˜äº23.2.0çš„ï¼Œå¹¶ä¸”ï¼Œè¿™ä¸ªç‰¹æ€§æ”¯æŒçš„æœ€ä½SDKç‰ˆæœ¬ä¸º14ï¼Œæ‰€ä»¥ï¼Œéœ€è¦å…¼å®¹Android 4.0çš„è®¾å¤‡ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨è¿™ä¸ªç‰¹æ€§çš„ï¼Œåœ¨API Level 14ä»¥ä¸‹çš„è®¾å¤‡ä¼šé»˜è®¤ä½¿ç”¨äº®è‰²ä¸»é¢˜ã€‚ä¸è¿‡ç°åœ¨4.0ä»¥ä¸‹çš„è®¾å¤‡åº”è¯¥æ¯”è¾ƒå°‘äº†å§ï¼Œæ¯•ç«Ÿå¾®ä¿¡çš„minSdkVersionéƒ½è®¾ç½®ä¸º14äº†ã€‚</p>
<h3 id="å‡†å¤‡èµ„æº"><a href="#å‡†å¤‡èµ„æº" class="headerlink" title="å‡†å¤‡èµ„æº"></a>å‡†å¤‡èµ„æº</h3><ol>
<li><p>è®©æˆ‘ä»¬è‡ªå·±çš„ä¸»é¢˜ç»§æ‰¿å¹¶åº”ç”¨DayNightä¸»é¢˜ã€‚</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.DayNight.DarkActionBar"</span>&gt;</span><span class="xml"></span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!--customize your theme here--&gt;</span></div><div class="line">        </div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>æ–°å»ºå¤œé—´æ¨¡å¼èµ„æºæ–‡ä»¶å¤¹:åœ¨<code>res</code>ç›®å½•ä¸‹æ–°å»º<code>values-night</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨æ­¤ç›®å½•ä¸‹æ–°å»º<code>colors.xml</code>æ–‡ä»¶åœ¨å¤œé—´æ¨¡å¼ä¸‹çš„åº”ç”¨çš„èµ„æºã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦æ–°å»º<code>drawable-night</code>,<code>layout-night</code>ç­‰åç¼€ä¸º<code>-night</code>çš„å¤œé—´èµ„æºæ–‡ä»¶å¤¹ã€‚<br>æˆ‘çš„<code>values</code>å’Œ<code>values-night</code>ç›®å½•ä¸‹çš„<code>colors.xml</code>çš„å†…å®¹å¦‚ä¸‹:</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="comment">&lt;!--values-colors.xml--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>#009688<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>#00796B<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>#009688<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"textColorPrimary"</span>&gt;</span>#616161<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"viewBackground"</span>&gt;</span>@android:color/white<span class="tag">&lt;/<span class="name">color</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></div></pre></td></tr></table></figure>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="comment">&lt;!--values-night-colors.xml&gt;</span></div><div class="line">&lt;resources&gt;</div><div class="line">    &lt;color name="colorPrimary"&gt;#35464e&lt;/color&gt;</div><div class="line">    &lt;color name="colorPrimaryDark"&gt;#212a2f&lt;/color&gt;</div><div class="line">    &lt;color name="colorAccent"&gt;#212a2f&lt;/color&gt;</div><div class="line">    &lt;color name="textColorPrimary"&gt;#616161&lt;/color&gt;</div><div class="line">    &lt;color name="viewBackground"&gt;#212a2f&lt;/color&gt;</div><div class="line">&lt;/resources&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿Activityç»§æ‰¿è‡ªAppCompatActivityã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="comment">// code here</span></div><div class="line">	<span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    	</div><div class="line">    &#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="é™æ€åº”ç”¨"><a href="#é™æ€åº”ç”¨" class="headerlink" title="é™æ€åº”ç”¨"></a>é™æ€åº”ç”¨</h4><p>åœ¨Applicationçš„ç»§æ‰¿ç±»ä¸‹è®¾ç½®åˆå§‹ä¸»é¢˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate();</div><div class="line">        </div><div class="line">		AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);</div><div class="line">		<span class="comment">// other code here</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œ<code>AppCompatDelegate.setDefaultNightMode()</code>æ–¹æ³•å¯ä»¥æ¥å—çš„å‚æ•°å€¼æœ‰4ä¸ªï¼š</p>
<ul>
<li>MODE_NIGHT_NO. Always use the day (light) theme(ä¸€ç›´åº”ç”¨æ—¥é—´(light)ä¸»é¢˜).</li>
<li>MODE_NIGHT_YES. Always use the night (dark) theme(ä¸€ç›´ä½¿ç”¨å¤œé—´(dark)ä¸»é¢˜).</li>
<li>MODE_NIGHT_AUTO. Changes between day/night based on the time of day(æ ¹æ®å½“å‰æ—¶é—´åœ¨day/nightä¸»é¢˜é—´åˆ‡æ¢).</li>
<li>MODE_NIGHT_FOLLOW_SYSTEM(é»˜è®¤é€‰é¡¹). This setting follows the systemâ€™s setting, which is essentially MODE_NIGHT_NO(è·Ÿéšç³»ç»Ÿï¼Œé€šå¸¸ä¸ºMODE_NIGHT_NO).</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯é™æ€çš„ã€‚ä½†æ˜¯è¿™ä¸ªå€¼å¹¶ä¸æ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œæ¯æ¬¡åœ¨å¼€å¯è¿›ç¨‹æ—¶éœ€è¦é‡æ–°è®¾ç½®ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘æ˜¯åœ¨<code>onCreate()</code>æ–¹æ³•ä¸­è®¾ç½®çš„ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¤§ç¥å»ºè®®åœ¨Activityæˆ–è€…Applicationçš„<strong>static</strong>ä»£ç å—ä¸­è®¾ç½®ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">static</span> &#123;</div><div class="line">	    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate();</div><div class="line">        </div><div class="line">		<span class="comment">// other code here</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="åŠ¨æ€åº”ç”¨"><a href="#åŠ¨æ€åº”ç”¨" class="headerlink" title="åŠ¨æ€åº”ç”¨"></a>åŠ¨æ€åº”ç”¨</h4><p>è™½ç„¶ä¸Šé¢çš„é™æ€åº”ç”¨çš„è®¾ç½®éå¸¸ç®€å•ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼çš„åº”ç”¨åœºæ™¯è¿˜æ˜¯å¤ªå°‘äº†ã€‚æˆ‘ä»¬æ›´å¤šçš„è¿˜æ˜¯éœ€è¦åŠ¨æ€çš„æ ¹æ®éœ€è¦åŠ¨æ€çš„åˆ‡æ¢ã€‚</p>
<ol>
<li><p>æ£€æµ‹å½“å‰ä¸»é¢˜æ¨¡å¼</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> mode = getResources().getConfiguration().uiMode &amp; Configuration.UI_MODE_NIGHT_MASK;</div></pre></td></tr></table></figure>
</li>
<li><p>è®¾ç½®ä¸»é¢˜</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(mode == Configuration.UI_MODE_NIGHT_YES) &#123;</div><div class="line">	AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(mode == Configuration.UI_MODE_NIGHT_NO) &#123;</div><div class="line">	AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">	<span class="comment">// blah blah</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">recreate();</div></pre></td></tr></table></figure>
<p> åœ¨è°ƒç”¨<code>recreate()</code>æ–¹æ³•ä¹‹å‰ï¼Œè¿˜å¯ä»¥åˆ›å»ºä¸€äº›åŠ¨ç”»è¿›è¡Œè¿‡æ¸¡ã€‚è€Œä¸”ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œè°ƒç”¨<code>recreate()</code>éœ€è¦å¯¹ä¸€äº›æ•°æ®è¿›è¡Œä¿å­˜ï¼Œä¾‹å¦‚fragmentï¼ŒCheckBox,RadioBoxç­‰ã€‚å¦‚ä¸‹æ‰€ç¤º:</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">   	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">       	<span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">   	</div><div class="line">   	 	<span class="keyword">if</span> (savedInstanceState != <span class="keyword">null</span>) &#123;</div><div class="line">   	 		FragmentManager manager = getChildFragmentManager();</div><div class="line">			doubanMomentFragment = (DoubanMomentFragment) manager.getFragment(savedInstanceState, <span class="string">"douban"</span>);</div><div class="line">   	 	&#125; <span class="keyword">else</span> &#123;</div><div class="line">   	 		doubanMomentFragment = DoubanMomentFragment.newInstance();</div><div class="line">   	 	&#125;</div><div class="line">   	&#125;</div><div class="line">   	</div><div class="line">   	<span class="meta">@Override</span></div><div class="line">   	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span><span class="params">(Bundle outState)</span> </span>&#123;</div><div class="line">      	 <span class="keyword">super</span>.onSaveInstanceState(outState);</div><div class="line">      	 FragmentManager manager = getChildFragmentManager();</div><div class="line">      	 manager.putFragment(outState, <span class="string">"douban"</span>, doubanMomentFragment);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä¸»é¢˜çš„å€¼å­˜å‚¨åˆ°SharedPreferenceä¸­ï¼Œå·²ä¾¿äºåº”ç”¨åœ¨ä¸‹ä¸€æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åº”ç”¨ä¸»é¢˜ã€‚
</code></pre><h4 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h4><ul>
<li><p>Q:ç³»ç»Ÿé»˜è®¤çš„é¢œè‰²ä¸åˆæˆ‘çš„å£å‘³æ€ä¹ˆåŠï¼Ÿ</p>
<p>A:ä½¿ç”¨ä¸»é¢˜å±æ€§,ä¾‹å¦‚:<code>textColor:?android:attr/textColorPrimary</code>,<code>color:?attr/colorControlNormal</code>ç­‰ã€‚</p>
</li>
<li><p>Q:ä¸ºä»€ä¹ˆæˆ‘çš„WebViewé¢œè‰²æ²¡æœ‰å˜åŒ–ï¼Ÿ</p>
<p>A:å› ä¸ºWebViewä¸èƒ½ä½¿ç”¨ä¸»é¢˜å±æ€§ã€‚WebViewçš„é¢œè‰²å®é™…ä¸Šå–å†³äºç½‘é¡µå†…å®¹é¢œè‰²ã€‚ç½‘é¡µçš„é»˜è®¤èƒŒæ™¯è‰²æ˜¯ç™½è‰²ï¼Œæ‰€ä»¥å°½ç®¡è®¾ç½®äº†ä¸»é¢˜ä¸º<code>AppCompatDelegate.MODE_NIGHT_YES</code>ï¼Œç½‘é¡µä»ç„¶æ˜¯ç™½è‰²ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å°±å¾ˆä¸æ­äº†ã€‚æ‰€ä»¥ï¼Œç½‘é¡µçš„å†…å®¹å’ŒèƒŒæ™¯è‰²ç­‰èµ„æºä¹Ÿéœ€è¦é€‚é…äº†ã€‚</p>
</li>
<li><p>Q:ä¸ºä»€ä¹ˆä¸ç›´æ¥è®¾ç½®ä¸º<code>MODE_NIGHT_AUTO</code>å‘¢ï¼Ÿ</p>
<p>A:å› ä¸ºä½¿ç”¨<code>MODE_NIGHT_AUTO</code>éœ€è¦è¯·æ±‚åæ ‡æƒé™ï¼Œè·å–ç³»ç»Ÿçš„ä½ç½®ã€‚ä½ è‚¯å®šä¼šè¯´äº†ï¼Œè¿™å°¼ç›ä¸æ˜¯å‘çˆ¹å—ï¼Ÿå¦‚æœç¨‹åºå·²ç»æˆäºˆäº†åæ ‡æƒé™(location permission)(å¦‚æœä½ çš„target SDKä¸º23æˆ–è€…æ›´é«˜ï¼Œéœ€è¦è€ƒè™‘è¿è¡Œæ—¶æƒé™)ï¼ŒAppCompatä¼šè¯•ç€å»è·å–ä¸Šæ¬¡ä¿å­˜çš„åæ ‡ï¼Œæ ¹æ®åæ ‡æ¥è®¡ç®—æ—¥å‡ºä¸æ—¥è½çš„æ—¶é—´ã€‚å¦‚æœç¨‹åºæ²¡æœ‰ä½ç½®æƒé™æˆ–è€…LocationManageræ²¡æœ‰å­˜å‚¨ä¸Šæ¬¡åæ ‡çš„ä¿¡æ¯å‘¢ï¼Ÿç³»ç»Ÿæˆ–é»˜è®¤è®¾ç½®ä¸ºæ—©ä¸Š6ç‚¹é’Ÿä¸ºæ—¥å‡ºï¼Œä¸‹åˆ10ç‚¹ä¸ºæ—¥è½ã€‚ç”¨æˆ·è°ƒæ•´ç³»ç»Ÿæ—¶é—´ï¼Œå½“å‰çš„ä¸»é¢˜ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚å¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·åœ¨è®¾å®šä¸»é¢˜åï¼Œä¸»é¢˜è¿˜ä¼šéšç€æ—¶é—´æ”¹å˜,<code>MODE_NIGHT_AUTO</code>å°±ä¸é€‚ç”¨äº†ã€‚</p>
</li>
</ul>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>æœ¬é¡¹ç›®ä»£ç <a href="https://github.com/marktony/PaperPlane" target="_blank" rel="external">PaperPlane</a> .<br>è¿è¡Œæ•ˆæœ</p>
<img src="/2016/12/31/ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼/paper_plane.gif" alt="Paper Plane" title="Paper Plane"> 
<p>åœ¨Android 6.0åŠä»¥ä¸‹çš„è®¾å¤‡ä¸Šï¼Œæœ¬é¡¹ç›®è¿è¡Œæ—¶ä¼šæœ‰åˆ‡æ¢çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæœï¼Œä½†æ˜¯ä¸æ”¯æŒAndroid 7.0åŠä»¥ä¸Šçš„è®¾å¤‡ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[é€‚é…Android 7.1 Nougatæ–°ç‰¹æ€§]]></title>
      <url>http://marktony.github.io/2016/12/29/%E9%80%82%E9%85%8DAndroid-7-1-Nougat%E6%96%B0%E7%89%B9%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>è€å¸æœºå¸¦ä½ åƒç‰›è½§ç³–<br><a id="more"></a></p>
<h3 id="Whatâ€™s-new-in-Android-7-1-Nougat"><a href="#Whatâ€™s-new-in-Android-7-1-Nougat" class="headerlink" title="Whatâ€™s new in Android 7.1 Nougat?"></a>Whatâ€™s new in Android 7.1 Nougat?</h3><p>Android 7.1 Nougat å·²ç»æ¨å‡ºæœ‰ä¸€æ®µæ—¶é—´ï¼Œç›¸ä¿¡å¤§å¤šæ•°äººå’Œæˆ‘ä¸€æ ·ï¼Œå¹¶æ²¡æœ‰ç”¨ä¸Šæœ€æ–°çš„ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œæ€»æœ‰ä¸€ç¾¤èµ°åœ¨æ—¶ä»£çš„å‰åˆ—çº¿ä¸Šçš„Geekä»¬ï¼Œå‹‡äºå°é²œï¼Œè‰°è‹¦å¥‹æ–—ï¼Œä¸ºåˆ·æ–°ç‰ˆæœ¬å·è´¡çŒ®è‡ªå·±çš„åŠ›é‡ã€‚å¥½å§ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘è¿˜æ²¡æœ‰ç”¨ä¸Š7.1ï¼Œæœ‰äº›çœ¼é¦‹äº†ã€‚é‚£ä¹ˆï¼Œå’Œå¼€å‘è€…æ¯æ¯ç›¸å…³çš„æœ‰å“ªäº›æ–°ç‰¹æ€§å‘¢ï¼Ÿ</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/android_nougat.png" alt="Android 7.1 Nougat" title="Android 7.1 Nougat">
<p>æœ¬æ¬¡ä¸»è¦ä»‹ç»3ä¸ªæ–°ç‰¹æ€§:<strong>App Shortcuts</strong>, <strong>Round Icon Resource</strong> å’Œ <strong>Image Keyboard Support</strong>ã€‚æ‰€æœ‰çš„æ–°ç‰¹æ€§å¯ä»¥è®¿é—®è°·æ­Œå¼€å‘è€…ä¸­æ–‡åšå®¢çš„æ–‡ç« <a href="http://developers.googleblog.cn/2016/12/android-711-nougat_20.html" target="_blank" rel="external">æ¬¢è¿ä½¿ç”¨Android 7.1.1 Nougat</a>ã€‚</p>
<h3 id="App-Shortcuts"><a href="#App-Shortcuts" class="headerlink" title="App Shortcuts"></a>App Shortcuts</h3><p>ä½œä¸ºä¸€ä¸ªå¯†åˆ‡å…³æ³¨Androidå‘å±•çš„ä¼ªGeekï¼Œåœ¨7.1æ­£å¼ç‰ˆæœªå‘å¸ƒä¹‹å‰ï¼Œé€šè¿‡ç½‘ä¸Šçš„ä¸€äº›çˆ†æ–™æ–‡ç« ï¼Œæˆ‘å°±äº†è§£åˆ°äº†è¿™ä¸€æ–°åŠŸèƒ½ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªåŠŸèƒ½åˆšå¼€å§‹å‡ºç°æ—¶ï¼Œæˆ‘è¿˜ä»¥ä¸ºGoogle Pixelè¦ä¸Šå‹æ„Ÿå±äº†å‘¢ï¼Œäº‹å®è¯æ˜ï¼Œçš„ç¡®æ˜¯æˆ‘æƒ³å¤šäº†ã€‚</p>
<p>App Shortcutså…è®¸ç”¨æˆ·ç›´æ¥åœ¨å¯åŠ¨å™¨ä¸­æ˜¾ç¤ºä¸€äº›æ“ä½œï¼Œè®©ç”¨æˆ·ç«‹å³æ‰§è¡Œåº”ç”¨çš„æ·±å±‚æ¬¡çš„åŠŸèƒ½ã€‚è§¦å‘è¿™ä¸€åŠŸèƒ½çš„æ“ä½œå°±æ˜¯ã€Œé•¿æŒ‰ã€ã€‚è¿™ä¸€åŠŸèƒ½ç±»ä¼¼äºiOSä¸­çš„ã€Œ3D Touchã€ã€‚</p>
<p>ä¸‹é¢é€šè¿‡ä¸€å¼ GIFï¼Œç›´è§‚çš„æ„Ÿå—ä¸€ä¸‹App Shortcutsæ˜¯æ€æ ·çš„ã€‚ï¼ˆç”±äºæˆ‘çš„ä¸€åŠ 3å¹¶æ²¡æœ‰å‡çº§åˆ°æœ€æ–°çš„7.1ï¼Œè¿˜åªæ˜¯7.0ï¼Œæ‰€ä»¥æˆ‘å®‰è£…äº†Nova Launcheræ¥ä½“éªŒã€‚ï¼‰</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/app_shortcuts.gif" alt="App Shortcuts" title="App Shortcuts">
<p>é•¿æŒ‰å›¾æ ‡ï¼Œæ”¶åˆ°éœ‡åŠ¨åæ¾æ‰‹ï¼Œå¦‚æœèƒ½å¤Ÿçœ‹åˆ°å›¾æ ‡ä¸Šå¼¹å‡ºäº†æ”¯æŒçš„è·³è½¬æ“ä½œï¼Œè¯´æ˜æˆåŠŸçš„å‘¼å‡ºäº†ShortcutsåŠŸèƒ½ï¼Œå¦‚æœä¸æ”¯æŒè¿™ä¸€åŠŸèƒ½ï¼Œåœ¨Nova Launcherä¸Šå¼¹å‡ºçš„å°±æ˜¯å¸è½½æˆ–è€…ç§»é™¤æ“ä½œï¼Œåœ¨Pixel Launcherä¸Šä¸ä¼šå‡ºç°å¼¹å‡ºèœå•ï¼Œæ˜¾ç¤ºçš„æ˜¯å¸¸è§çš„é•¿æŒ‰æ“ä½œã€‚é•¿æŒ‰å¼¹å‡ºçš„æ“ä½œï¼Œå¯ä»¥å°†è¿™ä¸ªæ“ä½œå·²å¿«æ·æ–¹å¼å›¾æ ‡çš„å½¢å¼ç›´æ¥æ”¾ç½®åœ¨ä¸»å±ä¸Šã€‚å¦‚æœé•¿æŒ‰ä¸»å›¾æ ‡ä¸æ¾æ‰‹ï¼Œå°±å¯ä»¥è°ƒæ•´ä½ç½®äº†ã€‚</p>
<p>ç›®å‰ï¼Œä¸€ä¸ªåº”ç”¨æœ€å¤šå¯ä»¥æ”¯æŒ <strong>5</strong> ä¸ªShortcut,å¯ä»¥é€šè¿‡<a href="https://developer.android.com/reference/android/content/pm/ShortcutManager.html#getMaxShortcutCountPerActivity(" target="_blank" rel="external">getMaxShortcutCountPerActivity</a>)æŸ¥çœ‹Launcheræœ€å¤šæ”¯æŒShortcutçš„æ•°é‡ã€‚æ¯ä¸€ä¸ªShortcutéƒ½å¯¹åº”ç€ä¸€ä¸ªæˆ–è€…å¤šä¸ªintentï¼Œå½“ç”¨æˆ·é€‰æ‹©æŸä¸€ä¸ªShortcutæ—¶ï¼Œåº”è¯¥åšå‡ºç‰¹å®šçš„åŠ¨ä½œã€‚ä¸‹é¢æ˜¯ä¸€äº›å°†ä¸€äº›ç‰¹å®šçš„åŠ¨ä½œä½œä¸ºShortcutsçš„ä¾‹å­ï¼š</p>
<ul>
<li><p>åœ¨åœ°å›¾APPä¸­ï¼ŒæŒ‡å¼•ç”¨æˆ·è‡³æœ€å¸¸ç”¨çš„ä½ç½®</p>
</li>
<li><p>åœ¨èŠå¤©APPä¸­ï¼Œå‘é€ä¿¡æ¯è‡³æŸä¸ªå¥½å‹</p>
</li>
<li><p>åœ¨å¤šåª’ä½“APPä¸­ï¼Œæ’­æ”¾ä¸‹ä¸€ä¸ªç”µè§†èŠ‚ç›®</p>
</li>
<li><p>åœ¨æ¸¸æˆAPPä¸­ï¼ŒåŠ è½½è‡³ä¸Šæ¬¡ä¿å­˜çš„åœ°æ–¹</p>
</li>
</ul>
<p>App Shortcutå¯ä»¥åˆ†ä¸ºä¸¤ç§ä¸åŒçš„ç±»å‹ï¼š Static Shortcutsï¼ˆé™æ€å¿«æ·æ–¹å¼ï¼‰ å’Œ Dynamic Shortcutsï¼ˆåŠ¨æ€å¿«æ·æ–¹å¼ï¼‰ã€‚</p>
<ul>
<li>Static Shortcutsï¼šåœ¨æ‰“åŒ…åˆ°apkçš„èµ„æºæ–‡ä»¶ä¸­å®šä¹‰ï¼Œæ‰€ä»¥ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡æ›´æ–°ç‰ˆæœ¬æ—¶æ‰èƒ½æ”¹å˜é™æ€å¿«æ·æ–¹å¼çš„è¯¦ç»†è¯´æ˜ã€‚</li>
<li>Dynamic Shortcutsï¼šé€šè¿‡ShortcutManager APIåœ¨è¿è¡Œæ—¶å‘å¸ƒï¼Œåœ¨è¿è¡Œæ—¶ï¼Œåº”ç”¨å¯ä»¥å‘å¸ƒï¼Œå‡çº§å’Œç§»é™¤å¿«æ·æ–¹å¼ã€‚</li>
</ul>
<h4 id="Using-Static-Shortcuts"><a href="#Using-Static-Shortcuts" class="headerlink" title="Using Static Shortcuts"></a>Using Static Shortcuts</h4><p>åˆ›å»ºStatic Shortcutsåˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>
<p>1.åœ¨å·¥ç¨‹çš„manifestæ–‡ä»¶ (AndroidManifest.xml)ä¸‹ï¼Œæ‰¾åˆ° intent filterè®¾ç½®ä¸º <strong>android.intent.action.MAIN</strong> å’Œ <strong>android.intent.category.LAUNCHER</strong> çš„Activityã€‚</p>
<p>2.åœ¨æ¬¡Activityä¸‹æ·»åŠ <meta-data>æ ‡ç­¾ï¼Œå¼•ç”¨å®šä¹‰shortcutsçš„èµ„æºæ–‡ä»¶ã€‚</meta-data></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activity</span></span></div><div class="line">        <span class="attr">android:name</span>=<span class="string">".homepage.MainActivity"</span></div><div class="line">        <span class="attr">android:configChanges</span>=<span class="string">"orientation|keyboardHidden|screenSize|screenLayout"</span></div><div class="line">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></div><div class="line">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme.NoActionBar"</span>&gt;</div><div class="line">        <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></div><div class="line"></div><div class="line">            <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></div><div class="line">            <span class="attr">android:name</span>=<span class="string">"android.app.shortcuts"</span></div><div class="line">            <span class="attr">android:resource</span>=<span class="string">"@xml/shortcuts"</span> /&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></div></pre></td></tr></table></figure>
<p>3.åˆ›å»ºæ–°çš„èµ„æºæ–‡ä»¶<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">```xml</div><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;shortcuts xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</div><div class="line"></div><div class="line">    &lt;shortcut</div><div class="line">        android:enabled=&quot;true&quot;</div><div class="line">        android:icon=&quot;@drawable/ic_search_circle&quot;</div><div class="line">        android:shortcutId=&quot;search_bookmarks&quot;</div><div class="line">        android:shortcutShortLabel=&quot;@string/search_bookmarks&quot;</div><div class="line">        android:shortcutLongLabel=&quot;@string/search_bookmarks&quot;&gt;</div><div class="line"></div><div class="line">        &lt;intent</div><div class="line">            android:action=&quot;android.intent.action.VIEW&quot;</div><div class="line">            android:targetPackage=&quot;com.marktony.zhihudaily&quot;</div><div class="line">            android:targetClass=&quot;com.marktony.zhihudaily.search.SearchActivity&quot; /&gt;</div><div class="line"></div><div class="line">		&lt;!--å¦‚æœä½ çš„ä¸€ä¸ªshortcutå…³è”ç€å¤šä¸ªintentï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œç»§ç»­æ·»</div><div class="line">			åŠ ã€‚æœ€åä¸€ä¸ªintentå†³å®šç€ç”¨æˆ·åœ¨åŠ è½½è¿™ä¸ªshortcutæ—¶ä¼šçœ‹åˆ°ä»€ä¹ˆ--&gt;</div><div class="line"></div><div class="line">        &lt;categories android:name=&quot;android.shortcut.conversation&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;/shortcut&gt;</div><div class="line"></div><div class="line">	&lt;!--åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„shortcut--&gt;</div><div class="line"></div><div class="line">&lt;/shortcuts&gt;</div></pre></td></tr></table></figure></p>
<p><strong>shortcut</strong>ä¸‹æ ‡ç­¾çš„å«ä¹‰ï¼š</p>
<ul>
<li><p>enabled:è§åçŸ¥æ„ï¼Œshortcutæ˜¯å¦å¯ç”¨ã€‚å¦‚æœä½ å†³å®šè®©è¿™ä¸ªstatic shortcutä¸åœ¨å¯ç”¨çš„è¯ï¼Œå¯ç›´æ¥å°†å…¶è®¾ç½®ä¸º <strong>false</strong> ï¼Œæˆ–è€…ç›´æ¥ä» <strong>shortcuts</strong> æ ‡ç­¾ä¸­ç§»é™¤ã€‚</p>
</li>
<li><p>icon:æ˜¾ç¤ºåœ¨å·¦è¾¹çš„å›¾æ ‡ï¼Œå¯ç”¨ä½¿ç”¨<em>Vector drawable</em>ã€‚</p>
</li>
<li><p>shortcutDisabledMessage:å½“ç¦ç”¨æ­¤shortcutåï¼Œå®ƒä»ç„¶ä¼šå‡ºç°åœ¨ç”¨æˆ·é•¿æŒ‰åº”ç”¨å›¾æ ‡åçš„å¿«æ·æ–¹å¼åˆ—è¡¨é‡Œï¼Œä¹Ÿå¯ä»¥è¢«æ‹–åŠ¨å¹¶å›ºå®šåˆ°æ¡Œé¢ä¸Šï¼Œä½†æ˜¯å®ƒä¼šå‘ˆç°ç°è‰²å¹¶ä¸”ç”¨æˆ·ç‚¹å‡»æ—¶ä¼šå¼¹å‡ºToastè¿™ä¸ªæ ‡ç­¾æ‰€å®šä¹‰çš„å†…å®¹ã€‚</p>
</li>
<li><p>shortcutLongLabel:å½“å¯åŠ¨å™¨æœ‰è¶³å¤Ÿå¤šçš„ç©ºé—´æ—¶ï¼Œä¼šæ˜¾ç¤ºè¿™ä¸ªæ ‡ç­¾æ‰€å®šä¹‰çš„å†…å®¹ã€‚</p>
</li>
<li><p>shortcutShortLabel:shortcutçš„ç®€è¦è¯´æ˜ï¼Œæ˜¯å¿…éœ€å­—æ®µã€‚å½“shortcutè¢«æ·»åŠ åˆ°æ¡Œé¢ä¸Šæ—¶ï¼Œæ˜¾ç¤ºçš„ä¹Ÿæ˜¯è¿™ä¸ªå­—æ®µã€‚</p>
</li>
<li><p>intent:shortcutå…³è”çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªintentï¼Œå½“ç”¨æˆ·ç‚¹å‡»shortcutæ—¶è¢«æ‰“å¼€ã€‚</p>
</li>
<li><p>shortcutId:shortcutçš„å”¯ä¸€æ ‡ç¤ºidï¼Œè‹¥å­˜åœ¨å…·æœ‰ç›¸åŒshortcutIdçš„shortcutï¼Œåˆ™åªæ˜¾ç¤ºä¸€ä¸ªã€‚</p>
</li>
</ul>
<p>åˆ°è¿™é‡Œï¼Œæœ€ç®€å•çš„shortcutå°±æ·»åŠ æˆåŠŸäº†ã€‚è¿è¡ŒåŒ…å«ä¸Šé¢çš„æ–‡ä»¶çš„é¡¹ç›®ï¼Œç‚¹å‡»shortcutå°±å¯ä»¥ç›´æ¥è¿›å…¥ <strong>SearchActivity</strong>ï¼Œå½“æŒ‰ä¸‹backé”®æ—¶ï¼Œç›´æ¥å°±é€€å‡ºäº†åº”ç”¨ã€‚å¦‚æœå¸Œæœ›ä¸é€€å‡ºåº”ç”¨ï¼Œè€Œæ˜¯è¿›å…¥ <strong>MainActivity</strong> æ—¶ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä¸ç”¨ç€æ€¥ï¼Œåœ¨shortcutç»§ç»­æ·»åŠ intentå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">shortcuts</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></div><div class="line">	</div><div class="line">    <span class="tag">&lt;<span class="name">shortcut</span></span></div><div class="line">        <span class="attr">android:enabled</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:icon</span>=<span class="string">"@drawable/ic_search_circle"</span></div><div class="line">        <span class="attr">android:shortcutId</span>=<span class="string">"search_bookmarks"</span></div><div class="line">        <span class="attr">android:shortcutShortLabel</span>=<span class="string">"@string/search_bookmarks"</span></div><div class="line">        <span class="attr">android:shortcutLongLabel</span>=<span class="string">"@string/search_bookmarks"</span>&gt;</div><div class="line">	</div><div class="line">		<span class="tag">&lt;<span class="name">intent</span></span></div><div class="line">    			<span class="attr">android:action</span>=<span class="string">"android.intent.action.MAIN"</span></div><div class="line">    			<span class="attr">android:targetClass</span>=<span class="string">"com.marktony.zhihudaily.homepage.MainActivity"</span></div><div class="line">		    <span class="attr">android:targetPackage</span>=<span class="string">"com.marktony.zhihudaily"</span> /&gt;</div><div class="line">	</div><div class="line">        <span class="tag">&lt;<span class="name">intent</span></span></div><div class="line">            <span class="attr">android:action</span>=<span class="string">"android.intent.action.VIEW"</span></div><div class="line">            <span class="attr">android:targetPackage</span>=<span class="string">"com.marktony.zhihudaily"</span></div><div class="line">            <span class="attr">android:targetClass</span>=<span class="string">"com.marktony.zhihudaily.search.SearchActivity"</span> /&gt;</div><div class="line">	</div><div class="line">        <span class="tag">&lt;<span class="name">categories</span> <span class="attr">android:name</span>=<span class="string">"android.shortcut.conversation"</span> /&gt;</span></div><div class="line">	</div><div class="line">    <span class="tag">&lt;/<span class="name">shortcut</span>&gt;</span></div><div class="line">	</div><div class="line">  	<span class="comment">&lt;!--åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„shortcut--&gt;</span></div><div class="line">	</div><div class="line"> <span class="tag">&lt;/<span class="name">shortcuts</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="Using-Dynamic-Shortcuts"><a href="#Using-Dynamic-Shortcuts" class="headerlink" title="Using Dynamic Shortcuts"></a>Using Dynamic Shortcuts</h4><p>åŠ¨æ€å¿«æ·æ–¹å¼åº”è¯¥å’Œåº”ç”¨å†…çš„ç‰¹å®šçš„ã€ä¸Šä¸‹æ–‡æ•æ„Ÿçš„actioné“¾æ¥ã€‚è¿™äº›actionåº”è¯¥å¯ä»¥åœ¨ç”¨æˆ·çš„å‡ æ¬¡ä½¿ç”¨ä¹‹é—´ã€ç”šè‡³æ˜¯åœ¨åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­è¢«æ”¹å˜ã€‚å¥½çš„å€™é€‰actionåŒ…æ‹¬æ‰“ç”µè¯ç»™ç‰¹å®šçš„äººã€å¯¼èˆªè‡³ç‰¹å®šçš„åœ°æ–¹ã€æˆ–è€…å±•ç¤ºå½“å‰æ¸¸æˆçš„åˆ†æ•°ã€‚</p>
<p><a href="https://developer.android.com/reference/android/content/pm/ShortcutManager.html" target="_blank" rel="external">ShortcutManager</a> APIå…è®¸æˆ‘ä»¬åœ¨åŠ¨æ€å¿«æ·æ–¹å¼ä¸Šå®Œæˆä¸‹é¢çš„æ“ä½œï¼š</p>
<ul>
<li><p>å‘å¸ƒ:ä½¿ç”¨setDynamicShortcuts()é‡æ–°å®šä¹‰æ•´ä¸ªåŠ¨æ€å¿«æ·æ–¹å¼åˆ—è¡¨ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨addDynamicShortcuts()å‘å·²å­˜åœ¨çš„åŠ¨æ€å¿«æ·æ–¹å¼åˆ—è¡¨ä¸­æ·»åŠ å¿«æ·æ–¹å¼ã€‚</p>
</li>
<li><p>æ›´æ–°:ä½¿ç”¨updateShortcuts()æ–¹æ³•ã€‚</p>
</li>
<li><p>ç§»é™¤:ä½¿ç”¨removeDynamicShortcuts()æ–¹æ³•ç§»é™¤ç‰¹å®šåŠ¨æ€å¿«æ·æ–¹å¼æˆ–è€…ä½¿ç”¨removeAllDynamicShortcuts()ç§»é™¤æ‰€æœ‰åŠ¨æ€å¿«æ·æ–¹å¼ã€‚</p>
</li>
</ul>
<p>ä¸‹é¢æ˜¯åœ¨MainActivityçš„onCreate()ä¸­åˆ›å»ºåŠ¨æ€å¿«æ·æ–¹å¼çš„ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line"></div><div class="line">    ...</div><div class="line"></div><div class="line">    ShortcutManager shortcutManager = getSystemService(ShortcutManager.class);</div><div class="line"></div><div class="line">    ShortcutInfo webShortcut = <span class="keyword">new</span> ShortcutInfo.Builder(<span class="keyword">this</span>, <span class="string">"shortcut_web"</span>)</div><div class="line">            .setShortLabel(<span class="string">"github"</span>)</div><div class="line">            .setLongLabel(<span class="string">"Open Tonny's github web site"</span>)</div><div class="line">            .setIcon(Icon.createWithResource(<span class="keyword">this</span>, R.drawable.ic_dynamic_shortcut))</div><div class="line">            .setIntent(<span class="keyword">new</span> Intent(Intent.ACTION_VIEW, Uri.parse(<span class="string">"https://marktony.github.io"</span>)))</div><div class="line">            .build();</div><div class="line"></div><div class="line">    shortcutManager.setDynamicShortcuts(Collections.singletonList(webShortcut));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ä¸ºåŠ¨æ€å¿«æ·æ–¹å¼åˆ›å»ºè¿”å›æ ˆã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line"></div><div class="line">    ...</div><div class="line"></div><div class="line">    ShortcutInfo dynamicShortcut = <span class="keyword">new</span> ShortcutInfo.Builder(<span class="keyword">this</span>, <span class="string">"shortcut_dynamic"</span>)</div><div class="line">            .setShortLabel(<span class="string">"Dynamic"</span>)</div><div class="line">            .setLongLabel(<span class="string">"Open dynamic shortcut"</span>)</div><div class="line">            .setIcon(Icon.createWithResource(<span class="keyword">this</span>, R.drawable.ic_dynamic_shortcut_2))</div><div class="line">            .setIntents(</div><div class="line">                    <span class="keyword">new</span> Intent[]&#123;</div><div class="line">                            <span class="keyword">new</span> Intent(Intent.ACTION_MAIN, Uri.EMPTY, <span class="keyword">this</span>, MainActivity.class).setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK),</div><div class="line">                            <span class="keyword">new</span> Intent(DynamicShortcutActivity.ACTION)</div><div class="line">                    &#125;)</div><div class="line">            .build();</div><div class="line"></div><div class="line">    shortcutManager.setDynamicShortcuts(Arrays.asList(webShortcut, dynamicShortcut));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºçš„Activityï¼Œåå­—å«åšDynamicShortcutActivityï¼Œåœ¨manifestæ–‡ä»¶ä¸­æ³¨å†Œã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activity</span>  </span></div><div class="line">      <span class="attr">android:name</span>=<span class="string">".DynamicShortcutActivity"</span></div><div class="line">      <span class="attr">android:label</span>=<span class="string">"Dynamic shortcut activity"</span>&gt;</div><div class="line">      <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"com.marktony.zhihudaily.OPEN_DYNAMIC_SHORTCUT"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></div></pre></td></tr></table></figure>
<p>é€šè¿‡æ¸…é™¤arrayä¸­çš„æ’åºè¿‡çš„intentsï¼Œå½“æˆ‘ä»¬é€šè¿‡åˆ›å»ºå¥½çš„shortcutè¿›å…¥DynamicShortcutActivityä¹‹åï¼ŒæŒ‰ä¸‹backé”®ï¼ŒMainActivityå°±ä¼šè¢«åŠ è½½ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨åŠ¨æ€åˆ›å»ºå¿«æ·æ–¹å¼ä¹‹å‰ï¼Œæœ€å¥½æ˜¯æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦è¶…è¿‡äº†æ‰€å…è®¸çš„æœ€å¤§å€¼ã€‚å¦åˆ™ä¼šæŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ã€‚</p>
<h4 id="Extra-Bits"><a href="#Extra-Bits" class="headerlink" title="Extra Bits"></a>Extra Bits</h4><ul>
<li><p>å½“static shortcut å’Œ dynamic shortcutä¸€èµ·å±•ç¤ºæ—¶ï¼Œå…¶å‡ºç°çš„é¡ºåºæ˜¯æ€æ ·å®šåˆ¶å‘¢ï¼Ÿ</p>
<p>  åœ¨ <strong>ShortcutInfo.Builder</strong> ä¸­æœ‰ä¸€ä¸ªä¸“é—¨çš„æ–¹æ³• <strong>setRank(int)</strong> ,é€šè¿‡è®¾ç½®ä¸åŒçš„ç­‰çº§ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶åŠ¨æ€å¿«æ·æ–¹å¼çš„å‡ºç°é¡ºåºï¼Œç­‰çº§è¶Šé«˜ï¼Œå‡ºç°åœ¨å¿«æ·æ–¹å¼åˆ—è¡¨ä¸­çš„ä½ç½®å°±è¶Šé«˜ã€‚</p>
</li>
<li><p>æˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®åŠ¨æ€å¿«æ·æ–¹å¼çš„shortLabelçš„å­—ä½“é¢œè‰²ã€‚</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">ForegroundColorSpan colorSpan = <span class="keyword">new</span> ForegroundColorSpan(getResources().getColor(android.R.color.holo_red_dark, getTheme()));</div><div class="line">   String label = <span class="string">"github"</span>;</div><div class="line">   SpannableStringBuilder colouredLabel = <span class="keyword">new</span> SpannableStringBuilder(label);</div><div class="line">   colouredLabel.setSpan(colorSpan, <span class="number">0</span>, label.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);</div><div class="line"></div><div class="line">   ShortcutInfo webShortcut = <span class="keyword">new</span> ShortcutInfo.Builder(MainActivity.<span class="keyword">this</span>, <span class="string">"shortcut_web"</span>)</div><div class="line">           .setShortLabel(colouredLabel)</div><div class="line">           .setRank(<span class="number">1</span>)</div><div class="line">           .build();</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="App-Shortcuts-Best-Practices"><a href="#App-Shortcuts-Best-Practices" class="headerlink" title="App Shortcuts Best Practices"></a>App Shortcuts Best Practices</h4><p>å½“è®¾è®¡å’Œåˆ›å»ºåº”ç”¨çš„shortcutsæ—¶ï¼Œåº”è¯¥éµå®ˆä¸‹é¢çš„æŒ‡å¯¼å»ºè®®ï¼š</p>
<ul>
<li><p>éµå¾ªè®¾è®¡è§„èŒƒ:ä¸ºäº†ä¿æŒæˆ‘ä»¬çš„åº”ç”¨å’Œç³»ç»Ÿåº”ç”¨çš„å¿«æ·æ–¹å¼åœ¨è§†è§‰ä¸Šä¸€è‡´æ€§ï¼Œåº”è¯¥éµå®ˆ<a href="https://developer.android.com/shareables/design/app-shortcuts-design-guidelines.pdf" target="_blank" rel="external">App Shortcuts Design Guidelines</a>ã€‚</p>
</li>
<li><p>å‘å¸ƒ4ä¸ªä¸åŒçš„å¿«æ·æ–¹å¼:å°½ç®¡ç°åœ¨çš„APIæ”¯æŒé™æ€å’ŒåŠ¨æ€æ€»å…±5ä¸ªå¿«æ·æ–¹å¼ï¼Œä½†æ˜¯ä¸ºäº†æé«˜shortcutçš„è§†è§‰æ•ˆæœï¼Œå»ºè®®åªæ·»åŠ 4ä¸ªä¸åŒçš„å¿«æ·æ–¹å¼ã€‚</p>
</li>
<li><p>é™åˆ¶å¿«æ·æ–¹å¼æè¿°çš„æ–‡æœ¬é•¿åº¦:åœ¨Launcherä¸­ï¼Œæ˜¾ç¤ºå¿«æ·æ–¹å¼æ—¶ï¼Œç©ºé—´é•¿åº¦å—åˆ°äº†é™åˆ¶ã€‚å¦‚æœå¯èƒ½çš„è¯ï¼Œåº”è¯¥å°†ã€Œshort descriptionã€çš„æ–‡å­—é•¿åº¦æ§åˆ¶åœ¨10ä¸ªå­—æ¯ä»¥å†…ï¼Œå°†ã€Œlong discriptionã€çš„é•¿åº¦é™åˆ¶åœ¨25ä¸ªå­—æ¯ä»¥å†…ã€‚</p>
</li>
<li><p>ä¿å­˜shortcutå’Œactionçš„å†å²è®°å½•:åˆ›å»ºçš„æ¯ä¸€ä¸ªshortcutï¼Œåº”è¯¥è€ƒè™‘åˆ°ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ä¸åŒçš„æ–¹å¼å®Œæˆç›¸åŒçš„ä»»åŠ¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®°å¾—è°ƒç”¨ <strong>reportShortcutUsed()</strong> æ–¹æ³•ï¼Œè¿™æ ·ï¼Œlauncherå°±å¯ä»¥æé«˜shortcutå¯¹åº”çš„actionsçš„ååº”é€Ÿåº¦ã€‚</p>
</li>
<li><p>åªæœ‰åœ¨shortcutsçš„æ„ä¹‰å­˜åœ¨æ—¶æ›´æ–°ï¼šå½“æ”¹å˜åŠ¨æ€å¿«æ·æ–¹å¼æ—¶ï¼Œåªæœ‰åœ¨shortcutä»ç„¶ä¿æŒç€å®ƒçš„å«ä¹‰æ—¶ï¼Œè°ƒç”¨ <strong>updateShortcuts()</strong> æ–¹æ³•æ”¹å˜å®ƒçš„ä¿¡æ¯ã€‚å¦åˆ™ï¼Œåº”è¯¥ä½¿ç”¨<strong>addDynamicShortcuts()</strong> æˆ–è€… <strong>setDynamicShortcuts()</strong> åˆ›å»ºä¸€ä¸ªå…·æœ‰æ–°å«ä¹‰çš„IDçš„å¿«æ·æ–¹å¼ã€‚</p>
<p>  ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»åˆ›å»ºäº†å¯¼èˆªåˆ°ä¸€ä¸ªè¶…å¸‚çš„å¿«æ·æ–¹å¼ï¼Œå¦‚æœè¶…å¸‚çš„åç§°æ”¹å˜äº†ä½†æ˜¯ä½ç½®å¹¶æ²¡æœ‰å˜åŒ–æ—¶ï¼Œåªæ›´æ–°ä¿¡æ¯æ˜¯åˆé€‚çš„ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·å¼€å§‹åœ¨ä¸€ä¸ªä¸åŒä½ç½®çš„è¶…å¸‚è´­ç‰©æ—¶ï¼Œæœ€å¥½æ˜¯åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¿«æ·æ–¹å¼(è€Œä¸ä»…ä»…æ˜¯æ›´æ–°ä¿¡æ¯äº†)ã€‚</p>
</li>
<li><p>åœ¨å¤‡ä»½å’Œæ¢å¤æ—¶ï¼ŒåŠ¨æ€shortcutsä¸åº”è¯¥è¢«ä¿å­˜:æ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ¨èæˆ‘ä»¬åœ¨éœ€è¦APPå¯åŠ¨å’Œé‡æ–°å‘å¸ƒåŠ¨æ€å¿«æ·æ–¹å¼æ—¶ï¼Œæ£€æŸ¥ <strong>getDynamicShortcuts()</strong> çš„å¯¹è±¡çš„æ•°é‡ã€‚å¯ä»¥å‚è€ƒ<a href="https://developer.android.com/guide/topics/ui/shortcuts.html#backup-and-restore" target="_blank" rel="external">Backup and Restore</a>éƒ¨åˆ†çš„ä»£ç ç‰‡æ®µã€‚</p>
</li>
</ul>
<h3 id="Round-Icon-Resources"><a href="#Round-Icon-Resources" class="headerlink" title="Round Icon Resources"></a>Round Icon Resources</h3><p>åœ¨Android 7.1ä¸Šï¼ŒGoogleæ¨å‡ºäº†ä¸€ä¸ªéƒ¨åˆ†ç”¨æˆ·å¯èƒ½ä¸å¤ªå–œæ¬¢çš„ç‰¹æ€§â€“åœ†å½¢å›¾æ ‡ã€‚åœ†å½¢å›¾æ ‡é•¿ä»€ä¹ˆæ ·ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„å›¾ã€‚</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/round_icon.png" alt="round icon" title="round icon">
<blockquote>
<p>åŒæ—¶ï¼Œåœ†å½¢å›¾æ ‡è§„èŒƒä¹Ÿä½œä¸ºä¸€éƒ¨åˆ†å†…å®¹åŠ å…¥åˆ°äº†æ›´æ–°è¯´æ˜å’Œå¼€å‘æ–‡æ¡£ä¸­ã€‚<br>åº”ç”¨ç¨‹åºç°åœ¨å¯ä»¥å®šä¹‰åœ†å½¢å¯åŠ¨å™¨å›¾æ ‡ä»¥ç”¨äºç‰¹å®šçš„ç§»åŠ¨è®¾å¤‡ä¹‹ä¸Šã€‚å½“å¯åŠ¨å™¨è¯·æ±‚åº”ç”¨ç¨‹åºå›¾æ ‡æ—¶ï¼Œç¨‹åºæ¡†æ¶åº”è¿”å› androidï¼šicon æˆ– androidï¼šroundIconï¼Œè§†è®¾å¤‡å…·ä½“è¦æ±‚è€Œå®šã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºåœ¨å¼€å‘æ—¶åº”è¯¥ç¡®ä¿åŒæ—¶å®šä¹‰ androidï¼šiconå’Œ androidï¼šroundIcon ä¸¤ä¸ªå˜é‡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Image Asset Studio æ¥è®¾è®¡åœ†å½¢å›¾æ ‡ã€‚</p>
<p>æ‚¨åº”è¯¥ç¡®ä¿åœ¨æ”¯æŒæ–°çš„åœ†å½¢å›¾æ ‡çš„è®¾å¤‡ä¸Šæµ‹è¯•æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºå›¾æ ‡çš„å¤–è§‚æ— è™å’Œå®é™…æ•ˆæœã€‚æµ‹è¯•æ‚¨çš„èµ„æºçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨ Google Pixel è®¾å¤‡ä¸Šå®‰è£…æ‚¨çš„åº”ç”¨ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡è¿è¡Œ Android æ¨¡æ‹Ÿå™¨å¹¶ä½¿ç”¨ Google API æ¨¡æ‹Ÿå™¨ç³»ç»Ÿï¼ˆç›®æ ‡ API ç­‰çº§ä¸º 25ï¼‰æµ‹è¯•æ‚¨çš„å›¾æ ‡ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <strong>Android Studio</strong> è‡ªå¸¦çš„ <strong>Image Asset Studio</strong>è®¾è®¡å›¾æ ‡ã€‚åœ¨é¡¹ç›®çš„ <strong>res</strong> ç›®å½•ä¸‹ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹© <strong>new</strong> â€“&gt; <strong>Image Asset</strong> å³å¯è®¾è®¡å›¾æ ‡ã€‚</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/ImageAssetStudio.png" alt="Image Asset Studio" title="Image Asset Studio">
<p>æ›´å¤šå…³äºè®¾è®¡åº”ç”¨å›¾æ ‡çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ<a href="https://material.google.com/style/icons.html#icons-product-icons" target="_blank" rel="external">Material Design guidelines</a>ã€‚</p>
<h3 id="Image-Keyboard-Support"><a href="#Image-Keyboard-Support" class="headerlink" title="Image Keyboard Support"></a>Image Keyboard Support</h3><p>åœ¨è¾ƒæ—©ç‰ˆæœ¬çš„Androidç³»ç»Ÿä¸­ï¼Œè½¯é”®ç›˜(ä¾‹å¦‚æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„Input Method Editorsï¼Œæˆ–è€…è¯´IME)ï¼Œåªèƒ½å¤Ÿç»™åº”ç”¨å‘é€unicodeç¼–ç çš„emojiï¼Œå¯¹äºrich contentï¼Œåº”ç”¨åªèƒ½é€šè¿‡ä½¿ç”¨è‡ªå»ºçš„ç§æœ‰çš„APIå®ç°å‘é€å›¾ç‰‡çš„åŠŸèƒ½ã€‚è€Œåœ¨Android 7.1ä¸­ï¼ŒSDKåŒ…å«äº†ä¸€ä¸ªå…¨æ–°çš„Commit Content APIï¼Œè¾“å…¥æ³•åº”ç”¨ä¸ä»…å¯ä»¥è°ƒç”¨æ­¤ API å®ç°å‘é€å›¾ç‰‡å’Œå…¶ä»–rich contentï¼Œä¸€äº›é€šè®¯åº”ç”¨ï¼ˆæ¯”å¦‚ Google Messengerï¼‰ä¹Ÿå¯ä»¥é€šè¿‡æ­¤ API æ¥æ›´å¥½åœ°å¤„ç†è¿™äº›æ¥è‡ªè¾“å…¥æ³•çš„å›¾ç‰‡ã€ç½‘é¡µä¿¡æ¯å’Œ GIF å†…å®¹ã€‚</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/image-keyboard-sample.png" alt="image keyboard" title="image keyboard">
<h4 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works"></a>How it works</h4><ol>
<li><p>å½“ç”¨æˆ·ç‚¹å‡»EditTextæ—¶ï¼Œ    editorä¼šå‘é€ä¸€ä¸ªå®ƒæ‰€èƒ½æ¥å—çš„ <strong>EditorInfo.contentMimeTypes</strong> MIME å†…å®¹ç±»å‹çš„åˆ—è¡¨ã€‚</p>
</li>
<li><p>IMEè¯»å–è¿™ä¸ªåœ¨è½¯é”®ç›˜ä¸­æ”¯æŒç±»å‹å’Œå±•ç¤ºå†…å®¹çš„åˆ—è¡¨ã€‚</p>
</li>
<li><p>å½“ç”¨æˆ·é€‰æ‹©ä¸€å¼ å›¾ç‰‡åï¼ŒIMEè°ƒç”¨ <strong>commitContent()</strong> å¹¶å‘editorå‘é€ä¸€ä¸ªInputContentInfoã€‚ <strong>commitContent()</strong> æ–¹æ³•æ˜¯ä¸€ä¸ªç±»ä¼¼äº <strong>commitText()</strong> çš„æ–¹æ³•ï¼Œä½†æ˜¯æ˜¯rich contentçš„ã€‚ <strong>InputContentInfo</strong> åŒ…å«ç€ä¸€ä¸ªè¡¨ç¤ºcontent providerä¸­å†…å®¹çš„URIã€‚ç„¶åæˆ‘ä»¬çš„åº”ç”¨å°±å¯ä»¥è¯·æ±‚ç›¸åº”çš„æƒé™å¹¶è¯»å–URIä¸­çš„å†…å®¹ã€‚</p>
</li>
</ol>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/image-keyboard-diagram.png" alt="image keyboard diagram" title="image keyboard diagram">
<h4 id="Adding-Image-Support-to-Apps"><a href="#Adding-Image-Support-to-Apps" class="headerlink" title="Adding Image Support to Apps"></a>Adding Image Support to Apps</h4><p>ä¸ºäº†æ¥æ”¶æ¥è‡ªIMEçš„rich contentï¼Œåº”ç”¨å¿…é¡»å‘Šè¯‰IMEå®ƒæ‰€èƒ½æ¥æ”¶çš„å†…å®¹ç±»å‹å¹¶ä¹‹æŒ‡å®šå½“æ¥æ”¶åˆ°å†…å®¹åçš„å›è°ƒæ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ€æ ·åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿæ¥æ”¶PNGå›¾ç‰‡çš„ <strong>EditText</strong> çš„æ¼”ç¤ºä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">EditText editText = <span class="keyword">new</span> EditText(<span class="keyword">this</span>) &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> InputConnection <span class="title">onCreateInputConnection</span><span class="params">(EditorInfo editorInfo)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> InputConnection ic = <span class="keyword">super</span>.onCreateInputConnection(editorInfo);</div><div class="line">        EditorInfoCompat.setContentMimeTypes(editorInfo,</div><div class="line">                <span class="keyword">new</span> String [] &#123;<span class="string">"image/png"</span>&#125;);</div><div class="line"></div><div class="line">        <span class="keyword">final</span> InputConnectionCompat.OnCommitContentListener callback =</div><div class="line">            <span class="keyword">new</span> InputConnectionCompat.OnCommitContentListener() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCommitContent</span><span class="params">(InputContentInfoCompat inputContentInfo,</span></span></div><div class="line">                        <span class="keyword">int</span> flags, Bundle opts) &#123;</div><div class="line">                    <span class="comment">// read and display inputContentInfo asynchronously</span></div><div class="line">                    <span class="keyword">if</span> (BuildCompat.isAtLeastNMR1() &amp;&amp; (flags &amp;</div><div class="line">                        InputConnectionCompat.INPUT_CONTENT_GRANT_READ_URI_PERMISSION) != <span class="number">0</span>) &#123;</div><div class="line">                        <span class="keyword">try</span> &#123;</div><div class="line">                            inputContentInfo.requestPermission();</div><div class="line">                        &#125;</div><div class="line">                        <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// return false if failed</span></div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="comment">// read and display inputContentInfo asynchronously.</span></div><div class="line">                    <span class="comment">// call inputContentInfo.releasePermission() as needed.</span></div><div class="line"></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  <span class="comment">// return true if succeeded</span></div><div class="line">                &#125;</div><div class="line">            &#125;;</div><div class="line">        <span class="keyword">return</span> InputConnectionCompat.createWrapper(ic, editorInfo, callback);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä»£ç è¿˜æ˜¯è›®å¤šçš„ï¼Œè§£é‡Šä¸€ä¸‹ã€‚</p>
<ul>
<li><p>ä¾‹å­ä½¿ç”¨äº†support libraryï¼Œå¹¶ä¸”å¼•ç”¨çš„æ˜¯ <strong>android.support.v13.view.inputmethod</strong> è€Œä¸æ˜¯ <strong>android.view.inputmethod</strong> ã€‚</p>
</li>
<li><p>ä¾‹å­åˆ›å»ºäº†ä¸€ä¸ª <strong>EditText</strong> å¹¶å¤å†™äº†å®ƒæ”¹å˜ <strong>InputConnection</strong> çš„ <strong>onCreateInputConnection(EditorInfo)</strong> æ–¹æ³•. <strong>InputConnection</strong> æ˜¯IMEå’Œæ­£åœ¨æ¥æ”¶è¾“å…¥çš„æ²Ÿé€šç®¡é“ã€‚</p>
</li>
<li><p>è°ƒç”¨ <strong>super.onCreateInputConnection()</strong> ä¿ç•™äº†å†…å»ºçš„è¡Œä¸º(åŒ…æ‹¬å‘é€å’Œæ¥æ”¶æ–‡æœ¬)ï¼Œå¹¶æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ª <strong>InputConnection</strong> çš„å¼•ç”¨ã€‚</p>
</li>
<li><p><strong>setContentMimeTypes()</strong> å‘ <strong>EditorInfo</strong> æ·»åŠ äº†ä¸€ä¸ªæ‰€æ”¯æŒçš„MIMEç±»å‹çš„åˆ—è¡¨ã€‚ éœ€è¦ä¿è¯åœ¨ <strong>setContentMimeTypes()</strong> ä¹‹å‰è°ƒç”¨ <strong>super.onCreateInputConnection()</strong> ã€‚</p>
</li>
<li><p>å›è°ƒåœ¨IMEæäº¤å†…å®¹æ˜¯è¢«æ‰§è¡Œã€‚ <strong>onCommitContent()</strong> æ–¹æ³•æœ‰ä¸€ä¸ªå¯¹åŒ…å«äº†å†…å®¹URIçš„ <strong>InputContentInfoCompat</strong> çš„å¼•ç”¨ã€‚</p>
<ul>
<li>å½“æˆ‘ä»¬çš„åº”ç”¨è¿è¡Œåœ¨API Level 25æˆ–è€…æ›´é«˜å¹¶ä¸”IMEè®¾ç½®äº† <strong>INPUT_CONTENT_GRANT_READ_URI_PERMISSION</strong> flagæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è¯·æ±‚å¹¶ä¸”é‡Šæ”¾æƒé™ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ­¤ä¹‹å‰å°±æ‹¥æœ‰content URIçš„è®¿é—®æƒé™ï¼Œä¸€æ˜¯å› ä¸ºæƒé™æ˜¯ç”±IMEæˆæƒçš„ï¼ŒäºŒæ˜¯content providerä¸å¯¹è®¿é—®è¿›è¡Œçº¦æŸã€‚æ›´å¤šçš„ä¿¡æ¯å¯ä»¥è®¿é—®<a href="https://developer.android.com/guide/topics/text/image-keyboard.html#adding_image_support_to_imes" target="_blank" rel="external">Adding Image Support to IMEs</a></li>
</ul>
</li>
<li><p><strong>createWrapper()</strong> åŒ…è£…äº†inputConnectionå’Œå·²ä¿®æ”¹çš„editorInfoï¼Œæ–°çš„InputConnectionçš„å›è°ƒå¹¶ä¸”è¿”å›ã€‚</p>
</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€äº›å®è·µå°æŠ€å·§ã€‚</p>
<ul>
<li><p>ä¸æ”¯æŒrich contentçš„Editorä¸åº”è¯¥è°ƒç”¨ <strong>setContentTypes()</strong> å¹¶æŠŠ <strong>EditorInfo.contentMimeTypes</strong> è®¾ç½®ä¸ºnullã€‚</p>
</li>
<li><p>Editoråº”è¯¥å¿½ç•¥æ‰åœ¨ <strong>InputConnectionInfo</strong> ä¸­æŒ‡å®šçš„MIMEç±»å‹å’Œæ‰€æ¥æ”¶ç±»å‹ä¸é€šçš„å†…å®¹ã€‚</p>
</li>
<li><p>rich contentä¸å½±å“ä¹Ÿä¸è¢«æ–‡æœ¬æŒ‡é’ˆçš„ä½ç½®æ‰€å½±å“ã€‚editoråœ¨è¿›è¡Œå†…å®¹å¤„ç†æ˜¯å¯ä»¥ç›´æ¥å¿½ç•¥æ‰å…‰æ ‡çš„ä½ç½®ã€‚</p>
</li>
<li><p>åœ¨editorçš„ <strong>OnCommitContentListener.onCommitContent()</strong> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¼‚æ­¥çš„è¿”å›trueï¼Œç”šè‡³æ˜¯åœ¨åŠ è½½å†…å®¹ä¹‹å‰ã€‚</p>
</li>
<li><p>ä¸åŒäºæ–‡æœ¬å†…å®¹åœ¨è¢«æäº¤ä¹‹å‰å¯ä»¥åœ¨IMEä¸­è¢«ç¼–è¾‘ï¼Œrich contentä¼šè¢«ç«‹å³æäº¤ã€‚éœ€è¦æ³¨æ„ç‰¹æ€§ï¼Œå¦‚æœæƒ³è¦æä¾›ç¼–è¾‘æˆ–è€…åˆ é™¤å†…å®¹çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æä¾›å¤„ç†é€»è¾‘ã€‚</p>
</li>
</ul>
<p>ä¸ºäº†æµ‹è¯•APPï¼Œéœ€è¦ç¡®ä¿ä½ çš„è®¾å¤‡æˆ–è€…è™šæ‹Ÿæœºçš„é”®ç›˜èƒ½å¤Ÿå‘é€rich contentã€‚ä½ å¯ä»¥åœ¨Android 7.1æˆ–è€…æ›´é«˜çš„ç³»ç»Ÿä¸­ä½¿ç”¨Google Keyboardï¼Œæˆ–è€…æ˜¯å®‰è£…<a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME sample</a>.</p>
<p>ä½ å¯ä»¥åœ¨<a href="https://developer.android.com/samples/CommitContentSampleApp/index.html" target="_blank" rel="external">CommitContent App sample</a>è·å–åˆ°å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚</p>
<h4 id="Adding-Image-Support-to-IMEs"><a href="#Adding-Image-Support-to-IMEs" class="headerlink" title="Adding Image Support to IMEs"></a>Adding Image Support to IMEs</h4><p>æƒ³è¦IMEæ”¯æŒå‘é€rich contentï¼Œéœ€è¦å¼•å…¥ä¸‹é¢æ‰€å±•ç¤ºçš„Commit Content APIã€‚</p>
<ul>
<li><p>å¤å†™ <strong>onStartInput()</strong> æˆ–è€… <strong>onStartInputView()</strong> ï¼Œå¹¶è¯»å–æ¥è‡ªç›®æ ‡editorçš„æ”¯æŒå†…å®¹ç±»å‹åˆ—è¡¨ã€‚</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartInputView</span><span class="params">(EditorInfo info, <span class="keyword">boolean</span> restarting)</span> </span>&#123;</div><div class="line">    String[] mimeTypes = EditorInfoCompat.getContentMimeTypes(editorInfo);</div><div class="line"></div><div class="line">    <span class="keyword">boolean</span> gifSupported = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">for</span> (String mimeType : mimeTypes) &#123;</div><div class="line">        <span class="keyword">if</span> (ClipDescription.compareMimeTypes(mimeType, <span class="string">"image/gif"</span>)) &#123;</div><div class="line">            gifSupported = <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (gifSupported) &#123;</div><div class="line">        <span class="comment">// the target editor supports GIFs. enable corresponding content</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// the target editor does not support GIFs. disable corresponding content</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>å½“ç”¨æˆ·é€‰æ‹©äº†ä¸€å¼ å›¾ç‰‡æ—¶ï¼Œå°†å†…å®¹æäº¤ç»™APPã€‚å½“IMEæœ‰æ­£åœ¨ç¼–è¾‘çš„æ–‡æœ¬æ—¶ï¼Œåº”è¯¥é¿å…è°ƒç”¨ <strong>commitContent()</strong> ï¼Œå› ä¸ºè¿™æ ·å¯èƒ½å¯¼è‡´editorå¤±å»ç„¦ç‚¹ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µå±•ç¤ºäº†æ€æ ·æäº¤ä¸€å¼ GIFå›¾ç‰‡ã€‚</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Commits a GIF image</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> contentUri Content URI of the GIF image to be sent</div><div class="line"> * <span class="doctag">@param</span> imageDescription Description of the GIF image to be sent</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">commitGifImage</span><span class="params">(Uri contentUri, String imageDescription)</span> </span>&#123;</div><div class="line">    InputContentInfoCompat inputContentInfo = <span class="keyword">new</span> InputContentInfoCompat(</div><div class="line">            contentUri,</div><div class="line">            <span class="keyword">new</span> ClipDescription(imageDescription, <span class="keyword">new</span> String[]&#123;<span class="string">"image/gif"</span>&#125;));</div><div class="line">    InputConnection inputConnection = getCurrentInputConnection();</div><div class="line">    EditorInfo editorInfo = getCurrentInputEditorInfo();</div><div class="line">    Int flags = <span class="number">0</span>;</div><div class="line">    If (android.os.Build.VERSION.SDK_INT &gt;= <span class="number">25</span>) &#123;</div><div class="line">        flags |= InputConnectionCompat.INPUT_CONTENT_GRANT_READ_URI_PERMISSION;</div><div class="line">    &#125;</div><div class="line">    InputConnectionCompat.commitContent(</div><div class="line">            inputConnection, editorInfo, inputContentInfo, flags, opts);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ä½œä¸ºä¸€ä¸ªIMEå¼€å‘è€…ï¼Œæœ‰å¾ˆå¤§å¯èƒ½ä½ éœ€è¦å¼•å…¥ä½ è‡ªå·±çš„content provideræ¥å“åº”content URIè¯·æ±‚ã€‚å¦‚æœä½ çš„IMEæ”¯æŒæ¥è‡ªåƒ <strong>MediaStore</strong> è¿™æ ·å·²ç»å­˜åœ¨çš„content providerå€’æ˜¯å¯ä»¥ä¾‹å¤–ã€‚å…³äºåˆ›å»ºcontent providerçš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è§ <a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME sample</a>, [Content Provider] (<a href="https://developer.android.com/guide%20/topics/providers/content-providers.html)æ–‡æ¡£" target="_blank" rel="external">https://developer.android.com/guide%20/topics/providers/content-providers.html)æ–‡æ¡£</a>, <a href="https://developer.android.com/training/secure-file-sharing/setup-sharing.html" target="_blank" rel="external">File Provider</a>æ–‡æ¡£ã€‚</p>
</li>
<li><p>å¦‚æœæ­£åœ¨åˆ›å»ºè‡ªå·±çš„content providerï¼Œå»ºè®®ä¸è¦export(å°† android:export è®¾ç½®ä¸ºfalse)ã€‚é€šè¿‡è®¾ç½® <strong>android:grandUriPermission</strong> ä¸ºtrueå…è®¸åœ¨providerå†…éƒ¨è¿›è¡Œæƒé™æˆäºˆæ›¿ä»£ã€‚ç„¶åï¼Œä½ çš„IMEåœ¨å†…å®¹æäº¤æ—¶å¯ä»¥æˆäºˆè®¿é—®content URIçš„æƒé™ã€‚æœ‰ä¸¤ç§å®ç°çš„æ–¹æ³•ï¼š</p>
<ul>
<li><p>åœ¨Android 7.1(API Level 25)æˆ–æ›´é«˜çš„ç³»ç»Ÿä¸­ï¼Œå½“è°ƒç”¨ <strong>commitContent</strong> æ–¹æ³•æ—¶ï¼Œå°†flagå‚æ•°è®¾ç½®ä¸º <strong>INPUT_CONTENT_GRANT_READ_URI_PERMISSION</strong> ã€‚ç„¶åï¼ŒAPPæ”¶åˆ°çš„ <strong>InputContentInfo</strong> å¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨ <strong>requestPermission()</strong> æ–¹æ³•å’Œ <strong>releasePermission()</strong> è¯·æ±‚å’Œé‡Šæ”¾ä¸´æ—¶è®¿é—®æƒé™ã€‚</p>
</li>
<li><p>åœ¨Android 7.0(API Level 24)æˆ–è€…æ›´ä½çš„ç³»ç»Ÿä¸­ï¼Œ <strong>INPUT_CONTENT_GRANT_READ_URI_PERMISSION</strong> ç›´æ¥è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨çš„æˆäºˆå†…å®¹è®¿é—®æƒé™ã€‚æ–¹æ³•å°±æ˜¯ <strong>grantUriPermission()</strong> ,ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å¼•å…¥æ»¡è¶³è‡ªå·±è¦æ±‚çš„æœºåˆ¶ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>æƒé™æˆäºˆçš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME sample</a>ä¸­çš„doCommitContent()æ–¹æ³•ã€‚</p>
<p>ä¸ºäº†æµ‹è¯•IMEï¼Œç¡®ä¿æˆ‘ä»¬çš„è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨æ‹¥æœ‰æ¥æ”¶rich contentçš„çš„åº”ç”¨ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Android 7.1æˆ–è€…æ›´é«˜çš„ç³»ç»Ÿä¸­ä½¿ç”¨Google Messengeråº”ç”¨æˆ–è€…å®‰è£…<a href="https://developer.android.com/samples/CommitContentSampleApp/index.html" target="_blank" rel="external">CommitContent App Sample</a>ã€‚</p>
<p>è·å–å®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥è®¿é—®<a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME Sample</a>ã€‚</p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>Googleåœ¨åˆ·æ–°ç‰ˆæœ¬å·çš„è·¯ä¸Šç®€ç›´æ˜¯åœ¨ç­–é©¬å¥”è…¾äº†ï¼Œå˜šå„¿é©¾ã€‚æˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿçœ‹åˆ°Googleçš„åŠªåŠ›ï¼ŒAndroidä¹Ÿåœ¨å˜çš„è¶Šæ¥è¶Šå¥½ï¼ŒåŠ æ²¹å§ï¼Œå°æœºå™¨äººã€‚</p>
<p>æœ¬æ¬¡Shortcutséƒ¨åˆ†çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„GitHubä»“åº“<a href="https://github.com/marktony/ZhiHuDaily" target="_blank" rel="external">ZhiHuDaily</a>ä¸­çœ‹åˆ°ã€‚æ¬¢è¿starå“Ÿã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†]]></title>
      <url>http://marktony.github.io/2016/11/05/JAVA%E6%B7%B1%E5%85%8B%E9%9A%86%E4%B8%8E%E6%B5%85%E5%85%8B%E9%9A%86/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨å…‹éš†å¯ä»¥å¿«é€Ÿæ„é€ ä¸€ä¸ªå’Œå·²æœ‰å¯¹è±¡ç›¸åŒçš„å‰¯æœ¬</p>
<a id="more"></a>
<p>æ‰€æœ‰çš„Javaç±»éƒ½ç»§æ‰¿è‡ªjava.lang.Object,è€ŒObjectç±»æä¾›äº†ä¸€ä¸ªcloneæ–¹æ³•ï¼Œå¯ä»¥å°†ä¸€ä¸ªJavaå¯¹è±¡å¤åˆ¶ä¸€ä»½ã€‚éœ€è¦æ³¨æ„çš„æ˜¯èƒ½å¤Ÿå®ç°å…‹éš†çš„Javaç±»å¿…é¡»å®ç°ä¸€ä¸ªæ ‡ç¤ºæ¥å£Cloneableï¼Œè¡¨ç¤ºè¿™ä¸ªJavaç±»æ”¯æŒå¤åˆ¶ã€‚å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£ä½†æ˜¯è°ƒç”¨äº†clone()æ–¹æ³•ï¼ŒJavaç¼–è¯‘å™¨å°†æŠ›å‡ºä¸€ä¸ªCloneNotSupportedExceptionå¼‚å¸¸ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†"><a href="#ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†" class="headerlink" title="ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†"></a>ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç±»åŒ…å«ä¸€äº›æˆå‘˜å¯¹è±¡ï¼Œåœ¨å…‹éš†å¯¹è±¡æ—¶ï¼Œæ ¹æ®å…¶æˆå‘˜å¯¹è±¡æ˜¯å¦ä¹Ÿå…‹éš†ï¼Œå…‹éš†åˆ†ä¸ºä¸¤ç§å½¢å¼ï¼šæ·±å…‹éš†å’Œæµ…å…‹éš†ã€‚</p>
<h4 id="æµ…å…‹éš†"><a href="#æµ…å…‹éš†" class="headerlink" title="æµ…å…‹éš†"></a>æµ…å…‹éš†</h4><p>åœ¨æµ…å…‹éš†ä¸­ï¼Œè¢«å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰æ™®é€šæˆå‘˜å˜é‡éƒ½å…·æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œè€Œæ‰€æœ‰çš„å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæµ…å…‹éš†ä»…ä»…å¤åˆ¶æ‰€è€ƒè™‘çš„å¯¹è±¡ï¼Œè€Œä¸å¤åˆ¶å®ƒæ‰€å¼•ç”¨çš„æˆå‘˜å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å…¶ä¸­çš„æˆå‘˜å¯¹è±¡å¹¶ä¸å¤åˆ¶ã€‚åœ¨æµ…å…‹éš†ä¸­ï¼Œå½“å¯¹è±¡è¢«å¤åˆ¶æ—¶å®ƒæ‰€åŒ…å«çš„æˆå‘˜å¯¹è±¡å´æ²¡æœ‰è¢«å¤åˆ¶ã€‚</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/shadow_copy.png" alt="æµ…å…‹éš†" title="æµ…å…‹éš†">
<p>å›¾ä¸­obj1ä¸ºåŸå‹å¯¹è±¡ï¼Œobj2ä¸ºå¤åˆ¶åçš„å¯¹è±¡ï¼ŒcontainedObj1å’ŒcontainedObj2ä¸ºæˆå‘˜å¯¹è±¡ã€‚</p>
<h4 id="æ·±å…‹éš†"><a href="#æ·±å…‹éš†" class="headerlink" title="æ·±å…‹éš†"></a>æ·±å…‹éš†</h4><p>åœ¨æ·±å…‹éš†ä¸­è¢«å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰æ™®é€šæˆå‘˜å˜é‡ä¹Ÿéƒ½å«æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œé™¤å»é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡ã€‚é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡å°†æŒ‡å‘è¢«å¤åˆ¶è¿‡æ¥çš„æ–°å¯¹è±¡ï¼Œè€Œä¸å†æ˜¯åŸæœ‰çš„é‚£äº›è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæ·±å…‹éš†æŠŠè¦å¤åˆ¶çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½å¤åˆ¶äº†ä¸€éã€‚åœ¨æ·±å…‹éš†ä¸­ï¼Œé™¤äº†å¯¹è±¡æœ¬èº«è¢«å¤åˆ¶å¤–ï¼Œå¯¹è±¡åŒ…å«çš„å¼•ç”¨ä¹Ÿè¢«å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯å…¶ä¸­çš„æˆå‘˜å¯¹è±¡ä¹Ÿè¢«å¤åˆ¶ã€‚</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/deep_copy.png" alt="æ·±å…‹éš†" title="æ·±å…‹éš†">
<h3 id="Javaä¸­clone-æ–¹æ³•è§£æ"><a href="#Javaä¸­clone-æ–¹æ³•è§£æ" class="headerlink" title="Javaä¸­clone()æ–¹æ³•è§£æ"></a>Javaä¸­clone()æ–¹æ³•è§£æ</h3><p>Javaè¯­è¨€æä¾›çš„clone()æ–¹æ³•å°†å¯¹è±¡å¤åˆ¶äº†ä¸€ä»½å¹¶è¿”å›ç»™è°ƒç”¨è€…ã€‚ä¸€èˆ¬è€Œè¨€,clone()æ–¹æ³•æ»¡è¶³ï¼š</p>
<ol>
<li>å¯¹ä»»ä½•çš„å¯¹è±¡xï¼Œéƒ½æœ‰x.clone() != xï¼Œå³å…‹éš†å¯¹è±¡ä¸åŸå¯¹è±¡ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</li>
<li>å¯¹ä»»ä½•å¯¹å¯¹è±¡xï¼Œéƒ½æœ‰x.clone().getClass() == x.getClass()ï¼Œå³å…‹éš†å¯¹è±¡ä¸åŸå¯¹è±¡çš„ç±»å‹ä¸€æ ·ã€‚</li>
<li>å¦‚æœå¯¹è±¡xçš„equals()æ–¹æ³•å®šä¹‰æ°å½“ï¼Œé‚£ä¹ˆx.clone().equals(x)åº”è¯¥æˆç«‹ã€‚</li>
</ol>
<p>ä¸ºäº†è·å–å¯¹è±¡çš„ä¸€ä»½æ‹·è´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Objectç±»çš„clone()æ–¹æ³•ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>åœ¨æ´¾ç”Ÿç±»ä¸­è¦†ç›–åŸºç±»çš„clone()æ–¹æ³•ï¼Œå¹¶å£°æ˜ä¸ºpublicã€‚</li>
<li>åœ¨æ´¾ç”Ÿç±»çš„clone()æ–¹æ³•ä¸­ï¼Œè°ƒç”¨super.clone()ã€‚</li>
<li>åœ¨æ´¾ç”Ÿç±»ä¸­å®ç°Cloneableæ¥å£ã€‚</li>
</ol>
<p>åœ¨Javaä¸­ï¼Œé€šè¿‡è¦†ç›–Objectç±»çš„clone()æ–¹æ³•å¯ä»¥å®ç°æµ…å…‹éš†ï¼Œå¦‚æœéœ€è¦å®ç°æ·±å…‹éš†ï¼Œå¯ä»¥é€šè¿‡åºåˆ—åŒ–ç­‰æ–¹å¼å®ç°ã€‚</p>
<p>åºåˆ—åŒ–(Serialization)å°±æ˜¯å°†å¯¹è±¡å†™åˆ°æµçš„è¿‡ç¨‹ï¼Œå†™åˆ°æµä¸­çš„å¯¹è±¡æ˜¯åŸå¯¹è±¡çš„ä¸€ä¸ªæ‹·è´ï¼Œè€ŒåŸå¯¹è±¡ä»ç„¶å­˜åœ¨ä¸å†…å­˜ä¸­ã€‚é€šè¿‡åºåˆ—åŒ–å®ç°çš„æ‹·è´ä¸ä»…å¯ä»¥å¤åˆ¶å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸”å¯ä»¥å¤åˆ¶å…¶å¼•ç”¨çš„æˆå‘˜å¯¹è±¡ï¼Œå› æ­¤é€šè¿‡åºåˆ—åŒ–å°†å¯¹è±¡å†™åˆ°ä¸€ä¸ªæµä¸­ï¼Œå†ä»æµé‡Œå°†å…¶è¯»å‡ºæ¥ï¼Œä»è€Œå®ç°å…‹éš†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯èƒ½å¤Ÿå®ç°åºåˆ—åŒ–çš„å¯¹è±¡å…¶ç±»å¿…é¡»å®ç°Serializableæ¥å£ï¼Œå¦åˆ™æ— æ³•å®ç°åºåˆ—åŒ–æ“ä½œã€‚</p>
<p>Javaæä¾›çš„Cloneableæ¥å£å’ŒSerializableæ¥å£å…¶ä»£ç éƒ½éå¸¸ç®€å•ï¼Œå®ƒä»¬æ˜¯ç©ºæ¥å£ï¼Œè¿™ç§ç©ºæ¥å£ä¹Ÿç§°ä¸ºæ ‡ç¤ºæ¥å£ï¼Œæ ‡ç¤ºæ¥å£ä¸­æ²¡æœ‰ä»»ä½•æ–¹æ³•å®šä¹‰ï¼Œå…¶ä½œç”¨å°±æ˜¯å‘Šè¯‰JREè¿™äº›æ¥å£çš„å®ç°ç±»æ˜¯å¦å…·æœ‰æŸä¸ªåŠŸèƒ½ï¼Œå¦‚æ˜¯å¦æ”¯æŒå…‹éš†ï¼Œæ˜¯å¦æ”¯æŒåºåˆ—åŒ–ç­‰ã€‚</p>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>ä¸‹é¢é€šè¿‡ä¸¤ä¸ªå®ä¾‹åˆ†åˆ«å®ç°æµ…å…‹éš†å’Œæ·±å…‹éš†ã€‚</p>
<h4 id="é‚®ä»¶æµ…å…‹éš†"><a href="#é‚®ä»¶æµ…å…‹éš†" class="headerlink" title="é‚®ä»¶æµ…å…‹éš†"></a>é‚®ä»¶æµ…å…‹éš†</h4><p>1.å®ä¾‹è¯´æ˜</p>
<p>ç”±äºé‚®ä»¶å¯¹è±¡åŒ…å«çš„å†…å®¹è¾ƒå¤š(å¦‚å‘é€è€…ã€æ¥æ”¶è€…ã€æ ‡é¢˜ã€å†…å®¹ã€ä¸»é¢˜ã€æ—¥æœŸã€é™„ä»¶ç­‰)ï¼ŒæŸç³»ç»Ÿç°éœ€è¦æä¾›ä¸€ä¸ªé‚®ä»¶å¤åˆ¶åŠŸèƒ½ï¼Œå¯¹äºå·²ç»åˆ›å»ºå¥½çš„é‚®ä»¶å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªæ–°çš„é‚®ä»¶å¯¹è±¡ï¼Œå¦‚æœè¦ä¿®æ”¹æŸéƒ¨åˆ†å†…å®¹ï¼Œæ— é¡»ä¿®æ”¹åŸå§‹çš„é‚®ä»¶å¯¹è±¡ï¼Œåªéœ€è¦ä¿®æ”¹å¤åˆ¶å¾—åˆ°çš„é‚®ä»¶å¯¹è±¡å³å¯ã€‚åœ¨æœ¬å®ä¾‹ä¸­ä½¿ç”¨æµ…å…‹éš†å®ç°é‚®ä»¶å¤åˆ¶ï¼Œå¤åˆ¶é‚®ä»¶(E_mail)çš„åŒæ—¶ä¸å¤åˆ¶é™„ä»¶(Attachment)ã€‚</p>
<p>2.å®ä¾‹ç±»å›¾</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/shadow_clone_class_diagram.png" alt="æµ…å…‹éš†ç±»å›¾" title="æµ…å…‹éš†ç±»å›¾">
<p>3.å®ä¾‹ä»£ç åŠè§£é‡Š</p>
<p>(1) æŠ½è±¡åŸå‹ç±»Object</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> java.lang</div><div class="line">	...</div><div class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedExceptioni</span>;</div><div class="line">	...</div></pre></td></tr></table></figure>
<p>Objectä½œä¸ºæŠ½è±¡åŸå‹ç±»ï¼Œåœ¨Javaä¸­ï¼Œæ‰€æœ‰çš„ç±»éƒ½æ˜¯Objectçš„å­ç±»ï¼Œåœ¨Objectä¸­æä¾›å…‹éš†æ–¹æ³•clone()ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå…¶clone()æ–¹æ³•å…·ä½“å®ç°ç”±JVMå®Œæˆï¼Œç”¨æˆ·ä½¿ç”¨æ—¶æ— é¡»å…³å¿ƒã€‚</p>
<p>(2) å…·ä½“åŸå‹ç±»Email(é‚®ä»¶ç±»)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> Attachment attachment = <span class="keyword">null</span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Email</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.attachment = <span class="keyword">new</span> Attachment();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</div><div class="line">        Email clone = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            clone = (Email) <span class="keyword">super</span>.clone();</div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span>  clone;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> Attachment <span class="title">getAttachment</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.attachment;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"æŸ¥çœ‹é‚®ä»¶"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Emailç±»æ˜¯å…·ä½“åŸå‹ç±»ï¼Œä¹Ÿæ˜¯Objectç±»çš„å­ç±»ï¼Œåœ¨Javaä¸­ï¼Œåªæœ‰å®ç°äº†Cloneableæ¥å£çš„ç±»æ‰èƒ½ä½¿ç”¨clone()æ–¹æ³•æ¥è¿›è¡Œå¤åˆ¶ï¼Œå› æ­¤Emailç±»å®ç°äº†Cloneableæ¥å£ã€‚åœ¨Emailç±»ä¸­è¦†ç›–äº†Objectçš„clone()æ–¹æ³•ï¼ŒåŠŸè¿‡ç›´æ¥æˆ–é—´æ¥è°ƒç”¨Objectçš„clone()æ–¹æ³•è¿”å›ä¸€ä¸ªå…‹éš†çš„åŸå‹å¯¹è±¡ã€‚åœ¨Emailç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæˆå‘˜å¯¹è±¡attachmentï¼Œç±»å‹ä¸ºAttachmentã€‚</p>
<p>4.è¾…åŠ©ä»£ç </p>
<p>(1) é™„ä»¶ç±»Attachment</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Attachment</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"ä¸‹è½½é™„ä»¶"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜æ·±å…‹éš†å’Œæµ…å…‹éš†çš„åŒºåˆ«ï¼Œåœ¨æœ¬å®ä¾‹ä¸­å¼•å…¥äº†é™„ä»¶ç±»Attachment,é‚®ä»¶ç±»Emailä¸é™„ä»¶ç±»æ˜¯ç»„åˆå…³è”å…³ç³»ï¼Œåœ¨é‚®ä»¶ç±»ä¸­å®šä¹‰ä¸€ä¸ªé™„ä»¶ç±»å¯¹è±¡ä½œä¸ºå…¶æˆå‘˜å¯¹è±¡ã€‚</p>
<p>(2) å®¢æˆ·ç«¯æµ‹è¯•ç±»Client</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Email email, copyEmail;</div><div class="line">        email = <span class="keyword">new</span> Email();</div><div class="line">        copyEmail = (Email) email.clone();</div><div class="line">        </div><div class="line">        System.out.println(<span class="string">"email == copyEmail?"</span>);</div><div class="line">        System.out.println(email == copyEmail);</div><div class="line">        </div><div class="line">        System.out.println(<span class="string">"email.getAttachment == copyEmail.getAttachment?"</span>);</div><div class="line">        System.out.println(email.getAttachment() == copyEmail.getAttachment());</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨Clientå®¢æˆ·ç«¯æµ‹è¯•ç±»ä¸­ï¼Œæ¯”è¾ƒåŸå‹å¯¹è±¡å’Œå¤åˆ¶å¯¹è±¡æ˜¯å¦ä¸€è‡´ï¼Œå¹¶æ¯”è¾ƒå…¶æˆå‘˜å¯¹è±¡attachmentçš„å¼•ç”¨æ˜¯å¦ä¸€è‡´ã€‚</p>
<p>5.ç»“æœåˆ†æ</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•ç±»ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">email == copyEmail?</div><div class="line">false</div><div class="line">email.getAttachment == copyEmail.getAttachment?</div><div class="line">true</div></pre></td></tr></table></figure>
<h4 id="é‚®ä»¶æ·±å…‹éš†"><a href="#é‚®ä»¶æ·±å…‹éš†" class="headerlink" title="é‚®ä»¶æ·±å…‹éš†"></a>é‚®ä»¶æ·±å…‹éš†</h4><p>1.å®ä¾‹è¯´æ˜</p>
<p>ä½¿ç”¨æ·±å…‹éš†å®ç°é‚®ä»¶å¤åˆ¶ï¼Œå³å¤åˆ¶é‚®ä»¶çš„åŒæ—¶å¤åˆ¶é™„ä»¶ã€‚</p>
<p>2.å®ä¾‹ç±»å›¾</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/deep_clone_class_diagram.png" alt="æ·±å…‹éš†ç±»å›¾" title="æ·±å…‹éš†ç±»å›¾">
<p>3.å®ä¾‹ä»£ç ä¸è§£é‡Š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Attachment attachment = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Email</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.attachment = <span class="keyword">new</span> Attachment();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">deepClone</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, OptionalDataException </span>&#123;</div><div class="line">        </div><div class="line">        <span class="comment">// å°†å¯¹è±¡å†™å…¥æµä¸­</span></div><div class="line">        ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</div><div class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(baos);</div><div class="line">        oos.writeObject(<span class="keyword">this</span>);</div><div class="line">        </div><div class="line">        <span class="comment">// å°†å¯¹è±¡ä»æµä¸­è¯»å‡º</span></div><div class="line">        ByteArrayInputStream bais = <span class="keyword">new</span> ByteArrayInputStream(baos.toByteArray());</div><div class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(bais);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> ois.readObject();</div><div class="line">        </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Attachment <span class="title">getAttachment</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.attachment;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"æŸ¥çœ‹é‚®ä»¶"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Emailä½œä¸ºå…·ä½“åŸå‹ç±»ï¼Œç”±äºå®ç°çš„æ˜¯æ·±å…‹éš†ï¼Œæ— é¡»ä½¿ç”¨Objectçš„clone()æ–¹æ³•ï¼Œå› æ­¤æ— é¡»å®ç°Cloneableæ¥å£ï¼›é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼å®ç°æ·±å…‹éš†ï¼Œç”±äºè¦å°†Emailç±»å‹çš„å¯¹è±¡å†™å…¥æµä¸­ï¼Œå› æ­¤Emailç±»éœ€è¦å®ç°Serializiableæ¥å£ã€‚</p>
<p>4.è¾…åŠ©ä»£ç </p>
<p>(1)é™„ä»¶ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.Serializable;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Attachment</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"ä¸‹è½½é™„ä»¶"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½œä¸ºEmailç±»çš„å¯¹è±¡æˆå‘˜ï¼Œåœ¨æ·±å…‹éš†ä¸­ï¼ŒAttachmentç±»å‹çš„å¯¹è±¡ä¹Ÿå°†è¢«å†™å…¥æµä¸­ï¼Œå› æ­¤Attachmentç±»ä¹Ÿéœ€è¦å®ç°Serializiableæ¥å£ã€‚</p>
<p>(2)å®¢æˆ·ç«¯æµ‹è¯•ç±»Client</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Email email, copyEmail = <span class="keyword">null</span>;</div><div class="line">        email = <span class="keyword">new</span> Email();</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            copyEmail = (Email) email.deepClone();</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"email == copyEmail?"</span>);</div><div class="line">        System.out.println(email == copyEmail);</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"email.getAttachment == copyEmail.getAttachment?"</span>);</div><div class="line">        System.out.println(email.getAttachment() == copyEmail.getAttachment());</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>5.ç»“æœåŠåˆ†æ</p>
<p>ç¼–è¯‘è¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•ç±»ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">email == copyEmail?</div><div class="line">false</div><div class="line">email.getAttachment == copyEmail.getAttachment?</div><div class="line">false</div></pre></td></tr></table></figure>
<p>é€šè¿‡ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè¡¨è¾¾å¼(email == copyEmail)ç»“æœä¸ºfalseï¼Œå³é€šè¿‡å¤åˆ¶å¾—åˆ°çš„å¯¹è±¡ä¸åŸå‹å¯¹è±¡çš„å¼•ç”¨ä¸ä¸€è‡´ï¼Œè¡¨è¾¾å¼(email.getAttachment() == copyEmail.getAttachment())ç»“æœä¸ºfalseï¼ŒåŸå‹å¯¹è±¡ä¸å…‹éš†å¯¹è±¡æˆå‘˜å¯¹è±¡çš„å¼•ç”¨ä¸ç›¸åŒï¼Œè¯´æ˜å…¶æˆå‘˜å¯¹è±¡ä¹Ÿå¤åˆ¶äº†ä¸€ä»½ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[macOSå®‰è£…gccæ•™ç¨‹]]></title>
      <url>http://marktony.github.io/2016/10/31/macOS%E5%AE%89%E8%A3%85gcc%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>ç®€å•å‡ æ­¥å°±å¯ä»¥åœ¨macä¸ŠæˆåŠŸå®‰è£…gcc<br><a id="more"></a></p>
<p>ç½‘ä¸Šçš„æ•™ç¨‹å¤§å¤šæ˜¯é€šè¿‡å®‰è£…Xcodeå®ç°å®‰è£…gccçš„ï¼Œè¿™ç§æ–¹å¼çš„èŠ±è´¹æœ‰ç‚¹å¤ªå¾—ä¸å¿å¤±ï¼ŒXcodeå æ®çš„ç©ºé—´æ˜¯åœ¨å¤ªå¤§ï¼Œè¿™å¯¹äº128gç”¨æˆ·ç®€ç›´å°±æ˜¯å™©æ¢¦ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯é€šè¿‡homebrewå®‰è£…ï¼Œå‰ææ˜¯ä½ ç”µè„‘ä¸Šè¦å®‰è£…äº†homebrewã€‚</p>
<p>è¿™é‡Œä»‹ç»ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚</p>
<p>1.åˆ°<a href="https://sourceforge.net/projects/hpc/files/hpc/gcc/" target="_blank" rel="external">è¿™é‡Œ</a>ä¸‹è½½æ‰€éœ€è¦çš„çš„gccå‹ç¼©åŒ…ã€‚<br><img src="/2016/10/31/macOSå®‰è£…gccæ•™ç¨‹/website.png" alt="ä¸‹è½½åœ°å€" title="ä¸‹è½½åœ°å€"></p>
<p>2.ä¸‹è½½å®Œæˆåï¼Œé€šè¿‡terminalè¿›å…¥ä¸‹è½½ç›®å½•ï¼Œå³gcc-4.8-bin.tar.gzæ‰€åœ¨çš„ç›®å½•ã€‚è¾“å…¥å‘½ä»¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gunzip gcc-4.8-bin.tar.gz</div></pre></td></tr></table></figure></p>
<p>è§£å‹gcc-4.8-bin.tar.gzå‹ç¼©åŒ…ï¼Œæ³¨æ„åªéœ€è¦è§£å‹ä¸€æ¬¡ï¼Œåœ¨åŒä¸€ç›®å½•ä¸‹å¾—åˆ°gcc-4.8-bin.taræ–‡ä»¶ã€‚</p>
<p>3.ç»§ç»­åœ¨terminalä¸­è¾“å…¥å‘½ä»¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo tar -xvf gcc-4.8-bin.tar</div></pre></td></tr></table></figure></p>
<p>è¾“å…¥å¯†ç åï¼Œè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆäº†usrç›®å½•ã€‚cd /user/local/binå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„gccç›¸å…³çš„å‘½ä»¤äº†ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥å°†æ•´ä¸ªç›®å½•ç§»åŠ¨åˆ°ä½ éœ€è¦çš„ç›®å½•ã€‚<br><img src="/2016/10/31/macOSå®‰è£…gccæ•™ç¨‹/directory.png" alt="è§£å‹åçš„ç›®å½•" title="è§£å‹åçš„ç›®å½•"></p>
<p>4.æ·»åŠ gccè·¯å¾„ã€‚å…³æ‰å½“å‰terminalï¼Œé‡æ–°æ–°å»ºä¸€ä¸ªterminalã€‚è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š<code>touch ï½/.bash_profile</code>æ–°å»ºä¸€ä¸ªbash_profileæ–‡ä»¶ï¼Œä½¿ç”¨viæˆ–è€…å…¶ä»–ç¼–è¾‘å™¨å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<code>export PATH=&quot;/Users/lizhaotailang/Gcc/usr/local/bin:$PATH&quot;</code>,å½“ç„¶è¿™æ˜¯æˆ‘çš„è·¯å¾„ï¼Œå…·ä½“çš„è·¯å¾„æ ¹æ®ä½ çš„å®é™…æƒ…å†µè€Œå®šã€‚å†™å…¥å®Œæˆåå…³é—­æ–‡ä»¶ã€‚ä¸ºäº†ä½¿æ–‡ä»¶ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦åœ¨terminalè¾“å…¥<code>source ï½ï¼.bash_profile</code>ã€‚</p>
<p>5.æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆã€‚åœ¨terminalä¸­è¾“å…¥ï¼š<code>echo $PATH</code>,å¦‚æœèƒ½å¤Ÿåœ¨è¾“å‡ºä¸­çœ‹åˆ°åˆšåˆšæ·»åŠ çš„è·¯å¾„å°±è¯´æ˜æ·»åŠ æˆåŠŸäº†ã€‚æˆ–è€…ç›´æ¥è¾“å…¥gccå‘½ä»¤ï¼Œå¦‚æœèƒ½å¤Ÿçœ‹åˆ°gccçš„clangé”™è¯¯è€Œä¸æ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶çš„è¯ï¼Œå°±è¯´æ˜é…ç½®æˆåŠŸäº†ã€‚<br><img src="/2016/10/31/macOSå®‰è£…gccæ•™ç¨‹/terminal.png" alt="è·¯å¾„é…ç½®" title="è·¯å¾„é…ç½®"></p>
<p>6.ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨gccäº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter]]></title>
      <url>http://marktony.github.io/2016/10/21/Android-Studio%E6%96%B0%E5%BB%BALibrary%E5%B9%B6%E4%B8%8A%E4%BC%A0%E5%88%B0JCenter/</url>
      <content type="html"><![CDATA[<p>ç®€å•å®ç”¨çš„æ•™ç¨‹ï¼Œæ•™ä½ å¦‚ä½•ä¸€æ­¥ä¸€æ­¥ä»æ–°å»ºLibraryåˆ°ä¸Šä¼ è‡³JCenter<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨å¼€å‘appçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çš„æƒ…å†µï¼Œä¾‹å¦‚å¸¸ç”¨çš„<a href="https://github.com/square/okhttp" target="_blank" rel="external">Okhttp</a>ï¼Œåªéœ€è¦æ·»åŠ ä¸€è¡Œä»£ç åˆ°appä¸‹åˆ°gradleæ–‡ä»¶ä¸­å°±å¯ä»¥å®ç°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile &apos;com.squareup.okhttp3:okhttp:3.4.1&apos;</div></pre></td></tr></table></figure></p>
<p>è¿™ç§æ–¹å¼ä½¿ç”¨çš„å°±æ˜¯squareupä¸Šä¼ åˆ°JCenterçš„Libraryã€‚é‚£ä¹ˆè¿™ç§æ–¹å¼æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</p>
<h3 id="Mavenä¸JCenter"><a href="#Mavenä¸JCenter" class="headerlink" title="Mavenä¸JCenter"></a>Mavenä¸JCenter</h3><p>JCenteræ˜¯ç”±<a href="https://bintray.com/" target="_blank" rel="external">bintray.com</a>ç»´æŠ¤çš„Mavenåº“ã€‚åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­å®šä¹‰å¦‚ä¸‹ï¼Œå°±å¯ä»¥ä½¿ç”¨JCenteräº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Maven Central<br>Mavenæ˜¯ç”±<a href="https://sonatype.org/" target="_blank" rel="external">sonatype.org</a>ç»´æŠ¤çš„Mavenä»“åº“ã€‚<br>åœ¨ä½¿ç”¨ä¸€äº›å¼€æºåº“çš„æ—¶å€™å¯èƒ½ä¼šè¦æ±‚ä½ åœ¨æ ¹ç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        mavenCentral()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·å°±èƒ½ä½¿ç”¨mavenCentraläº†ã€‚</p>
<p>è¿™ä¸¤è€…æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p>
<p>å•Šå“ˆå“ˆå“ˆå“ˆï¼Œæ²¡æœ‰å…³ç³»ï¼ˆçŸ¥é“çœŸç›¸çš„æˆ‘è¡¨æƒ…æ˜¯è¿™æ ·çš„ï¼šä½ tmåœ¨é€—æˆ‘.jpgï¼‰ã€‚éƒ½æ˜¯Mavenä»“åº“ï¼Œåªæ˜¯å­˜æ”¾çš„åœ°æ–¹ä¸ä¸€æ ·ç½¢äº†ã€‚åœ¨è¾ƒè€ç‰ˆæœ¬çš„Android Studioä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ Maven Centralï¼Œä¸è¿‡ç”±äºå®ƒå¯¹å¼€å‘è€…ä¸é‚£ä¹ˆçš„å‹å¥½ï¼Œåæ¥å°±é»˜è®¤ä½¿ç”¨JCenteräº†ã€‚</p>
<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><h4 id="1-æ³¨å†Œbintrayå¸å·"><a href="#1-æ³¨å†Œbintrayå¸å·" class="headerlink" title="1. æ³¨å†Œbintrayå¸å·"></a>1. æ³¨å†Œbintrayå¸å·</h4><p>è¿™æ˜¯å½“ç„¶äº†ï¼Œè¦åœ¨äººå®¶çš„å¹³å°ä¸Šå‘å¸ƒLibraryå½“ç„¶é¦–å…ˆå¾—æœ‰ä¸€ä¸ªå¸å·äº†ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨GitHubç™»å½•ã€‚</p>
<p>ä¼ é€é—¨â€”&gt;<a href="https://bintray.com/" target="_blank" rel="external">bintrayå®˜æ–¹ç½‘ç«™</a></p>
<p>æ³¨å†ŒæˆåŠŸåå°±èƒ½çœ‹åˆ°é…±çš„é¡µé¢äº†ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_personal_centre.png" alt="bintrayä¸ªäººä¸­å¿ƒ" title="bintrayä¸ªäººä¸­å¿ƒ">
<h4 id="2-åˆ›å»ºæ–°çš„ä»“åº“"><a href="#2-åˆ›å»ºæ–°çš„ä»“åº“" class="headerlink" title="2. åˆ›å»ºæ–°çš„ä»“åº“"></a>2. åˆ›å»ºæ–°çš„ä»“åº“</h4><p>ç‚¹å‡»Add New Repository, åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œtypeé€‰æ‹©Mavenã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_create_new_repository.png" alt="åˆ›å»ºæ–°çš„ä»“åº“" title="åˆ›å»ºæ–°çš„ä»“åº“">
<h4 id="3-åˆ›å»ºpackage"><a href="#3-åˆ›å»ºpackage" class="headerlink" title="3. åˆ›å»ºpackage"></a>3. åˆ›å»ºpackage</h4><p>ä»“åº“åˆ›å»ºæˆåŠŸä¹‹åå°±å¯ä»¥æ·»åŠ åŒ…äº†ã€‚è¿›å…¥ä»“åº“è¯¦æƒ…é¡µï¼Œç‚¹å‡»å³ä¸‹è§’ï¼ŒAdd New Packageã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_add_new_package.png" alt="åˆ›å»ºpackage" title="åˆ›å»ºpackage">
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_add_new_package1.png" alt="åˆ›å»ºpackage" title="åˆ›å»ºpackage">
<p>åˆ°è¿™é‡Œï¼Œå‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ï¼Œç°åœ¨è¦å¼€å§‹å†™ä»£ç äº†ã€‚</p>
<h3 id="åˆ›å»ºLibrary"><a href="#åˆ›å»ºLibrary" class="headerlink" title="åˆ›å»ºLibrary"></a>åˆ›å»ºLibrary</h3><ol>
<li><p>æ–°å»ºä¸€ä¸ªAndroid Projectï¼Œè¿™é‡Œå’Œæˆ‘ä»¬å¹³æ—¶åˆ›å»ºå·¥ç¨‹æ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>åœ¨é¡¹ç›®æ ¹æ–‡ä»¶å¤¹ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œnew -&gt; module -&gt; Android Libraryã€‚</p>
</li>
</ol>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/AndroidStudio_create_new_module.png" alt="åˆ›å»ºLibrary" title="åˆ›å»ºLibrary">
<p>åˆ›å»ºæˆåŠŸåï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/AndroidStudio_project_structure.png" alt="é¡¹ç›®ç»“æ„" title="é¡¹ç›®ç»“æ„">
<ol>
<li>ç°åœ¨å°±å¯ä»¥åœ¨åº“ç›®å½•(æˆ‘è¿™é‡Œæ˜¯CircleProgressBar)ä¸‹ç¼–å†™ä»£ç äº†ã€‚</li>
</ol>
<h3 id="æ‰“åŒ…æ–‡ä»¶"><a href="#æ‰“åŒ…æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…æ–‡ä»¶"></a>æ‰“åŒ…æ–‡ä»¶</h3><p>ä¹‹å‰çœ‹çš„æ•™ç¨‹éƒ½æ˜¯é€šè¿‡é…ç½®ç‚’é¸¡å¤æ‚(å¥½å§ï¼Œå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼Œé…ç½®äº†å¾ˆä¹…éƒ½æ²¡æœ‰æˆåŠŸâ€¦)çš„build.gradleçš„æ–¹æ³•æ¥å®ç°çš„ã€‚è¿™é‡Œä»‹ç»ä¸€ç§ç‚’é¸¡ç‚’é¸¡ç®€å•çš„æ–¹æ³•ã€‚</p>
<p>1.æ‰¾åˆ°Libraryä¸‹çš„build.gradleæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ext &#123;</div><div class="line">    PUBLISH_GROUP_ID = &apos;io.github.marktony&apos;</div><div class="line">    PUBLISH_ARTIFACT_ID = &apos;circle-progress-bar&apos;</div><div class="line">    PUBLISH_VERSION = &apos;1.1&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ–‡ä»¶æœ«å°¾æ·»åŠ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply from: &apos;https://raw.githubusercontent.com/blundell/release-android-library/master/android-release-aar.gradle&apos;</div></pre></td></tr></table></figure></p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/AndroidStudio_set_gradle.png" alt="é…ç½®gradleæ–‡ä»¶" title="é…ç½®gradleæ–‡ä»¶">
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>PUBLISH_GROUP_ID</td>
<td>å¼€å‘è€…åç§°</td>
</tr>
<tr>
<td>PUBLISH_ARTIFACT_ID</td>
<td>é¡¹ç›®åç§°</td>
</tr>
<tr>
<td>PUBLISH_VERSION</td>
<td>ç‰ˆæœ¬</td>
</tr>
</tbody>
</table>
<p>å¯¹æ¯”compileåœ°å€ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç†è§£ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile &apos;io.github.marktony:circle-progress-bar:1.1&apos;</div></pre></td></tr></table></figure></p>
<p>2.æ‰“åŒ…<br>åœ¨Android Studioçš„terminalä¸­æ‰§è¡Œï¼š</p>
<p>Windows:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradlew clean build generateRelease</div></pre></td></tr></table></figure></p>
<p>MacOS:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./gradlew clean build generateRelease</div></pre></td></tr></table></figure></p>
<p>ç»è¿‡ä¸€ç³»åˆ—çš„ä¸‹è½½ï¼‹å„ç§ç¼–è¯‘ä¹‹å(ç¬¬ä¸€æ¬¡ç¼–è¯‘çš„è¯ï¼Œå»ºè®®ä½ åƒä¸ªé¥­æˆ–è€…ç»“ä¸ªå©šç”Ÿä¸ªå¨ƒä»€ä¹ˆçš„å†å›æ¥(ç¬‘ï¼Œå¤§æ¦‚30åˆ†é’Ÿå·¦å³)ï¼Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œè¦ä¸‹è½½æ–‡ä»¶è¶…çº§å¤šï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯åªæœ‰æˆ‘ä¸€ä¸ªäººæ˜¯è¿™æ ·ã€‚ä»¥åå†ç¼–è¯‘å°±ç‚’é¸¡å¿«äº†ã€‚)å°±ä¼šæç¤ºä½ BUILD SUCCESS,è¿˜æœ‰zipåŒ…çš„å­˜æ”¾è·¯å¾„ï¼Œæ‰¾åˆ°è¿™ä¸ªzipï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p>
<h3 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h3><p>å›åˆ°ä¹‹å‰bintrayçš„ç½‘ç«™ï¼Œè¿›å…¥packageçš„è¯¦æƒ…ï¼Œå°±ä¼šçœ‹åˆ°ä¸‹é¢çš„ç•Œé¢ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_package_detail.png" alt="packageè¯¦æƒ…" title="packageè¯¦æƒ…">
<p>ç‚¹å‡»versionï¼Œæ–°å»ºä¸€ä¸ªç‰ˆæœ¬ã€‚å®Œæˆåç‚¹å‡»åˆšåˆšæ–°å»ºçš„ç‰ˆæœ¬ï¼Œç‚¹å‡»Upload Filesï¼Œä¸Šä¼ ä¹‹å‰ç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œæ³¨æ„è¦é€‰ä¸­exploding the archiveé€‰é¡¹ã€‚</p>
<p>ç‚¹å‡»Save Changesï¼Œå°±ä¼šæœ‰æç¤ºä½ æ˜¯å¦å‘å¸ƒï¼Œç‚¹å‡»å‘å¸ƒå°±å¥½äº†ã€‚</p>
<p>å¦‚ä½•å‘å¸ƒåˆ°JCenterå‘¢ï¼Ÿ</p>
<p>å›åˆ°packageï¼Œçœ‹åˆ°å³ä¸‹è§’Add to JCenterï¼Œç‚¹å‡»å°±å¯ä»¥ç”³è¯·å‘å¸ƒåˆ°JCenteräº†ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_add_to_jcenter.png" alt="æ·»åŠ åˆ°JCenter" title="æ·»åŠ åˆ°JCenter">
<p>åé¢å°±æ˜¯ç­‰å¾…å®¡æ ¸ï¼Œä¸€èˆ¬ç­‰å¾…å‡ ä¸ªå°æ—¶å°±ä¼šå®¡æ ¸é€šè¿‡äº†ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦è®©åˆ«äººçŸ¥é“ä½ çš„compileåœ°å€ï¼Œå¯ä»¥åœ¨Generalæ ç›®ä¸‹åˆ†åˆ«çœ‹åˆ°Mavenå’ŒGradleçš„åœ°å€äº†ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_compile_addr_maven.png" alt="Mavenåœ°å€" title="Mavenåœ°å€">
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_compile_addr_gradle.png" alt="Gradle" title="Gradle">
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åœ¨æˆ‘çœ‹æ¥ï¼Œé€šè¿‡ä¸Šè¿°æ–¹æ³•å®ç°ä¸Šä¼ Libraryåˆ°JCenterçš„æ–¹æ³•ç›¸è¾ƒäºé…ç½®å¤æ‚gradleæ–‡ä»¶çš„æ–¹å¼è¦ç®€ä¾¿è®¸å¤šï¼Œä½†åŒæ—¶ä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿå°±æ„å‘³è¿™æ¯æ¬¡æœ‰äº†æ–°çš„ç‰ˆæœ¬éƒ½è¦æ‰‹åŠ¨ä¸Šä¼ ï¼Œä¸èƒ½é€šè¿‡terminalç›´æ¥ä¸Šä¼ ã€‚</p>
<p>å¦‚æœä½ å¯¹æˆ‘å¯¹CirlceProgressBaré¡¹ç›®æ„Ÿå…´è¶£æˆ–è€…å¯¹é…ç½®æ–‡ä»¶æœ‰ä¸è§£å¯¹åœ°æ–¹ï¼Œå¯ä»¥å‚è€ƒæºä»£ç </p>
<p><a href="https://github.com/marktony/CircleProgressBar" target="_blank" rel="external">https://github.com/marktony/CircleProgressBar</a></p>
<p>é¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œé‡Œé¢ä¹Ÿæœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œå¦‚æœä½ è§‰å¾—æœ‰ç”¨çš„è¯å°±ç»™ä¸ªstarå§ï¼Œå½“ç„¶é¡µæ¬¢è¿ä½ çœ‹ä¸€çœ‹æˆ‘å¯¹å…¶ä»–é¡¹ç›®å“¦ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[é‡æ„ï¼å°†Google MVPåº”ç”¨äºå·²æœ‰é¡¹ç›®]]></title>
      <url>http://marktony.github.io/2016/09/27/%E9%87%8D%E6%9E%84%EF%BC%81%E5%B0%86Google-MVP%E5%BA%94%E7%94%A8%E4%BA%8E%E5%B7%B2%E6%9C%89%E9%A1%B9%E7%9B%AE/</url>
      <content type="html"><![CDATA[<p>å°†Googleå®˜æ–¹çš„Android MVPæ¶æ„å¼•å…¥åˆ°å·²æœ‰çš„é¡¹ç›®ä¸­ã€‚<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨æœ¬æ¬¡é¡¹ç›®é‡æ„ä¹‹å‰ï¼Œæˆ‘çš„é¡¹ç›®é‡‡ç”¨çš„æ˜¯ä»€ä¹ˆæ¶æ„å‘¢ï¼Ÿ</p>
<p>é¢ï¼Œæ²¡æœ‰æ¶æ„â€¦æˆ–è€…è¯´ï¼Œä¸é‚£ä¹ˆæ ‡å‡†çš„MVCï¼Œä¸€ä¸ªé¡µé¢å°±æ˜¯ä¸€ä¸ªActivityæˆ–è€…Fragmentï¼Œå„ç§æ•°æ®ï¼Œç½‘ç»œè¯·æ±‚ï¼Œå“åº”éƒ½å†™åœ¨Activityæˆ–è€…Fragmentâ€“è¿™ä¸¤ä¸ªä¸æ€ä¹ˆæ ‡å‡†çš„Controllerä¸­ï¼Œä»£ç æ··ä¹±ï¼Œè€Œä¸”é•¿é•¿é•¿é•¿é•¿é•¿ï¼Œå†™ä»£ç çš„æ—¶å€™ä¸€æ—¶çˆ½ï¼Œåˆ°äº†ç»´æŠ¤é˜¶æ®µï¼Œé‚£é…¸çˆ½ï¼Œä¸æ•¢ç›¸ä¿¡ã€‚é‡‡ç”¨æ–°çš„æ¶æ„è¿«åœ¨çœ‰ç«ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå·²ç»æœ‰å¾ˆå¤šçš„Appé¡¹ç›®é‡‡ç”¨äº†MVPæˆ–è€…MVVMç­‰æ¶æ„ã€‚ç”±äºå¹¶æ²¡æœ‰é‚£ä¹ˆæƒå¨çš„å®ç°ï¼Œå¾ˆå¤šå¼€å‘è€…ä¹Ÿé™·å…¥äº†é€‰æ‹©å›°éš¾ç—‡ï¼Œåœ¨å„ç§æ¶æ„ç›´æ¥æ‘‡æ‘†ä¸å®šï¼Œæ‰¾ä¸åˆ°é€‚åˆè‡ªå·±é¡¹ç›®æ¶æ„ã€‚è€ŒGoogleä¹Ÿé€‚æ—¶çš„æ¨å‡ºäº†ä¸€ç³»åˆ—å®˜æ–¹ç¤ºä¾‹ç”¨äºå‚è€ƒã€‚</p>
<h3 id="Googleç¤ºä¾‹é¡¹ç›®"><a href="#Googleç¤ºä¾‹é¡¹ç›®" class="headerlink" title="Googleç¤ºä¾‹é¡¹ç›®"></a>Googleç¤ºä¾‹é¡¹ç›®</h3><blockquote>
<p><a href="https://github.com/googlesamples/android-architecture" target="_blank" rel="external">Android Architecture Blueprints [beta]</a></p>
</blockquote>
<p>ç¤ºä¾‹é¡¹ç›®ä»¥ä¸€ä¸ªTODO APPä¸ºä¾‹ï¼Œç›®å‰ä»ç„¶åœ¨è¿›è¡Œä¸­ã€‚æœ¬æ¬¡é¡¹ç›®é‡æ„é‡‡ç”¨çš„æ˜¯åŸºç¡€ç‰ˆ <a href="https://github.com/googlesamples/android-architecture/tree/todo-mvp/" target="_blank" rel="external">todo-mvp</a></p>
<p>ç¤ºä¾‹é¡¹ç›®çš„ä»£ç ç»„ç»‡æ–¹å¼å’Œæˆ‘ä¹‹å‰ä»¥adapter, activity, fragmentç­‰ç»„ç»‡æ–¹å¼ä¸åŒï¼Œé‡‡ç”¨çš„æ˜¯æŒ‰ç…§åŠŸèƒ½åˆ’åˆ†ï¼Œä¸€ç§åŠŸèƒ½å°±æ˜¯ä¸€ä¸ªåŒ…ï¼ŒåŒ…å†…æ–‡ä»¶ä»¥xxxactivity, xxxfragment, xxxcontract, xxxpresenterå‘½åï¼Œxxxä»£è¡¨ç€æ‰€è¦å®ç°çš„åŠŸèƒ½ã€‚æœ¬æ¬¡é¡¹ç›®é‡æ„ä¸¤ç§æ–¹å¼å‡æœ‰é‡‡ç”¨ã€‚</p>
<h3 id="é‡æ„"><a href="#é‡æ„" class="headerlink" title="é‡æ„"></a>é‡æ„</h3><p>é¦–å…ˆæ˜¯ä»¿ç…§TODO MVPï¼Œå»ºç«‹ä¸¤ä¸ªBaseæ¥å£ï¼ŒBaseViewå’ŒBasePresenterï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬æ¥å£æ˜¯æ‰€æœ‰çš„Viewå’ŒPresenterçš„åŸºç±»ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BasePresenter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>BasePresenterä¸­æœ‰æ–¹æ³•start()ï¼Œä½œç”¨æ˜¯Presenterå¼€å§‹è·å–æ•°æ®å¹¶æ”¹å˜ç•Œé¢æ˜¾ç¤ºï¼Œè°ƒç”¨æ—¶æœºä¸ºFragmentçš„onResume()æ–¹æ³•ä¸­ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseView</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPresenter</span><span class="params">(T presenter)</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initViews</span><span class="params">(View view)</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>BaseViewä¸­æœ‰æ–¹æ³•setPresenter(),å°†Presenterç¤ºä¾‹ä¼ å…¥viewï¼Œè°ƒç”¨æ—¶æœºä¸ºPresenterå®ç°ç±»çš„æ„é€ æ–¹æ³•ä¸­ï¼ŒinitViews()ä¼ å…¥Viewå®ä¾‹ï¼Œç”¨äºåˆå§‹åŒ–ç•Œé¢å…ƒç´ ï¼Œè°ƒç”¨æ—¶æœºä¸ºFragmentçš„onCreate()æ–¹æ³•ä¸­ã€‚</p>
<p>æ¥ç€åˆ›å»ºå¥‘çº¦ç±»ï¼Œç”¨äºç»Ÿä¸€ç®¡ç†Viewå’ŒPresenterçš„æ‰€æœ‰æ¥å£ã€‚è¿™é‡Œä»¥çŸ¥ä¹æ—¥æŠ¥çš„éƒ¨åˆ†ä¸ºä¾‹ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ZhihuDailyContract</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> <span class="keyword">extends</span> <span class="title">BaseView</span>&lt;<span class="title">Presenter</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">showError</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">showLoading</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">stopLoading</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">showResults</span><span class="params">(ArrayList&lt;ZhihuDailyNews.Question&gt; list)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">showNetworkError</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">BasePresenter</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadPosts</span><span class="params">(<span class="keyword">long</span> date, <span class="keyword">boolean</span> clearing)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadMore</span><span class="params">(<span class="keyword">long</span> date)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">startReading</span><span class="params">(<span class="keyword">int</span> position)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">goToSettings</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç„¶ååˆ›å»ºç›¸åº”çš„Activityï¼Œåœ¨å®˜æ–¹çš„ç¤ºä¾‹é¡¹ç›®ä¸­ï¼ŒActivityæ˜¯ä½œä¸ºViewå’ŒPresenterçš„æ¡¥æ¢ä½¿ç”¨ï¼Œç”¨äºåˆ›å»ºViewå’ŒPresenterå®ä¾‹ã€‚æœ¬é¡¹ç›®ç”±äºæ¶‰åŠäº†TabLayoutå’ŒViewPagerçš„ä½¿ç”¨ï¼Œæ‰€ä»¥åˆ›å»ºViewå’ŒPresenterçš„éƒ¨åˆ†æˆ‘æ”¾åˆ°äº†ViewPagerçš„Adapterä¸­å®ç°ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPagerAdapter</span> <span class="keyword">extends</span> <span class="title">FragmentPagerAdapter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String[] titles;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Context context;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainPagerAdapter</span><span class="params">(FragmentManager fm, Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(fm);</div><div class="line">        <span class="keyword">this</span>.context = context;</div><div class="line">        titles = context.getResources().getStringArray(R.array.page_titles);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Fragment <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (position == <span class="number">1</span>)&#123;</div><div class="line">            GuokrFragment fragment = GuokrFragment.newInstance();</div><div class="line">            <span class="keyword">new</span> GuokrPresenter(context, fragment);</div><div class="line">            <span class="keyword">return</span> fragment;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (position == <span class="number">2</span>)&#123;</div><div class="line">            DoubanMomentFragment fragment = DoubanMomentFragment.newInstance();</div><div class="line">            <span class="keyword">new</span> DoubanMomentPresenter(context, fragment);</div><div class="line">            <span class="keyword">return</span> fragment;</div><div class="line">        &#125;</div><div class="line">        ZhihuDailyFragment fragment = ZhihuDailyFragment.newInstance();</div><div class="line">        <span class="keyword">new</span> ZhihuDailyPresenter(context, fragment);</div><div class="line">        <span class="keyword">return</span> fragment;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> titles.length;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> CharSequence <span class="title">getPageTitle</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> titles[position];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Fragmentåœ¨ç¤ºä¾‹é¡¹ç›®ä¸­çš„è§’è‰²ä¸ºViewçš„å…·ä½“å®ç°ç±»ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZhihuDailyFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span></div><div class="line">        <span class="keyword">implements</span> <span class="title">ZhihuDailyContract</span>.<span class="title">View</span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> RecyclerView recyclerView;</div><div class="line">    <span class="keyword">private</span> SwipeRefreshLayout refresh;</div><div class="line">    <span class="keyword">private</span> FloatingActionButton fab;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ZhihuDailyNewsAdapter adapter;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ZhihuDailyContract.Presenter presenter;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZhihuDailyFragment</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ZhihuDailyFragment <span class="title">newInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ZhihuDailyFragment();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Nullable</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        View view = inflater.inflate(R.layout.fragment_douban_zhihu_daily,container,<span class="keyword">false</span>);</div><div class="line"></div><div class="line">        initViews(view);</div><div class="line"></div><div class="line">        presenter.loadPosts(Calendar.getInstance().getTimeInMillis(), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">        refresh.setOnRefreshListener(<span class="keyword">new</span> SwipeRefreshLayout.OnRefreshListener() &#123;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</div><div class="line">                presenter.refresh();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        fab.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">                ...</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> view;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPresenter</span><span class="params">(ZhihuDailyContract.Presenter presenter)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (presenter != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">this</span>.presenter = presenter;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initViews</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">        recyclerView = (RecyclerView) view.findViewById(R.id.rv_main);</div><div class="line">        recyclerView.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(getContext()));</div><div class="line">        recyclerView.addItemDecoration(<span class="keyword">new</span> DividerItemDecoration(getActivity(),LinearLayoutManager.VERTICAL));</div><div class="line">        refresh = (SwipeRefreshLayout) view.findViewById(R.id.refresh);</div><div class="line">        fab = (FloatingActionButton) view.findViewById(R.id.fab);</div><div class="line">        fab.setRippleColor(getResources().getColor(R.color.colorPrimaryDark));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showError</span><span class="params">()</span> </span>&#123;</div><div class="line">        Snackbar.make(fab, R.string.loaded_failed,Snackbar.LENGTH_SHORT).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showLoading</span><span class="params">()</span> </span>&#123;</div><div class="line">        refresh.post(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                refresh.setRefreshing(<span class="keyword">true</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stopLoading</span><span class="params">()</span> </span>&#123;</div><div class="line">        refresh.post(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                refresh.setRefreshing(<span class="keyword">false</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showResults</span><span class="params">(ArrayList&lt;ZhihuDailyNews.Question&gt; list)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (adapter == <span class="keyword">null</span>) &#123;</div><div class="line">            adapter = <span class="keyword">new</span> ZhihuDailyNewsAdapter(getContext(), list);</div><div class="line">            adapter.setItemClickListener(<span class="keyword">new</span> OnRecyclerViewOnClickListener() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnItemClick</span><span class="params">(View v, <span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">                    presenter.startReading(position);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            recyclerView.setAdapter(adapter);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            adapter.notifyDataSetChanged();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showNetworkError</span><span class="params">()</span> </span>&#123;</div><div class="line">        Snackbar.make(fab,R.string.no_network_connected,Snackbar.LENGTH_INDEFINITE)</div><div class="line">                .setAction(R.string.go_to_set, <span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">                        presenter.goToSettings();</div><div class="line">                    &#125;</div><div class="line">                &#125;).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åˆ›å»ºPresenterã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZhihuDailyPresenter</span> <span class="keyword">implements</span> <span class="title">ZhihuDailyContract</span>.<span class="title">Presenter</span>, <span class="title">OnStringListener</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ZhihuDailyContract.View view;</div><div class="line">    <span class="keyword">private</span> Context context;</div><div class="line">    <span class="keyword">private</span> StringModelImpl model;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ArrayList&lt;ZhihuDailyNews.Question&gt; list = <span class="keyword">new</span> ArrayList&lt;ZhihuDailyNews.Question&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZhihuDailyPresenter</span><span class="params">(Context context, ZhihuDailyContract.View view)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.context = context;</div><div class="line">        <span class="keyword">this</span>.view = view;</div><div class="line">        <span class="keyword">this</span>.view.setPresenter(<span class="keyword">this</span>);</div><div class="line">        model = <span class="keyword">new</span> StringModelImpl(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadPosts</span><span class="params">(<span class="keyword">long</span> date, <span class="keyword">boolean</span> clearing)</span> </span>&#123;</div><div class="line">        view.showLoading();</div><div class="line">        <span class="keyword">if</span> (clearing) &#123;</div><div class="line">            list.clear();</div><div class="line">        &#125;</div><div class="line">        model.load(Api.ZHIHU_HISTORY + formatter.ZhihuDailyDateFormat(date), <span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> </span>&#123;</div><div class="line">        list.clear();</div><div class="line">        loadPosts(Calendar.getInstance().getTimeInMillis(), <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadMore</span><span class="params">(<span class="keyword">long</span> date)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (NetworkState.networkConnected(context)) &#123;</div><div class="line">            model.load(Api.ZHIHU_HISTORY + formatter.ZhihuDailyDateFormat(date), <span class="keyword">this</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            view.showNetworkError();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startReading</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        context.startActivity(<span class="keyword">new</span> Intent(context, ZhihuDetailActivity.class)</div><div class="line">                .putExtra(<span class="string">"id"</span>,list.get(position).getId())</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">goToSettings</span><span class="params">()</span> </span>&#123;</div><div class="line">        context.startActivity(<span class="keyword">new</span> Intent(Settings.ACTION_SETTINGS));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String result)</span> </span>&#123;</div><div class="line">        Gson gson = <span class="keyword">new</span> Gson();</div><div class="line">        ZhihuDailyNews post = gson.fromJson(result, ZhihuDailyNews.class);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (ZhihuDailyNews.Question item : post.getStories()) &#123;</div><div class="line">            list.add(item);</div><div class="line">        &#125;</div><div class="line">        view.showResults(list);</div><div class="line">        view.stopLoading();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(VolleyError error)</span> </span>&#123;</div><div class="line">        view.stopLoading();</div><div class="line">        view.showError();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Presenterè·å–åˆ°äº†Viewï¼Œå¹¶é€šè¿‡è°ƒç”¨setPresenter()æ–¹æ³•å°†è‡ªèº«ä¼ å…¥ï¼Œå¦‚æœéœ€è¦å¯¹æ”¹å˜ç•Œé¢æ˜¾ç¤ºï¼Œç›´æ¥è°ƒç”¨Viewå±‚çš„æ–¹æ³•å³å¯ã€‚è¿™æ ·Presenterå°±äºViewå±‚å®ç°äº†åˆ†ç¦»ã€‚</p>
<p>æœ€åæ˜¯Modelå±‚çš„å®ç°ã€‚ç”±äºä½¿ç”¨äº†Gsonï¼Œæ•°æ®çš„è¿”å›ç±»å‹åªéœ€è¦ä¸ºStringç±»å‹å³å¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnStringListener</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è¯·æ±‚æˆåŠŸæ—¶å›è°ƒ</div><div class="line">     * <span class="doctag">@param</span> result</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String result)</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è¯·æ±‚å¤±è´¥æ—¶å›è°ƒ</div><div class="line">     * <span class="doctag">@param</span> error</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(VolleyError error)</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºè¯·æ±‚æˆåŠŸæ—¶å’Œè¯·æ±‚å¤±è´¥æ—¶çš„å›è°ƒã€‚</p>
<p>ç„¶åéœ€è¦ä¸€ä¸ªStringModelçš„å®ç°ç±»â€“StringModelImplã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringModelImpl</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Context context;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringModelImpl</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.context = context;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(String url, <span class="keyword">final</span> OnStringListener listener)</span> </span>&#123;</div><div class="line">        StringRequest request = <span class="keyword">new</span> StringRequest(url, <span class="keyword">new</span> Response.Listener&lt;String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">                listener.onSuccess(s);</div><div class="line">            &#125;</div><div class="line">        &#125;, <span class="keyword">new</span> Response.ErrorListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onErrorResponse</span><span class="params">(VolleyError volleyError)</span> </span>&#123;</div><div class="line">                listener.onError(volleyError);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        VolleySingleton.getVolleySingleton(context).addToRequestQueue(request);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼ŒModel, View, Presenterå‡å·²å®ç°ï¼Œå®ç°äº†å„ä¸ªå±‚æ¬¡çš„åˆ†ç¦»ã€‚</p>
<p>é‡‡ç”¨MVPæ¶æ„è¿›è¡Œé‡æ„ï¼Œä»£ç é‡ä¸Šç›¸å¯¹äºåŸé¡¹ç›®æ—¶æœ‰æ‰€å¢åŠ çš„ï¼Œä½†è¿™ç§æ•°é‡çš„å¢åŠ ç›¸å¯¹äºMVPæ¶æ„å¸¦æ¥çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚å½“ç„¶è¿™æ˜¯å¯¹äºä»£ç é‡æ¯”è¾ƒå¤§çš„é¡¹ç›®è€Œè¨€ï¼Œå¹³æ—¶ç”¨äºç»ƒæ‰‹çš„å°é¡¹ç›®å°±æ²¡æœ‰å¿…è¦å¼ºé¡¹ç›®æ‰€éš¾ï¼Œå‹‰å¼ºçš„å®ç°MVPäº†ï¼Œè¿™æ ·åªä¼šå¢åŠ ä»£ç é‡è€Œå·²ã€‚</p>
<h3 id="æœ¬é¡¹ç›®åœ°å€"><a href="#æœ¬é¡¹ç›®åœ°å€" class="headerlink" title="æœ¬é¡¹ç›®åœ°å€"></a>æœ¬é¡¹ç›®åœ°å€</h3><blockquote>
<p><a href="https://github.com/marktony/ZhihuDaily" target="_blank" rel="external">çº¸é£æœº-é‡‡ç”¨MVPæ¶æ„ï¼Œä¸€æ¬¾é›†åˆäº†çŸ¥ä¹æ—¥æŠ¥ã€æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„ç»¼åˆæ€§é˜…è¯»å®¢æˆ·ç«¯</a></p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Javaä¸­çš„å•ä¾‹æ¨¡å¼]]></title>
      <url>http://marktony.github.io/2016/07/19/Java%E4%B8%AD%E7%9A%84%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ</h3><a id="more"></a>
<p>å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºæ¨¡å¼ï¼Œç”¨äºäº§ç”Ÿå¯¹è±¡çš„ä¸€ä¸ªå…·ä½“å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥ç¡®ä¿ç³»ç»Ÿä¸­ä¸€ä¸ªç±»åªèƒ½äº§ç”Ÿå”¯ä¸€çš„ä¸€ä¸ªå®ä¾‹ã€‚</p>
<p>è¿™æ ·çš„æ–¹å¼èƒ½å¤Ÿå¸¦æ¥ä¸¤å¤§å¥½å¤„ï¼š</p>
<ol>
<li>å¯¹äºé¢‘ç¹ä½¿ç”¨çš„å¯¹è±¡ï¼Œå¯ä»¥çœç•¥åˆ›å»ºå¯¹è±¡æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå¯¹äºå¤åˆ¶çš„å¯¹è±¡ï¼Œè¿™æ ·çš„åˆ›å»ºæ–¹å¼çš„å¼€é”€æ˜¯ååˆ†å€¼å¾—çš„ã€‚</li>
<li>newçš„æ¬¡æ•°å°‘äº†ï¼Œå¯¹å†…å­˜çš„ä½¿ç”¨é¢‘ç‡ä¹Ÿå°±ä¸‹é™äº†ï¼Œå½“ç„¶ä¹Ÿå°±å‡è½»äº†GCçš„å‹åŠ›ã€‚</li>
</ol>
<h3 id="è®¾è®¡æ€æƒ³"><a href="#è®¾è®¡æ€æƒ³" class="headerlink" title="è®¾è®¡æ€æƒ³"></a>è®¾è®¡æ€æƒ³</h3><p>è¿™ç§æ¨¡å¼è¦è§£å†³çš„é—®é¢˜å°±æ˜¯è¦ä¿è¯åº”ç”¨ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ã€‚é‚£æ€æ ·å®ç°å‘¢ï¼Ÿ</p>
<ol>
<li>ä¸å…è®¸å…¶ä»–ç¨‹åºnewå¯¹è±¡</li>
<li>åœ¨è¯¥ç±»ä¸­åˆ›å»ºå¯¹è±¡</li>
<li>å¯¹å¤–éœ€è¦æš´éœ²ä¸€ä¸ªæ–¹æ³•ï¼Œè®©å…¶ä»–è·å–è¿™ä¸ªå¯¹è±¡</li>
</ol>
<p>ä½“ç°åˆ°ä»£ç ä¸­ï¼Œè§£å†³åŠæ³•ä¸ºï¼š</p>
<ol>
<li>ç§æœ‰åŒ–æ„é€ å‡½æ•°</li>
<li>åœ¨æœ¬ç±»ä¸­åˆ›å»ºä¸€ä¸ªæœ¬ç±»å¯¹è±¡</li>
<li>å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œèƒ½å¤Ÿè®©å…¶ä»–çš„ç±»è·å–è¿™ä¸ªå¯¹è±¡</li>
</ol>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><p>1.æœ€ç®€å•çš„å†™æ³•ä¸º</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹å¼ç§°ä¸ºé¥¿æ±‰å¼ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ç®€å•æ˜äº†</li>
<li>åœ¨ç±»åŠ è½½æ—¶å³å®Œæˆäº†å®ä¾‹åŒ–ï¼Œé¿å…äº†çº¿ç¨‹åŒæ­¥çš„é—®é¢˜</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>æ²¡æœ‰ä½¿ç”¨æ‡’åŠ è½½</li>
<li>å¯èƒ½é€ æˆå†…å­˜æµªè´¹</li>
</ul>
</li>
</ul>
<p>2.å˜ç§æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        instance = <span class="keyword">new</span> Singleton();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç›¸æ¯”äºç¬¬ä¸€ç§å†™æ³•ï¼Œæœ¬ç±»ä¸­å°†å®ä¾‹åŒ–å¯¹è±¡çš„ä»£ç æ”¾åˆ°äº†staticä»£ç å—ä¸­ã€‚ä¸¤ç§æ–¹æ³•çš„æ•ˆæœå…¶å®æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥ä¼˜ç¼ºç‚¹ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>3.æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;    </div><div class="line">	<span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;        </div><div class="line">	    instance = <span class="keyword">new</span> Singleton();    </div><div class="line">	&#125;</div><div class="line">    	<span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ä½¿ç”¨äº†æ‡’åŠ è½½</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>å½“æœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œè°ƒç”¨ getInstance() çš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºå¤šä¸ªå®    ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨å¤šçº¿ç¨‹ä¸‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚</li>
</ul>
</li>
</ul>
<p>4.æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span> <span class="params">()</span></span>&#123;&#125;    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;    </div><div class="line">      <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</div><div class="line">  	     instance = <span class="keyword">new</span> Singleton();    </div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>çº¿ç¨‹å®‰å…¨ï¼Œè§£å†³äº†å¤šå®ä¾‹é—®é¢˜</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>ä¸é«˜æ•ˆã€‚å› ä¸ºåœ¨ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ getInstance() æ–¹    æ³•ã€‚ä½†æ˜¯åŒæ­¥æ“ä½œåªéœ€è¦åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰è¢«éœ€è¦ï¼Œå³ç¬¬ä¸€æ¬¡åˆ›å»ºå•ä¾‹å®ä¾‹å¯¹è±¡æ—¶ã€‚</li>
</ul>
</li>
</ul>
<p>5.åŒé‡æ ¡éªŒé”<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</div><div class="line">            <span class="keyword">synchronized</span> (Singleton.class)&#123;</div><div class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</div><div class="line">                    instance = <span class="keyword">new</span> Singleton();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿›è¡Œä¸¤æ¬¡if(instance == null)(Double-Check)çš„æ£€æŸ¥å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>å¹¶å‘åº¦é«˜ï¼Œæå‡äº†æ€§èƒ½ã€‚</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>å¹¶ä¸æ˜¯ç»å¯¹å®‰å…¨</li>
</ul>
</li>
</ul>
<p>6.å†…éƒ¨ç±»<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;  </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;;  </div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span></span>&#123;  </div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance=<span class="keyword">new</span> Singleton();  </div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> SingletonHolder.instance;  </div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯Googleå…¬å¸çš„å·¥ç¨‹å¸ˆBob Leeå†™çš„æ–°çš„æ‡’æ±‰å•ä¾‹æ¨¡å¼ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ä½¿ç”¨JVMæœ¬èº«æœºåˆ¶ä¿è¯äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</li>
<li>ç”±äº SingletonHolder æ˜¯ç§æœ‰çš„ï¼Œé™¤äº† getInstance() ä¹‹å¤–æ²¡æœ‰åŠæ³•è®¿é—®å®ƒï¼Œå› æ­¤å®ƒæ˜¯æ‡’æ±‰å¼çš„ã€‚</li>
<li>åŒæ—¶è¯»å–å®ä¾‹çš„æ—¶å€™ä¸ä¼šè¿›è¡ŒåŒæ­¥ï¼Œæ²¡æœ‰æ€§èƒ½ç¼ºé™·ã€‚</li>
<li>ä¸ä¾èµ–jdkç‰ˆæœ¬ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ã€ŠEffective Javaã€‹æ¨èçš„å†™æ³•ã€‚</p>
<p>7.æšä¸¾<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> EasySingleton&#123;</div><div class="line">    INSTANCE;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ç®€å•æ˜äº†</li>
<li>è°ƒç”¨ç®€å•ï¼Œä½¿ç”¨EasySingleton.INSTANCEè®¿é—®å®ä¾‹ï¼Œæ¯”getInstance()ç®€å•</li>
<li>åˆ›å»ºæšä¸¾æœ¬èº«å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸ç”¨æ‹…å¿ƒå­˜åœ¨å¤šä¸ªå®ä¾‹çš„é—®é¢˜</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>æšä¸¾ç±»å‹enumåœ¨jdk1.5æ—¶æ‰å¼•å…¥ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•å¹¶ä¸é€‚ç”¨äºjdk1.5ä¹‹å‰çš„ç‰ˆæœ¬</li>
</ul>
</li>
</ul>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘æµ‹è¯•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonPatternTest</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line"></div><div class="line">        CountDownLatch latch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> threadCount = <span class="number">1000</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; threadCount; i++)&#123;</div><div class="line">            <span class="keyword">new</span> Thread()&#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    <span class="keyword">try</span> &#123;</div><div class="line">                        <span class="comment">// all thread to wait</span></div><div class="line">                        latch.await();</div><div class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                        e.printStackTrace();</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="comment">// test get instance</span></div><div class="line">                    System.out.println(Singleton.getInstance().hashCode());</div><div class="line">                &#125;</div><div class="line">            &#125;.start();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// release lock, let all thread excute Singleton.getInstance() at the same time</span></div><div class="line">        latch.countDown();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­CountDownLatch latchä¸ºé—­é”ï¼Œæ‰€æœ‰çº¿ç¨‹ä¸­éƒ½ç”¨latch.await();ç­‰å¾…é”é‡Šæ”¾ï¼Œå¾…æ‰€æœ‰çº¿ç¨‹åˆå§‹åŒ–å®Œæˆä½¿ç”¨latch.countDown();é‡Šæ”¾é”ï¼Œä»è€Œè¾¾åˆ°çº¿ç¨‹å¹¶å‘æ‰§è¡ŒSingleton.getInstance()çš„æ•ˆæœã€‚</p>
<p>ç»“æœä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">2016228077</div><div class="line">2016228077</div><div class="line">2016228077</div><div class="line">2016228077</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>Reference:</p>
<p><a href="http://blog.csdn.net/dmk877/article/details/50311791" target="_blank" rel="external">http://blog.csdn.net/dmk877/article/details/50311791</a></p>
<p><a href="http://www.trinea.cn/java/singleton/" target="_blank" rel="external">http://www.trinea.cn/java/singleton/</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Get start with Kotlin on Android]]></title>
      <url>http://marktony.github.io/2016/07/10/Get-start-with-Kotlin-on-Android/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»æ€æ ·å…¥é—¨ç”¨Kotlinå¼€å‘Androidé¡¹ç›®ã€‚ç¤ºä¾‹é¡¹ç›®åœ°å€ä¸ºï¼š<a href="https://github.com/marktony/FanfouHandpick" target="_blank" rel="external">GitHub:é¥­å¦ç²¾é€‰</a></p>
<h3 id="ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ</h3><p>Kotlinæ˜¯ç”±<a href="https://www.jetbrains.com/" target="_blank" rel="external">JetBrains</a>å¼€å‘ï¼ŒåŸºäºJVMçš„ä¸€é—¨æ–°çš„ç¼–ç¨‹è¯­è¨€ã€‚å¼€å‘è¿‡Androidçš„ç«¥é‹åº”è¯¥éƒ½çŸ¥é“Android Studioï¼Œå®ƒå°±æ˜¯åŸºäºIntellij IDEAå¼€å‘çš„ï¼Œè€ŒIntellij IDEAæ­£æ˜¯ç”±JetBrainså‡ºå“ã€‚</p>
<p>å¯¹äºAndroidå¼€å‘è€…è€Œè¨€ï¼ŒKotlinæœ‰ä¸¤ä¸ªæœ‰è¶£çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å¯¹äºJavaç†Ÿæ‚‰çš„å¼€å‘è€…ï¼Œä¸Šæ‰‹Kotlinä¼šå¾ˆå¿«ï¼Œå› ä¸ºKotlinéå¸¸ç›´è§‰åŒ–ã€‚</li>
<li>å¼ºå¤§çš„IDEæ”¯æŒã€‚</li>
</ul>
<p>ç›¸æ¯”äºJava7,Kotlinçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li>æ˜“äºè¡¨ç°ã€‚èƒ½å®å®åœ¨åœ¨çš„å°‘å†™å¾ˆå¤šä»£ç ã€‚</li>
<li>ç±»å‹å®‰å…¨ã€‚æˆ‘ä»¬åœ¨Javaä¸­ç»å¸¸è¦é˜²æ­¢äº§ç”Ÿ<strong>NullPointerException</strong>ï¼Œè€Œä½¿ç”¨Kotlinæ˜¯ç©ºå®‰å…¨çš„ã€‚æˆ‘ä»¬å¯ä»¥èŠ‚çº¦å¾ˆå¤šè°ƒè¯•ç©ºå¼‚å¸¸çš„æ—¶é—´ã€‚</li>
<li>å‡½æ•°å¼ã€‚Kotlinæ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä½†æ˜¯å¥¹ä½¿ç”¨å¾ˆå¤šå‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µã€‚ä¾‹å¦‚lambdaè¡¨è¾¾å¼ã€‚</li>
<li>æ‰©å±•å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±•ç±»æ›´å¤šçš„ç‰¹æ€§ã€‚</li>
<li>ä¸Javaçš„å®Œç¾äº’æ“ä½œã€‚æˆ‘ä»¬ç”šè‡³åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨Kotlinå’ŒJavaä¸¤ç§è¯­è¨€æ··åˆç¼–ç¨‹ã€‚</li>
</ul>
<h3 id="åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin"><a href="#åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin" class="headerlink" title="åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin"></a>åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin</h3><p>é¦–å…ˆå½“ç„¶æ˜¯è¦é…ç½®å¼€å‘ç¯å¢ƒäº†ã€‚ä»Intellij 15å¼€å§‹ï¼ŒKotlinæ’ä»¶æ˜¯é»˜è®¤å®‰è£…çš„ã€‚ä½†æ˜¯Android Studioä¸­å¯èƒ½å°±è¦æˆ‘ä»¬æ‰‹åŠ¨é…ç½®äº†ã€‚</p>
<p>æ‰“å¼€ <strong>Android Studio</strong> è¿›å…¥ <strong>Preferences</strong> çš„ <strong>plugin</strong> æ ï¼Œé€‰æ‹© <strong>Install JetBrains Plugin</strong>,åœ¨æœç´¢æ¡†ä¸­è¾“å…¥ <strong>Kotlin</strong>,ç„¶åå°±èƒ½çœ‹åˆ°Kotlinæ’ä»¶äº†ï¼Œç‚¹å‡»å®‰è£…å³å¯ã€‚</p>
<p>ç¯å¢ƒé…ç½®å¥½åï¼Œå°±å¯ä»¥åŠ¨æ‰‹å†™é¡¹ç›®äº†ã€‚æŒ‰ç…§å¹³æ—¶æˆ‘ä»¬æ–°å»ºAndroidé¡¹ç›®çš„æ­¥éª¤ï¼Œæ–°å»ºä¸€ä¸ªé¡¹ç›®ã€‚ç„¶åç‚¹å‡»Android Studioçš„èœå• <strong>Code</strong> çš„ <strong>Convert Java File to Kotlin File</strong>,javaæ–‡ä»¶å°±è‡ªåŠ¨çš„è½¬æ¢ä¸ºäº†Kotlinæ–‡ä»¶ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ã€‚</p>
<h3 id="å°è±¡"><a href="#å°è±¡" class="headerlink" title="å°è±¡"></a>å°è±¡</h3><p>æˆ‘å¹¶æ²¡æœ‰ç”¨Kotlinè¿›è¡ŒAndroidå¼€å‘çš„ç»éªŒï¼Œè¿™æ¬¡çš„é¡¹ç›®ä¹Ÿä¸»è¦æ˜¯ä½œä¸ºç»ƒæ‰‹ä½¿ç”¨ã€‚ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯çœäº‹å„¿ï¼Œèƒ½å‡å°‘å¾ˆå¤šä¸å¿…è¦çš„ä»£ç ã€‚å¯ä»¥ä¸ç”¨å†™å¾ˆå¤šçš„findViewByIdäº†ã€‚è®¾ç½®ç›‘å¬å™¨ä¹Ÿæ–¹ä¾¿äº†å¾ˆå¤šäº†ã€‚<br>Talk is cheap, show you the code.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</div><div class="line"></div><div class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</div><div class="line">        setContentView(R.layout.activity_main)</div><div class="line"></div><div class="line">        textView.text = <span class="string">"Hello Kotlin"</span></div><div class="line"></div><div class="line">        textView.setOnClickListener &#123;</div><div class="line">          Snackbar.make(fab,<span class="string">"Hello Snackbar"</span>,Snackbar.LENGTH_SHORT)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šæ‰‹å°è±¡ä¸é”™ï¼Œä»¥åæœ‰æœºä¼šä¼šå°è¯•ä½¿ç”¨Kotlinï¼</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Fragmentç”Ÿå‘½å‘¨æœŸæ¢ç´¢]]></title>
      <url>http://marktony.github.io/2016/06/13/Fragment%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%8E%A2%E7%B4%A2/</url>
      <content type="html"><![CDATA[<p>Fragmentå’ŒActivityç±»ä¼¼ï¼Œä¹Ÿæœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”fragmentçš„ç”Ÿå‘½å‘¨æœŸå’Œactivityçš„ç”Ÿå‘½å‘¨æœŸç‰¹åˆ«ç›¸ä¼¼ã€‚<br><a id="more"></a></p>
<p>Activityçš„ç”Ÿå‘½å‘¨æœŸç”±å››ç§çŠ¶æ€ï¼Œè¿è¡Œã€æš‚åœã€åœæ­¢ã€å’Œé”€æ¯ï¼Œç±»ä¼¼çš„ï¼ŒFragmentä¹Ÿæœ‰è¿™å››ç§çŠ¶æ€ï¼Œåªæ˜¯åœ¨ä¸€äº›ç»†å°çš„åœ°æ–¹æœ‰æ‰€ä¸åŒã€‚</p>
<p>Fragmentç”Ÿå‘½å‘¨æœŸå›¾(æ¥è‡ªAndroidå®˜ç½‘)</p>
<img src="/2016/06/13/Fragmentç”Ÿå‘½å‘¨æœŸæ¢ç´¢/fragment_lifecycle.png" alt="fragment_lifecycle" title="fragment_lifecycle">
<p>ä¸‹é¢ç›´æ¥é€šè¿‡å·¥ç¨‹æ¥è®¤è¯†Fragmentçš„ç”Ÿå‘½å‘¨æœŸ</p>
<p>é¦–å…ˆæ–°å»ºFragmentDemoå·¥ç¨‹ã€‚</p>
<p>MainActivity.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.marktony.fragmentdemo;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.support.v4.app.FragmentManager;</div><div class="line"><span class="keyword">import</span> android.support.v4.app.FragmentTransaction;</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.View;</div><div class="line"><span class="keyword">import</span> android.widget.Button;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Button btnAddFragment;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> FragmentManager fragmentManager;</div><div class="line">    <span class="keyword">private</span> FragmentTransaction fragmentTransaction;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"MainActivity"</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        initViews();</div><div class="line"></div><div class="line">        initData();</div><div class="line"></div><div class="line">        btnAddFragment.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">                MyFragment fragment = <span class="keyword">new</span> MyFragment();</div><div class="line">                fragmentTransaction.replace(R.id.container,fragment);</div><div class="line">                fragmentTransaction.commit();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onCreate"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">        fragmentManager = getSupportFragmentManager();</div><div class="line">        fragmentTransaction = fragmentManager.beginTransaction();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initViews</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">        btnAddFragment = (Button) findViewById(R.id.btn_add_fragment);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»£ç å¾ˆç®€å•ï¼ŒåŠ è½½ç›¸åº”çš„å¸ƒå±€ï¼Œé€šè¿‡ç›‘å¬buttonçš„ç‚¹å‡»äº‹ä»¶ï¼ŒåŠ è½½fragmentã€‚</p>
<p>activity_main.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/container"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:paddingBottom</span>=<span class="string">"@dimen/activity_vertical_margin"</span></div><div class="line">    <span class="attr">android:paddingLeft</span>=<span class="string">"@dimen/activity_horizontal_margin"</span></div><div class="line">    <span class="attr">android:paddingRight</span>=<span class="string">"@dimen/activity_horizontal_margin"</span></div><div class="line">    <span class="attr">android:paddingTop</span>=<span class="string">"@dimen/activity_vertical_margin"</span></div><div class="line">    <span class="attr">tools:context</span>=<span class="string">"com.marktony.fragmentdemo.MainActivity"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_add_fragment"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"add_fragment"</span>/&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>MyFragment.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.marktony.fragmentdemo;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.support.annotation.Nullable;</div><div class="line"><span class="keyword">import</span> android.support.v4.app.Fragment;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.LayoutInflater;</div><div class="line"><span class="keyword">import</span> android.view.View;</div><div class="line"><span class="keyword">import</span> android.view.ViewGroup;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by lizhaotailang on 2016/6/13.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"MY_FRAGMENT"</span>;</div><div class="line"></div><div class="line">    <span class="comment">// empty constructor</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFragment</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttach</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onAttach(context);</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onAttach"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onCreate"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Nullable</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onCreateView"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_my,container,<span class="keyword">false</span>);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onActivityCreated"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onStart();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onStart"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onResume();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onResume"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onPause();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onPause"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onStop();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onStop"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroyView</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDestroyView();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onDestroyView"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDestroy();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onDestroy"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDetach</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDetach();</div><div class="line"></div><div class="line">        Log.d(TAG,<span class="string">"onDetach"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>MyFragmentä¸­å¤å†™äº†ä¸€äº›æ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰“å°æ—¥å¿—ã€‚</p>
<p>okï¼Œå¤§åŠŸå‘Šæˆï¼Œç°åœ¨å°±è·‘åˆ°æ‰‹æœºä¸Šã€‚</p>
<p>è§‚å¯Ÿæ‰“å°æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">com.marktony.fragmentdemo D/MainActivity: onCreate</div></pre></td></tr></table></figure></p>
<p>æŒ‰ä¸‹æŒ‰é’®æ—¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onAttach</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onCreate</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onCreateView</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onActivityCreated</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onStart</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onResume</div></pre></td></tr></table></figure></p>
<p>æ­¤æ—¶æŒ‰ä¸‹homeé”®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onPause</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onStop</div></pre></td></tr></table></figure></p>
<p>é‡æ–°å›åˆ°åº”ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onStart</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onResume</div></pre></td></tr></table></figure></p>
<p>æŒ‰ä¸‹backé”®ï¼Œæ­¤æ—¶fragmentå’Œactivityå‡è¢«é”€æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onPause</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onStop</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onDestroyView</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onDestroy</div><div class="line">com.marktony.fragmentdemo D/MY_FRAGMENT: onDetach</div></pre></td></tr></table></figure></p>
<p>è§‚å¯Ÿæ—¥å¿—ï¼Œä¸éš¾å‘ç°ã€‚</p>
<p>å½“fragmentè¢«åˆ›å»ºæ—¶ï¼Œä¼šä¾æ¬¡ç»å†ä»¥ä¸‹çŠ¶æ€ï¼š</p>
<ul>
<li>onAttach()</li>
<li>onCreate()</li>
<li>onCreateView()</li>
<li>onActivityCreated()</li>
</ul>
<p>å½“fragmentå¤„äºå¯è§çŠ¶æ€æ—¶ï¼Œä¼šç»å†</p>
<ul>
<li>onStart()</li>
<li>onResume()</li>
</ul>
<p>ä¸å¯è§æ—¶ï¼Œç»å†äº†</p>
<ul>
<li>onPause()</li>
<li>onStop()</li>
</ul>
<p>å½“fragmentè¢«é”€æ¯æ—¶ï¼ˆæˆ–ç›¸åº”çš„activityè¢«é”€æ¯æ—¶ï¼‰</p>
<ul>
<li>onPause()</li>
<li>onStop()</li>
<li>onDestroyView()</li>
<li>onDestroy()</li>
<li>onDetach()</li>
</ul>
<p>ç”±æ­¤å¯è§ï¼Œfragmentçš„ç”Ÿå‘½å‘¨æœŸå’Œactivityçš„ç”Ÿå‘½å‘¨æœŸçœŸçš„éå¸¸çš„ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›æ–°çš„çŠ¶æ€ã€‚</p>
<p>åœ¨fragmentä¸­ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡onSaveInstanceState()æ–¹æ³•ä¿å­˜æ•°æ®çš„ï¼Œå› ä¸ºè¿›å…¥åœæ­¢çŠ¶æ€çš„fragmentå¯èƒ½ç”±äºç³»ç»Ÿå†…å­˜ä¸è¶³è€Œè¢«å›æ”¶ï¼Œä¿å­˜ä¸‹æ¥æ•°æ®å¯ä»¥åœ¨onCreate(),onCreateView(),onActivityCreate()ä¸‰ä¸ªæ–¹æ³•ä¸­é‡æ–°å¾—åˆ°ï¼Œä»–ä»¬éƒ½å«æœ‰ä¸€ä¸ªBundleç±»å‹çš„saveInstanceStateå‚æ•°ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[GitHub Pagesç°åœ¨æ”¯æŒHttpsäº†]]></title>
      <url>http://marktony.github.io/2016/06/10/GitHub-Pages%E7%8E%B0%E5%9C%A8%E6%94%AF%E6%8C%81Https%E4%BA%86/</url>
      <content type="html"><![CDATA[<p>HTTPS for GitHub Pages<br><a id="more"></a></p>
<p>æ•°ä»¥ç™¾ä¸‡è®¡çš„äººç”¨<a href="https://pages.github.com/" target="_blank" rel="external">GitHub Pages</a>æ¥æ”¯æŒä»–ä»¬çš„ç½‘ç«™ï¼Œè¿™äº›ç½‘ç«™æ¯å¤©ä¹Ÿä¼šæœ‰æ•°ä»¥ç™¾ä¸‡è®¡çš„è®¿é—®é‡ï¼Œä¸ºäº†æ›´å¥½çš„æ”¯æŒè¿™äº›GitHub Pagesç«™ç‚¹ï¼Œä¹Ÿä¸ºäº†åœ¨äº’è”ç½‘ä¸­å¢åŠ HTTPSçš„ä½¿ç”¨èŒƒå›´ï¼ŒGitHub Pagesç°åœ¨å®˜æ–¹æ”¯æŒæ‰€æœ‰   <code>&lt;username&gt;.github.io</code> ç«™ç‚¹äº†ã€‚HTTPSæä¾›çš„åŠ å¯†å±‚ï¼Œå¯ä»¥é˜²æ­¢ä»–äººçª¥æ¢æˆ–ç¯¡æ”¹æŒ‡å‘æ‚¨çš„Pagesç«™ç‚¹ã€‚</p>
<p>ä½ ç°åœ¨å°±å¯ä»¥è®¿é—® <code>*.github.io</code>ç«™ç‚¹ï¼Œå¼ºåˆ¶ä½ çš„ç«™ç‚¹ä½¿ç”¨HTTPSã€‚å¦‚æœä½ ä½¿ç”¨äº†HTTPSï¼Œä»»ä½•HTTPè¯·æ±‚éƒ½ä¼šè¢«ç›´æ¥é‡å®šå‘ä¸ºHTTPSè¯·æ±‚ã€‚</p>
<img src="/2016/06/10/GitHub-Pagesç°åœ¨æ”¯æŒHttpsäº†/github_pages_now_support_https.png" alt="github_pages_now_support_https" title="github_pages_now_support_https">
<p>ä»2016å¹´6æœˆ9æ—¥å¼€å§‹ï¼Œæ‰€æœ‰çš„æ–°å»ºGitHub Pagesç«™ç‚¹éƒ½ä¼šè¢«å¼ºåˆ¶ä½¿ç”¨HTTPSã€‚åŒæ—¶ä¸ºäº†ä½¿å·²ç»å­˜åœ¨çš„ç«™ç‚¹èƒ½å¤Ÿå¼ºåˆ¶ä½¿ç”¨HTTPSï¼Œä½ å¯ä»¥è®¿é—®ä½ çš„ç«™ç‚¹çš„ä»“åº“ï¼Œç‚¹å‡»<a href="https://help.github.com/articles/securing-your-github-pages-site-with-https/" target="_blank" rel="external">Pages HTTPS documentation</a>æ¥è·å–æ›´å¤šçš„ä¿¡æ¯ã€‚</p>
<p>å¼€å¯GitHub Pages HTTPSçš„æ–¹æ³•ï¼š</p>
<p>å¦‚ä¸Šé¢æ‰€è¯´ï¼Œå¯¹äºåœ¨2016å¹´6æœˆ9æ—¥ä¹‹åå¼€é€šçš„ï¼Œä»¥ <code>&lt;username&gt;.github.io</code> ä¸ºåŸŸåçš„ç«™ç‚¹ï¼Œå°†è‡ªåŠ¨å¼€å¯HTTPSã€‚</p>
<p>å¯¹äºåœ¨9æ—¥ä¹‹å‰å¼€é€šçš„ç«™ç‚¹ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•å¼€å¯ï¼š</p>
<p>step 1. åœ¨GitHubä¸»ç«™ï¼Œè¿›å…¥åˆ°pagesçš„åº“(repository)<br>step 2. åœ¨ä½ çš„ä»“åº“åç§°ä¸‹ï¼Œç‚¹å‡»Settings</p>
<img src="/2016/06/10/GitHub-Pagesç°åœ¨æ”¯æŒHttpsäº†/repo-actions-settings.png" alt="repo-actions-settings" title="repo-actions-settings">
<p>step 3. åœ¨â€œGitHub Pagesâ€ä¸‹ï¼Œé€‰æ‹©Enforce HTTPS</p>
<img src="/2016/06/10/GitHub-Pagesç°åœ¨æ”¯æŒHttpsäº†/enforce-https-checkbox.png" alt="enforce-https-checkbox" title="enforce-https-checkbox">
<p>å—¯ï¼Œå¬åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼Œæˆ‘ä¹Ÿæ˜¯åœ¨ç¬¬ä¸€æ—¶é—´æŠŠåšå®¢å‡çº§åˆ°äº†HTTPSï¼Œä¸ä¿¡ä½ çœ‹ï¼</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å®ç°RecyclerViewçš„itemçš„æ»‘åŠ¨åˆ é™¤]]></title>
      <url>http://marktony.github.io/2016/05/28/%E5%AE%9E%E7%8E%B0RecyclerView%E7%9A%84item%E7%9A%84%E6%BB%91%E5%8A%A8%E5%88%A0%E9%99%A4/</url>
      <content type="html"><![CDATA[<p>åˆ©ç”¨ItemTouchHelperå®ç°recycler view itemçš„ä¾§æ»‘åˆ é™¤<br><a id="more"></a></p>
<h3 id="å…³äºItemTouchHelper"><a href="#å…³äºItemTouchHelper" class="headerlink" title="å…³äºItemTouchHelper"></a>å…³äºItemTouchHelper</h3><p>å®˜æ–¹æ–‡æ¡£çš„è§£é‡Šï¼š</p>
<blockquote>
<p>This is a utility class to add swipe to dismiss and drag &amp; drop support to RecyclerView.</p>
</blockquote>
<p>ä»æ–‡æ¡£ä¸éš¾çœ‹å‡ºï¼ŒItemTouchHelperæ˜¯ä¸€ä¸ªç”¨äºåœ¨RecyclerViewä¸­å®ç°æ»‘åŠ¨åˆ é™¤å’Œæ‹–æ‹½çš„å·¥å…·ç±»ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ul>
<li>ä¿®æ”¹build.gradleæ–‡ä»¶ï¼Œæ·»åŠ ä¾èµ–ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile &apos;com.android.support:recyclerview-v7:23.4.0&apos;</div></pre></td></tr></table></figure>
<ul>
<li>æ„å»ºobjectä¸Adapter</li>
</ul>
<p>è¿™é‡Œå‡è®¾æˆ‘å·²ç»æ„å»ºå¥½äº†å®ä½“ç±»CodeLanguageå’Œadapterï¼Œåœ¨æ„å»ºadapteræ—¶ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">   mMovies.remove(position);</div><div class="line">   notifyItemRemoved(position);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºItemTouchHelper.SimpleCallbackå­ç±»</li>
</ul>
<p>ä¸ºäº†å¤„ç†æ‹–åŠ¨å’Œæ»‘åŠ¨äº‹ä»¶ï¼Œéœ€è¦åˆ›å»ºItemTouchHelper.SimpleCallbackçš„å®ç°ç±»ã€‚è¿™é‡Œï¼Œåªå¯¹æ»‘åŠ¨äº‹ä»¶æ„Ÿå…´è¶£ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„callback.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodeLanguageItemTouchHelper</span> <span class="title">extens</span> <span class="title">ItemTouchHelper</span>.<span class="title">SimpleCallback</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> CodeLanguageAdapter adapter;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CodeLanguageItemTouchHelper</span><span class="params">(CodeLanguageAdapter adapter)</span></span>&#123;</div><div class="line">      <span class="keyword">super</span>(ItemTouchHelper.UP | ItemTouchHelper.DOWN, ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT);</div><div class="line">      <span class="keyword">this</span>.adapter = adapter;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	* If you don't support drag &amp; drop, this method will never be called.</div><div class="line">    * å¦‚æœä¸æ”¯æŒæ‹–æ‹½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚</div><div class="line">	* <span class="doctag">@param</span> recyclerView The RecyclerView to which ItemTouchHelper is attached to. ItemTouchHelperéœ€è¦é™„åŠ åˆ°çš„RecyclerView</div><div class="line">	* <span class="doctag">@param</span> viewHolder The ViewHolder which is being dragged by the user. æ‹–åŠ¨çš„ViewHolder</div><div class="line">	* <span class="doctag">@param</span> target The ViewHolder over which the currently active item is being dragged. ç›®æ ‡ä½ç½®çš„ViewHolder</div><div class="line">	* <span class="doctag">@return</span> True if the viewHolder has been moved to the adapter position of target. viewHolderæ˜¯å¦è¢«ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®</div><div class="line">	*/</div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMove</span><span class="params">(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder, RecyclerView.ViewHolder target)</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">   &#125;</div><div class="line"></div><div class="line">	<span class="comment">/**</span></div><div class="line">	* Called when a ViewHolder is swiped by the user.</div><div class="line">	* If you don't support swiping, this method will never be called.</div><div class="line">	* å¦‚æœä¸æ”¯æŒæ»‘åŠ¨ï¼Œæ–¹æ³•ä¸ä¼šè¢«æ‰§è¡Œã€‚</div><div class="line">	* <span class="doctag">@param</span> viewHolder The ViewHolder which has been swiped by the user.</div><div class="line">	* <span class="doctag">@param</span> direction  The direction to which the ViewHolder is swiped.</div><div class="line">	*					It is one of UP, DOWN, LEFT or RIGHT.</div><div class="line">	*					If your getMovementFlags(RecyclerView, ViewHolder) method returned relative flags instead of LEFT / RIGHT;</div><div class="line">	*					`direction` will be relative as well. (START or END).</div><div class="line">	*/</div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSwiped</span><span class="params">(RecyclerView.ViewHolder viewHolder, <span class="keyword">int</span> direction)</span> </span>&#123;</div><div class="line">      <span class="comment">//Remove item</span></div><div class="line">      adapter.remove(viewHolder.getAdapterPosition());</div><div class="line">   &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>CodeLanguageItemTouchHelperé»˜è®¤çš„æ„é€ æ–¹æ³•éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* Creates a Callback for the given drag and swipe allowance.</div><div class="line">* <span class="doctag">@param</span> dragDirs è¡¨ç¤ºæ‹–æ‹½çš„æ–¹å‘ï¼Œæœ‰å…­ä¸ªç±»å‹çš„å€¼ï¼šLEFTã€RIGHTã€STARTã€ENDã€UPã€DOWN</div><div class="line">* <span class="doctag">@param</span> swipeDirs è¡¨ç¤ºæ»‘åŠ¨çš„æ–¹å‘ï¼Œæœ‰å…­ä¸ªç±»å‹çš„å€¼ï¼šLEFTã€RIGHTã€STARTã€ENDã€UPã€DOWN</div><div class="line">*/</div><div class="line">ItemTouchHelper.SimpleCallback(<span class="keyword">int</span> dragDirs, <span class="keyword">int</span> swipeDirs)</div></pre></td></tr></table></figure>
<p>CodeLanguageItemTouchHelperé»˜è®¤éœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•onMove(),onSwiped()ï¼ŒonMove()æ˜¯å¯¹æ‹–æ‹½çš„å®ç°ï¼ŒonSwiped()æ˜¯å¯¹æ»‘åŠ¨çš„å®ç°ã€‚</p>
<ul>
<li>å°†ItemTouchHelperæ·»åŠ è‡³RecyclerView</li>
</ul>
<p>åˆ›å»ºå¥½è‡ªå·±çš„ItemTouchHelperç±»åï¼Œå°†å®ƒé™„åŠ åˆ°RecyclerViewå°±å¾ˆç®€å•äº†ã€‚åœ¨Activityæˆ–è€…Fragmentçš„onCreate()æ–¹æ³•ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ItemTouchHelper.Callback callback = <span class="keyword">new</span> MovieTouchHelper(adapter);</div><div class="line">ItemTouchHelper helper = <span class="keyword">new</span> ItemTouchHelper(callback);</div><div class="line">helper.attachToRecyclerView(codeLanguageRecyclerView);</div></pre></td></tr></table></figure>
<p>ç°åœ¨æ‰€æœ‰çš„å·¥ä½œå·²ç»å®Œæˆã€‚æˆ‘ä»¬ç°åœ¨è¿˜æ²¡æœ‰æ·»åŠ åŠ¨ç”»ï¼Œé»˜è®¤çš„åŠ¨ç”»ç³»ç»Ÿå·²ç»æ·»åŠ ã€‚ç°åœ¨å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p>
<p>ç¤ºä¾‹projectåœ¨è¿™é‡Œï¼š<a href="https://github.com/marktony/zhuanlan" target="_blank" rel="external">GitHub</a>ï¼Œä¸ä¸Šè¿°é¡¹ç›®ç¨æœ‰ä¸åŒã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜]]></title>
      <url>http://marktony.github.io/2016/05/27/%E5%85%B3%E4%BA%8E%E7%9F%A5%E4%B9%8E%E4%B8%93%E6%A0%8FID%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%B4%E6%98%8E/</url>
      <content type="html"><![CDATA[<p>å¯¹ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDä»¥åŠå¦‚ä½•åœ¨çŸ¥ä¹ä¸“æ Appä¸­æ·»åŠ å–œæ¬¢çš„ä¸“æ çš„ä¸€äº›æ–¹æ³•ã€‚<br><a id="more"></a></p>
<h3 id="ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ</h3><p>çŸ¥ä¹ä¸“æ idæ˜¯ç”±è‹¥å¹²å­—ç¬¦ç»„æˆï¼Œæ˜¯ä¸€ä¸ªçŸ¥ä¹ä¸“æ çš„å”¯ä¸€æ ‡è¯†ã€‚å¦‚ <strong>wooyun</strong> æ˜¯çŸ¥ä¹ç”¨æˆ· <strong>fenggou</strong> çš„ä¸“æ  <strong>ä¹Œäº‘å›</strong> çš„idã€‚</p>
<h3 id="æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ"><a href="#æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ" class="headerlink" title="æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ"></a>æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ</h3><ul>
<li>PCç”¨æˆ·é€šè¿‡æµè§ˆå™¨æµè§ˆç½‘ç«™æ—¶ï¼Œè¿›å…¥æŸç”¨æˆ·çš„ä¸»é¡µæ—¶ï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨æ˜¾ç¤ºçš„URLï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œçº¢è‰²çº¿æ¡æ‰€æŒ‡å¤„wooyunå³ä¸ºIDã€‚</li>
</ul>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_pc.png" alt="zhihu_id_pc.png" title="">
<ul>
<li>Androidå®¢æˆ·ç«¯éº»çƒ¦ä¸€äº›ï¼Œè¿›å…¥åˆ°ç”¨æˆ·çš„ä¸»é¡µåï¼Œå¦‚æœè¯¥ç”¨æˆ·æœ‰å¼€é€šçŸ¥ä¹ä¸“æ ï¼Œè¿›å…¥TAçš„ä¸“æ ã€‚</li>
</ul>
<p>ç‚¹å‡»TAçš„æ–‡ç« ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_0.png" alt="zhihu_id_android_0.png" title="">
<p>è¿›å…¥TAçš„ä¸“æ ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_1.png" alt="zhihu_id_android_1.png" title="">
<p>ç‚¹å‡»åˆ†äº«æŒ‰é’®ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_2.png" alt="zhihu_id_android_2.png" title="">
<p>ç„¶åé€‰æ‹©å¤åˆ¶åˆ°ç²˜è´´æ¿ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_3.png" alt="zhihu_id_android_3.png" title="">
<p>ç²˜è´´è‡³çŸ¥ä¹ä¸“æ Appçš„è‡ªå®šä¹‰é¡µé¢ã€‚ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œç²˜è´´è‡³dialogä¸­ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_4.png" alt="zhihu_id_android_4.png" title="">
<p>åˆ é™¤ä¸éœ€è¦çš„éƒ¨åˆ†ï¼Œåªç•™ä¸‹idéƒ¨åˆ†ã€‚ç°åœ¨å°±å¯ä»¥ç‚¹å‡»ç¡®å®šæ·»åŠ äº†ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_5.png" alt="zhihu_id_android_5.png" title="">
<h3 id="ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ</h3><p>å¥½å§ï¼Œç°åœ¨æ·»åŠ idçš„æ­¥éª¤ç¡®å®æœ‰ç‚¹éº»çƒ¦ï¼Œåé¢æˆ‘ä¼šæƒ³åŠæ³•æŠŠæ·»åŠ idçš„æ­¥éª¤ç²¾ç®€ä¸€äº›ã€‚é¢„è®¡ä¸‹ä¸€ç‰ˆä¼šå®ç°ã€‚</p>
<h3 id="éœ€è¦æ³¨æ„çš„äº‹é¡¹"><a href="#éœ€è¦æ³¨æ„çš„äº‹é¡¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„äº‹é¡¹"></a>éœ€è¦æ³¨æ„çš„äº‹é¡¹</h3><p>å»ºè®®æ€»æ·»åŠ IDä¸è¦è¶…è¿‡20ä¸ªï¼Œæ·»åŠ è¿‡å¤šçš„æ ç›®æ—¶å¯èƒ½é€ æˆåˆå§‹åŒ–é¡µé¢æ—¶ï¼ŒåŠ è½½æ—¶é—´è¿‡é•¿ã€‚</p>
<h3 id="æœ€åè¯´ä¸€å¥"><a href="#æœ€åè¯´ä¸€å¥" class="headerlink" title="æœ€åè¯´ä¸€å¥"></a>æœ€åè¯´ä¸€å¥</h3><p>é¡¹ç›®ç›®å‰å·²ç»å¼€æºåˆ°GitHub,é¡¹ç›®åœ°å€<a href="https://github.com/marktony/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ GitHub</a>,æ¬¢è¿æ„Ÿå…´è¶£çš„åŒå­¦fork+starï¼Œå®šåˆ¶å±äºè‡ªå·±çš„çŸ¥ä¹ä¸“æ Appã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Tips]]></title>
      <url>http://marktony.github.io/2016/05/19/Tips/</url>
      <content type="html"><![CDATA[<p>é‚£äº›æˆ‘è‡ªå·±è¸©è¿‡çš„å‘!</p>
<a id="more"></a>
<ul>
<li><p>SwipeRefreshLayout setRefreshing()æ–¹æ³•å¤±è´¥<br>è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">swipeRefreshLayout.post(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        swipeRefreshLayout.setRefreshing(<span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Recyclerviewä¸SwipeRefreshLayoutæ»‘åŠ¨äº‹ä»¶å†²çª<br>ç•Œé¢ä¸­åŒæ—¶æœ‰è¿™ä¸¤ç§viewæ—¶ï¼Œæ»‘åŠ¨æ—¶é—´ä¾¿å†²çªäº†ã€‚çŸ¥ä¹androidå®¢æˆ·ç«¯è®¾ç½®ç•Œé¢åœ¨æ— ç½‘ç»œè¿æ¥æ—¶ï¼Œä¹Ÿå­˜åœ¨åŒæ ·çš„æ»‘åŠ¨äº‹ä»¶å†²çªçš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒçš„å¸ƒå±€åº”è¯¥æ˜¯SwipeRefreshLayoutå’ŒScrollViewå†²çªã€‚<br>è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">recyclerView.setOnScrollListener(<span class="keyword">new</span> RecyclerView.OnScrollListener() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrolled</span><span class="params">(RecyclerView recyclerView, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</div><div class="line">               <span class="keyword">super</span>.onScrolled(recyclerView, dx, dy);</div><div class="line"></div><div class="line">               <span class="comment">// ç¡®ä¿åªæœ‰å½“RecyclerViewçš„itemæ»‘åŠ¨åˆ°æœ€ä¸Šé¢çš„ä¸€ä¸ªæ—¶RefreshLayoutæ‰èƒ½ä¸‹æ‹‰</span></div><div class="line">               refreshLayout.setEnabled(linearLayoutManager.findFirstVisibleItemPosition() == <span class="number">0</span>);</div><div class="line">           &#125;</div><div class="line">       &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>åº”ç”¨é€€å‡ºæ—¶ç½‘ç»œè¯·æ±‚æœªå®Œæˆå¯¼è‡´å¤±å»context<br>è¿™ä¹ˆè¯´å¯èƒ½ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œå…·ä½“çš„æè¿°åº”è¯¥æ˜¯ï¼šå½“ç½‘ç»œè¯·æ±‚ä»åœ¨è¿›è¡Œæ—¶ï¼Œé€€å‡ºåº”ç”¨ï¼Œè¿™æ˜¯å¤±å»contextï¼ŒæŸäº›é€‚é…å™¨æ²¡æœ‰é€‚é…å®Œæˆï¼Œå¯¼è‡´åº”ç”¨ç›´æ¥å´©æºƒã€‚<br>åœ¨çŸ¥ä¹ä¸“æ çš„è¿‡ç¨‹ä¸­ï¼Œfragmentä¸­çš„å†…å®¹å…¨éƒ¨ä¸ºrecyclerviewï¼Œè€Œä¸”å…¨éƒ¨æ˜¯åœ¨ç½‘ç»œè¯·æ±‚ä¸‹å®Œæˆçš„ã€‚ç¬¬ä¸€ç‰ˆçš„æ—¶å€™æˆ‘é‡åˆ°çš„é—®é¢˜å°±æ˜¯ä¸Šè¿°æè¿°çš„è¿™æ ·ï¼Œåœ¨ç½‘ç»œè¯·æ±‚æ²¡æœ‰å®Œå…¨å®Œæˆæ—¶ï¼Œé€€å‡ºåº”ç”¨ï¼Œrecyclerviewçš„é€‚é…è¿˜æ²¡æœ‰å®Œæˆï¼Œä¹‹åç›´æ¥å¯¼è‡´set text on a null objectã€‚<br>æˆ‘çš„è§£å†³æ–¹æ³•æ˜¯ï¼šç»™æ‰€æœ‰volleyç½‘ç»œè¯·æ±‚è®¾ç½®TAGï¼Œç„¶ååœ¨fragmentçš„onStop()æ–¹æ³•ä¸­å–æ¶ˆè¯·æ±‚ã€‚<br>ç¤ºä¾‹ä»£ç :</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> RequestQueue queue;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String	 TAG = <span class="string">"TAG"</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">		queue = Volley.newRequestQueue(getActivity().getApplicationContext());</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Nullable</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        View view = inflater.inflate(R.layout.my_fragment,container,<span class="keyword">false</span>);</div><div class="line"></div><div class="line">        JsonObjectRequest request = <span class="keyword">new</span> JsonObjectRequest(Request.Method.GET, <span class="string">"my url"</span>, <span class="keyword">new</span> Response.Listener&lt;JSONObject&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(JSONObject jsonObject)</span> </span>&#123;</div><div class="line">                <span class="comment">// code</span></div><div class="line">        &#125;, <span class="keyword">new</span> Response.ErrorListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onErrorResponse</span><span class="params">(VolleyError volleyError)</span> </span>&#123;</div><div class="line">               <span class="comment">// code</span></div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        request.setTag(TAG);</div><div class="line">        queue.add(request);</div><div class="line"></div><div class="line">         <span class="meta">@Override</span></div><div class="line">    	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onStop();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (queue != <span class="keyword">null</span>)&#123;</div><div class="line">            queue.cancelAll(TAG);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>å»é™¤å­—ç¬¦ä¸²ä¸­çš„htmléƒ¨åˆ†<br>åœ¨Androidä¸­é€šè¿‡ä¸€è¡Œä»£ç å³å¯æå®šã€‚<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">newString = android.text.Html.fromHtml(oldString).toString();</div></pre></td></tr></table></figure>
</li>
</ul>
<p>åœ¨javaä¸­çš„è§£å†³æ–¹æ³•æ˜¯ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">String newString = Jsoup.parse(html).text();</div></pre></td></tr></table></figure></p>
<p>moreâ€¦</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[çŸ¥ä¹ä¸“æ APIåˆ†æ]]></title>
      <url>http://marktony.github.io/2016/05/14/%E7%9F%A5%E4%B9%8E%E4%B8%93%E6%A0%8FAPI%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<p>çŸ¥ä¹ä¸“æ APIçš„ç®€å•åˆ†æ<br><a id="more"></a></p>
<p>æ„Ÿè°¢çŸ¥ä¹ï¼Œæä¾›å¦‚æ­¤å‡ºè‰²çš„å¹³å°ï¼Œæ›´è¦æ„Ÿè°¢è¾›è‹¦çš„ä¸“æ ä½œè€…ä»¬ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†è¿™ä¹ˆå¤šçš„å¹²è´§ï¼Œæœ€åæ„Ÿè°¢æ”¯æŒæˆ‘çš„äººä»¬ï¼Œè°¢è°¢ä½ ä»¬ï¼</p>
<h3 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h3><p>å£°æ˜ï¼šä»¥ä¸‹æ‰€æœ‰APIå‡ç”± <strong>çŸ¥ä¹(Zhihu.INC)</strong> æä¾›ï¼Œæœ¬äººé€šè¿‡éæ­£å¸¸æ‰‹æ®µè·å–ã€‚è·å–ä¸å…±äº«çš„è¡Œä¸ºæœ‰ä¾µçŠ¯çŸ¥ä¹æƒç›Šçš„å«Œç–‘ã€‚è‹¥è¢«å‘ŠçŸ¥åœæ­¢ä½¿ç”¨ä¸å…±äº«ï¼Œæœ¬äººå°†åŠæ—¶åˆ é™¤æ•´ä¸ªé¡¹ç›®ã€‚è¯·æ‚¨çŸ¥æ‚‰ç›¸å…³æƒ…å†µï¼Œéµå®ˆçŸ¥ä¹çš„åè®®ã€‚APIä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨ä½œå•†ä¸šç”¨é€”ã€‚</p>
<h3 id="ç¤ºä¾‹é¡¹ç›®"><a href="#ç¤ºä¾‹é¡¹ç›®" class="headerlink" title="ç¤ºä¾‹é¡¹ç›®"></a>ç¤ºä¾‹é¡¹ç›®</h3><p><a href="https://github.com/marktony/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ Android</a></p>
<h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><ul>
<li>ä¸“æ çš„æ¶ˆæ¯å‡ä»¥JSONæ ¼å¼è¾“å‡º</li>
<li>http methodå‡ä¸ºGET</li>
<li>JSON ARRAY ä¸­çš„æ•°æ®ï¼Œåªé€‰å–äº†å…·æœ‰ä»£è¡¨æ€§çš„éƒ¨åˆ†è¿›è¡Œå±•ç¤º</li>
</ul>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><h4 id="è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯"><a href="#è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯" class="headerlink" title="è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯"></a>è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/columns/ä¸“æ å</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚è·å–çŸ¥ä¹å°ç®¡å®¶çš„ä¸“æ ä¿¡æ¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/columns/zhihuadmin</div></pre></td></tr></table></figure></p>
<p>å¾—åˆ°çš„ä¿¡æ¯ä¸ºï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"followersCount"</span>: <span class="number">7883</span>,</div><div class="line">  <span class="attr">"creator"</span>:</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"profileUrl"</span>: <span class="string">"https://www.zhihu.com/people/zhihuadmin"</span>,</div><div class="line">      <span class="attr">"bio"</span>: <span class="string">"æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼"</span>,</div><div class="line">      <span class="attr">"hash"</span>: <span class="string">"3d198a56310c02c4a83efb9f4a4c027e"</span>,</div><div class="line">      <span class="attr">"uid"</span>: <span class="number">53253479858176</span>,</div><div class="line">      <span class="attr">"isOrg"</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">"description"</span>: <span class="string">""</span>,</div><div class="line">      <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">      <span class="attr">"avatar"</span>:</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"34bf96bf5584ac4b5264bd7ed4fdbc5a"</span>,</div><div class="line">          <span class="attr">"template"</span>: <span class="string">"https://pic3.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">        &#125;,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"topics"</span>:</div><div class="line">      [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"url"</span>: <span class="string">"https://www.zhihu.com/topic/19552112"</span>,</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"19552112"</span>,</div><div class="line">          <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å»ºè®®åé¦ˆ"</span></div><div class="line">        &#125;,</div><div class="line">      ],</div><div class="line">    <span class="attr">"activateState"</span>: <span class="string">"activated"</span>,</div><div class="line">    <span class="attr">"href"</span>: <span class="string">"/api/columns/zhihuadmin"</span>,</div><div class="line">    <span class="attr">"acceptSubmission"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"firstTime"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"postTopics"</span>:</div><div class="line">      [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"postsCount"</span>: <span class="number">4</span>,</div><div class="line">          <span class="attr">"id"</span>: <span class="number">2</span>,</div><div class="line">          <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹"</span></div><div class="line">        &#125;,</div><div class="line">      ],</div><div class="line">    <span class="attr">"pendingName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"avatar"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"id"</span>: <span class="string">"5a1ec50171767c4fc856f430e46297db"</span>,</div><div class="line">        <span class="attr">"template"</span>: <span class="string">"https://pic4.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">      &#125;,</div><div class="line">    <span class="attr">"canManage"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"description"</span>: <span class="string">"çŸ¥ä¹ç¤¾åŒºç®¡ç†å›¢é˜Ÿå®˜æ–¹ä¸“æ ï¼Œä¸å®šæœŸæ›´æ–°ç¤¾åŒºç®¡ç†å·¥ä½œç›¸å…³çš„æœ€æ–°æ¶ˆæ¯ã€‚"</span>,  </div><div class="line">    <span class="attr">"pendingTopics"</span>: [],</div><div class="line">    <span class="attr">"nameCanEditUntil"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"reason"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"banUntil"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶è¯´"</span>,</div><div class="line">    <span class="attr">"url"</span>: <span class="string">"/zhihuadmin"</span>,</div><div class="line">    <span class="attr">"intro"</span>: <span class="string">"çŸ¥ä¹ç¤¾åŒºç®¡ç†å›¢é˜Ÿå®˜æ–¹ä¸“æ ï¼Œä¸å®šæœŸæ›´æ–°ç¤¾åŒºç®¡ç†å·¥ä½œâ€¦"</span>,  </div><div class="line">    <span class="attr">"topicsCanEditUntil"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"activateAuthorRequested"</span>: <span class="string">"none"</span>,</div><div class="line">    <span class="attr">"commentPermission"</span>: <span class="string">"anyone"</span>,</div><div class="line">    <span class="attr">"following"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"postsCount"</span>: <span class="number">19</span>,  </div><div class="line">    <span class="attr">"canPost"</span>: <span class="literal">false</span></div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<ul>
<li>followersCount: å…³æ³¨è¯¥ä¸“æ çš„äººæ•°</li>
<li>creator: è¯¥ä¸“æ çš„åˆ›å»ºè€…ä¿¡æ¯<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>topics: ä¸“æ è¯é¢˜ä¿¡æ¯<ul>
<li>url: è¯é¢˜åœ¨çŸ¥ä¹å®˜ç½‘ä¸­çš„åœ°å€</li>
<li>id: è¯é¢˜id</li>
<li>name: è¯é¢˜åç§°</li>
</ul>
</li>
<li>activateState: çŠ¶æ€ä¿¡æ¯ï¼Œæ˜¯å¦æ¿€æ´»</li>
<li>href: apiè¯·æ±‚åœ°å€</li>
<li>acceptSubmission: æ˜¯å¦æ¥å—æäº¤æ–‡ç« </li>
<li>firstTime: æ˜¯å¦ä¸ºé¦–æ¬¡æäº¤ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>postTopics: æ–‡ç« è¯é¢˜ä¿¡æ¯<ul>
<li>postsCount: è¯¥è¯é¢˜ä¸‹æ–‡ç« æ•°</li>
<li>id: id</li>
<li>name: è¯é¢˜åç§°</li>
</ul>
</li>
<li>pendingName: ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>avatar: ä¸“æ å¤´åƒä¿¡æ¯<ul>
<li>id: å¤´åƒid</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>canManage: æ˜¯å¦å¯ä»¥è¿›è¡Œç®¡ç†</li>
<li>description: ä¸“æ ä¿¡æ¯æè¿°</li>
<li>pendingTopics: ???è¯é¢˜</li>
<li>nameCanEditUntil: è·ä¸‹ä¸€æ¬¡ä¿®æ”¹åç§°çš„æ—¶é—´</li>
<li>reason: è¢«å°ç¦çš„åŸå› </li>
<li>banUntil: è¢«å°ç¦çš„æ—¶é—´</li>
<li>slug: ä¸“æ slug</li>
<li>url: url</li>
<li>intro: ä¸“æ ä»‹ç»ä¿¡æ¯</li>
<li>topicsCanEditUntil: è·ä¸‹ä¸€æ¬¡ä¿®æ”¹è¯é¢˜çš„æ—¶é—´</li>
<li>activateAuthorRequested: ???</li>
<li>commentPermission: è¯„è®ºæƒé™</li>
<li>following: æ˜¯å¦å…³æ³¨æ”¹ä¸“æ </li>
<li>postsCount: ä¸“æ æ–‡ç« æ•°</li>
<li>canPost: å½“å‰å¸å·æ˜¯å¦æœ‰å‘è¡¨æ–‡ç« çš„æƒé™</li>
</ul>
<p>åœ¨è·å–å›¾ç‰‡urlæ—¶ï¼Œå¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„å°ºå¯¸ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œå›¾ç‰‡è´¨é‡ä¾æ¬¡å¢åŠ ã€‚ä¹Ÿå¯ä»¥ä¸æ·»åŠ å°ºå¯¸å‚æ•°ï¼Œé»˜è®¤è·å–æœ€å¤§ç±»å‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_s.jpg</div><div class="line">https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_m.jpg</div><div class="line">https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_l.jpg</div><div class="line">https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_b.jpg</div><div class="line">https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_r.jpg</div></pre></td></tr></table></figure></p>
<h4 id="è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨"><a href="#è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨" class="headerlink" title="è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨"></a>è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/columns/ä¸“æ å/posts?limit=æ•°é‡&amp;offset=ä»å“ªé‡Œå¼€å§‹</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼Œè·å–çŸ¥ä¹å°ç®¡å®¶çš„æœ€æ–°çš„10ç¯‡æ–‡ç« <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/columns/zhihuadmin/posts?limit=10&amp;offset=0</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œlimitä¸ºè·å–çš„æ•°é‡é™åˆ¶ï¼Œoffsetä¸ºåç§»é‡ï¼Œå³ä»å“ªé‡Œå¼€å§‹è·å–ã€‚<br>é»˜è®¤æ•°æ®ä¸ºlimit=10ï¼Œoffset=0ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦å®šä¹‰äºŒè€…çš„å€¼ã€‚<br>è·å¾—çš„æ•°æ®ä¸º:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;  </div><div class="line">    <span class="attr">"isTitleImageFullScreen"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"rating"</span>: <span class="string">"none"</span>,</div><div class="line">    <span class="attr">"sourceUrl"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"publishedTime"</span>: <span class="string">"2016-10-13T14:00:49+08:00"</span>,</div><div class="line">    <span class="attr">"links"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"comments"</span>: <span class="string">"/api/posts/22921645/comments"</span></div><div class="line">      &#125;,</div><div class="line">    <span class="attr">"author"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"profileUrl"</span>: <span class="string">"https://www.zhihu.com/people/zhihuadmin"</span>,</div><div class="line">        <span class="attr">"bio"</span>: <span class="string">"æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼"</span>,</div><div class="line">        <span class="attr">"hash"</span>: <span class="string">"3d198a56310c02c4a83efb9f4a4c027e"</span>,</div><div class="line">        <span class="attr">"uid"</span>: <span class="number">53253479858176</span>,</div><div class="line">        <span class="attr">"isOrg"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">"description"</span>: <span class="string">""</span>,  </div><div class="line">        <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">        <span class="attr">"avatar"</span>:</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"id"</span>: <span class="string">"34bf96bf5584ac4b5264bd7ed4fdbc5a"</span>,</div><div class="line">            <span class="attr">"template"</span>: <span class="string">"https://pic3.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">          &#125;,</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶"</span></div><div class="line">      &#125;,</div><div class="line">    <span class="attr">"url"</span>: <span class="string">"/p/22921645"</span>,</div><div class="line">    <span class="attr">"title"</span>: <span class="string">"æ–°ç‰ˆç¤¾åŒºç®¡ç†è§„å®šäº 2016 å¹´ 10 æœˆ 13 æ—¥æ­£å¼è¿è¡Œ"</span>,</div><div class="line">    <span class="attr">"titleImage"</span>: <span class="string">"https://pic2.zhimg.com/v2-517f47cc5269b57f26ea4a25f29d8505_r.jpg"</span>,</div><div class="line">    <span class="attr">"summary"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"content"</span>: <span class="string">"&lt;p&gt;2016 å¹´ 9 æœˆ 13 æ—¥å°ç®¡å®¶å‘å¸ƒäº†æ–°ç‰ˆç¤¾åŒºç®¡ç†è§„å®šï¼Œæ˜ç¡®äº†ã€Œæ¶æ„è¡Œä¸ºã€çš„å®šä¹‰å’Œè¿è§„ç±»å‹ï¼ŒåŒæ—¶å¢åŠ äº†ã€Œå‘å¸ƒåƒåœ¾å¹¿å‘Šä¿¡æ¯ã€çš„ 3 ç§è¿è§„ç±»å‹ã€‚åœ¨å®Œæˆäº†ä¸ºæœŸ 1 ä¸ªæœˆçš„è¯•è¿è¡Œå&lt;b&gt;ï¼Œ&lt;/b&gt;&lt;b&gt;&lt;a href=\"https://www.zhihu.com/question/19790711/answer/36685915\" class=\"\" data-editable=\"true\" data-title=\"\u65b0\u7248\u793e\u533a\u7ba1\u7406\u89c4\u5b9a\"&gt;\u65b0\u7248\u793e\u533a\u7ba1\u7406\u89c4\u5b9a&lt;/a&gt;"</span>,</div><div class="line">    <span class="attr">"state"</span>: <span class="string">"published"</span>,</div><div class="line">    <span class="attr">"href"</span>: <span class="string">"/api/posts/22921645"</span>,</div><div class="line">    <span class="attr">"meta"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"previous"</span>: <span class="literal">null</span>,</div><div class="line">        <span class="attr">"next"</span>: <span class="literal">null</span></div><div class="line">      &#125;,</div><div class="line">    <span class="attr">"commentPermission"</span>: <span class="string">"anyone"</span>,</div><div class="line">    <span class="attr">"snapshotUrl"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"canComment"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"slug"</span>: <span class="number">22921645</span>,</div><div class="line">    <span class="attr">"commentsCount"</span>: <span class="number">76</span>,</div><div class="line">    <span class="attr">"likesCount"</span>: <span class="number">436</span></div><div class="line">  &#125;,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<ul>
<li>isTitleImageFullScreen: æ–‡ç« æ ‡é¢˜å¤§å›¾æ˜¯å¦å…¨å±</li>
<li>rating: ???è¯„çº§</li>
<li>sourceUrl: æºè·¯å¾„</li>
<li>publishedTime: å‘è¡¨æ—¶é—´</li>
<li>links: é“¾æ¥ä¿¡æ¯<ul>
<li>comments: è¯„è®ºåœ°å€</li>
</ul>
</li>
<li>creator: è¯¥ä¸“æ çš„åˆ›å»ºè€…ä¿¡æ¯<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>url: æ–‡ç« ç½‘é¡µå†…å®¹è·å–(<a href="https://zhuanlan.zhihu.com" target="_blank" rel="external">https://zhuanlan.zhihu.com</a> + url)</li>
<li>title: æ–‡ç« æ ‡é¢˜</li>
<li>titleImage: æ–‡ç« æ ‡é¢˜å¤§å›¾url(éœ€è¦æ³¨æ„çš„æ˜¯,titleImageçš„å€¼æœ‰å¯èƒ½ä¸ºç©º)ï¼Œå’Œå¤´åƒä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»„åˆä¸åŒçš„å°ºå¯¸å‚æ•°è·å–ä¸åŒå°ºå¯¸çš„å›¾ç‰‡</li>
<li>summary: æ–‡ç« ç®€è¦ä¿¡æ¯</li>
<li>content: HTMLæ ¼å¼çš„æ–‡ç« å†…å®¹è¯¦æƒ…ï¼Œå¯ä»¥é€šè¿‡WebViewæˆ–è€…UIWebViewå±•ç¤ºå†…å®¹</li>
<li>state: æ–‡ç« çŠ¶æ€(æ˜¯å¦å‘è¡¨)</li>
<li>href: apiè¯·æ±‚åœ°å€</li>
</ul>
<h4 id="è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯"><a href="#è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯" class="headerlink" title="è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯"></a>è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/posts/SLUG</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼Œè·å–çŸ¥ä¹å°ç®¡å®¶çš„æœ€æ–°ä¸€ç¯‡æ–‡ç« ï¼Œé€šè¿‡å·²ç»è·å¾—çš„ä¿¡æ¯ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ç»„åˆurlè¿›è¡Œè·å–ï¼Œä¸€æ˜¯é€šè¿‡hrefå€¼ï¼Œå¦ä¸€ç§å°±æ˜¯slugå€¼ï¼Œå½“ç„¶ï¼Œè¿™ä¸¤ç§æ–¹å¼æ®Šé€”åŒå½’ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/posts/22921645</div></pre></td></tr></table></figure></p>
<p>è·å–åˆ°çš„ä¿¡æ¯ä¸º:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"isTitleImageFullScreen"</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">"rating"</span>: <span class="string">"none"</span>,</div><div class="line">  <span class="attr">"titleImage"</span>: <span class="string">"https://pic2.zhimg.com/v2-cab0719fdec0816c475d7b70e016cbb1_r.jpg"</span>,</div><div class="line">  <span class="attr">"links"</span>:</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"comments"</span>: <span class="string">"/api/posts/22591792/comments"</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"reviewers"</span>: [],</div><div class="line">  <span class="attr">"topics"</span>:</div><div class="line">    [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"url"</span>: <span class="string">"https://www.zhihu.com/topic/19550887"</span>,</div><div class="line">        <span class="attr">"id"</span>: <span class="string">"19550887"</span>,</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹ç¤¾åŒº"</span></div><div class="line">      &#125;,</div><div class="line">    ],</div><div class="line">  <span class="attr">"titleImageSize"</span>:</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"width"</span>: <span class="number">0</span>,</div><div class="line">      <span class="attr">"height"</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"href"</span>: <span class="string">"/api/posts/22591792"</span>,</div><div class="line">  <span class="attr">"excerptTitle"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"author"</span>:</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"profileUrl"</span>: <span class="string">"https://www.zhihu.com/people/zhihuadmin"</span>,</div><div class="line">      <span class="attr">"bio"</span>: <span class="string">"æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼"</span>,</div><div class="line">      <span class="attr">"hash"</span>: <span class="string">"3d198a56310c02c4a83efb9f4a4c027e"</span>,</div><div class="line">      <span class="attr">"uid"</span>: <span class="number">53253479858176</span>,</div><div class="line">      <span class="attr">"isOrg"</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">"description"</span>: <span class="string">""</span>,</div><div class="line">      <span class="attr">"badge"</span>:</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"identity"</span>:</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"description"</span>: <span class="string">"çŸ¥ä¹å®˜æ–¹å¸å·"</span></div><div class="line">            &#125;,</div><div class="line">          <span class="attr">"best_answerer"</span>: <span class="literal">null</span></div><div class="line">        &#125;,</div><div class="line">      <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">      <span class="attr">"avatar"</span>:</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"34bf96bf5584ac4b5264bd7ed4fdbc5a"</span>,</div><div class="line">          <span class="attr">"template"</span>: <span class="string">"https://pic3.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">        &#125;,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶"</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"column"</span>:</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶è¯´"</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"tipjarState"</span>: <span class="string">"inactivated"</span>,</div><div class="line">  <span class="attr">"content"</span>: <span class="string">"&lt;p&gt;ä»Šå¤©ï¼Œå°ç®¡å®¶å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ç«™å†…ã€Œä¸è§„èŒƒè½¬è½½ã€è¡Œä¸ºçš„å¤„ç†æƒ…å†µã€‚&lt;/p&gt;&lt;br&gt;"</span>,</div><div class="line">  <span class="attr">"state"</span>: <span class="string">"published"</span>,</div><div class="line">  <span class="attr">"sourceUrl"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"pageCommentsCount"</span>: <span class="number">34</span>,</div><div class="line">  <span class="attr">"canComment"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">"snapshotUrl"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"slug"</span>: <span class="number">22591792</span>,</div><div class="line">  <span class="attr">"publishedTime"</span>: <span class="string">"2016-09-23T17:33:56+08:00"</span>,</div><div class="line">  <span class="attr">"url"</span>: <span class="string">"/p/22591792"</span>,</div><div class="line">  <span class="attr">"title"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶å·¥ä½œç¬”è®°ï¼šä¸è§„èŒƒè½¬è½½ï¼Ÿä¸å¯ä»¥ï¼"</span>,</div><div class="line">  <span class="attr">"lastestLikers"</span>:</div><div class="line">    [</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"profileUrl"</span>: <span class="string">"https://www.zhihu.com/people/su-shu-95-98"</span>,</div><div class="line">        <span class="attr">"bio"</span>: <span class="string">"ä¸€ä¸ªæ— æ³•ç”¨ä¸€å¥è¯æè¿°çš„äºº"</span>,</div><div class="line">        <span class="attr">"hash"</span>: <span class="string">"a6975d974fb22609a31dbbdec6f375e3"</span>,</div><div class="line">        <span class="attr">"uid"</span>: <span class="number">657690756534505472</span>,</div><div class="line">        <span class="attr">"isOrg"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">"description"</span>: <span class="string">"ä½ è¯´ä»€ä¹ˆéƒ½å¯¹ã€‚"</span>,</div><div class="line">        <span class="attr">"slug"</span>: <span class="string">"su-shu-95-98"</span>,</div><div class="line">        <span class="attr">"avatar"</span>:</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"id"</span>: <span class="string">"888129f4afd91083c0cfd156e6889438"</span>,</div><div class="line">            <span class="attr">"template"</span>: <span class="string">"https://pic1.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">          &#125;,</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"è‹èˆ’"</span></div><div class="line">      &#125;,</div><div class="line">    ],</div><div class="line">  <span class="attr">"summary"</span>: <span class="string">"&lt;img src=\"https://pic1.zhimg.com/v2-4f2228e8f8292ec30c373488afa2bd48_200x112.jpg\" data-rawwidth=\"920\" data-rawheight=\"638\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https://pic1.zhimg.com/v2-4f2228e8f8292ec30c373488afa2bd48_r.jpg\"&gt;ä»Šå¤©ï¼Œå°ç®¡å®¶å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ç«™å†…ã€Œä¸è§„èŒƒè½¬è½½ã€è¡Œä¸ºçš„å¤„ç†æƒ…å†µã€‚ å¹´åˆæˆ‘ä»¬å‘å¸ƒäº†..."</span>,</div><div class="line">  <span class="attr">"reviewingCommentsCount"</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">"meta"</span>:</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"previous"</span>:</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"isTitleImageFullScreen"</span>: <span class="literal">false</span>,</div><div class="line">          <span class="attr">"rating"</span>: <span class="string">"none"</span>,</div><div class="line">          <span class="attr">"titleImage"</span>: <span class="string">"https://pic2.zhimg.com/517f47cc5269b57f26ea4a25f29d8505_r.jpg"</span>,</div><div class="line">          <span class="attr">"links"</span>:</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"comments"</span>: <span class="string">"/api/posts/22434253/comments"</span></div><div class="line">            &#125;,</div><div class="line">          <span class="attr">"topics"</span>:</div><div class="line">            [</div><div class="line">              &#123;</div><div class="line">                <span class="attr">"url"</span>: <span class="string">"https://www.zhihu.com/topic/19550887"</span>,</div><div class="line">                <span class="attr">"id"</span>: <span class="string">"19550887"</span>,</div><div class="line">                <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹ç¤¾åŒº"</span></div><div class="line">              &#125;,            </div><div class="line">            ],</div><div class="line">          <span class="attr">"href"</span>: <span class="string">"/api/posts/22434253"</span>,</div><div class="line">          <span class="attr">"excerptTitle"</span>: <span class="string">""</span>,</div><div class="line">          <span class="attr">"author"</span>:</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"profileUrl"</span>: <span class="string">"https://www.zhihu.com/people/zhihuadmin"</span>,</div><div class="line">              <span class="attr">"bio"</span>: <span class="string">"æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼"</span>,</div><div class="line">              <span class="attr">"hash"</span>: <span class="string">"3d198a56310c02c4a83efb9f4a4c027e"</span>,</div><div class="line">              <span class="attr">"uid"</span>: <span class="number">53253479858176</span>,</div><div class="line">              <span class="attr">"isOrg"</span>: <span class="literal">false</span>,</div><div class="line">              <span class="attr">"description"</span>: <span class="string">""</span>,</div><div class="line">              <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">              <span class="attr">"avatar"</span>:</div><div class="line">                &#123;</div><div class="line">                  <span class="attr">"id"</span>: <span class="string">"34bf96bf5584ac4b5264bd7ed4fdbc5a"</span>,</div><div class="line">                  <span class="attr">"template"</span>: <span class="string">"https://pic3.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">                &#125;,</div><div class="line">              <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶"</span></div><div class="line">            &#125;,</div><div class="line">          <span class="attr">"column"</span>:</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"slug"</span>: <span class="string">"zhihuadmin"</span>,</div><div class="line">              <span class="attr">"name"</span>: <span class="string">"çŸ¥ä¹å°ç®¡å®¶è¯´"</span></div><div class="line">            &#125;,</div><div class="line">          <span class="attr">"content"</span>: <span class="string">"é¢˜ä¸‹å‘å¸ƒç›¸åŒå›ç­”ï¼›&lt;/p&gt;&lt;img src=\"https://pic2.zhimg.com/a86dbedbeb67a26b33252ee4e8e886a9_b.png\" data-rawwidth=\"469\" data-rawheight=\"348\" class=\"origin_image zh-lightbox-thumb\" width=\"469\" data-original=\"https://pic2.zhimg.com/a86dbedbeb67a26b33252ee4e8e886a9_r.png\"&gt;&lt;br&gt;"</span>,</div><div class="line">          <span class="attr">"state"</span>: <span class="string">"published"</span>,</div><div class="line">          <span class="attr">"sourceUrl"</span>: <span class="string">""</span>,</div><div class="line">          <span class="attr">"pageCommentsCount"</span>: <span class="number">0</span>,</div><div class="line">          <span class="attr">"canComment"</span>: <span class="literal">true</span>,</div><div class="line">          <span class="attr">"snapshotUrl"</span>: <span class="string">""</span>,</div><div class="line">          <span class="attr">"slug"</span>: <span class="number">22434253</span>,</div><div class="line">          <span class="attr">"publishedTime"</span>: <span class="string">"2016-09-13T17:34:29+08:00"</span>,</div><div class="line">          <span class="attr">"url"</span>: <span class="string">"/p/22434253"</span>,</div><div class="line">          <span class="attr">"title"</span>: <span class="string">"æ–°ç‰ˆç¤¾åŒºç®¡ç†è§„èŒƒäºä»Šæ—¥è¯•è¿è¡Œ"</span>,</div><div class="line">          <span class="attr">"summary"</span>: <span class="string">"ç¤¾åŒºç®¡ç†è§„èŒƒæ˜¯çŸ¥å‹å…±è¯†çš„æ€»ç»“ï¼Œä¹Ÿæ˜¯ç¤¾åŒºå¥åº·å‘å±•çš„åŸºçŸ³ã€‚è¿‘æœŸï¼Œæˆ‘ä»¬ä¸æ–­æ”¶åˆ°çŸ¥å‹ä»¬åé¦ˆæ–°çš„æ‰°ä¹±ç¤¾åŒºç§©åºçš„è¡Œä¸ºï¼Œå¦‚é›†èµçˆ†ç…§ã€ç‚¹èµæŠ½å¥–ã€è¯„è®ºåŒºå‘å¸ƒä¹±ç ã€åˆ·èµåˆ·ç²‰ã€æ¶æ„è¥é”€ã€å›ç­”éšè—æ·˜å®é“¾æ¥..."</span>,</div><div class="line">          <span class="attr">"reviewingCommentsCount"</span>: <span class="number">0</span>,</div><div class="line">          <span class="attr">"meta"</span>:</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"previous"</span>: <span class="literal">null</span>,</div><div class="line">              <span class="attr">"next"</span>: <span class="literal">null</span></div><div class="line">            &#125;,</div><div class="line">          <span class="attr">"commentPermission"</span>: <span class="string">"anyone"</span>,</div><div class="line">          <span class="attr">"commentsCount"</span>: <span class="number">0</span>,</div><div class="line">          <span class="attr">"likesCount"</span>: <span class="number">0</span></div><div class="line">        &#125;,</div><div class="line">      <span class="attr">"next"</span>: <span class="literal">null</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">"commentPermission"</span>: <span class="string">"anyone"</span>,</div><div class="line">  <span class="attr">"commentsCount"</span>: <span class="number">34</span>,</div><div class="line">  <span class="attr">"likesCount"</span>: <span class="number">241</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>isTitleImageFullScreen: æ–‡ç« æ ‡é¢˜å¤§å›¾æ˜¯å¦å…¨å±</li>
<li>rating: ???è¯„çº§</li>
<li>titleImage: æ–‡ç« æ ‡é¢˜å¤§å›¾url(éœ€è¦æ³¨æ„çš„æ˜¯,titleImageçš„å€¼æœ‰å¯èƒ½ä¸ºç©º)ï¼Œå’Œå¤´åƒä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»„åˆä¸åŒçš„å°ºå¯¸å‚æ•°è·å–ä¸åŒå°ºå¯¸çš„å›¾ç‰‡</li>
<li>links: é“¾æ¥ä¿¡æ¯<ul>
<li>comments: è¯„è®ºè·å–åœ°å€</li>
</ul>
</li>
<li>reviewers: å¤å®¡äºº(åœ¨æˆ‘è¯·æ±‚çš„è¿™ä¹ˆå¤šæ¬¡ä¸­ï¼Œå¹¶æ²¡æœ‰æˆåŠŸè·å¾—è¿‡æ­¤é¡¹å¯¹åº”çš„å€¼ã€‚ä¸æ’é™¤æ­¤é¡¹è¿”å›å…·ä½“å€¼çš„å¯èƒ½æ€§ã€‚æ¨æµ‹ä¸ºcreatorç±»å‹ã€‚)</li>
<li>topics: ä¸“æ è¯é¢˜ä¿¡æ¯<ul>
<li>url: è¯é¢˜åœ¨çŸ¥ä¹å®˜ç½‘ä¸­çš„åœ°å€</li>
<li>id: è¯é¢˜id</li>
<li>name: è¯é¢˜åç§°</li>
</ul>
</li>
<li>titleImageSize:<ul>
<li>width å®½åº¦</li>
<li>height é«˜åº¦</li>
</ul>
</li>
<li>href: apiè¯·æ±‚åœ°å€</li>
<li>excerptTitle: å¼•ç”¨(æ‘˜å½•)æ ‡é¢˜</li>
<li>author:<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>badge å¾½ç« ï¼Œå³è®¤è¯ä¿¡æ¯<ul>
<li>identity å®˜æ–¹å¸å·<ul>
<li>description è®¤è¯è¯¦æƒ…æè¿°</li>
</ul>
</li>
<li>best_answerer ä¼˜ç§€å›ç­”è€…</li>
</ul>
</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>column: æ‰€å±ä¸“æ <ul>
<li>slug slug</li>
<li>name ä¸“æ åç§°</li>
</ul>
</li>
<li>tipjarState: æ‰“èµä¿¡æ¯</li>
<li>content: HTMLæ ¼å¼çš„å†…å®¹ä¿¡æ¯è¯¦æƒ…</li>
<li>state: æ–‡ç« çŠ¶æ€ï¼Œæ˜¯å¦å‘å¸ƒ</li>
<li>sourceUrl: æºåœ°å€</li>
<li>pageCommentsCount: è¯„è®ºæ•°</li>
<li>canComment: æ˜¯å¦å¯ä»¥è¯„è®º</li>
<li>snapshotUrl: çŸ­ç½‘å€?</li>
<li>slug: æ–‡ç« çš„slug</li>
<li>publishedTime: æ–‡ç« å‘è¡¨æ—¶é—´</li>
<li>url: urlåœ°å€</li>
<li>title: æ–‡ç« æ ‡é¢˜</li>
<li>lastestLikers: æœ€è¿‘ç‚¹èµçš„ç”¨æˆ·<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>summaryâ€: æ–‡ç« ç®€è¦ä¿¡æ¯</li>
<li>reviewingCommentsCount: å®¡æŸ¥ä¸­çš„è¯„è®ºæ•°é‡</li>
<li>meta: meta<ul>
<li>previous ä¸Šä¸€ç¯‡æ–‡ç« çš„ä¿¡æ¯ï¼Œjsonç»“æ„å’Œä¸Šé¢çš„å†…å®¹ç›¸åŒ</li>
<li>next ä¸‹ä¸€ç¯‡æ–‡ç« çš„ä¿¡æ¯</li>
</ul>
</li>
<li>commentPermission: è¯„è®ºæƒé™</li>
<li>commentsCount: è¯„è®ºæ•°é‡</li>
<li>likesCount: èµçš„æ•°é‡</li>
</ul>
<p>åœ¨è®¤è¯ä¿¡æ¯ä¸­ï¼Œç›®å‰åªå‘ç°æœ‰ä¸¤ç§ç±»å‹ï¼Œidentityå®˜æ–¹å¸å·å’Œbest_answererä¼˜ç§€å›ç­”è€…ï¼Œç”±äºçŸ¥ä¹å°ç®¡å®¶åªæ˜¯å®˜æ–¹å¸å·ï¼Œå¹¶ä¸æ˜¯ä¼˜ç§€å›ç­”è€…ï¼Œè¿™é‡Œé€‰å–ä¼˜ç§€å›ç­”è€…<a href="https://www.zhihu.com/people/aton" target="_blank" rel="external">è‹è‰å®‰</a>çš„ä¿¡æ¯è¿›è¡Œåˆ†æã€‚<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">"badge":</div><div class="line">  &#123;</div><div class="line">    "identity": null,</div><div class="line">    "best_answerer":</div><div class="line">      &#123;</div><div class="line">        "topics": [],</div><div class="line">        "description": "ä¼˜ç§€å›ç­”è€…"</div><div class="line">      &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>identity å®˜æ–¹å¸å·</li>
<li>best_answerer ä¼˜ç§€å›ç­”è€…<ul>
<li>topics è¯é¢˜</li>
<li>description æè¿°ä¿¡æ¯</li>
</ul>
</li>
</ul>
<h4 id="è·å–è¯„è®ºåˆ—è¡¨"><a href="#è·å–è¯„è®ºåˆ—è¡¨" class="headerlink" title="è·å–è¯„è®ºåˆ—è¡¨"></a>è·å–è¯„è®ºåˆ—è¡¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/posts/æ–‡ç« slug/comments?limit=æ•°é‡é™åˆ¶&amp;offset=åç§»é‡</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæ‹¼æ¥urlçš„æ–¹æ³•å’Œè·å–æ–‡ç« åˆ—è¡¨æ—¶çš„æ–¹æ³•æ—¶ä¸€æ ·çš„ï¼Œä¸å†èµ˜è¿°ã€‚ä¾‹å¦‚è·å–æ–‡ç« slugä¸º22591792çš„å‰30æ¡è¯„è®ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/posts/22591792/comments?limit=30&amp;offset=0</div></pre></td></tr></table></figure></p>
<p>è·å–åˆ°çš„ä¿¡æ¯ä¸º<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"content"</span>: <span class="string">"å°ç®¡å®¶æ£’æ£’å“’ï¼æ”¯æŒ~"</span>,</div><div class="line">    <span class="attr">"liked"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"href"</span>: <span class="string">"/api/posts/22591792/comments/169039008"</span>,</div><div class="line">    <span class="attr">"inReplyToCommentId"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"reviewing"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"author"</span>:</div><div class="line">      &#123;</div><div class="line">        <span class="attr">"profileUrl"</span>: <span class="string">"https://www.zhihu.com/people/fei-xiao-gui"</span>, <span class="attr">"bio"</span>: <span class="string">"å¿ƒä¸­æœ‰çˆ± è„šä¸‹æœ‰é£ æ‰€ä»¥æˆ‘è·‘å¾—å¿«~"</span>,</div><div class="line">        <span class="attr">"hash"</span>: <span class="string">"41cd5c7249081389da3a523b3cb0629b"</span>, <span class="attr">"uid"</span>: <span class="number">28048833380352</span>,</div><div class="line">        <span class="attr">"isOrg"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">"description"</span>: <span class="string">"å“å­¦å…¼ä¼˜~"</span>,</div><div class="line">        <span class="attr">"slug"</span>: <span class="string">"fei-xiao-gui"</span>,</div><div class="line">        <span class="attr">"avatar"</span>:</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"id"</span>: <span class="string">"a061ebdd61bb57c81b3206dda51418fc"</span>, <span class="attr">"template"</span>: <span class="string">"https://pic1.zhimg.com/&#123;id&#125;_&#123;size&#125;.jpg"</span></div><div class="line">          &#125;,</div><div class="line">        <span class="attr">"name"</span>: <span class="string">"è²å°æ¡‚"</span></div><div class="line">      &#125;,</div><div class="line">    <span class="attr">"createdTime"</span>: <span class="string">"2016-09-23T17:35:54+08:00"</span>,</div><div class="line">    <span class="attr">"featured"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"id"</span>: <span class="number">169039008</span>,</div><div class="line">    <span class="attr">"likesCount"</span>: <span class="number">1</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure></p>
<ul>
<li>content: è¯„è®ºå†…å®¹</li>
<li>liked: æ˜¯å¦ç»™è¿™æ¡è¯„è®ºç‚¹è¿‡èµ</li>
<li>href: è¯¥æ¡è¯„è®ºçš„è¯¦æƒ…åœ°å€</li>
<li>inReplyToCommentId: æ‰€å›å¤çš„è¯„è®ºçš„id</li>
<li>reviewing: æ˜¯å¦æ­£åœ¨è¢«å®¡æŸ¥ä¸­</li>
<li>author: è¯„è®ºçš„ä½œè€…<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>createdTime: è¯„è®ºåˆ›å»ºæ—¶é—´</li>
<li>featured: ???æ˜¯å¦ä¸ºç²¾å½©è¯„è®º</li>
<li>id: è¯¥æ¡è¯„è®ºçš„id</li>
<li>likesCount: è·å¾—çš„èµçš„æ•°é‡</li>
</ul>
<p>å¯¹ä»–äººè¯„è®ºçš„å›å¤æ•°æ®æœ‰äº›è®¸çš„ä¸åŒï¼ŒinReplyToCommentIdçš„å€¼ä¸ä¸º0ï¼Œjsonæ•°æ®ä¸­å¢åŠ äº†inReplyToUserå­—æ®µï¼Œå†…å®¹ä¸ºauthorç±»å‹ã€‚è¿™é‡Œä¸å†å…·ä½“åˆ†æã€‚</p>
<h4 id="è·å–ç‚¹èµä¿¡æ¯"><a href="#è·å–ç‚¹èµä¿¡æ¯" class="headerlink" title="è·å–ç‚¹èµä¿¡æ¯"></a>è·å–ç‚¹èµä¿¡æ¯</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/posts/22591792/likers?limit=è·å–æ•°é‡&amp;offset=åç§»é‡</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼Œè·å–æ–‡ç« slugä¸º22591792çš„æœ€æ–°20ä¸ªç‚¹èµçš„äººçš„ä¿¡æ¯ï¼Œauthorç±»å‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/api/posts/22591792/likers?limit=20&amp;offset=0</div></pre></td></tr></table></figure></p>
<p>urlçš„æ‹¼æ¥æ–¹æ³•å’Œä¸Šé¢è·å–æ–‡ç« ä¿¡æ¯æ—¶æ–¹æ³•ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>æœ€åè¿˜æ˜¯æ”¾ä¸Šè‡ªå·±çš„ç¤ºä¾‹é¡¹ç›®åœ°å€ï¼š<br><a href="https://github.com/marktony/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ Android</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Javaä¸­ç±»æˆå‘˜çš„åˆå§‹åŒ–]]></title>
      <url>http://marktony.github.io/2016/05/12/Java%E4%B8%AD%E7%B1%BB%E6%88%90%E5%91%98%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>å¦‚æœä¸€ä¸ªç±»çš„åŸºæœ¬æˆå‘˜å˜é‡ï¼Œåœ¨æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆå®ƒçš„é»˜è®¤å€¼æ˜¯å¤šå°‘å‘¢ï¼Ÿ<br><a id="more"></a></p>
<p>åœ¨Javaä¸­ï¼Œç±»çš„æŸä¸ªæˆå‘˜å˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå³ä½¿æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼ŒJavaä¹Ÿä¼šç¡®ä¿å®ƒè·å¾—ä¸€ä¸ªé»˜è®¤å€¼ã€‚OK, talk is cheap, show me the code:</p>
<pre><code>public class InitialTest {

    private int anInt;
    private long aLong;
    private short aShort;
    private char aChar;
    private float aFloat;
    private double aDouble;
    private boolean aBoolean;
    private byte aByte;
    private InitialTest reference;

    public static void main(String args[]){

        InitialTest initialTest = new InitialTest();
        System.out.println(&quot;Boolean &quot; + initialTest.aBoolean);
        System.out.println(&quot;Byte &quot; + initialTest.aByte);
        System.out.println(&quot;Char &quot; + initialTest.aChar);
        System.out.println(&quot;Short &quot; +initialTest.aShort);
        System.out.println(&quot;Int &quot; + initialTest.anInt);
        System.out.println(&quot;Long &quot; + initialTest.aLong);
        System.out.println(&quot;Float &quot; + initialTest.aFloat);
        System.out.println(&quot;Double &quot; + initialTest.aDouble);
        System.out.print(&quot;Reference &quot; + initialTest.reference);

    }

}
</code></pre><p>æˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç±»ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„çœ‹å‡ºä½œç”¨æ˜¯ä»€ä¹ˆã€‚ä¸‹é¢æ˜¯è¿è¡Œç»“æœ</p>
<pre><code>Boolean false
Byte 0
Char  
Short 0
Int 0
Long 0
Float 0.0
Double 0.0
Reference null
</code></pre><p>ç»“æœå·²ç»å¾ˆæ˜æ˜¾äº†ã€‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">åŸºæœ¬ç±»å‹</th>
<th style="text-align:left">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">boolean</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td style="text-align:left">char</td>
<td style="text-align:left">â€˜\u0000â€™(null)</td>
</tr>
<tr>
<td style="text-align:left">byte</td>
<td style="text-align:left">(byte)0</td>
</tr>
<tr>
<td style="text-align:left">short</td>
<td style="text-align:left">(short)0</td>
</tr>
<tr>
<td style="text-align:left">int</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">long</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">float</td>
<td style="text-align:left">0.0</td>
</tr>
<tr>
<td style="text-align:left">double</td>
<td style="text-align:left">0.0</td>
</tr>
<tr>
<td style="text-align:left">reference</td>
<td style="text-align:left">null</td>
</tr>
</tbody>
</table>
<p>å½“å˜é‡ä½œä¸ºç±»çš„æˆå‘˜ä½¿ç”¨æ—¶ï¼ŒJavaæ‰ä¼šç¡®ä¿ç»™å®šé»˜è®¤å€¼ï¼Œä»¥ç¡®ä¿é‚£äº›åŸºæœ¬æˆå‘˜å˜é‡å¾—åˆ°åˆå§‹åŒ–(C++ä¸­æ²¡æœ‰æ­¤åŠŸèƒ½),é˜²æ­¢ç¨‹åºäº§ç”Ÿé”™è¯¯ã€‚ä½†æ˜¯ï¼Œè¿™äº›åˆå§‹å€¼å¯¹äºä½ çš„ç¨‹åºå¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ï¼Œæ‰€ä»¥æœ€å¥½æ˜ç¡®çš„å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<p>ä½†æ˜¯ä¸Šè¿°ç¡®ä¿åˆå§‹åŒ–çš„æ–¹æ³•å¹¶ä¸é€‚ç”¨äºâ€œå±€éƒ¨å˜é‡â€(å³éç±»æˆå‘˜)ï¼Œå› æ­¤å½“æˆ‘æŠŠä»£ç æ”¹æˆä¸‹é¢çš„æ ·å­æ—¶ï¼ŒIDEå°±ä¼šæç¤ºé”™è¯¯äº†ï¼š</p>
<pre><code>public static void main(String args[]){
    InitialTest initialTest = new InitialTest();
    System.out.println(&quot;Boolean &quot; + initialTest.aBoolean);
    System.out.println(&quot;Byte &quot; + initialTest.aByte);
    System.out.println(&quot;Short &quot; +initialTest.aShort);
    System.out.println(&quot;Char &quot; + initialTest.aChar);
    System.out.println(&quot;Int &quot; + initialTest.anInt);
    System.out.println(&quot;Long &quot; + initialTest.aLong);
    System.out.println(&quot;Float &quot; + initialTest.aFloat);
    System.out.println(&quot;Double &quot; + initialTest.aDouble);
    System.out.print(&quot;Reference &quot; + initialTest.reference);
    int i;
    System.out.println(&quot;another int is &quot; + i);
}
</code></pre><p>IDEAæç¤ºé”™è¯¯ï¼š</p>
<pre><code>Variable &apos;i&apos; might not have been initialized
</code></pre><p>å¦‚æœä¸æ˜¯åœ¨IDEä¸­ç¼–è¾‘çš„ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘çš„æ—¶å€™ä¹Ÿä¼šæç¤ºä½ è¿™ä¸ªé”™è¯¯ï¼Œå‘Šè¯‰ä½ è¿™ä¸ªå˜é‡æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ã€‚C++ç¼–è¾‘å™¨ä¼šå¯¹æœªåˆå§‹åŒ–å˜é‡ç»™äºˆä¸€ä¸ªè­¦å‘Šï¼Œè€Œéé”™è¯¯ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Activityçš„å››ç§å¯åŠ¨æ¨¡å¼]]></title>
      <url>http://marktony.github.io/2016/05/11/Activity%E7%9A%84%E5%9B%9B%E7%A7%8D%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>æµ…æAndroidä¸­Activityçš„å››ç§å¯åŠ¨æ¨¡å¼:standard,singleTop,singleTask,singleInstance<br><a id="more"></a></p>
<p>å¯åŠ¨æ¨¡å¼ä¸€å…±æœ‰ä¸Šè¿°çš„å››ç§ï¼Œå¯ä»¥åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­é€šè¿‡ç»™<ctivity>æ ‡ç­¾æŒ‡å®šandroid:launchModeå±æ€§æ¥é€‰æ‹©å¯åŠ¨æ¨¡å¼ã€‚</ctivity></p>
<h3 id="standard"><a href="#standard" class="headerlink" title="standard"></a>standard</h3><p>standardæ˜¯Activityé»˜è®¤çš„å¯åŠ¨æ¨¡å¼ï¼Œåœ¨ä¸è¿›è¡Œæ˜¾ç¤ºæŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰Activityéƒ½ä¼šè‡ªåŠ¨çš„ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚Androidä½¿ç”¨è¿”å›æ ˆæ¥ç®¡ç†Activity,åœ¨standardæ¨¡å¼ä¸‹ï¼Œæ¯å½“å¯åŠ¨ä¸€ä¸ªæ–°çš„Activity,å®ƒå°±ä¼šåœ¨è¿”å›æ ˆä¸­å…¥æ ˆï¼Œå¹¶å¤„äºæ ˆé¡¶çš„ä½ç½®ã€‚å¯¹äºä½¿ç”¨standardæ¨¡å¼çš„Activity,ç³»ç»Ÿä¸ä¼šåœ¨ä¹è¿™ä¸ªActivityæ˜¯å¦å·²ç»åœ¨è¿”å›æ ˆä¸­ï¼Œæ¯æ¬¡å¯åŠ¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Activityå®ä¾‹ã€‚</p>
<p>ç°åœ¨é€šè¿‡å®è·µæ¥ä½“ä¼šä¸€ä¸‹standardæ¨¡å¼ï¼Œé¦–å…ˆæ˜¯æ–°å»ºä¸€ä¸ªActivityTesté¡¹ç›®ï¼Œä¿®æ”¹MainActivityçš„onCreate()ä¸­ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Log.d(&quot;Mainactivity&quot;,this.toString());

    Button btn1 = (Button) findViewById(R.id.btn1);

    btn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(MainActivity.this,MainActivity.class);
            startActivity(intent);
        }
    });

}
</code></pre><p>ä»£ç å¾ˆç®€å•ï¼Œåœ¨MainActivityçš„åŸºç¡€ä¸Šå¯åŠ¨MainActivityï¼Œä»é€»è¾‘ä¸Šè®²æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä¸è¿‡æˆ‘ä»¬åœ¨äºç ”ç©¶standardæ¨¡å¼ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå°±ä¸å»è¿½ç©¶å®é™…çš„ç”¨é€”äº†ã€‚å¦å¤–æˆ‘ä»¬è¿˜åœ¨onCreate()ä¸­æ·»åŠ äº†ä¸€å¥æ‰“å°æ—¥å¿—ä¿¡æ¯ï¼Œæ‰“å°å½“å‰Activityçš„å®ä¾‹ã€‚</p>
<p>ç°åœ¨è¿è¡Œç¨‹åºï¼Œç„¶åå†MainActivityç•Œé¢è¿ç»­ç‚¹å‡»ä¸¤æ¬¡æŒ‰é’®ï¼Œè§‚å¯ŸLogCatä¸­æ‰“å°çš„æ—¥å¿—ä¿¡æ¯ã€‚</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@5e658bb
MainActivity: com.marktony.applicationtest.MainActivity@cfae411
MainActivity: com.marktony.applicationtest.MainActivity@b0e0bac
</code></pre><p>ä»æ‰“å°ä¿¡æ¯ä¸­å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ï¼Œæ¯æ¬¡ç‚¹å‡»æŒ‰é’®å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„MainActivityçš„å®ä¾‹ï¼Œæ­¤æ—¶è¿”å›æ ˆä¸­ä¹Ÿä¼šå­˜åœ¨ä¸‰ä¸ªMainActivityçš„å®ä¾‹ï¼Œå› æ­¤æƒ³è¦å®Œå…¨é€€å‡ºåº”ç”¨ï¼Œå¿…é¡»ç‚¹å‡»ä¸‰æ¬¡è¿”å›é”®ã€‚</p>
<h3 id="singleTop"><a href="#singleTop" class="headerlink" title="singleTop"></a>singleTop</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—standardæ¨¡å¼ä¸å¤ªåˆç†ã€‚activityæ˜æ˜å·²ç»åœ¨æ ˆé¡¶äº†ï¼Œä¸ºä»€ä¹ˆå†æ¬¡å¯åŠ¨æ—¶è¿˜è¦åˆ›å»ºä¸€ä¸ªæ–°çš„Activityå®ä¾‹å‘¢ï¼Ÿè¿™æ—¶singleTopæ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å½“Activityçš„å¯åŠ¨æ¨¡å¼è¢«æŒ‡å®šä¸ºsingleTopæ—¶ï¼Œåœ¨å¯åŠ¨Activityæ—¶å¦‚æœå‘ç°è¿”å›æ ˆçš„æ ˆé¡¶å·²ç»æ˜¯è¯¥Activityï¼Œåˆ™å¯ä»¥è®¤ä¸ºç›´æ¥ä½¿ç”¨å®ƒï¼Œä¸åˆ›å»ºæ–°çš„å®ä¾‹ã€‚</p>
<p>ä¸‹é¢çœ‹å®ä¾‹,ä¿®æ”¹AndroidManifest.xmlä¸­çš„MainActivityçš„å¯åŠ¨æ¨¡å¼ä¸ºsingleTop:</p>
<pre><code>&lt;activity android:name=&quot;.MainActivity&quot;
    android:launchMode=&quot;singleTop&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre><p>é‡æ–°è¿è¡Œç¨‹åºï¼Œé€šè¿‡LogCatæŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Activityå®ä¾‹ã€‚</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@5e658bb
</code></pre><p>ä¹‹åä¸ç®¡ç‚¹å‡»å¤šå°‘æ¬¡æŒ‰é’®ï¼Œéƒ½ä¸ä¼šæœ‰æ–°çš„æ‰“å°ä¿¡æ¯å‡ºç°ï¼Œå› ä¸ºç›®å‰Activityå·²ç»å¤„äºè¿”å›æ ˆçš„æ ˆé¡¶ï¼Œæ¯å½“æƒ³è¦å†å¯åŠ¨ä¸€ä¸ªMainActivityæ—¶éƒ½ä¼šç›´æ¥ä½¿ç”¨æ ˆé¡¶çš„Activityï¼Œå› æ­¤MainActivityä¹Ÿåªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œä»…æŒ‰ä¸€æ¬¡è¿”å›é”®å³å¯é€€å‡ºç¨‹åºã€‚</p>
<p>ä¸è¿‡å½“MainActivityä¸åœ¨æ ˆé¡¶æ—¶ï¼Œè¿™æ˜¯å†å¯åŠ¨MainActivityï¼Œè¿˜æ˜¯ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼Œä¸‹é¢æ¥å®éªŒä¸€ä¸‹ã€‚ä¿®æ”¹MainActivityä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Log.d(&quot;MainActivity&quot;,this.toString());

    Button btn1 = (Button) findViewById(R.id.btn1);

    btn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(MainActivity.this,SecondActivity.class);
            startActivity(intent);
        }
    });
}
</code></pre><p>è¿™æ¬¡æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®å¯åŠ¨çš„æ˜¯SecondActivityã€‚ç„¶åä¿®æ”¹SecondActivityä¸­onCreate()æ–¹æ³•ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);

    Button btn2 = (Button) findViewById(R.id.btn2);
    btn2.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new
            Intent(SecondActivity.this,MainActivity.class);
            startActivity(intent);
        }
    });
}
</code></pre><p>æˆ‘ä»¬åœ¨SecondActivityä¸­çš„æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ä¸­åˆåŠ å…¥äº†å¯åŠ¨MainActivityçš„ä»£ç ã€‚ç°åœ¨é‡æ–°è¿è¡Œç¨‹åºï¼Œåœ¨MainActivityç•Œé¢ç‚¹å‡»æŒ‰é’®è¿›å…¥SecondActivityï¼Œç„¶ååœ¨SecondActivityç•Œé¢ç‚¹å‡»æŒ‰é’®ï¼Œåˆä¼šé‡æ–°è¿›å…¥åˆ°MainActivityã€‚æŸ¥çœ‹LogCatä¸­çš„ä¿¡æ¯ï¼š</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@eb60bcf
SecondActivity: com.marktony.applicationtest.SecondActivity@5cf7342
MainActivity: com.marktony.applicationtest.MainActivity@a360333
</code></pre><p>å¯ä»¥çœ‹åˆ°ç³»ç»Ÿåˆ›å»ºäº†ä¸¤ä¸ªä¸åŒçš„MainActivity,è¿™æ˜¯ç”±äºåœ¨SecondActivityä¸­å†æ¬¡å¯åŠ¨Activityæ—¶ï¼Œæ ˆé¡¶çš„Activityå·²ç»å˜æˆäº†SecondActivityï¼Œå› æ­¤ä¼šæ–°å»ºä¸€ä¸ªæ–°çš„MainActivityã€‚ç°åœ¨æŒ‰ä¸‹backé”®å°±ä¼šè¿”å›åˆ°SecondActivity,å†æ¬¡æŒ‰ä¸‹backé”®ï¼Œåˆä¼šå›åˆ°MainActivity,å†æŒ‰ä¸€æ¬¡backé”®æ‰ä¼šé€€å‡ºç¨‹åºã€‚</p>
<h3 id="singleTask"><a href="#singleTask" class="headerlink" title="singleTask"></a>singleTask</h3><p>ä½¿ç”¨singleTaskæ¨¡å¼å¯ä»¥å¾ˆå¥½çš„è§£å†³é‡å¤åˆ›å»ºæ ˆé¡¶Activityçš„é—®é¢˜ï¼Œä½†æ˜¯æ­£å¦‚ä½ çœ‹åˆ°çš„ï¼Œå¦‚æœè¯¥Activityå¹¶æ²¡æœ‰å¤„äºæ ˆé¡¶çš„ä½ç½®ï¼Œè¿˜æ˜¯å¯èƒ½åˆ›å»ºå¤šä¸ªActivityå®ä¾‹çš„ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰æ–¹æ³•å¯ä»¥è®©Activityåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­æŒ‡å­˜åœ¨ä¸€ä¸ªå®ä¾‹å‘¢ï¼Ÿ<br>è¿™å°±è¦å€ŸåŠ©singleTaskæ¨¡å¼æ¥å®ç°äº†ã€‚å½“Activityçš„å¯åŠ¨æ¨¡å¼æŒ‡å®šä¸ºsingleTaskï¼Œæ¯æ¬¡å¯åŠ¨è¯¥Activityæ—¶ç³»ç»Ÿé¦–å…ˆä¼šåœ¨è¿”å›æ ˆä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥Activityçš„å®ä¾‹ï¼Œå¦‚æœå‘ç°å·²ç»å­˜åœ¨åˆ™ç›´æ¥ä½¿ç”¨è¯¥å®ä¾‹ï¼Œå¹¶æŠŠåœ¨è¿™ä¸ªActivityä¹‹ä¸Šçš„æ‰€æœ‰Activityç»Ÿç»Ÿå‡ºæ ˆï¼Œå¦‚æœæ²¡æœ‰å‘ç°å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚<br>ä¸‹é¢é€šè¿‡ä»£ç æ¥ç›´è§‚çš„ç†è§£ä¸€ä¸‹ã€‚ä¿®æ”¹AndroidManifest.xmlæ–‡ä»¶ä¸­MainActivityçš„å¯åŠ¨æ¨¡å¼ï¼š</p>
<pre><code>&lt;activity android:name=&quot;.MainActivity&quot;
    android:launchMode=&quot;singleTask&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre><p>ç„¶ååœ¨MainActivityä¸­æ·»åŠ onRestart()æ–¹æ³•ï¼Œå¹¶æ‰“å°æ—¥å¿—ï¼š</p>
<pre><code>@Override
protected void onRestart() {
    super.onRestart();
    Log.d(&quot;MainActivity&quot;,&quot;onStart&quot;);
}
</code></pre><p>æœ€ååœ¨SecondActivityä¸­æ·»åŠ onDestroy()æ–¹æ³•ï¼Œå¹¶æ‰“å°æ—¥å¿—ï¼š</p>
<pre><code>@Override
protected void onDestroy() {
    super.onDestroy();
    Log.d(&quot;SecondActivity&quot;,&quot;onDestroy&quot;);
}
</code></pre><p>ç°åœ¨é‡æ–°è¿è¡Œç¨‹åºï¼Œåœ¨MainActivityç•Œé¢ç‚¹å‡»æŒ‰é’®è¿›å…¥SecondActivityï¼Œç„¶ååœ¨SecondActivityç•Œé¢ç‚¹æŒ‰é’®ï¼Œåˆä¼šé‡æ–°è¿›å…¥åˆ°MainActivityã€‚æŸ¥çœ‹LogCatä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼š</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@f2c42cf
SecondActivity: com.marktony.applicationtest.SecondActivity@81ea653
MainActivity: onStart
SecondActivity: onDestroy
</code></pre><p>ä»æ‰“å°ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨SecondActivityä¸­å¯åŠ¨MainActivityæ—¶ï¼Œä¼šå‘ç°è¿”å›æ ˆé‡Œå·²ç»å­˜åœ¨ä¸€ä¸ªMainActivityçš„å®ä¾‹ï¼Œå¹¶ä¸”æ˜¯åœ¨SecondActivityçš„ä¸‹é¢ï¼Œäºæ˜¯SecondActivityä¼šä»è¿”å›æ ˆä¸­å‡ºæ ˆï¼Œè€ŒMainActivityé‡æ–°æˆä¸ºäº†æ ˆé¡¶Activityï¼Œå› æ­¤MainActivityçš„onRestart()æ–¹æ³•å’ŒSecondActivityçš„onDestroy()æ–¹æ³•ä¼šå¾—åˆ°æ‰§è¡Œã€‚ç°åœ¨è¿”å›æ ˆä¸­åªå‰©ä¸‹ä¸€ä¸ªMainActivityçš„å®ä¾‹äº†ï¼ŒæŒ‰ä¸€ä¸‹backé”®å°±å¯ä»¥é€€å‡ºç¨‹åºã€‚</p>
<h3 id="singleInstance"><a href="#singleInstance" class="headerlink" title="singleInstance"></a>singleInstance</h3><p>singleInstanceåº”è¯¥æ˜¯å››ç§å¯åŠ¨æ¨¡å¼ä¸­æœ€ç‰¹æ®Šä¹Ÿæœ€å¤æ‚çš„ä¸€ç§äº†ã€‚ä¸åŒäºä»¥ä¸Šä¸‰ç§å¯åŠ¨æ¨¡å¼ï¼ŒæŒ‡å®šä¸ºsingleInstanceçš„Activityä¼šå¯ç”¨ä¸€ä¸ªæ–°çš„è¿”å›æ ˆæ¥ç®¡ç†è¿™ä¸ªActivity(å…¶å®å¦‚æœsingleTaskæ¨¡å¼æŒ‡å®šäº†ä¸åŒçš„taskAffinityï¼Œä¹Ÿä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„è¿”å›æ ˆ)ã€‚é‚£ä¹ˆè¿™ä¹ˆåšæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬çš„ç¨‹åºä¸­æœ‰ä¸€ä¸ªActivityæ˜¯å…è®¸å…¶ä»–ç¨‹åºè°ƒç”¨çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å®ç°å…¶ä»–ç¨‹åºå’Œæˆ‘ä»¬çš„ç¨‹åºå¯ä»¥å…±äº«è¿™ä¸ªActivityçš„å®ä¾‹ï¼Œåº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿä½¿ç”¨å‰é¢ä¸‰ç§å¯åŠ¨æ¨¡å¼è‚¯å®šæ˜¯æ— æ³•å®ç°çš„ï¼Œå› ä¸ºæ¯ä¸ªç¨‹åºéƒ½ä¼šæœ‰è‡ªå·±çš„è¿”å›æ ˆï¼ŒåŒä¸€ä¸ªActivityåœ¨ä¸åŒçš„è¿”å›æ ˆä¸­å…¥æ ˆæ—¶å¿…ç„¶æ˜¯åˆ›å»ºæ–°çš„å®ä¾‹ã€‚è€Œä½¿ç”¨singleInstanceæ¨¡å¼å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ä¼šæœ‰ä¸€ä¸ªå•ç‹¬çš„è¿”å›æ ˆæ¥ç®¡ç†è¿™ä¸ªActivityï¼Œä¸ç®¡æ˜¯é‚£ä¸ªåº”ç”¨ç¨‹åºæ¥è®¿é—®è¿™ä¸ªActivityï¼Œéƒ½å…±ç”¨çš„åŒä¸€ä¸ªè¿”å›æ ˆï¼Œä¹Ÿå°±è§£å†³äº†å…±äº«Activityå®ä¾‹çš„é—®é¢˜ã€‚</p>
<p>OK,talk is cheap,show me the code,æˆ‘ä»¬è¿˜æ˜¯æ¥å®è·µä¸€ä¸‹ã€‚ä¿®æ”¹AndroidManifest.xmlä¸­SecondActivityçš„å¯åŠ¨æ¨¡å¼:</p>
<pre><code>&lt;activity android:name=&quot;.SecondActivity&quot;
    android:launchMode=&quot;singleInstance&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;com.marktony.applicatiointest.ACTION_START&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
        &lt;category android:name=&quot;com.marktony.applicationtest.MY_CATEGORY&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre><p>æˆ‘ä»¬å…ˆå°†SecondActivityçš„å¯åŠ¨æ¨¡å¼æŒ‡å®šä¸ºsingleInstanceï¼Œç„¶åä¿®æ”¹MainActivityä¸­onCreate()æ–¹æ³•çš„ä»£ç :</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Log.d(&quot;MainActivity&quot;,&quot;task id is &quot; + getTaskId());

    Button btn1 = (Button) findViewById(R.id.btn1);
    btn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(MainActivity.this,SecondActivity.class);
            startActivity(intent);
        }
    });

}
</code></pre><p>åœ¨onCreate()æ–¹æ³•ä¸­æ‰“å°äº†å½“å‰è¿”å›æ ˆçš„idã€‚ç„¶åä¿®æ”¹SecondActivityä¸­onCreate()æ–¹æ³•çš„ä»£ç ï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);

    Log.d(&quot;SecondActivity&quot;,&quot;task id is &quot; + getTaskId());

    Button btn2 = (Button) findViewById(R.id.btn2);
    btn2.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(SecondActivity.this,ThirdActivity.class);
            startActivity(intent);
        }
    });
}
</code></pre><p>åŒæ ·åœ¨onCreate()æ–¹æ³•ä¸­æ‰“å°äº†å½“å‰è¿”å›æ ˆçš„idï¼Œç„¶ååˆä¿®æ”¹äº†æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„ä»£ç ï¼Œç”¨äºå¯åŠ¨ThirdActivityã€‚æœ€åä¿®æ”¹ThirdActivityä¸­onCreate()æ–¹æ³•çš„ä»£ç ï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_third);

    Log.d(&quot;ThirdActivity&quot;,&quot;task id is &quot; + getTaskId());
}
</code></pre><p>ä»ç„¶æ˜¯åœ¨onCreate()æ–¹æ³•ä¸­æ‰“å°äº†å½“å‰è¿”å›æ ˆçš„idã€‚ç°åœ¨é‡æ–°è¿è¡Œç¨‹åºï¼Œåœ¨MainActivityç•Œé¢ä¸­ç‚¹å‡»æŒ‰é’®è¿›å…¥åˆ°SecondActivityï¼Œç„¶ååœ¨SecondActivityä¸­ç‚¹å‡»æŒ‰é’®è¿›å…¥åˆ°ThirdActivityã€‚æŸ¥çœ‹LogCatä¸­çš„æ‰“å°ä¿¡æ¯ï¼š</p>
<pre><code>MainActivity: task id is 403
SecondActivity: task id is 404
ThirdActivity: task id is 403
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒSecondActivityçš„task idä¸åŒäºMainActivityå’ŒThirdActivityï¼Œè¿™è¯´æ˜SecondActivityç¡®å®æ˜¯å­˜æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„è¿”å›æ ˆä¸­çš„ï¼Œè€Œä¸”è¿™ä¸ªæ ˆä¸­åªæœ‰SecondActivityè¿™ä¸€ä¸ªActivityã€‚</p>
<p>ç„¶åæˆ‘ä»¬æŒ‰ä¸‹backé”®è¿›è¡Œè¿”å›ï¼Œä½ ä¼šå‘ç°ThirdActivityç«Ÿç„¶è¿”å›äº†MainActivityï¼Œå†æŒ‰ä¸‹backé”®åˆä¼šè¿”å›åˆ°SecondActivityï¼Œå†æŒ‰ä¸‹è¿”å›é”®ä¼šé€€å‡ºç¨‹åºï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>å…¶å®åŸç†å¾ˆç®€å•ï¼Œç”±äºMainActivityå’ŒThirdActivityæ˜¯å­˜æ”¾åœ¨åŒä¸€ä¸ªè¿”å›æ ˆé‡Œçš„ï¼Œå½“åœ¨ThirdActivityçš„ç•Œé¢æŒ‰ä¸‹è¿”å›é”®ï¼ŒThirdActivityä¼šä»è¿”å›æ ˆä¸­å‡ºæ ˆï¼Œé‚£ä¹ˆMainActivityå°±æˆä¸ºäº†æ ˆé¡¶Activityæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šï¼Œå› æ­¤ä¹Ÿå°±å‡ºç°äº†ä»ThirdActivityç›´æ¥è¿”å›åˆ°MainActivityçš„æƒ…å†µã€‚ç„¶ååœ¨MainActivityå†æ¬¡æŒ‰ä¸‹è¿”å›é”®ï¼Œè¿™æ˜¯å½“å‰çš„è¿”å›æ ˆå·²ç»ç©ºäº†ï¼Œäºæ˜¯å°±æ˜¾ç¤ºäº†å¦ä¸€ä¸ªè¿”å›æ ˆçš„æ ˆé¡¶Activityï¼ŒåŠSecondActivityã€‚æœ€åå†æ¬¡æŒ‰ä¸‹backé”®ï¼Œè¿™æ˜¯æ‰€æœ‰çš„è¿”å›æ ˆå‡è¢«æ¸…ç©ºäº†ï¼Œä¹Ÿå°±è‡ªç„¶çš„é€€å‡ºäº†ç¨‹åºã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[è¿›ç¨‹ä¸çº¿ç¨‹]]></title>
      <url>http://marktony.github.io/2016/05/02/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h2 id="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»"></a>è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»</h2><a id="more"></a>
<h4 id="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ</h4><p>è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ç‹¬ç«‹å•ä½ã€‚è¿›ç¨‹æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„è™šæ‹Ÿç©ºé—´åœ°å€ï¼Œå¹¶ä¸ä¾èµ–çº¿ç¨‹è€Œç‹¬ç«‹å­˜åœ¨ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ</h4><p>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯cpuè°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ã€‚å®ƒæ˜¯è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹æœ¬èº«å¹¶ä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºï¼Œè¿è¡Œæ˜¯åªæ˜¯æš‚ç”¨ä¸€äº›è®¡æ•°å™¨ã€å¯„å­˜å™¨å’Œæ ˆã€‚</p>
<h4 id="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»-1"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»-1" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»"></a>è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»</h4><p>ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªç¨‹åºè‡³å°‘æ‹¥æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚<br>ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åˆ›å»ºå’Œæ’¤é”€å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹å¹¶å‘çš„æ‰§è¡Œã€‚</p>
<p>çº¿ç¨‹æ›´åŠ æ¥è¿‘äºæ‰§è¡Œä½“çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥åŒè¿›ç¨‹ä¸­çš„å…¶ä»–çº¿ç¨‹å…±äº«æ•°æ®ï¼Œä½†æ˜¯æ‹¥æœ‰ç‹¬ç«‹çš„æ ˆç©ºé—´ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„æ‰§è¡Œåºåˆ—ã€‚</p>
<h4 id="è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«"></a>è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«</h4><p>è¿›ç¨‹ä¸çº¿ç¨‹çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬æ˜¯ä¸åŒçš„æ“ä½œç³»ç»Ÿèµ„æºç®¡ç†æ–¹å¼ã€‚è¿›ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒä¹‹åï¼Œåœ¨ä¿æŠ¤æ¨¡å¼å¯¹å…¶ä»–è¿›ç¨‹æ²¡æœ‰å½±å“ï¼Œçº¿ç¨‹åªæ˜¯è¿›ç¨‹çš„ä¸åŒæ‰§è¡Œè·¯å¾„ã€‚çº¿ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„å †æ ˆå’Œå±€éƒ¨å˜é‡ï¼Œä½†æ˜¯æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªçº¿ç¨‹æ­»æ‰é‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¹Ÿå°±æ­»æ‰äº†ï¼Œæ‰€ä»¥å¤šè¿›ç¨‹çš„åº”ç”¨è¦æ¯”å¤šçº¿ç¨‹çš„åº”ç”¨æ›´åŠ å¥å£®ã€‚ä½†æ˜¯è¿›ç¨‹åœ¨åˆ‡æ¢æ—¶è€—è´¹çš„èµ„æºä¹Ÿæ¯”è¾ƒå¤šï¼Œæ•ˆç‡ä¹Ÿè¦æ›´å·®ï¼Œæ‰€ä»¥åœ¨å¹¶å‘æ€§è¦æ±‚é«˜åˆè¦å…±äº«å˜é‡æ•°æ®ï¼Œåªèƒ½é çº¿ç¨‹ï¼Œè€Œä¸æ˜¯è¿›ç¨‹ã€‚</p>
<p>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£ã€‚ä½†æ˜¯çº¿ç¨‹ä¸èƒ½ç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šçº¿ç¨‹æ‰§è¡Œæ§åˆ¶ã€‚</p>
<p>ä»é€»è¾‘ä¸Šçœ‹ï¼Œå¤šçº¿ç¨‹çš„æ„ä¹‰åœ¨äºåœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºå½“ä¸­ï¼Œæœ‰å¤šä¸ªæ‰§è¡Œéƒ¨åˆ†å¯ä»¥åŒæ—¶æ‰§è¡Œã€‚ä½†æ˜¯æ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰å°†å¤šä¸ªçº¿ç¨‹çœ‹ä½œå¤šä¸ªç‹¬ç«‹çš„åº”ç”¨ï¼Œæ¥å®ç°è¿›ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ä»¥åŠèµ„æºåˆ†é…ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ANR]]></title>
      <url>http://marktony.github.io/2016/05/01/ANR/</url>
      <content type="html"><![CDATA[<p>æµ…è°ˆAndroidå¼€å‘ä¸­çš„ANRç°è±¡<br><a id="more"></a></p>
<h3 id="ä»€ä¹ˆæ˜¯ANR"><a href="#ä»€ä¹ˆæ˜¯ANR" class="headerlink" title="ä»€ä¹ˆæ˜¯ANR"></a>ä»€ä¹ˆæ˜¯ANR</h3><p>ANR,Application Not Responding,å³ç¨‹åºæœªå“åº”ã€‚å‘ç”ŸANRæ—¶ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºä¸€ä¸ªdialogï¼Œæç¤ºç”¨æˆ·å‡ºç°äº†ANRï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©â€œç­‰å¾…â€ï¼Œæˆ–è€…æ˜¯â€œå¼ºåˆ¶å…³é—­â€ï¼Œç»“æŸåº”ç”¨ã€‚ANRåŒå´©æºƒä¸€æ ·ï¼Œæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­åº”è¯¥é¿å…çš„ã€‚</p>
<h3 id="ä»€ä¹ˆä¼šè§¦å‘ANRï¼š"><a href="#ä»€ä¹ˆä¼šè§¦å‘ANRï¼š" class="headerlink" title="ä»€ä¹ˆä¼šè§¦å‘ANRï¼š"></a>ä»€ä¹ˆä¼šè§¦å‘ANRï¼š</h3><ul>
<li>ä¸»çº¿ç¨‹è¢«IOæ“ä½œé˜»å¡ã€‚ï¼ˆæ–‡æ¡£ä¸­ç‰¹åˆ«å¼ºè°ƒ:<strong>you should not perform the work on the UI thread(ä¸è¦åœ¨UIçº¿ç¨‹ä¸­è¿›è¡ŒIOæ“ä½œ)</strong>ï¼‰ã€‚</li>
<li>ä¸»çº¿ç¨‹ä¸­å­˜åœ¨è€—æ—¶çš„æ“ä½œã€‚</li>
<li>ä¸»çº¿ç¨‹ä¸­é”™è¯¯æ“ä½œã€‚å¦‚Thread.wait()æˆ–Thread.sleep()ç­‰ã€‚</li>
</ul>
<p>åœ¨Androidä¸­ï¼Œåº”ç”¨ç¨‹åºçš„å“åº”æ˜¯å—åˆ°Activity Manager å’Œ Window Manageerç³»ç»ŸæœåŠ¡çš„ã€‚ä¸€æ—¦å‡ºç°ä»¥ä¸‹æƒ…å†µï¼ŒAndroidç³»ç»Ÿå°±ä¼šå±•ç¤ºdialogï¼š</p>
<ul>
<li>5ç§’å†…æ²¡æœ‰ç›¸åº”è§¦æ‘¸æ“ä½œã€‚(No response to an input event (such as key press or screen touch events) within 5 seconds.)</li>
<li>å¹¿æ’­æ¥æ”¶å™¨åœ¨10å†…æ²¡æœ‰æ‰§è¡Œå®Œæˆã€‚(A BroadcastReceiver hasnâ€™t finished executing within 10 seconds.)</li>
</ul>
<h3 id="æ€æ ·é¿å…ANR"><a href="#æ€æ ·é¿å…ANR" class="headerlink" title="æ€æ ·é¿å…ANR"></a>æ€æ ·é¿å…ANR</h3><p>Androidåº”ç”¨é€šå¸¸æ˜¯å®Œå…¨è¿è¡Œåœ¨UIçº¿ç¨‹(<code>UI Thread</code>)æˆ–è€…è¯´ä¸»çº¿ç¨‹(<code>Main Thread</code>)ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ åœ¨UIçº¿ç¨‹ä¸­è¿›è¡Œçš„ä»»ä½•é•¿è€—æ—¶æ“ä½œéƒ½æœ‰å¯èƒ½è§¦å‘ANRã€‚å› æ­¤ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­çš„ä»»ä½•æ“ä½œéƒ½åº”è¯¥å°½å¯èƒ½å¿«çš„å®Œæˆã€‚</p>
<ul>
<li>åœ¨Activityç”Ÿå‘½å‘¨æœŸä¸­çš„å…³é”®æ–¹æ³•ï¼Œä¾‹å¦‚onCreate()å’ŒonResume()ä¸­ï¼Œå®Œæˆå°½å¯èƒ½å°‘çš„å·¥ä½œã€‚</li>
<li>ä½¿ç”¨AsyncTaskå¤„ç†è€—æ—¶æ“ä½œ(ç½‘ç»œè¯·æ±‚å’Œæ•°æ®æ“ä½œç­‰ã€‚)</li>
<li>å¦‚æœä½¿ç”¨äº†Threadæˆ–è€…HandlerThread,ç¡®ä¿ä¸»çº¿ç¨‹ä¸ä¼šåœ¨ç­‰å¾…å·¥ä½œçº¿ç¨‹å®Œæˆæ—¶è¢«é˜»å¡ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šè§¦å‘Thread.wait()æˆ–Thread.sleep()ï¼Œåº”è¯¥ä½¿ç”¨Handlerå¤„ç†å·¥ä½œçº¿ç¨‹çš„ç»“æœã€‚</li>
<li>åœ¨BroadcastReceiverä¸­å®Œæˆé‚£äº›å°è€Œæ•£(small,discrete)çš„å·¥ä½œï¼Œè€Œä¸æ˜¯é‚£äº›é•¿è€—æ—¶æ“ä½œæˆ–è®¡ç®—çš„å·¥ä½œï¼Œå¦‚æœéœ€è¦ï¼Œåº”è¯¥äº¤ç»™IntentServiceå»å®Œæˆã€‚</li>
</ul>
<h3 id="æŠ€å·§æé«˜"><a href="#æŠ€å·§æé«˜" class="headerlink" title="æŠ€å·§æé«˜"></a>æŠ€å·§æé«˜</h3><p>é€šå¸¸ï¼Œ100è‡³200msæ˜¯ç”¨æˆ·è®¤ä¸ºåº”ç”¨è¿è¡Œç¼“æ…¢çš„é˜€å€¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›é¢å¤–çš„tipsï¼Œå¯ä»¥ä½¿åº”ç”¨é¿å…ANRå’ŒåŠæ—¶å“åº”ç”¨æˆ·ï¼š</p>
<ul>
<li>å¦‚æœåº”ç”¨æ­£åœ¨åå°å¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œé‚£ä¹ˆï¼Œå¤„ç†çš„è¿›åº¦åº”è¯¥å‘ŠçŸ¥ç”¨æˆ·å¤„ç†çš„è¿›åº¦ã€‚å¯ä»¥åœ¨UIä¸­ä½¿ç”¨ <strong>ProgressBar</strong>ã€‚</li>
<li>ç‰¹åˆ«çš„ï¼Œå¦‚æœæ˜¯æ¸¸æˆåº”ç”¨çš„è¯ï¼Œè®¡ç®—å·¥ä½œåº”è¯¥åœ¨å·¥ä½œè¿›ç¨‹(Worker thread)ä¸­å®Œæˆã€‚</li>
<li>å¦‚æœåœ¨åˆå§‹åŒ–ä¸­éœ€è¦è¿›è¡Œè€—æ—¶æ“ä½œï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ¬¢è¿é¡µ(splash screen)æˆ–è€…æç¤ºç”¨æˆ·æ­£åœ¨å°½å¿«åŠ è½½ï¼ŒåŒæ—¶æ˜¾ç¤ºåŠ è½½è¿›åº¦ä¿¡æ¯ã€‚è¿™æ ·ï¼Œç”¨æˆ·æ‰ä¸ä¼šè®¤ä¸ºä½ çš„åº”ç”¨åœæ»äº†(frozen)ã€</li>
<li>ä½¿ç”¨Systraceå’ŒTraceviewæ¥å®šä½åº”ç”¨ä¸­å“åº”ç”¨æˆ·çš„ç“¶é¢ˆçš„ä½ç½®ã€‚</li>
</ul>
<p>æ–‡æ¡£åœ°å€ï¼š<a href="!http://developer.android.com/training/articles/perf-anr.html">Android Developer</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“]]></title>
      <url>http://marktony.github.io/2016/04/28/zhihudaily/</url>
      <content type="html"><![CDATA[<p>æ€»ç»“åœ¨å¼€å‘çŸ¥ä¹å°æŠ¥çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œç›¸åº”çš„è§£å†³æ–¹æ³•,ä»¥åŠåˆ†äº«å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸€äº›å¿ƒå¾—ä½“ä¼š<br><a id="more"></a></p>
<h2 id="çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“"><a href="#çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“" class="headerlink" title="çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“"></a>çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“</h2><p>æ€»ç»“åœ¨çŸ¥ä¹å°æŠ¥å¼€å‘çš„å·¥ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠç›¸å…³çš„è§£å†³åŠæ³•ã€‚</p>
<p>1.Intentå¯¼è‡´çš„ActivityNotFoundException</p>
<p>æ— æ³•æ‰¾åˆ°å¯¹åº”çš„activityï¼Œè¿™ä¸ªå¼‚å¸¸åœ¨ä½¿ç”¨Intentå¯åŠ¨ä¸€äº›ç³»ç»Ÿçº§éšå¼çš„activityæ—¶å¯èƒ½ä¼šå‡ºç°ï¼Œä¾‹å¦‚çŸ­ä¿¡ã€é‚®ä»¶ã€æ‰“å¼€ç›¸æœºç­‰ï¼Œï¼ˆè¿˜æœ‰æ‰‹æœºæ²¡æœ‰é‚®ä»¶ã€çŸ­ä¿¡appï¼Ÿå½“ç„¶æœ‰äº†ï¼ï¼‰å¦‚æœä¸å¯¹è¿™ä¸ªå¼‚å¸¸è¿›è¡Œå¤„ç†çš„è¯ï¼Œåº”ç”¨å°±ä¼šç›´æ¥Crashã€‚</p>
<pre><code>Uri uri = Uri.parse(&quot;market://details?id=&quot;+getPackageName());
Intent intent = new Intent(Intent.ACTION_VIEW,uri);
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent);
</code></pre><p>è¿™ä¸ªå¼‚å¸¸åœ¨å¼€å‘ç®€å•ç¿»è¯‘çš„è¿‡ç¨‹å°±æ›¾ç»é‡åˆ°è¿‡ã€‚</p>
<ul>
<li><p>æ–¹æ³•1: æœ€ä½³è§£å†³æ–¹æ¡ˆâ€“&gt;åœ¨å‘å‡ºè¿™ä¸ªéšå¼Intentä¹‹å‰è°ƒç”¨resolveActivityåšæ£€æŸ¥</p>
<pre><code>Intent intent = new Intent(Intent.ACTION_XXX);
ComponentName componentName = intent.resolveActivity(getPackageManager());
if(componentName != null) {
String className = componentName.getClassName();
}
</code></pre></li>
<li><p>æ–¹æ³•2ï¼šä½¿ç”¨try-catchæ•è·è¿™ä¸ªå¼‚å¸¸ã€‚</p>
<pre><code>try{
// to start a mail activity code
} catch (android.content.ActivityNotFoundException ex){
// catch Exception
Snackbar.make(view, &quot;No mail app found&quot;,Snackbar.LENGTH_SHORT).show();
}
</code></pre></li>
</ul>
<p>2.WebViewæ— å›¾æ¨¡å¼çš„å®ç°</p>
<p>Android WebViewä¸­å®ç°äº†ä¸€ä¸ªæ–¹æ³•</p>
<pre><code>webView.getSettings().setBlockNetworkImage(boolean config)
</code></pre><p>å®˜æ–¹æ–‡æ¡£è§£é‡Šä¸ºï¼š</p>
<pre><code>Gets whether the WebView does not load image resources from the network.
</code></pre><p>å½“configä¸ºtrueæ—¶ï¼Œä¸åŠ è½½å›¾ç‰‡ï¼Œåä¹‹åŠ è½½å›¾ç‰‡ï¼Œè€Œä¸”æ˜¯å½“urlåŠ è½½å®Œæˆæ—¶æ‰å¼€å§‹åŠ è½½ã€‚</p>
<p>3.æ¥å£å®ç°RecyclerView itemçš„ç‚¹å‡»äº‹ä»¶<br>RecyclerViewæ˜¯Googleåœ¨v7åŒ…ä¸­æ–°å¢çš„ä¸€ç§æ§ä»¶ï¼Œç”¨äºä»£æ›¿ListView,ä¸è¿‡å®ƒå¹¶æ²¡æœ‰åŸºæœ¬çš„ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±ä¸ºitemå®šä¹‰ç‚¹å‡»äº‹ä»¶ã€‚</p>
<p>é¦–å…ˆéœ€è¦è‡ªå®šä¹‰æ¥å£</p>
<pre><code>public interface OnRecyclerViewOnClickListener {
    void OnItemClick(View v,int position);
}
</code></pre><p>åœ¨é€‚é…å™¨ä¸­å®šä¹‰æ¥å£å˜é‡</p>
<pre><code>private OnRecyclerViewOnClickListener mListener;
</code></pre><p>æš´éœ²æ¥å£</p>
<pre><code>public void setItemClickListener(OnRecyclerViewOnClickListener listener){
    this.mListener = listener;
}
</code></pre><p>ç„¶ååœ¨onCreateViewHolderä¸­æ³¨å†Œç‚¹å‡»äº‹ä»¶</p>
<pre><code>@Override
public LatestItemViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
    View view = inflater.inflate(R.layout.latest_item_layout,parent,false);
    LatestItemViewHolder holder = new LatestItemViewHolder(view,mListener);
    return holder;
}
</code></pre><p>åœ¨ViewHolderä¸­è®¾ç½®</p>
<pre><code>public class LatestItemViewHolder extends RecyclerView.ViewHolder implements View.OnClickListener {
    private OnRecyclerViewOnClickListener listener;
    private CardView item;

    public LatestItemViewHolder(View itemView,OnRecyclerViewOnClickListener listener) {
        super(itemView);

        item = (CardView) itemView.findViewById(R.id.card_view_item);
        this.listener = listener;
        itemView.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) {
        if (listener != null){
            listener.OnItemClick(v,getLayoutPosition());
        }
    }
}
</code></pre><p>åœ¨Activityæˆ–è€…Fragmentä¸­ä½¿ç”¨</p>
<pre><code>adapter = new LatestPostAdapter(getActivity(),list);
rvLatestNews.setAdapter(adapter);
adapter.setItemClickListener(new OnRecyclerViewOnClickListener() {
    @Override
    public void OnItemClick(View v, int position) {
        // write code
    }
});
</code></pre><p>4.æ¨ªå±ä¸‹Crash<br>ç”±äºåœ¨fragmentä¸­ä½¿ç”¨äº†RecyclerViewï¼Œå½“ç„¶ä¹Ÿå°±æ¶‰åŠåˆ°äº†Adapoterçš„ä½¿ç”¨ã€‚ç”±äºæˆ‘åœ¨Adapterçš„æ„é€ å‡½æ•°ä¸­ä¼ å…¥äº†Context,è¿™ç›´æ¥å¯¼è‡´äº†æ¨ªå±ä¸‹ç›´æ¥å´©æºƒã€‚</p>
<pre><code>public class LatestPostAdapter extends RecyclerView.Adapter&lt;LatestPostAdapter.LatestItemViewHolder&gt; {
// some code
public LatestPostAdapter(Context context, List&lt;LatestPost&gt; list){
      this.context = context;
      this.list = list;
      this.inflater = LayoutInflater.from(context);
  }
}
</code></pre><p>æˆ‘ä»¬ä¸åº”è¯¥ä¿å­˜é‚£äº›ä¾èµ–Activityçš„æ•°æ®ï¼Œæ¯”å¦‚Drawableï¼ŒAdapterï¼ŒViewæˆ–è€…ä»»ä½•ä¸Contextç›¸å…³è”çš„æ•°æ®ã€‚å› ä¸ºä¸Šä¸€ä¸ªActivityå·²ç»æ²¡æœ‰äº†ï¼Œå¦‚æœä½ è¿˜è¦ä¿æŒè¿™äº›èµ„æºçš„å¼•ç”¨ï¼Œå¯èƒ½å¯¼è‡´èµ„æºæ³„éœ²ã€‚</p>
<p>è§£å†³çš„æ–¹æ³•</p>
<ul>
<li>1.ç®€å•ç²—æš´å‹ ç›´æ¥ç¦æ­¢æ¨ªå±ï¼Œå½“ç„¶è¿™åªæ˜¯é€‚ç”¨äºæå°‘æ•°çš„æƒ…å†µã€‚å¯ä»¥åœ¨manifestæ–‡ä»¶ä¸­å¯¹åº”çš„activityé…ç½®ï¼š</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">android:screenOrientation="portrait"</div><div class="line">android:screenOrientation="landscape"</div></pre></td></tr></table></figure>
<p>æˆ–è€…åœ¨Javaä»£ç ä¸­å¤„ç†</p>
<pre><code>setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);  
</code></pre><ul>
<li><p>2.åœ¨æ¨ªå±æ—¶åšç›¸åº”çš„å¤„ç†ã€‚<br>é¦–å…ˆåœ¨manifest.xmlæ–‡ä»¶ä¸­é…ç½®å±å¹•æ–¹å‘æ”¹å˜æ—¶ä¸éœ€è¦é‡æ–°è½½å…¥ã€‚</p>
  <!--configChangeså‚æ•°çš„ä½œç”¨æ˜¯ä¸è®©activityé‡å¯
  3.2ä¹‹å‰çš„sdkåªéœ€è¦é…ç½®å‰é¢ä¸¤ä¸ªå€¼:keyboardHidden|orientation
  3.2ä¹‹åçš„sdkå¿…é¡»é…ç½®ä¸‰ä¸ªå€¼keyboardHidden|orientation|screensize
  -->
  <activity android:name=".UI.Activities.MainActivity" android:label="@string/app_name" android:configchanges="keyboardHidden|orientation|screenSize" android:theme="@style/AppTheme.NoActionBar">

</activity></li>
</ul>
<p>ç„¶ååœ¨activityä¸­é‡å†™æ–¹æ³•</p>
<pre><code>@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
}
</code></pre><p>5.toolbarä¸­å°ç®­å¤´(è¿”å›ä¸Šçº§activity)<br>å¥½å§ï¼Œè¿™æ˜¯ä¸ªä¸ç®—é«˜çº§çš„é—®é¢˜ï¼Œä½†æ˜¯ç¡®å®å›°æ‰°äº†æˆ‘ä¸€æ®µæ—¶é—´ã€‚é¦–å…ˆæ˜¯æ€æ ·æ˜¾ç¤ºè¿™ä¸ªç®­å¤´ã€‚</p>
<pre><code>private Toolbar toolbar;
toolbar = (Toolbar) findViewById(R.id.toolbar);
setSupportActionBar(toolbar);
// å…³é”®
getSupportActionBar().setDisplayHomeAsUpEnabled(true);
</code></pre><p>æ€æ ·ç›‘å¬å°ç®­å¤´çš„ç‚¹å‡»äº‹ä»¶å‘¢ï¼Ÿ</p>
<p>ç”±äºç®­å¤´æ˜¯ä½äºtoolbarä¸­çš„æ§ä»¶ï¼Œå¯ä»¥è”æƒ³åˆ°åº”è¯¥æ˜¯å’ŒonOptionsItemSelectedæ–¹æ³•æœ‰å…³ã€‚</p>
<pre><code>@Override
public boolean onOptionsItemSelected(MenuItem item) {

   int id = item.getItemId();

   // å°ç®­å¤´çš„idä¸ºandroid.R.id.home
   if (id == android.R.id.home){
       onBackPressed();
   }

   return super.onOptionsItemSelected(item);
 }
</code></pre>]]></content>
    </entry>
    
  
  
</search>
