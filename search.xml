<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[Make android app barcode and QR code aware]]></title>
      <url>http://tonnyl.github.io/2017/04/11/Make-android-app-barcode-and-QR-code-aware/</url>
      <content type="html"><![CDATA[<p>In this tutorial, we will carry out the barcode and QR code scanning within our app using ZXing library.<br><a id="more"></a></p>
<h1 id="Make-android-application-barcode-and-QR-code-aware"><a href="#Make-android-application-barcode-and-QR-code-aware" class="headerlink" title="Make android application barcode and QR code aware"></a>Make android application barcode and QR code aware</h1><p>In this tutorial, we will carry out the barcode and QR code scanning within our app using ZXing library.</p>
<h2 id="Why-ZXing"><a href="#Why-ZXing" class="headerlink" title="Why ZXing"></a>Why ZXing</h2><p>Here are the several ways to carry out this function below:</p>
<ul>
<li>Using Google Play Service and the <a href="https://developers.google.com/vision/" target="_blank" rel="external">Mobile Vision APIs</a>.</li>
<li>Using <a href="https://github.com/dm77/barcodescanner" target="_blank" rel="external">barcodescanner</a> library.</li>
<li>Using <a href="https://github.com/zxing/zxing" target="_blank" rel="external">ZXing</a> library.</li>
</ul>
<p>Letâ€™s analyze the positive and negative points of the 3 ways above.</p>
<ul>
<li>The first one, using Google Play Service and the Mobile Vision APIs is not suitable, because not every user has installed the Google Play Service on his devices especially in China.</li>
<li>The second one, using barcodescanner library is not suitable either. Though the integration of it is simple and it is fast, the adjustment of UI is not easy. Particularly when the UI is much complex, you need to pull down the source code and custom it by yourself.</li>
<li>Then only the ZXing left. The ZXing library is produced by Google, so it will not be abandoned in a short time. Many apps including the barcodescanner are based on it. Using ZXing library, we do not need to worry about users without Google Play Service installed, and we can make user scans easier and faster, and focus our development on handling the results.</li>
</ul>
<h2 id="What-is-ZXing"><a href="#What-is-ZXing" class="headerlink" title="What is ZXing"></a>What is ZXing</h2><blockquote>
<p>ZXing (â€œzebra crossingâ€) is an open-source, multi-format 1D/2D barcode image processing library implemented in Java, with ports to other languages.</p>
</blockquote>
<h2 id="Set-up-the-project"><a href="#Set-up-the-project" class="headerlink" title="Set up the project"></a>Set up the project</h2><h3 id="Add-the-dependences"><a href="#Add-the-dependences" class="headerlink" title="Add the dependences"></a>Add the dependences</h3><p>In your build.gradle file(<strong>App module level</strong>), add the <code>ZXing core</code> library to it.</p>
<pre><code class="groovy">dependencies {
    compile fileTree(include: [&#39;*.jar&#39;], dir: &#39;libs&#39;)
    // Other dependencies here...
    compile &#39;com.google.zxing:core:3.3.0&#39;
    testCompile &#39;junit:junit:4.12&#39;
}
</code></pre>
<h3 id="Ask-the-required-permissions"><a href="#Ask-the-required-permissions" class="headerlink" title="Ask the required permissions"></a>Ask the required permissions</h3><p>In your <code>AndroidManifest.xml</code> file, add the code below.</p>
<pre><code class="xml">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    package=&quot;io.github.marktony.espresso&quot;&gt;

    &lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.VIBRATE&quot; /&gt;

     &lt;application ...
</code></pre>
<h3 id="Import-the-needed-class-and-resource-files"><a href="#Import-the-needed-class-and-resource-files" class="headerlink" title="Import the needed class and resource files"></a>Import the needed class and resource files</h3><p>Copy <a href="https://github.com/TonnyL/Espresso/tree/master/mobile/src/main/java/io/github/marktony/espresso/zxing" target="_blank" rel="external">the whole package</a> to your project.</p>
<p><img src="http://ww4.sinaimg.cn/large/006tKfTcgy1feizatturkj30ki0us76v.jpg" alt=""></p>
<p><strong>Notice</strong>: I have simplified the classes and code in the package above, if you need the complete package, visit the <a href="https://github.com/zxing/zxing/tree/master/android" target="_blank" rel="external">ZXing samples</a> here and download the corresponding code.</p>
<p>After import the code, we need to add the resource files below.</p>
<ul>
<li><a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/res/layout/activity_scan.xml" target="_blank" rel="external"><code>res/layout/activity_scan</code></a> - The layout file of <a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/java/io/github/marktony/espresso/zxing/CaptureActivity.java" target="_blank" rel="external">CaptureActivity</a>.</li>
<li><a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/res/values/zxing_ids.xml" target="_blank" rel="external"><code>res/values/zxing_ids.xml</code></a> - The collection of zxing ids.</li>
<li><a href="https://github.com/TonnyL/Espresso/tree/master/mobile/src/main/res/raw" target="_blank" rel="external"><code>res/raw/beep.ogg</code></a> - The sound that app will make when recognize the code successfully.</li>
<li><a href="https://github.com/TonnyL/Espresso/tree/master/mobile/src/main/res/drawable" target="_blank" rel="external"><code>res/drawable/...</code></a> - Three files in total: <a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/res/drawable/scan_line.png" target="_blank" rel="external">scan_line.png</a>, <a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/res/drawable/qr_code_bg.9.png" target="_blank" rel="external">qr_code_bg.9.png</a>, <a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/res/drawable/shadow.png" target="_blank" rel="external">shadow.png</a>.</li>
</ul>
<h2 id="Wrap-it-up"><a href="#Wrap-it-up" class="headerlink" title="Wrap it up"></a>Wrap it up</h2><p>Now we start the <code>CaptureActivity</code> from <code>MainActivity</code> and expect a result by:</p>
<pre><code class="java">public class MainActivity extends AppCompatActivity {

    public final static int SCANNING_REQUEST_CODE = 1;

    private TextView textView;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        textView = (TextView) findViewById(R.id.textView);

        textView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(MainActivity.this, CaptureActivity.class);
                intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivityForResult(intent, SCANNING_REQUEST_CODE);
            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        switch (requestCode) {
            case SCANNING_REQUEST_CODE:
                if (resultCode == RESULT_OK) {
                    final Bundle bundle = data.getExtras();
                    Handler handler = new Handler(Looper.getMainLooper());
                    handler.post(new Runnable() {
                        @Override
                        public void run() {
                            textView.setText(bundle.getString(&quot;result&quot;));
                        }
                    });
                }
                break;
            default:
                break;
        }
    }
}
</code></pre>
<p>We take care of the result in function <code>onActivityResult()</code>.</p>
<p>Notice: If your target api level is 23 or higher, <strong>DO NOT</strong> forget adapt the runtime permissions because our app need to use the camera.<br>Tip: As you can see in my source code, I did not launch the <code>CaptureActivity</code> in <code>AddPackageFragment</code> instead of <code>MainActivity</code>, so it is a little bit different to the code above.</p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><p>Now we can test our app if it works well. Go to <a href="http://www.qr-code-generator.com/" target="_blank" rel="external">qr-code-generator.com</a> and test it. We should expect something just this:</p>
<p><img src="http://ww2.sinaimg.cn/large/006tKfTcgy1fej415g8dej30u00hs7ca.jpg" alt=""></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this tutorial, we have run through the process of facilitating barcode and QR code scanning within Android apps using the ZXing library. In your own apps, you might want to carry out further processing on the retrieved scan results, such as loading URLs or looking the data up in a third party data source.</p>
<p>You can download the complete source code of <a href="https://github.com/TonnyL/Espresso" target="_blank" rel="external">Espresso</a>, it is an express delivery tracking app designed with Material Design style, built on MVP(Model-View-Presenter) architecture with RxJava2, Retrofit2, Realm database and ZXing.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/zxing/zxing" target="_blank" rel="external">ZXing</a> - Official ZXing (â€œZebra Crossingâ€) project home.</p>
<h2 id="Contact"><a href="#Contact" class="headerlink" title="Contact"></a>Contact</h2><p>If you have any problem about this article or the Espresso project, contact me on:</p>
<p>Slack: <a href="https://androiddevsslack.slack.com" target="_blank" rel="external">https://androiddevsslack.slack.com</a></p>
<p>GitHub: <a href="https://github.com/TonnyL" target="_blank" rel="external">https://github.com/TonnyL</a></p>
<p>Medium: <a href="https://medium.com/@TonnyL" target="_blank" rel="external">https://medium.com/@TonnyL</a></p>
<p>Twitter: <a href="https://twitter.com/TonnyLZTL" target="_blank" rel="external">https://twitter.com/TonnyLZTL</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Realm(Java)çš„é‚£äº›äº‹]]></title>
      <url>http://tonnyl.github.io/2017/04/03/Realm-Java-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</url>
      <content type="html"><![CDATA[<p>Realm:Create reactive mobile apps in a fraction of time.<br><a id="more"></a></p>
<p><img src="https://ww4.sinaimg.cn/large/006tNc79gy1fe9omgy5jxj30xc0hfabm.jpg" alt="Realm"></p>
<h2 id="ä»€ä¹ˆæ˜¯Realm"><a href="#ä»€ä¹ˆæ˜¯Realm" class="headerlink" title="ä»€ä¹ˆæ˜¯Realm?"></a>ä»€ä¹ˆæ˜¯Realm?</h2><p>åœ¨Androidå¹³å°ä¸Šï¼Œæœ‰å¾ˆå¤šåŸºäºSQLiteçš„ORMæ¡†æ¶ï¼Œä¾‹å¦‚<a href="http://greenrobot.org/greendao/" target="_blank" rel="external">GreenDAO</a>,  <a href="http://ormlite.com/" target="_blank" rel="external">OrmLite</a>, <a href="http://satyan.github.io/sugar/" target="_blank" rel="external">SugarORM</a>, <a href="https://github.com/LitePalFramework/LitePal" target="_blank" rel="external">LitePal</a>ç­‰ç­‰ï¼Œå¯¹äºå†™ä¹ æƒ¯äº†SQLè¯­å¥çš„å°ä¼™ä¼´ä»¬æ¥è¯´ï¼Œçœ‹åˆ°SQLiteè¿™æ ·çš„æ•°æ®åº“è‚¯å®šæ˜¯å€æ„Ÿäº²åˆ‡äº†ï¼Œæœ‰äº†è¿™äº›æ¡†æ¶æ›´æ˜¯å¦‚è™æ·»ç¿¼ã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘ä»¬æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œæ•°æ®é‡å¹¶ä¸ä¼šç‰¹åˆ«çš„å¤§ï¼Œè¡¨çš„ç»“æ„ä¹Ÿä¸ä¼šç‰¹åˆ«å¤æ‚ï¼Œç”¨SQLè¯­å¥æœ‰ç§å¤§(è¿‡)æ(äº)å°(ç¹)ç”¨(ç)çš„æ„Ÿè§‰ï¼Œæˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…å¯èƒ½ä»…ä»…æ˜¯æŠŠç”¨æˆ·ç”Ÿæˆçš„æ•°æ®å¯¹è±¡å¿«é€Ÿçš„ç¼“å­˜èµ·æ¥ã€‚è¿™ä¸ªæ—¶å€™NoSQLå°±æ´¾ä¸Šäº†ç”¨åœºï¼Œä»¥Mongodbï¼ŒRedisä¸ºä»£è¡¨çš„NoSQLéƒ½å¼•å…¥äº†ä¸€äº›ç›¸å¯¹ç°ä»£åŒ–çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œæ¯”å¦‚æ”¯æŒJsonï¼ŒDocumentçš„æ¦‚å¿µï¼Œæµå¼apiï¼Œæ•°æ®å˜æ›´é€šçŸ¥ç­‰ç­‰ï¼Œæå¤§ç¨‹åº¦çš„é™ä½äº†æˆ‘ä»¬å­¦ä¹ çš„æˆæœ¬æé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚è€ŒRealmä½œä¸ºä¸€æ¬¾ç§»åŠ¨ç«¯çš„NoSQLæ¡†æ¶ï¼Œå®˜æ–¹å®šä½å°±æ˜¯æ›¿ä»£SQLiteç­‰å…³ç³»å‹æ•°æ®åº“ã€‚</p>
<p>Realmæ˜¯ä¸€ä¸ªç”±Y Combinatorå­µåŒ–çš„åˆ›ä¸šå›¢é˜Ÿå¼€æºå‡ºæ¥çš„MVCC(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)çš„æ•°æ®åº“ï¼Œæ”¯æŒè¿è¡Œåœ¨æ‰‹æœºï¼Œå¹³æ¿å’Œå¯ç©¿æˆ´è®¾å¤‡ç­‰åµŒå…¥å¼è®¾å¤‡ä¸Šã€‚</p>
<h2 id="Realmçš„ä¼˜ç‚¹"><a href="#Realmçš„ä¼˜ç‚¹" class="headerlink" title="Realmçš„ä¼˜ç‚¹"></a>Realmçš„ä¼˜ç‚¹</h2><ul>
<li><a href="#ç®€å•æ˜“ç”¨">ç®€å•æ˜“ç”¨</a></li>
<li><a href="#é€Ÿåº¦å¿«">é€Ÿåº¦å¿«</a></li>
<li><a href="#è·¨å¹³å°">è·¨å¹³å°</a></li>
<li><a href="#é«˜çº§åŠŸèƒ½">é«˜çº§åŠŸèƒ½</a></li>
<li><a href="#å¯è§†åŒ–">å¯è§†åŒ–</a></li>
<li><a href="#å¼€æº">å¼€æº</a></li>
</ul>
<h3 id="ç®€å•æ˜“ç”¨"><a href="#ç®€å•æ˜“ç”¨" class="headerlink" title="ç®€å•æ˜“ç”¨"></a>ç®€å•æ˜“ç”¨</h3><p>ä¸Šé¢æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼ŒRealmå¹¶ä¸æ˜¯åŸºäºSQLiteä¸Šçš„ORMï¼Œå®ƒæœ‰è‡ªå·±çš„æ•°æ®åº“å¼•æ“ï¼Œä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸€æ®µç®€å•çš„ä»£ç ã€‚</p>
<pre><code class="java">// é€šè¿‡ç»§æ‰¿å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„modelç±»
public class Dog extends RealmObject {
    private String name;
    private int age;

    // ... ç”Ÿæˆ getter å’Œ setter ...
}

public class Person extends RealmObject {
    @PrimaryKey
    private long id;
    private String name;
    private RealmList&lt;Dog&gt; dogs; // ç”Ÿå‘½ä¸€å¯¹å¤šçš„å…³ç³»

    // ... ç”Ÿæˆ getter å’Œ setter ...
}

// åƒæ™®é€šçš„Javaå¯¹è±¡ä¸€æ ·ä½¿ç”¨ä»–ä»¬
Dog dog = new Dog();
dog.setName(&quot;Rex&quot;);
dog.setAge(1);

// åˆå§‹åŒ–Realm
Realm.init(context);

// åœ¨å½“å‰çº¿ç¨‹ä¸‹è·å–Realmå®ä¾‹
Realm realm = Realm.getDefaultInstance();

// æŸ¥è¯¢Realmä¸­æ‰€æœ‰å¹´é¾„å°äº2å²çš„ç‹—ç‹—
final RealmResults&lt;Dog&gt; puppies = realm.where(Dog.class).lessThan(&quot;age&quot;, 2).findAll();
puppies.size(); // =&gt; 0 å› ä¸ºç°åœ¨è¿˜æ²¡æœ‰ç‹—ç‹—æ·»åŠ åˆ°Realmä¸­

// åœ¨äº‹ç‰©ä¸­æŒä¹…åŒ–ä½ çš„æ•°æ®
realm.beginTransaction();
final Dog managedDog = realm.copyToRealm(dog);
Person person = realm.createObject(Person.class);  
person.getDogs().add(managedDog);
realm.commitTransaction();

// å½“æ•°æ®æ”¹å˜åï¼ŒListenerä¼šè¢«é€šçŸ¥
puppies.addChangeListener(new RealmChangeListener&lt;RealmResults&lt;Dog&gt;&gt;() {
    @Override
    public void onChange(RealmResults&lt;Dog&gt; results) {
        // æŸ¥è¯¢ç»“æœä¼šè¢«å®æ—¶æ›´æ–°
        puppies.size(); // =&gt; 1
    }
});

// åœ¨åå°çº¿ç¨‹ä¸­å¼‚æ­¥åœ°æ›´æ–°å¯¹è±¡
realm.executeTransactionAsync(new Realm.Transaction() {
    @Override
    public void execute(Realm bgRealm) {
        Dog dog = bgRealm.where(Dog.class).equalTo(&quot;age&quot;, 1).findFirst();
        dog.setAge(3);
    }
}, new Realm.Transaction.OnSuccess() {
    @Override
    public void onSuccess() {

      // Realmå¯¹è±¡ä¼šè¢«è‡ªåŠ¨åœ°æ›´æ–°
        puppies.size(); // =&gt; 0 å› ä¸ºæ²¡æœ‰å°ç‹—ç‹—çš„å¹´é¾„å°äºä¸¤å²
        managedDog.getAge();   // =&gt; 3 ç‹—ç‹—çš„å¹´é¾„å·²ç»è¢«æ›´æ–°äº†
    }
});
</code></pre>
<h3 id="é€Ÿåº¦å¿«"><a href="#é€Ÿåº¦å¿«" class="headerlink" title="é€Ÿåº¦å¿«"></a>é€Ÿåº¦å¿«</h3><p>æˆ‘ä»¬ç›´æ¥çœ‹Realmå®˜æ–¹çš„å¯¹æ¯”æµ‹è¯•æ•°æ®å§ã€‚</p>
<p>æ¯ç§’èƒ½åœ¨200Kæ•°æ®è®°å½•ä¸­è¿›è¡ŒæŸ¥è¯¢åcountçš„æ¬¡æ•°: Realmèƒ½å¤Ÿè¾¾åˆ°30.9æ¬¡ï¼Œè€ŒSQLiteåªèƒ½è¾¾åˆ°13.6æ¬¡ï¼ŒCore Dataåªèƒ½è¾¾åˆ°å¯æ€œçš„ä¸€æ¬¡ã€‚<br><img src="https://ww4.sinaimg.cn/large/006tNc79gy1fe9omypcycj30qe0g0gma.jpg" alt="Record of counts"></p>
<p>åœ¨200Kæ¡æ•°æ®è®°å½•è¿›è¡Œä¸€æ¬¡éå†æŸ¥è¯¢ï¼Œæ•°æ®å’Œå‰é¢çš„countç›¸ä¼¼: Realmèƒ½å¤Ÿè¾¾åˆ°æ¯ç§’éå†200Kæ•°æ®è®°å½•31æ¬¡ï¼ŒSQLiteåªèƒ½è¾¾åˆ°14æ¬¡ï¼Œè€ŒCore Dataåªæœ‰å¯æ€œçš„2æ¬¡ã€‚<br><img src="https://ww3.sinaimg.cn/large/006tNc79gy1fe9onmh6bqj30qe0g0wf5.jpg" alt="Record of queries"></p>
<p>åœ¨ä¸€æ¬¡äº‹ç‰©ä¸­æ¯ç§’æ’å…¥æ•°æ®é‡çš„å¯¹æ¯”ï¼ŒSQLiteå¯ä»¥è¾¾åˆ°178Kæ¡è®°å½•ï¼Œæ€§èƒ½æœ€å¥½ï¼ŒRealmå¯ä»¥è¾¾åˆ°94Kï¼Œè€ŒCore Dataå†æ¬¡å«åº•ï¼Œåªæœ‰18Kã€‚<br><img src="https://ww3.sinaimg.cn/large/006tNc79gy1fe9onv5dvuj30qe0g0754.jpg" alt="Record of inserts"></p>
<p>æˆ‘è‡ªå·±ä¹Ÿè¿›è¡Œä¸€æ¬¡ç®€å•çš„æµ‹è¯•ï¼Œä»¥JSONæ ¼å¼æ’å…¥641æ¡è®°å½•(å¥½å§ï¼Œæˆ‘çŸ¥é“æ•°æ®é‡æ¯”è¾ƒå°ï¼Œä»…ä»…åªæ˜¯ä¸€ä¸ªå‚è€ƒï¼Œå…·ä½“çš„æ•°æ®å¯ä»¥å‚è€ƒ<a href="https://github.com/TonnyL/Espresso/blob/master/mobile/src/main/java/io/github/marktony/espresso/data/source/local/CompaniesLocalDataSource.java" target="_blank" rel="external">è¿™é‡Œ</a>)ã€‚</p>
<pre><code>04-03 19:06:13.837 11090-11245/io.github.marktony.espresso D/TAG: 1491217573837

04-03 19:06:14.044 11090-11245/io.github.marktony.espresso D/TAG: 1491217574044
</code></pre><p><img src="https://ww2.sinaimg.cn/large/006tNc79gy1fe9p947u3yj30vw02g0tc.jpg" alt="My Record"><br>207æ¯«ç§’(Android 7.1.1, Realm 3.0)ã€‚</p>
<h3 id="è·¨å¹³å°"><a href="#è·¨å¹³å°" class="headerlink" title="è·¨å¹³å°"></a>è·¨å¹³å°</h3><p>Realmç›®å‰æ”¯æŒObjective-C(iOS), Swift(iOS), Java(Android), JavaScript, Xamarinç­‰å¹³å°ã€‚</p>
<p>ç°åœ¨å¾ˆå¤šåº”ç”¨éƒ½éœ€è¦å…¼é¡¾iOSå’ŒAndroidä¸¤ä¸ªå¹³å°ï¼Œä½¿ç”¨Realmå¯ä»¥ä½¿ç”¨Realmæä¾›çš„APIï¼Œåœ¨æ•°æ®æŒä¹…åŒ–å±‚å®ç°ä¸¤ä¸ªå¹³å°çš„æ— å·®å¼‚åŒ–ç§»æ¤ï¼Œæ— éœ€å¯¹å†…éƒ¨æ•°æ®çš„æ¶æ„è¿›è¡Œæ”¹åŠ¨ã€‚</p>
<h3 id="é«˜çº§åŠŸèƒ½"><a href="#é«˜çº§åŠŸèƒ½" class="headerlink" title="é«˜çº§åŠŸèƒ½"></a>é«˜çº§åŠŸèƒ½</h3><p>Realmæ”¯æŒåŠ å¯†ï¼Œæ ¼å¼åŒ–æŸ¥è¯¢ï¼Œæµå¼APIï¼ŒJSONï¼Œæ•°æ®å˜æ›´é€šçŸ¥ç­‰ç­‰ã€‚</p>
<h3 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h3><p>Realmå®˜æ–¹æä¾›äº†ä¸€ä¸ªåä¸ºã€Œ<a href="https://itunes.apple.com/us/app/realm-browser/id1007457278?mt=12" target="_blank" rel="external">Realm Browser</a>ã€è½»é‡çº§çš„æ•°æ®åº“æŸ¥çœ‹å·¥å…·(ç›®å‰è¿˜åªæ”¯æŒmacOSå¹³å°)ï¼Œåˆ©ç”¨Realm Browseræˆ‘ä»¬å¯ä»¥è¿›è¡Œç®€å•çš„æ’å…¥ï¼Œåˆ é™¤ç­‰åŸºæœ¬æ“ä½œã€‚<br><img src="https://ww3.sinaimg.cn/large/006tNc79gy1fe9q6fqk7nj31kw0uth2j.jpg" alt="Realm Browser"></p>
<p>ç¬¬ä¸‰æ–¹å¼€å‘è€…ä¹Ÿæä¾›äº†ä¸€äº›ç§»åŠ¨ç«¯çš„æ•°æ®åº“æŸ¥çœ‹å·¥å…·ï¼Œä¾‹å¦‚ï¼š</p>
<p><a href="https://github.com/jonasrottmann/realm-browser" target="_blank" rel="external">Realm Browser by Jonas Rottmann (Android)</a></p>
<p><img src="https://ww3.sinaimg.cn/large/006tNc79gy1fe9rb6igm3j30u00zkq73.jpg" alt="Realm Browser by Jonas Rottmann (Android)"></p>
<p><a href="https://github.com/bearjaw/RBSRealmBrowser" target="_blank" rel="external">ealm Browser by Max Baumbach (iOS)</a></p>
<p><img src="https://ww2.sinaimg.cn/large/006tNc79gy1fe9rfz16e0g30ai0iub2a.gif" alt="Realm Browser by Max Baumbach (iOS)"></p>
<h3 id="å¼€æº"><a href="#å¼€æº" class="headerlink" title="å¼€æº"></a>å¼€æº</h3><p><a href="https://github.com/realm" target="_blank" rel="external">Realm</a>å·²ç»å°†<a href="https://github.com/realm/realm-core" target="_blank" rel="external">Realm Core</a>, <a href="https://github.com/realm/realm-java" target="_blank" rel="external">Realm Java</a>ï¼Œ<a href="https://github.com/realm/realm-cocoa" target="_blank" rel="external">Realm Cocoa</a>, <a href="https://github.com/realm/realm-js" target="_blank" rel="external">Realm JS</a>, <a href="https://github.com/realm/realm-dotnet" target="_blank" rel="external">Realm Dotnet</a>ç­‰ç­‰é¡¹ç›®å¼€æºï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œä½ å¯ä»¥å‘Realmå›¢é˜Ÿæbugï¼Œæå»ºè®®ç­‰ç­‰ï¼Œå’ŒRealmå›¢é˜Ÿä¸€èµ·è§è¯Realmçš„æˆé•¿ã€‚</p>
<p>å¦å¤–ï¼Œè¿˜æœ‰ä¸€ç‚¹ä¸€å®šè¦è¯´æ˜çš„æ˜¯ï¼ŒRealmå›¢é˜Ÿçš„<a href="https://realm.io/cn/news/" target="_blank" rel="external">åšå®¢</a>ï¼Œå¹²è´§æ»¡æ»¡ï¼Œè€Œä¸”éƒ½æœ‰ä¸­æ–‡ç¿»è¯‘å“¦~</p>
<h2 id="Realmçš„ä¸è¶³"><a href="#Realmçš„ä¸è¶³" class="headerlink" title="Realmçš„ä¸è¶³"></a>Realmçš„ä¸è¶³</h2><p>è¯´å®Œäº†ä¼˜ç‚¹ï¼Œè‡ªç„¶è¿˜è¦è¯´è¯´ä¸è¶³çš„åœ°æ–¹ã€‚</p>
<ul>
<li><a href="#ä½“ç§¯">ä½“ç§¯</a></li>
<li><a href="#æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></li>
<li><a href="#çº¿ç¨‹é™åˆ¶">çº¿ç¨‹é™åˆ¶</a></li>
</ul>
<h3 id="ä½“ç§¯"><a href="#ä½“ç§¯" class="headerlink" title="ä½“ç§¯"></a>ä½“ç§¯</h3><p>å¼•å…¥Realmä¹‹åï¼Œåœ¨ä¸åšä»»ä½•å¤„ç†çš„æƒ…å†µä¸‹ï¼ŒAPKä½“ç§¯å¢å¤§äº†ä¸€ä¸ªéå¸¸ææ€–çš„æ•°å­— <strong>5.6M</strong>ï¼Œä½ æ²¡æœ‰çœ‹é”™ï¼Œæ˜¯5.6å…† <del>(5.6Mæ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Œå››èˆäº”å…¥å°±æ˜¯10Mï¼Œåœ¨å››èˆäº”å…¥å°±æ˜¯100Må•Š)</del>ã€‚ç›´æ¥çœ‹å›¾å§ã€‚</p>
<p><img src="https://ww4.sinaimg.cn/large/006tNc79gy1fe9t6n20c4j30ky0yqn2w.jpg" alt="APK size before implementing Realm"></p>
<p><img src="https://ww1.sinaimg.cn/large/006tNc79gy1fe9t7ajo6lj30ky0yqn2u.jpg" alt="APK size using default configuration"></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®<code>build.gradle</code>çš„splitï¼Œæ ¹æ®ä¸åŒçš„è®¾å¤‡ç±»å‹å¯¹APKè¿›è¡Œæ‹†åˆ†ï¼Œä»è€Œè¾¾åˆ°ç¼©å‡ä½“ç§¯çš„ç›®çš„ã€‚ä¸‹é¢æˆ‘é…ç½®äº†splitä¹‹åï¼ŒAPKä½“ç§¯çš„å˜åŒ–ã€‚</p>
<pre><code class="gradle">splits {
        // Split apks on build target ABI, view all options for the splits here:
        // http://tools.android.com/tech-docs/new-build-system/user-guide/apk-splits
        abi {
            enable true
            reset()
            include &#39;armeabi&#39;, &#39;armeabi-v7a&#39;, &#39;arm64-v8a&#39;, &#39;mips&#39;, &#39;x86&#39;, &#39;x86_64&#39;
        }
        universalApk true
}
</code></pre>
<p><img src="https://ww2.sinaimg.cn/large/006tNc79gy1fe9t7nzglwj30ky0yq44c.jpg" alt="APK size using split"></p>
<h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><ol>
<li>Realmè¦æ±‚å½“å‰Beanå¯¹è±¡å¿…é¡»ç›´æ¥ç»§æ‰¿RealmObjectï¼Œ<del>æˆ–è€…é—´æ¥å®ç°(ç›®å‰å·²ç»ä¸å†æ¨èä½¿ç”¨)</del>ï¼Œä¾µå…¥æ€§éå¸¸å¼ºã€‚</li>
<li>Realmä¸æ”¯æŒå†…éƒ¨ç±»ã€‚</li>
<li>Realmä¿®æ”¹äº†éƒ¨åˆ†æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚List â€“&gt; RealmListã€‚åœ¨å†…éƒ¨å®ç°ä¸Šï¼ŒRealmListä¸ArrayListç­‰è¿˜æ˜¯æœ‰æ¯”è¾ƒå¤§çš„åŒºåˆ«çš„ã€‚</li>
<li><p>ä½¿ç”¨RealmList<t>æ—¶ï¼Œæ³›å‹<code>T</code>ç±»å‹å¿…é¡»æ˜¯ç›´æ¥ç»§æ‰¿äº†RealmObjectçš„ç±»å‹ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ˜¯RealmList<string>ç±»å‹ï¼Œé‚£ä¹ˆä¸å¥½æ„æ€ï¼Œè¿™æ˜¯ä¸æ”¯æŒçš„ğŸ˜‚ã€‚å®˜æ–¹å»ºè®®æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ª<code>RealmString</code>ç»§æ‰¿è‡ªRealmObjectï¼Œä¾‹å¦‚ï¼š</string></t></p>
<pre><code class="java"> public class RealmString extends RealmObject {

     private String string;

     public String getString() {
         return string;
     }

     public void setString(String string) {
         this.string = string;
     }
 }
</code></pre>
</li>
<li><p>Realmæ˜¯ä¸æ”¯æŒä¸»é”®è‡ªå¢é•¿çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±ç»´æŠ¤ä¸€ä¸ª<code>PrimaryKey</code>æ¥çº¦æŸä¸»é”®ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="java"> @PrimaryKey
 private String number;
</code></pre>
<p>å¦å¤–ï¼Œå¦‚æœæ²¡æœ‰ç»™RealmObjectè®¾ç½®ä¸»é”®ï¼ŒinsertOrUpdataçš„é»˜è®¤æ“ä½œå°±æ˜¯insertï¼Œè¿™æ · å°±ä¼šå¯¼è‡´é‡å¤æ’å…¥æ•°æ®è®°å½•äº†ã€‚</p>
</li>
<li><p>Intentä¼ å€¼æ—¶ï¼Œä¹Ÿä¼šæœ‰ä¸€äº›å‘ã€‚ä¾‹å¦‚ï¼Œæˆ‘æƒ³è¦åœ¨a1ä¸­æŸ¥è¯¢æ•°æ®ï¼Œç„¶åå°†æŸ¥è¯¢ç»“æœ(RealmList)ä¼ é€’åˆ°a2ä¸­ã€‚ä¸å¥½æ„æ€ï¼ŒRealmä¸æƒ³å’Œä½ è¯´è¯ï¼Œå¹¶å‘ä½ ä¸¢äº†ä¸€ä¸ªcrashã€‚è¿™æ˜¯å› ä¸ºï¼ŒArrayListå®ç°äº†<code>Serializable</code>æ¥å£ï¼Œè€ŒRealmListå¹¶æ²¡æœ‰ã€‚å†ä¾‹å¦‚ï¼Œå¦‚æœä¸æ˜¯RealmListï¼Œè€Œæ˜¯ä¸€ä¸ªæ™®é€šçš„ç»§æ‰¿è‡ªRealmObjectå¹¶å®ç°äº†<code>Serializable</code>æ¥å£çš„å®ä½“ç±»å‘¢ï¼Ÿä¹Ÿä¸è¡Œã€‚è¿™æ˜¯å› ä¸ºï¼ŒæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å¯¹è±¡ï¼Œè€Œæ˜¯Realmåˆ©ç”¨aptå¸®æˆ‘ä»¬ç”Ÿæˆçš„å®ä½“ç±»çš„å­ç±»ï¼Œæˆ–è€…è¯´å®ä½“ç±»çš„ä»£ç†ç±»ï¼Œè€Œåœ¨Realmä¸­ï¼Œèµ·ä½œç”¨çš„å°±æ˜¯è¿™ä¸ªä»£ç†ç±»ã€‚</p>
</li>
</ol>
<p>é‚£ä¹ˆï¼Œæ€ä¹ˆè§£å†³å‘¢ï¼Ÿå®˜æ–¹çš„å»ºè®®ä¸è¦ä¼ é€’æ•´ä¸ªRealmListæˆ–è€…RealmObjectï¼Œè€Œæ˜¯ä¼ é€’å¯¹è±¡çš„æ ‡è¯†ç¬¦ï¼Œç„¶ååœ¨æ¥æ”¶æ–¹(Activity, Service, BroadcastReceiverç­‰ç­‰)è§£æå‡ºè¿™ä¸ªæ ‡è¯†ç¬¦ï¼Œç„¶ååˆ©ç”¨Realmå†æ¬¡æŸ¥è¯¢è·å¾—ç›¸åº”çš„ç»“æœã€‚</p>
<h3 id="çº¿ç¨‹é™åˆ¶"><a href="#çº¿ç¨‹é™åˆ¶" class="headerlink" title="çº¿ç¨‹é™åˆ¶"></a>çº¿ç¨‹é™åˆ¶</h3><p>å¦‚æœä½ åœ¨UIçº¿ç¨‹è·å–åˆ°äº†å½“å‰Realmå¯¹è±¡ï¼Œåœ¨å¼‚æ­¥çº¿ç¨‹ä¸­ä½¿ç”¨å½“å‰Realmå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸äº†ã€‚RealmObjectä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥ï¼Œå¼‚æ­¥å¾ˆé‡è¦ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨è°ƒç”¨äº†<code>Realm.close()</code>æ–¹æ³•ä¹‹åï¼Œæ‰€è·å–çš„å¯¹è±¡å°±ä¸èƒ½å†è®¿é—®äº†ï¼Œæ‰€ä»¥ï¼Œåœ¨è·å–åˆ°äº†RealmObjectä¹‹åï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ª<code>copyFromRealm</code>æ¥å¤åˆ¶ä¸€ä»½å®ä¾‹ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚</p>
<h2 id="åœ¨Androidä¸­ä½¿ç”¨Realm"><a href="#åœ¨Androidä¸­ä½¿ç”¨Realm" class="headerlink" title="åœ¨Androidä¸­ä½¿ç”¨Realm"></a>åœ¨Androidä¸­ä½¿ç”¨Realm</h2><p>çœ‹åˆ°è¿™é‡Œçš„å®¢å®˜ï¼Œåº”è¯¥å¯¹Realmæ˜¯çœŸçˆ±äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥æ­£ç»è®¨è®ºä¸€ä¸‹ï¼Œå¦‚ä½•åœ¨Androidä¸­ä½¿ç”¨Realmæ•°æ®åº“ã€‚</p>
<ul>
<li><a href="#å…ˆå†³æ¡ä»¶">å…ˆå†³æ¡ä»¶</a></li>
<li><a href="#å®‰è£…">å®‰è£…</a></li>
<li><a href="#è·å–Realmå®ä¾‹">è·å–Realmå®ä¾‹</a></li>
<li><a href="#åˆ›å»ºRealmå®ä½“">åˆ›å»ºRealmå®ä½“</a></li>
<li><a href="#å¢åˆ æ”¹æŸ¥">å¢åˆ æ”¹æŸ¥</a></li>
<li><a href="#é«˜çº§ç”¨æ³•">é«˜çº§ç”¨æ³•</a><ul>
<li><a href="#åŠ å¯†">åŠ å¯†</a></li>
<li><a href="#ä¸Androidç³»ç»Ÿç»“åˆ">ä¸Androidç³»ç»Ÿç»“åˆ</a></li>
<li><a href="#ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ç»“åˆä½¿ç”¨">ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ç»“åˆä½¿ç”¨</a></li>
</ul>
</li>
</ul>
<h3 id="å…ˆå†³æ¡ä»¶"><a href="#å…ˆå†³æ¡ä»¶" class="headerlink" title="å…ˆå†³æ¡ä»¶"></a>å…ˆå†³æ¡ä»¶</h3><ul>
<li><a href="https://developer.android.com/studio/index.html" target="_blank" rel="external">Android Studio</a> 1.5.1æˆ–ä»¥ä¸Šç‰ˆæœ¬</li>
<li>JDK 1.7æˆ–ä»¥ä¸Šç‰ˆæœ¬</li>
<li>è¾ƒæ–°ç‰ˆæœ¬çš„Android SDK</li>
<li>Android API Level 9 æˆ–è€…ä»¥ä¸Š(å³Android 2.3åŠä»¥ä¸Š)</li>
</ul>
<p>ä»€ä¹ˆï¼Œä½ æƒ³è¦åœ¨Eclipseä¸Šä½¿ç”¨Realm?<br><img src="https://ww2.sinaimg.cn/large/006tNc79gy1feapqxnhi6j30dw09a3yu.jpg" alt="Using Realm in Eclipse"></p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>Realmæ˜¯ä½œä¸ºä¸€ä¸ªGradleæ’ä»¶å®‰è£…çš„ã€‚</p>
<ul>
<li><p>ç¬¬ä¸€æ­¥ï¼šåœ¨projectçº§åˆ«çš„<code>build.gradle</code>æ–‡ä»¶ä¸‹æ·»åŠ ï¼š</p>
<pre><code class="gradle">  buildscript {
      repositories {
          jcenter()
      }
      dependencies {
          classpath &quot;io.realm:realm-gradle-plugin:3.0.0&quot;
      }
  }
</code></pre>
<p>  ä¸‹é¢æ˜¯projectçº§åˆ«çš„<code>build.gradle</code>æ–‡ä»¶çš„ä½ç½®ï¼š<br>  <img src="https://ww4.sinaimg.cn/large/006tNc79gy1feapw9tjepj30pi0lu79w.jpg" alt="build.gradle file of project level"></p>
</li>
<li><p>ç¬¬äºŒæ­¥ï¼šåœ¨applicationçº§åˆ«çš„<code>build.gradle</code>æ–‡ä»¶çš„é¡¶éƒ¨åº”ç”¨<code>realm-android</code>æ’ä»¶ï¼š</p>
<pre><code class="gradle">  apply plugin: &#39;realm-android&#39;
</code></pre>
<p>  ä¸‹é¢æ˜¯applicationçº§åˆ«çš„<code>build.gradle</code>æ–‡ä»¶çš„ä½ç½®ï¼š<br>  <img src="https://ww4.sinaimg.cn/large/006tNc79gy1feaq13ys14j30pa0lsq8j.jpg" alt="build.gradle file of application level"></p>
</li>
</ul>
<p>æ·»åŠ å®Œæˆåï¼Œåˆ·æ–°gradleä¾èµ–å³å¯ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸¤ä¸ªçº§åˆ«çš„<code>build.gradle</code>æ–‡ä»¶ç¤ºä¾‹ï¼š</p>
<ul>
<li><a href="https://github.com/realm/realm-java/blob/master/examples/build.gradle" target="_blank" rel="external">Project level build.gradle</a></li>
<li><a href="https://github.com/realm/realm-java/blob/master/examples/introExample/build.gradle" target="_blank" rel="external">Application level build.gradle</a></li>
</ul>
<p>é™¤äº†gradleå¤–ï¼ŒRealmå¹¶ä¸æ”¯æŒåƒMavenå’ŒAntè¿™æ ·çš„æ„å»ºå·¥å…·ã€‚å¦‚æœä½ æœ‰éœ€è¦çš„è¯ï¼Œå¯ä»¥å…³æ³¨ä¸‹é¢çš„ä¸¤ä¸ªissueã€‚</p>
<ul>
<li><a href="https://github.com/realm/realm-java/issues/2342" target="_blank" rel="external">Maven support</a></li>
<li><a href="https://github.com/realm/realm-java/issues/1591" target="_blank" rel="external">Ant support</a></li>
</ul>
<h3 id="è·å–Realmå®ä¾‹"><a href="#è·å–Realmå®ä¾‹" class="headerlink" title="è·å–Realmå®ä¾‹"></a>è·å–Realmå®ä¾‹</h3><p>ä¸€èˆ¬éœ€è¦å…ˆåœ¨Applicationä¸­å®ŒæˆRealmçš„åˆå§‹åŒ–å·¥ä½œã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="java">public class App extends Application {

    @Override
    public void onCreate() {
        super.onCreate();
        Realm.init(this);
    }

}
</code></pre>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªConfigurationæ¥æŒ‡å®šRealmç”Ÿæˆçš„æ•°æ®åº“çš„åå­—å’Œç‰ˆæœ¬ç­‰ç­‰ã€‚</p>
<pre><code class="java">Realm realm = Realm.getInstance(new RealmConfiguration.Builder()
                .deleteRealmIfMigrationNeeded()
                .name(&quot;MyAwsomeRealmName.realm&quot;)
                .build());
</code></pre>
<h3 id="åˆ›å»ºRealmå®ä½“"><a href="#åˆ›å»ºRealmå®ä½“" class="headerlink" title="åˆ›å»ºRealmå®ä½“"></a>åˆ›å»ºRealmå®ä½“</h3><p>Realmçš„å®ä½“ç±»å¯ä»¥é€šè¿‡ç»§æ‰¿<code>RealmObject</code>çš„æ–¹å¼åˆ›å»ºï¼š</p>
<pre><code class="java">public class User extends RealmObject {

    private String          name;
    private int             age;

    @Ignore
    private int             sessionId;

    // é€šè¿‡IDEç”Ÿæˆçš„æ ‡å‡†getterså’Œsetters...
    public String getName() { return name; }
    public void   setName(String name) { this.name = name; }
    public int    getAge() { return age; }
    public void   setAge(int age) { this.age = age; }
    public int    getSessionId() { return sessionId; }
    public void   setSessionId(int sessionId) { this.sessionId = sessionId; }
}
</code></pre>
<p>Realmå®ä½“ç±»è¿˜æ˜¯æ”¯æŒ<code>public</code>, <code>protected</code>, <code>private</code>å­—æ®µå’Œæ–¹æ³•çš„ã€‚</p>
<pre><code class="java">public class User extends RealmObject {

    public String name;

    public boolean hasLongName() {
      return name.length() &gt; 7;
    }

    @Override
    public boolean equals(Object o) {
      // è‡ªå®šä¹‰equalsæ“ä½œ
    }
}
</code></pre>
<h4 id="å­—æ®µç±»å‹"><a href="#å­—æ®µç±»å‹" class="headerlink" title="å­—æ®µç±»å‹"></a>å­—æ®µç±»å‹</h4><p>Realmæ”¯æŒçš„å­—æ®µç±»å‹ï¼š</p>
<p><code>boolean</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>float</code>, <code>double</code>, <code>String</code>, <code>Date</code> and <code>byte[]</code>ï¼Œå…¶ä¸­integerç±»å‹<code>byte</code>, <code>short</code>, <code>int</code>ï¼Œéƒ½è¢«è‡ªåŠ¨çš„åŒ…è£…æˆäº†<code>long</code>ç±»å‹ã€‚<code>RealmObject</code>å’Œ<code>RealmList&lt;? extends RealmObject&gt;</code>çš„å­ç±»æ”¯æŒå®ä½“ç±»ä¹‹é—´çš„å…³ç³»(ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šç­‰)ã€‚</p>
<p>è£…ç®±ç±»å‹<code>Boolean</code>, <code>Byte</code>, <code>Short</code>, <code>Integer</code>, <code>Long</code>, <code>Float</code> å’Œ <code>Double</code>ç­‰ä¹Ÿå¯ä»¥åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯è¿™äº›å­—æ®µçš„å€¼æœ‰å¯èƒ½ä¸º<code>null</code>ã€‚</p>
<h4 id="Requiredå­—æ®µå’Œnullå€¼"><a href="#Requiredå­—æ®µå’Œnullå€¼" class="headerlink" title="Requiredå­—æ®µå’Œnullå€¼"></a>Requiredå­—æ®µå’Œnullå€¼</h4><p>åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå­—æ®µå€¼ä¸º<code>null</code>å¹¶ä¸åˆé€‚ã€‚åœ¨Realmä¸­ï¼Œ<code>@Required</code>æ³¨è§£å°±æ˜¯ç”¨æ¥å¼ºåˆ¶æ£€æŸ¥ï¼Œä¸å…è®¸å­—æ®µå‡ºç°<code>null</code>å€¼ã€‚åªæœ‰<code>Boolean</code>, <code>Byte</code>, <code>Short</code>, <code>Integer</code>, <code>Long</code>, <code>Float</code> å’Œ <code>Double</code>ç­‰å¯ä»¥ä½¿ç”¨<code>@Required</code>æ³¨è§£ï¼Œå¦‚æœå…¶ä»–ç±»å‹çš„å­—æ®µä½¿ç”¨äº†æ­¤æ³¨è§£ï¼Œç¼–è¯‘æ—¶å°†ä¼šå‡ºç°é”™è¯¯ã€‚åŸå§‹å­—æ®µç±»å‹å’Œ<code>RealmList</code>ç±»å‹è¢«éšå«çš„æ ‡ç¤ºä¸º<code>Required</code>ï¼Œè€Œ<code>RealmObject</code>ç±»å‹å­—æ®µæ˜¯å¯ä»¥ä¸ºnullableçš„ã€‚</p>
<h4 id="å±æ€§å¿½ç•¥"><a href="#å±æ€§å¿½ç•¥" class="headerlink" title="å±æ€§å¿½ç•¥"></a>å±æ€§å¿½ç•¥</h4><p>ä½¿ç”¨æ³¨è§£<code>@Ignore</code>æ„å‘³ç€æ­¤å­—æ®µå¯ä»¥ä¸è¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚</p>
<h4 id="è‡ªåŠ¨æ›´æ–°"><a href="#è‡ªåŠ¨æ›´æ–°" class="headerlink" title="è‡ªåŠ¨æ›´æ–°"></a>è‡ªåŠ¨æ›´æ–°</h4><p>å¯¹äºåº•å±‚æ•°æ®è€Œè¨€ï¼Œ<code>RealmObject</code>æ˜¯å®æ—¶çš„ï¼Œè‡ªåŠ¨æ›´æ–°çš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬è·å–åˆ°çš„å¯¹è±¡æ•°æ®ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨çš„åˆ·æ–°ã€‚æ›´æ”¹æ•°æ®å¯¹æŸ¥è¯¢çš„å½±å“ä¼šè¢«ç«‹åˆ»ååº”åœ¨æŸ¥è¯¢ç»“æœä¸Šã€‚</p>
<pre><code class="java">realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        Dog myDog = realm.createObject(Dog.class);
        myDog.setName(&quot;Fido&quot;);
        myDog.setAge(1);
    }
});
Dog myDog = realm.where(Dog.class).equalTo(&quot;age&quot;, 1).findFirst();

realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        Dog myPuppy = realm.where(Dog.class).equalTo(&quot;age&quot;, 1).findFirst();
        myPuppy.setAge(2);
    }
});

myDog.getAge(); // =&gt; 2
</code></pre>
<h4 id="å±æ€§ç´¢å¼•"><a href="#å±æ€§ç´¢å¼•" class="headerlink" title="å±æ€§ç´¢å¼•"></a>å±æ€§ç´¢å¼•</h4><p>ä½¿ç”¨æ³¨è§£<code>@Index</code>ä¼šç»™å­—æ®µæ·»åŠ ä¸€ä¸ªæœç´¢ç´¢å¼•ã€‚è¿™ä¼šå¯¼è‡´æ’å…¥é€Ÿåº¦å˜æ…¢å’Œæ•°æ®æ–‡ä»¶å˜å¤§ï¼Œä½†æ˜¯æŸ¥è¯¢æ“ä½œä¼šæ›´å¿«ã€‚æ‰€ä»¥ï¼ŒRealmåªæ¨èä½ åœ¨éœ€è¦æé«˜è¯»æ€§èƒ½çš„æ—¶å€™æ·»åŠ ç´¢å¼•ã€‚ç´¢å¼•æ”¯æŒçš„å­—æ®µç±»å‹åŒ…æ‹¬ï¼š<code>String</code>, <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>boolean</code> å’Œ <code>Date</code>ã€‚</p>
<h3 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h3><p>æ•°æ®åº“çš„ä½¿ç”¨ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯å¢åˆ æ”¹æŸ¥(CRUD)å››ç§æ“ä½œäº†ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹Realmæ˜¯å¦‚ä½•å®ç°ä¸Šè¿°å››ç§æ“ä½œçš„ã€‚</p>
<h4 id="å†™æ“ä½œ"><a href="#å†™æ“ä½œ" class="headerlink" title="å†™æ“ä½œ"></a>å†™æ“ä½œ</h4><p>åœ¨è®¨è®ºå…·ä½“çš„CRUDä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹å†™æ“ä½œã€‚è¯»æ“ä½œæ˜¯éšå¼å®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•æ—¶å€™ä½ éƒ½å¯ä»¥å¯¹å®ä½“è¿›è¡Œè®¿é—®å’ŒæŸ¥è¯¢ã€‚è€Œæ‰€æœ‰çš„å†™æ“ä½œ(æ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤)éƒ½å¿…é¡»åœ¨å†™äº‹ç‰©ä¸­å®Œæˆã€‚å†™äº‹ç‰©èƒ½å¤Ÿè¢«æäº¤å’Œå–æ¶ˆã€‚å†™æ“ä½œåŒæ—¶ä¹Ÿç”¨äºä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</p>
<pre><code class="java">// è·å–Realmå®ä¾‹
Realm realm = Realm.getDefaultInstance();

realm.beginTransaction();

//... åœ¨è¿™é‡Œæ·»åŠ æˆ–è€…å‡çº§å¯¹è±¡ ...
User user = realm.createObject(User.class);

realm.commitTransaction();
// å–æ¶ˆå†™æ“ä½œ
// realm.cancelTransaction();
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå†™æ“ä½œæ˜¯äº’æ–¥çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬åŒæ—¶åœ¨UIçº¿ç¨‹å’Œåå°çº¿ç¨‹ä¸­åˆ›å»ºå†™æ“ä½œå°±æœ‰å¯èƒ½å¯¼è‡´ANRã€‚å½“æˆ‘ä»¬åœ¨UIçº¿ç¨‹åˆ›å»ºå†™äº‹ç‰©æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://realm.io/docs/java/latest/#asynchronous-transactions" target="_blank" rel="external">å¼‚æ­¥äº‹ç‰©</a>æ¥é¿å…ANRçš„å‡ºç°ã€‚</p>
<p>Realmæ˜¯crashå®‰å…¨çš„ï¼Œæ‰€ä»¥å¦‚æœåœ¨äº‹ç‰©ä¸­äº§ç”Ÿäº†ä¸€ä¸ªå¼‚å¸¸ï¼ŒRealmæœ¬èº«æ˜¯ä¸ä¼šè¢«ç ´åçš„ã€‚ä¸è¿‡åœ¨å½“å‰äº‹ç‰©ä¸­çš„æ•°æ®è¢«ä¸¢å¤±ï¼Œä¸è¿‡ä¸ºäº†é¿å…å¼‚å¸¸äº§ç”Ÿçš„ä¸€ç³»åˆ—é—®é¢˜ï¼Œå–æ¶ˆäº‹ç‰©å°±éå¸¸é‡è¦äº†ã€‚å¦‚æœä½¿ç”¨<code>executeTransaction()</code>è¿™äº›æ“ä½œéƒ½ä¼šè¢«è‡ªåŠ¨å®Œæˆã€‚</p>
<p>ç”±äºRealmé‡‡ç”¨çš„MVCCæ¶æ„ï¼Œåœ¨å†™äº‹ç‰©è¿›è¡Œçš„åŒæ—¶ï¼Œè¯»æ“ä½œä¹Ÿæ˜¯è¢«å…è®¸çš„ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œé™¤ééœ€è¦åœ¨è®¸å¤šçš„çº¿ç¨‹ä¸­ï¼ŒåŒæ—¶å¤„ç†è®¸å¤šçš„å¹¶è¡Œäº‹åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§å‹äº‹ç‰©ï¼Œå®Œæˆè®¸å¤šç»†ç²’åº¦çš„äº‹ç‰©ã€‚å½“æˆ‘ä»¬å‘Realmæäº¤ä¸€ä¸ªå†™äº‹ç‰©æ—¶ï¼Œå…¶ä»–çš„Realmå®ä¾‹éƒ½ä¼šè¢«é€šçŸ¥ï¼Œå¹¶ä¸”è¢«<a href="https://realm.io/docs/java/latest/#auto-updating" target="_blank" rel="external">è‡ªåŠ¨æ›´æ–°</a>ã€‚</p>
<p>è¯»å’Œå†™çš„æ“ä½œåœ¨Realmä¸­å°±æ˜¯<a href="http://en.wikipedia.org/wiki/ACID" target="_blank" rel="external">ACID</a>.</p>
<h4 id="æ·»åŠ "><a href="#æ·»åŠ " class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç å°†æ•°æ®æ·»åŠ åˆ°Realmä¸­ï¼š</p>
<pre><code class="java">realm.beginTransaction();
User user = realm.createObject(User.class); // åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡
user.setName(&quot;John&quot;);
user.setEmail(&quot;john@corporation.com&quot;);
realm.commitTransaction();
</code></pre>
<pre><code class="java">User user = new User(&quot;John&quot;);
user.setEmail(&quot;john@corporation.com&quot;);

// å°†å¯¹è±¡å¤åˆ¶åˆ°Realmä¸­ï¼Œåé¢çš„æ“ä½œå¿…é¡»åœ¨realmUserä¸Šè¿›è¡Œã€‚
realm.beginTransaction();
User realmUser = realm.copyToRealm(user);
realm.commitTransaction();
</code></pre>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>realm.executeTransaction()</code>æ–¹æ³•æ›¿ä»£æ‰‹åŠ¨çš„è·Ÿè¸ª<code>realm.beginTransaction()</code>, <code>realm.commitTransaction()</code>å’Œ<code>realm.cancelTransaction()</code>ï¼Œè¿™ä¸ªæ–¹æ³•è‡ªåŠ¨åœ°å¤„ç†äº†begin/commitï¼Œå’Œé”™è¯¯å‘ç”Ÿåçš„cancelã€‚</p>
<pre><code class="java">realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        User user = realm.createObject(User.class);
        user.setName(&quot;John&quot;);
        user.setEmail(&quot;john@corporation.com&quot;);
    }
});
</code></pre>
<p>å¼‚æ­¥äº‹ç‰©å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¤„ç†åŒæ­¥äº‹ç‰©å¯èƒ½å¸¦æ¥çš„UIçº¿ç¨‹é˜»å¡çš„é—®é¢˜ã€‚ä½¿ç”¨å¼‚æ­¥äº‹ç‰©åï¼Œäº‹ç‰©ä¼šåœ¨ä¸€ä¸ªåå°çº¿ç¨‹ä¸Šè¿è¡Œï¼Œäº‹ç‰©å®Œæˆåä¼šè¿›è¡Œç»“æœé€šçŸ¥ã€‚</p>
<pre><code class="java">realm.executeTransactionAsync(new Realm.Transaction() {
            @Override
            public void execute(Realm bgRealm) {
                User user = bgRealm.createObject(User.class);
                user.setName(&quot;John&quot;);
                user.setEmail(&quot;john@corporation.com&quot;);
            }
        }, new Realm.Transaction.OnSuccess() {
            @Override
            public void onSuccess() {
                // äº‹ç‰©æˆåŠŸå®Œæˆ
            }
        }, new Realm.Transaction.OnError() {
            @Override
            public void onError(Throwable error) {
                // äº‹ç‰©å¤±è´¥ï¼Œè‡ªåŠ¨å–æ¶ˆ
            }
        });
</code></pre>
<p><code>onSuccess</code> å’Œ <code>onError</code> å›è°ƒéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯å¦‚æœæä¾›äº†è¿™äº›æ–¹æ³•ï¼Œå®ƒä»¬ä¼šåœ¨äº‹ç‰©æˆåŠŸå®Œæˆæˆ–è€…å¤±è´¥åè¢«è°ƒç”¨ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>RealmAsyncTask</code>è·å–ä¸€ä¸ªå¼‚æ­¥äº‹ç‰©çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ç”¨åœ¨å½“äº‹ç‰©æœªå®Œæˆè€ŒActivityæˆ–è€…Fragmentè¢«é”€æ¯æ—¶å–æ¶ˆäº‹ç‰©ã€‚å¦‚æœåœ¨å›è°ƒä¸­è¿›è¡Œäº†æ›´æ–°UIçš„æ“ä½œï¼Œè€Œåˆå¿˜è®°äº†å–æ¶ˆäº‹ç‰©ï¼Œå°±ä¼šé€ æˆcrashã€‚</p>
<pre><code class="java">public void onStop () {
    if (transaction != null &amp;&amp; !transaction.isCancelled()) {
        transaction.cancel();
    }
}
</code></pre>
<p>Realmè¿˜æä¾›äº†ä¸€ä¸ªå’Œç¥å¥‡çš„åŠŸèƒ½ï¼Œç›´æ¥é€šè¿‡JSON(String, JSONObject, InputStream)æ·»åŠ æ•°æ®ï¼Œå¹¶ä¸”Realmä¼šè‡ªåŠ¨å¿½ç•¥æ²¡æœ‰åœ¨RealmObjectä¸­å®šä¹‰çš„å­—æ®µã€‚å•ä¸ªçš„å¯¹è±¡å¯ä»¥é€šè¿‡<code>Realm.createObjectFromJson()</code>æ–¹æ³•æ·»åŠ ï¼Œå¯¹è±¡è¡¨å¯ä»¥é€šè¿‡<code>Realm.createAllFromJson()</code>æ–¹æ³•æ·»åŠ ã€‚</p>
<pre><code class="java">// ä»£è¡¨cityçš„RealmObject
public class City extends RealmObject {
    private String city;
    private int id;
    // getters and setters left out ...
}

// é€šè¿‡Stringæ·»åŠ 
realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        realm.createObjectFromJson(City.class, &quot;{ city: \&quot;Copenhagen\&quot;, id: 1 }&quot;);
    }
});

// é€šè¿‡ä¸€ä¸ªInputStreamæ·»åŠ å¤šä¸ªå¯¹è±¡
realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        try {
            InputStream is = new FileInputStream(new File(&quot;path_to_file&quot;));
            realm.createAllFromJson(City.class, is);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
});
</code></pre>
<p>Realmè§£æJSONæ—¶éµå¾ªä¸‹é¢çš„è§„åˆ™ï¼š</p>
<ul>
<li>ä½¿ç”¨åŒ…å«nullå€¼çš„JSONåˆ›å»ºå¯¹è±¡<ul>
<li>å¯¹äºéå¿…é¡»å­—æ®µï¼Œè®¾ç½®ä¸ºé»˜è®¤å€¼null</li>
<li>å¯¹äºå¿…é¡»å­—æ®µï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸</li>
</ul>
</li>
<li>ä½¿ç”¨åŒ…å«nullå€¼çš„JSONæ›´æ–°å¯¹è±¡<ul>
<li>å¯¹äºéå¿…é¡»å­—æ®µï¼Œè®¾ç½®ä¸ºnull</li>
<li>å¯¹äºå¿…é¡»å­—æ®µï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸</li>
</ul>
</li>
<li>JSONä¸åŒ…å«å­—æ®µ<ul>
<li>ä¿æŒå¿…é¡»å’Œéå¿…é¡»å­—æ®µçš„å€¼ä¸å˜</li>
</ul>
</li>
</ul>
<h4 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h4><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ª<code>User</code>ç±»ï¼š</p>
<pre><code class="java">public class User extends RealmObject {

    @PrimaryKey
    private String          name;
    private int             age;

    @Ignore
    private int             sessionId;

    // ä½¿ç”¨IDEç”Ÿæˆçš„æ ‡å‡†getterså’Œsetters
    public String getName() { return name; }
    public void   setName(String name) { this.name = name; }
    public int    getAge() { return age; }
    public void   setAge(int age) { this.age = age; }
    public int    getSessionId() { return sessionId; }
    public void   setSessionId(int sessionId) { this.sessionId = sessionId; }
}
</code></pre>
<p>æŸ¥è¯¢æ‰€æœ‰nameä¸ºã€ŒJohnã€æˆ–è€…ã€ŒPeterã€çš„User:</p>
<pre><code class="java">// åˆ›å»ºä¸€ä¸ªRealmQueryç”¨äºæŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„user
RealmQuery&lt;User&gt; query = realm.where(User.class);

// æ·»åŠ æŸ¥è¯¢æ¡ä»¶
query.equalTo(&quot;name&quot;, &quot;John&quot;);
query.or().equalTo(&quot;name&quot;, &quot;Peter&quot;);

// æ‰§è¡ŒæŸ¥è¯¢
RealmResults&lt;User&gt; result1 = query.findAll();

// æˆ–è€…è¿›è¡Œç®€åŒ–
RealmResults&lt;User&gt; result2 = realm.where(User.class)
                                  .equalTo(&quot;name&quot;, &quot;John&quot;)
                                  .or()
                                  .equalTo(&quot;name&quot;, &quot;Peter&quot;)
                                  .findAll();
</code></pre>
<p>ä¸Šé¢çš„ä»£ç å°±å¯ä»¥è·å–ä¸€ä¸ª<code>RealmResults</code>ç±»çš„å®ä¾‹ï¼ŒåŒ…å«äº†åç§°ä¸ºJohnæˆ–è€…Peterçš„æ‰€æœ‰userã€‚å½“<code>findAll()</code>æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼ŒæŸ¥è¯¢ä¾¿å¼€å§‹æ‰§è¡Œã€‚<code>findAll()</code>æ˜¯<code>findAll()</code>æ–¹æ³•å¤§å®¶æ—çš„ä¸€å‘˜ï¼Œç±»ä¼¼çš„æ–¹æ³•è¿˜æœ‰ï¼š<code>findAllSorted()</code>è¿”å›ä¸€ä¸ªæ’å¥½åºä¹‹åçš„ç»“æœé›†åˆï¼Œ<code>findAllAsync()</code>ä¼šåœ¨åå°çº¿ç¨‹ä¸­å¼‚æ­¥çš„å®ŒæˆæŸ¥è¯¢æ“ä½œã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å¾—åˆ°çš„ç»“æœæ˜¯æ²¡æœ‰è¢«å¤åˆ¶çš„ã€‚æ­£å¦‚Realmçš„å®˜æ–¹æ–‡æ¡£æ‰€è¨€ï¼š</p>
<blockquote>
<p>All fetches (including queries) are lazy in Realm, and the data is never copied.</p>
</blockquote>
<p>æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„å¯¹è±¡åˆ—è¡¨çš„å¼•ç”¨ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ç›´æ¥æ“ä½œï¼Œå¯¹è±¡å°†ä¼šæ˜¯åŸå§‹çš„å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯å¤åˆ¶ä¸€ä»½å§ã€‚</p>
<pre><code class="java">ArrayList array = realm. copyFromRealm(result2);
</code></pre>
<p><code>RealmResults</code>ç»§æ‰¿è‡ªJavaçš„<code>AbstractList</code>ï¼Œåœ¨è®¸å¤šæ–¹é¢çš„æ“ä½œç±»ä¼¼ã€‚ä¾‹å¦‚ï¼Œ<code>RealmResults</code>æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç´¢å¼•è·å–ç‰¹å®šçš„å¯¹è±¡ã€‚</p>
<p>å½“æŸ¥è¯¢æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„ç»“æœæ—¶ï¼Œè¿”å›å€¼<code>RealmResults</code>å¹¶ä¸ä¼šä¸ºnullï¼Œä½†æ˜¯<code>size()</code>æ–¹æ³•ä¼šè¿”å›0ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¦ä¿®æ”¹æˆ–è€…åˆ é™¤<code>RealmResults</code>ä¸­çš„å¯¹è±¡ï¼Œä¹Ÿå¿…é¡»åœ¨å†™äº‹ç‰©ä¸­è¿›è¡Œã€‚</p>
<h5 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h5><p>å¯¹äºæ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼Œéƒ½æœ‰ä»¥ä¸‹ä¸¤ç§æŸ¥è¯¢æ¡ä»¶ï¼š</p>
<ul>
<li><code>equalTo()</code></li>
<li><code>notEqualTo()</code></li>
</ul>
<p>ä½¿ç”¨<code>in()</code>åŒ¹é…æŸä¸€ç‰¹å®šå­—æ®µè€Œä¸æ˜¯ä¸€ä¸ªçš„å€¼çš„åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼ŒæŸ¥æ‰¾åå­— ã€ŒJillã€, ã€ŒWilliamã€, ã€ŒTrillianã€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>in(&quot;name&quot;, new String[]{&quot;Jill&quot;, &quot;William&quot;, &quot;Trillian&quot;})</code>ã€‚<code>in()</code>æ–¹æ³•æ¥æ”¶String, äºŒè¿›åˆ¶æ•°æ®å’Œæ•°å€¼å‹å­—æ®µã€‚</p>
<p>æ•°å€¼æ•°æ®ç±»å‹åŒ…æ‹¬<code>Data</code>ï¼Œéƒ½å…è®¸è¿›è¡Œä¸‹é¢çš„æŸ¥è¯¢æ¡ä»¶:</p>
<ul>
<li><code>between()</code>(åŒ…å«è¾¹ç•Œå€¼)</li>
<li><code>greaterThan()</code> - å¤§äº</li>
<li><code>lessThan()</code> - å°äº</li>
<li><code>greaterThanOrEqualTo()</code> - å¤§äºç­‰äº</li>
<li><code>lessThanOrEqualTo()</code> - å°äºç­‰äº</li>
</ul>
<p>Stringç±»å‹å­—æ®µå…è®¸ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢æ¡ä»¶ï¼š</p>
<ul>
<li><code>contains()</code> - åŒ…å«</li>
<li><code>beginsWith()</code> - ä»¥â€¦å¼€å¤´</li>
<li><code>endsWith()</code> - ä»¥â€¦ç»“å°¾</li>
<li><code>like()</code> - ç±»ä¼¼äº</li>
</ul>
<p>æ‰€æœ‰çš„Stringç±»å‹éƒ½æ”¯æŒæ·»åŠ ç¬¬ä¸‰ä¸ªå‚æ•°æ¥æ§åˆ¶å¤§å°å†™çš„æ•æ„Ÿç±»å‹ã€‚</p>
<ul>
<li>Case.INSENSITIVE -&gt; å¤§å°å†™ä¸æ•æ„Ÿ</li>
<li>Case.SENSITIVE -&gt; å¤§å°å†™æ•æ„Ÿ(é»˜è®¤å€¼)</li>
</ul>
<p>ä½¿ç”¨<code>like()</code>è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼ŒåŒ¹é…æ¡ä»¶å¦‚ä¸‹:</p>
<ul>
<li><code>*</code> - åŒ¹é…0ä¸ªæˆ–è€…å¤šä¸ªUnicodeå­—ç¬¦</li>
<li><code>?</code> - åŒ¹é…å•ä¸ªUnicodeå­—ç¬¦</li>
</ul>
<p>ä¸¾ä¸ªğŸŒ°ï¼Œå‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªRealmObjectæœ‰ä¸€ä¸ª<code>name</code>å­—æ®µï¼Œå…¶å€¼æœ‰ã€ŒWilliamã€, ã€ŒBillã€,ã€ŒJillã€, å’Œ ã€ŒTrillianã€ã€‚ æŸ¥è¯¢æ¡ä»¶<code>like(&quot;name&quot;, &quot;?ill*&quot;)</code>ä¼šåŒ¹é…å¼€å§‹çš„3ä¸ªå¯¹è±¡ï¼Œ è€Œ<code>like(&quot;name&quot;, &quot;*ia?&quot;)</code>ä¼šåŒ¹é…ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p>äºŒè¿›åˆ¶æ•°æ®ï¼ŒStringï¼Œ<code>RealmObject</code>çš„åˆ—è¡¨(<code>RealmList</code>)æœ‰å¯èƒ½ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯é•¿åº¦ä¸º0ï¼Œä¸‹é¢æ˜¯æ£€æµ‹æ˜¯å¦ä¸ºç©ºçš„æŸ¥è¯¢æ¡ä»¶ï¼š</p>
<ul>
<li><code>isEmpty()</code></li>
<li><code>isNotEmpty()</code></li>
</ul>
<p>å¦‚æœä¸€ä¸ªå­—æ®µæ˜¯éå¿…é¡»å­—æ®µï¼Œé‚£ä¹ˆå®ƒçš„å€¼å°±æœ‰å¯èƒ½ä¸º<code>null</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ¡ä»¶æ£€æµ‹ï¼š</p>
<ul>
<li><code>isNull()</code></li>
<li><code>isNotNull()</code></li>
</ul>
<h5 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h5><p>æ¯ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶éƒ½è¢«éšå¼åœ°ä½¿ç”¨<code>AND</code>è¿æ¥ã€‚è€Œé€»è¾‘è¿ç®—ç¬¦<code>OR</code>å¿…é¡»ä½¿ç”¨<code>or()</code>æ˜¾å¼åœ°å£°æ˜ã€‚</p>
<p>ä»ç„¶ä»¥ä¸Šé¢<code>User</code>ç±»ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>beginGroup()</code> å’Œ <code>endGroup()</code> æ¥å£°æ˜ä¸€ç»„æŸ¥è¯¢æ¡ä»¶ã€‚</p>
<pre><code class="java">RealmResults&lt;User&gt; r = realm.where(User.class)
                            .greaterThan(&quot;age&quot;, 10)  // éšå¼åœ°AND
                            .beginGroup()
                                .equalTo(&quot;name&quot;, &quot;Peter&quot;)
                                .or()
                                .contains(&quot;name&quot;, &quot;Jo&quot;)
                            .endGroup()
                            .findAll();
</code></pre>
<p>æŸ¥è¯¢æ¡ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨<code>not()</code>è¿›è¡Œå¦å®šï¼Œ<code>not()</code>ä¹Ÿå¯ä»¥å’Œ<code>beginGroup()</code> å’Œ <code>endGroup()</code> ç”¨äºå¦å®šä¸€ç»„å­æŸ¥è¯¢æ¡ä»¶ã€‚å†ä¸¾ä¸ªğŸŒ°ï¼Œæˆ‘ä»¬æƒ³è¦æŸ¥è¯¢æ‰€æœ‰åå­—ä¸ä¸ºã€ŒPeterã€å’Œã€ŒJoã€çš„Userï¼š</p>
<pre><code class="java">RealmResult&lt;User&gt; r = realm.where(User.class)
                           .not()
                           .beginGroup()
                                .equalTo(&quot;name&quot;, &quot;Peter&quot;)
                                .or()
                                .contains(&quot;name&quot;, &quot;Jo&quot;)
                            .endGroup()
                            .findAll();
</code></pre>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨<code>in()</code>è¿›è¡Œç®€åŒ–ï¼š</p>
<pre><code class="java">RealmResult&lt;User&gt; r = realm.where(User.class)
                           .not()
                           .in(&quot;name&quot;, new String[]{&quot;Peter&quot;, &quot;Jo&quot;})
                           finalAll();
</code></pre>
<h5 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h5><p>å½“æˆ‘ä»¬çš„æŸ¥è¯¢å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åº:</p>
<pre><code class="java">RealmResults&lt;User&gt; result = realm.where(User.class).findAll();
result = result.sort(&quot;age&quot;); // å‡åºæ’åº
result = result.sort(&quot;age&quot;, Sort.DESCENDING);
</code></pre>
<p>é»˜è®¤é‡‡ç”¨çš„æ˜¯æŒ‰å‡åºæ’åºï¼Œå¦‚æœéœ€è¦æ”¹å˜çš„è¯ï¼Œå¯ä»¥å°†<code>Sort.DESCENDING</code>ä½œä¸ºå¯é€‰å‚æ•°ä¼ å…¥ã€‚</p>
<h5 id="å”¯ä¸€å€¼"><a href="#å”¯ä¸€å€¼" class="headerlink" title="å”¯ä¸€å€¼"></a>å”¯ä¸€å€¼</h5><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>distinct()</code>æ¥æŸ¥è¯¢æŸä¸€å­—æ®µå…±æœ‰å¤šå°‘ç±»å‹çš„å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦æŸ¥è¯¢åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­æœ‰å¤šå°‘ä¸åŒçš„åå­—ï¼š</p>
<pre><code class="java">RealmResults&lt;Person&gt; unique = realm.where(Person.class).distinct(&quot;name&quot;);
</code></pre>
<p>æ­¤æ“ä½œåªæ”¯æŒintegerå’Œstringç±»å‹çš„å­—æ®µï¼Œå¯¹å…¶ä»–ç±»å‹è¿›è¡Œæ­¤æ“ä½œä¼šäº§ç”Ÿå¼‚å¸¸ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å¤šä¸ªå­—æ®µè¿›è¡Œæ’åºã€‚</p>
<h5 id="é“¾å¼æŸ¥è¯¢"><a href="#é“¾å¼æŸ¥è¯¢" class="headerlink" title="é“¾å¼æŸ¥è¯¢"></a>é“¾å¼æŸ¥è¯¢</h5><p>ç”±äºæŸ¥è¯¢ç»“æœå¹¶ä¸ä¼šè¿›è¡Œå¤åˆ¶å’Œè®¡ç®—æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„è¿‡æ»¤æˆ‘ä»¬çš„æ•°æ®ï¼š</p>
<pre><code class="java">RealmResults&lt;Person&gt; teenagers = realm.where(Person.class).between(&quot;age&quot;, 13, 20).findAll();
Person firstJohn = teenagers.where().equalTo(&quot;name&quot;, &quot;John&quot;).findFirst();
</code></pre>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å­å¯¹è±¡è¿›è¡Œé“¾å¼æŸ¥è¯¢ã€‚å‡è®¾ä¸Šé¢çš„<code>Person</code>ç±»è¿˜æœ‰ä¸€ä¸ª<code>Dog</code>ç±»å‹çš„listç±»å‹å­—æ®µï¼š</p>
<pre><code class="java">public class Dog extends RealmObject {
    private int age;
    // getters &amp; setters ...
}

public class Person extends RealmObject {
    private int age;
    private RealmList&lt;Dog&gt; dogs;
    // getters &amp; setters ...
}
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é“¾å¼æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾å¹´é¾„åœ¨13è‡³20ä¹‹é—´ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€åªå¹´é¾„ä¸º1å²çš„ç‹—ç‹—çš„äººï¼š</p>
<pre><code class="java">RealmResults&lt;Person&gt; teensWithPups = realm.where(Person.class).between(&quot;age&quot;, 13, 20).equalTo(&quot;dogs.age&quot;, 1).findAll();
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé“¾å¼æŸ¥è¯¢çš„åŸºç¡€å¹¶ä¸æ˜¯<code>RealmQuery</code>ï¼Œè€Œæ˜¯<code>RealmResults</code>ã€‚å¦‚æœæˆ‘ä»¬ä¸ºä¸€ä¸ªå·²ç»å­˜åœ¨çš„<code>RealmQuery</code>æ·»åŠ æ›´å¤šçš„æŸ¥è¯¢æ¡ä»¶ï¼Œä¿®æ”¹çš„æ˜¯queryæœ¬èº«ï¼Œè€Œä¸æ˜¯é“¾ã€‚</p>
<p>OKï¼Œåˆ°è¿™é‡Œï¼ŒæŸ¥è¯¢çš„æƒ…å†µæˆ‘ä»¬è®¨è®ºçš„ä¹Ÿå·®ä¸å¤šäº†ã€‚ç”±äºæŸ¥è¯¢åœ¨å¢åˆ æ”¹æŸ¥å››ç§æ“ä½œä¸­çš„ä½¿ç”¨é¢‘ç‡æœ€é«˜ï¼Œæ‰€ä»¥ç¯‡å¹…ä¹Ÿæœ€é•¿ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è®¨è®ºã€Œä¿®æ”¹ã€çš„æƒ…å†µã€‚</p>
<h4 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h4><p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢çš„å†…å®¹ä¸­å·²ç»è¿›è¡Œè¿‡ä¿®æ”¹çš„æ“ä½œäº†ï¼Œ<a href="#è‡ªåŠ¨æ›´æ–°">æˆ³è¿™é‡Œ</a>ã€‚æˆ‘ä»¬åœ¨æŸ¥è¯¢åˆ°ç¬¦åˆæ¡ä»¶çš„å¯¹è±¡åï¼Œå¼€å¯ä¸€ä¸ªäº‹ç‰©ï¼Œåœ¨äº‹ç‰©ä¸­è¿›è¡Œä¿®æ”¹ï¼Œç„¶åæäº¤äº‹ç‰©å³å¯:</p>
<pre><code class="java">realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        Dog myPuppy = realm.where(Dog.class).equalTo(&quot;age&quot;, 1).findFirst();
        myPuppy.setAge(2);
    }
});
</code></pre>
<h4 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h4><p>åˆ é™¤æ“ä½œå’Œä¿®æ”¹æ“ä½œç±»ä¼¼ï¼ŒåŸºæœ¬æ€æƒ³éƒ½æ˜¯å…ˆæŸ¥è¯¢ï¼Œç„¶ååœ¨äº‹ç‰©ä¸­è¿›è¡Œæ“ä½œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç è¿›è¡Œåˆ é™¤æ“ä½œ:</p>
<pre><code class="java">// è·å–æŸ¥è¯¢ç»“æœ
final RealmResults&lt;Dog&gt; results = realm.where(Dog.class).findAll();

// æ‰€æœ‰å¯¹æ•°æ®çš„å˜æ›´å¿…é¡»åœ¨äº‹ç‰©ä¸­è¿›è¡Œ
realm.executeTransaction(new Realm.Transaction() {
    @Override
    public void execute(Realm realm) {
        // ç§»é™¤ç¬¦åˆæ¡ä»¶çš„å•ä¸ªæŸ¥è¯¢ç»“æœ
        results.deleteFirstFromRealm();
        results.deleteLastFromRealm();

        // ç§»é™¤å•ä¸ªå¯¹è±¡
        Dog dog = results.get(5);
        dog.deleteFromRealm();

        // ç§»é™¤æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æŸ¥è¯¢ç»“æœ
        results.deleteAllFromRealm();
    }
});
</code></pre>
<h3 id="é«˜çº§ç”¨æ³•"><a href="#é«˜çº§ç”¨æ³•" class="headerlink" title="é«˜çº§ç”¨æ³•"></a>é«˜çº§ç”¨æ³•</h3><h4 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h4><p>Realmæ–‡ä»¶å¯ä»¥é€šè¿‡å‘<code>RealmConfiguration.Builder.encryptionKey()</code>ä¼ é€’ä¸€ä¸ª512ä½(64å­—èŠ‚)çš„å¯†é’¥è¿›è¡ŒåŠ å¯†åå­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚</p>
<pre><code class="java">byte[] key = new byte[64];
new SecureRandom().nextBytes(key);
RealmConfiguration config = new RealmConfiguration.Builder()
  .encryptionKey(key)
  .build();

Realm realm = Realm.getInstance(config);
</code></pre>
<p>è¿™æ ·çš„æªæ–½ä¿è¯äº†æ‰€æœ‰å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ•°æ®éƒ½æ˜¯ç»è¿‡æ ‡å‡†AES-256åŠ å¯†å’Œè§£å¯†çš„ã€‚å½“Realmæ–‡ä»¶åˆ›å»ºåï¼Œæ¯æ¬¡åˆ›å»ºRealmå®ä¾‹æ—¶éƒ½éœ€è¦æä¾›ç›¸åŒçš„å¯†é’¥ã€‚</p>
<p>ç‚¹å‡»<a href="https://github.com/realm/realm-java/tree/master/examples/encryptionExample" target="_blank" rel="external">examples/encryptionExample</a>æŸ¥çœ‹å®Œæ•´çš„ç¤ºä¾‹ï¼Œç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•é€šè¿‡Android KeyStoreå®‰å…¨åœ°å­˜å‚¨å¯†é’¥ä»¥ä¿è¯å…¶ä»–åº”ç”¨ä¸èƒ½è¯»å–æ­¤å¯†é’¥ã€‚</p>
<h4 id="ä¸Androidç³»ç»Ÿç»“åˆ"><a href="#ä¸Androidç³»ç»Ÿç»“åˆ" class="headerlink" title="ä¸Androidç³»ç»Ÿç»“åˆ"></a>ä¸Androidç³»ç»Ÿç»“åˆ</h4><h5 id="é€‚é…å™¨"><a href="#é€‚é…å™¨" class="headerlink" title="é€‚é…å™¨"></a>é€‚é…å™¨</h5><p>Realmæä¾›äº†ä¸€äº›æŠ½è±¡çš„å·¥å…·ç±»æ¥æ–¹ä¾¿åœ°å°† <code>OrderedRealmCollection</code><br>( <code>RealmResults</code> å’Œ <code>RealmList</code> éƒ½å®ç°äº†è¿™ä¸ªæ¥å£)å±•ç¤ºåˆ°UIæ§ä»¶ä¸Šã€‚</p>
<ul>
<li><a href="https://realm.io/docs/java/latest/adapter/io/realm/RealmBaseAdapter.html" target="_blank" rel="external"><code>RealmBaseAdapter</code></a> å¯ä»¥å’Œ <code>ListView</code> æ­é…ä½¿ç”¨ã€‚å‚è€ƒ<a href="https://github.com/realm/realm-android-adapters/blob/master/example/src/main/java/io/realm/examples/adapters/ui/listview/MyListAdapter.java" target="_blank" rel="external">ç¤ºä¾‹</a>ã€‚</li>
<li><a href="https://realm.io/docs/java/latest/adapter/io/realm/RealmRecyclerViewAdapter.html" target="_blank" rel="external"><code>RealmRecyclerViewAdapter</code></a> å¯ä»¥å’Œ <code>RecyclerView</code> æ­é…ä½¿ç”¨ã€‚å‚è§<a href="https://github.com/realm/realm-android-adapters/blob/master/example/src/main/java/io/realm/examples/adapters/ui/recyclerview/MyRecyclerViewAdapter.java" target="_blank" rel="external">ç¤ºä¾‹</a>ã€‚</li>
</ul>
<p>åœ¨ä½¿ç”¨è¿™äº›é€‚é…å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨applicationçº§åˆ«çš„<code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ é¢å¤–çš„ä¾èµ–:</p>
<pre><code class="gradle">dependencies {
    compile &#39;io.realm:android-adapters:2.0.0&#39;
}
</code></pre>
<h5 id="Intents"><a href="#Intents" class="headerlink" title="Intents"></a>Intents</h5><p>ç”±äºæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥åœ¨Intentä¹‹é—´ä¼ é€’<code>RealmObject</code>ï¼Œæ‰€ä»¥Realmå»ºè®®åªä¼ é€’<code>RealmObject</code>çš„æ ‡è¯†ç¬¦ã€‚ä¸¾ä¸ªå¾ˆç®€å•çš„ğŸŒ°ï¼šå¦‚æœä¸€ä¸ªä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªä¸»é”®ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥é€šè¿‡<code>Intent</code>çš„<code>Bundle</code>ä¼ é€’è¿™ä¸ªå€¼ã€‚</p>
<pre><code class="java">// å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªpersonç±»ï¼Œå¹¶ä¸”å°†å…¶idå­—æ®µè®¾ç½®ä¸º@PrimaryKey ...
Intent intent = new Intent(getActivity(), ReceivingService.class);
intent.putExtra(&quot;person_id&quot;, person.getId());
getActivity().startService(intent);
</code></pre>
<p>ç„¶ååœ¨æ¥æ”¶ç»„ä»¶ä¸­(Activity, Service, IntentService, BroadcastReceiver ç­‰ç­‰)è§£æå‡ºä¼ é€’çš„ä¸»é”®å€¼å¹¶æ‰“å¼€Realm,æŸ¥è¯¢åˆ°è¯¥ä¸»é”®å¯¹åº”çš„<code>RealmObject</code>ã€‚</p>
<pre><code class="java">// åœ¨onCreate(), onHandleIntent()ç­‰æ–¹æ³•ä¸­å®Œæˆ
String personId = intent.getStringExtra(&quot;person_id&quot;);
Realm realm = Realm.getDefaultInstance();
try {
    Person person = realm.where(Person.class).equalTo(&quot;id&quot;, personId).findFirst();
    // å¯¹personè¿›è¡Œä¸€äº›æ“ä½œ ...
} finally {
    realm.close();
}
</code></pre>
<p>å®Œæ•´çš„ç¤ºä¾‹å¯ä»¥åœ¨ <a href="https://github.com/realm/realm-java/tree/master/examples/threadExample" target="_blank" rel="external"><code>threading example</code></a> çš„<code>Object Passing</code>éƒ¨åˆ†æ‰¾åˆ°ã€‚ç¤ºä¾‹å±•ç¤ºäº†åœ¨Androidå¸¸ç”¨çš„å¦‚ä½•ä¼ é€’idå¹¶å¾—åˆ°å¯¹åº”çš„<code>RealmObject</code>ã€‚</p>
<h5 id="AsyncTask-amp-IntentService"><a href="#AsyncTask-amp-IntentService" class="headerlink" title="AsyncTask &amp; IntentService"></a>AsyncTask &amp; IntentService</h5><p>Realmå’Œ<code>AsyncTask</code>, <code>IntentService</code>æ­é…ä½¿ç”¨æ—¶ï¼Œéœ€è¦ç‰¹åˆ«ç•™å¿ƒï¼Œ<code>AsyncTask</code>ç±»åŒ…å«äº†ä¸€ä¸ªåœ¨åå°çº¿ç¨‹æ‰§è¡Œçš„<code>doInBackground()</code>æ–¹æ³•ï¼Œ<code>IntentService</code>ç±»åŒ…å«äº†åœ¨å·¥ä½œçº¿ç¨‹æ‰§è¡Œçš„<code>onHandleIntent(Intent intent)</code>æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨Realmï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰“å¼€Realmï¼Œå®Œæˆå·¥ä½œï¼Œç„¶ååœ¨é€€å‡ºä¹‹å‰å…³é—­Realmã€‚ä¸‹é¢æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š</p>
<p>AsyncTask:åœ¨<code>doInBackground()</code>æ–¹æ³•ä¸­æ‰“å¼€å’Œå…³é—­Realmã€‚</p>
<pre><code class="java">private class DownloadOrders extends AsyncTask&lt;Void, Void, Long&gt; {
    protected Long doInBackground(Void... voids) {
        // ç°åœ¨å·²ç»åœ¨åå°çº¿ç¨‹ä¸­äº†ã€‚

        // æ‰“å¼€Realm
        Realm realm = Realm.getDefaultInstance();
        try {
            // ä½¿ç”¨Realm
            realm.createAllFromJson(Order.class, api.getNewOrders());
            Order firstOrder = realm.where(Order.class).findFirst();
            long orderId = firstOrder.getId(); // orderçš„id
            return orderId;
        } finally {
            realm.close();
        }
    }

    protected void onPostExecute(Long orderId) {
        // å›åˆ°Androidä¸»çº¿ç¨‹
        // å®Œæˆä¸€äº›å’ŒorderIdæœ‰å…³çš„æ“ä½œä¾‹å¦‚åœ¨Realmä¸­
        // æŸ¥è¯¢orderå¹¶åšä¸€äº›æ“ä½œã€‚
    }
}
</code></pre>
<p>IntentServie: åœ¨<code>onHandleIntent()</code>æ–¹æ³•ä¸­æ‰“å¼€å’Œå…³é—­Realmã€‚</p>
<pre><code class="java">
public class OrdersIntentService extends IntentService {
    public OrdersIntentService(String name) {
        super(&quot;OrdersIntentService&quot;);
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        // ç°åœ¨å·²ç»åœ¨åå°çº¿ç¨‹ä¸­äº†ã€‚

        // æ‰“å¼€Realm
        Realm realm = Realm.getDefaultInstance();
        try {
            // ä½¿ç”¨Realm
            realm.createAllFromJson(Order.class, api.getNewOrders());
            Order firstOrder = realm.where(Order.class).findFirst();
            long orderId = firstOrder.getId(); // orderçš„id
        } finally {
            realm.close();
        }
    }
}
</code></pre>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼šåœ¨<code>IntentService</code>ä¸­ï¼Œ<code>ChangeListener</code>ä¸èƒ½å¤Ÿæ­£å¸¸çš„å·¥ä½œã€‚å°½ç®¡å®ƒæ˜¯ä¸€ä¸ª<code>Looper</code>çº¿ç¨‹ï¼Œæ¯ä¸€æ¬¡è°ƒç”¨<code>onHandleIntent()</code>ä¸ã€Œloopã€çš„åˆ†ç¦»äº‹ä»¶ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ³¨å†Œregister listenerï¼Œä½†æ˜¯å®ƒæ°¸è¿œä¹Ÿä¸ä¼šè¢«è§¦å‘ã€‚</p>
<h4 id="ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ç»“åˆä½¿ç”¨"><a href="#ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ç»“åˆä½¿ç”¨" class="headerlink" title="ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ç»“åˆä½¿ç”¨"></a>ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ç»“åˆä½¿ç”¨</h4><ul>
<li><a href="#Realmä¸GSON">Realmä¸GSON</a></li>
<li><a href="#Realmä¸Jackson-databind">Realmä¸Jackson-databind</a></li>
<li><a href="#Realmä¸Kotlin">Realmä¸Kotlin</a></li>
<li><a href="#Realmä¸Retrofit">Realmä¸Retrofit</a></li>
<li><a href="#Realmä¸RxJava">Realmä¸RxJava</a></li>
</ul>
<h5 id="Realmä¸GSON"><a href="#Realmä¸GSON" class="headerlink" title="Realmä¸GSON"></a>Realmä¸GSON</h5><p><a href="https://code.google.com/p/google-gson/" target="_blank" rel="external">GSON</a>æ˜¯Googleå¼€å‘çš„JSONå¤„ç†åº“ï¼ŒRealmå’ŒGSONå¯ä»¥æ— ç¼çš„é…åˆä½¿ç”¨ã€‚</p>
<pre><code class="java">// ä½¿ç”¨Userç±»
public class User extends RealmObject {
    private String name;
    private String email;
    // getters and setters ...
}

Gson gson = new GsonBuilder().create();
String json = &quot;{ name : &#39;John&#39;, email : &#39;john@corporation.com&#39; }&quot;;
User user = gson.fromJson(json, User.class);
</code></pre>
<p><strong>åºåˆ—åŒ–(Serialization)</strong></p>
<p>æˆ‘ä»¬æœ‰æ—¶éœ€è¦åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ä¸€ä¸ªRealmå¯¹è±¡ä»¥ä¾¿ä¸å…¶å®ƒåº“ï¼ˆæ¯”å¦‚<a href="http://square.github.io/retrofit/" target="_blank" rel="external">Retrofit</a>ï¼‰ç›¸é…åˆã€‚å› ä¸ºGSONä½¿ç”¨<a href="https://groups.google.com/forum/#!topic/google-gson/4G6Lv9PghUY" target="_blank" rel="external">æˆå‘˜å˜é‡å€¼è€Œégetterå’Œsetter</a>ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•é€šè¿‡GSONçš„ä¸€èˆ¬æ–¹æ³•æ¥åºåˆ—åŒ–Realmå¯¹è±¡ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä¸ºRealmæ¨¡å‹å¯¹è±¡è‡ªå®šä¹‰ä¸€ä¸ª<a href="https://google.github.io/gson/apidocs/com/google/gson/JsonSerializer.html" target="_blank" rel="external">JsonSerializer</a>å¹¶ä¸”å°†å…¶æ³¨å†Œä¸ºä¸€ä¸ª<a href="https://google.github.io/gson/apidocs/com/google/gson/TypeAdapter.html" target="_blank" rel="external">TypeAdapter</a>ã€‚</p>
<p>è¯·å‚è€ƒè¿™ä¸ª<a href="https://gist.github.com/cmelchior/ddac8efd018123a1e53a" target="_blank" rel="external">Gist</a>ã€‚</p>
<p><strong>æ•°ç»„(Primitive lists)</strong></p>
<p>æŸäº›JSON APIä¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›åŸå§‹æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚Stringå’Œintegerï¼‰ï¼Œ<a href="https://github.com/realm/realm-java/issues/575" target="_blank" rel="external">Realmæš‚æ—¶ä¸æ”¯æŒå¯¹è¿™ç§æ•°ç»„çš„å¤„ç†</a>ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰<a href="https://google.github.io/gson/apidocs/com/google/gson/TypeAdapter" target="_blank" rel="external">TypeAdapter</a>æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚</p>
<p>è¿™ä¸ª<a href="https://gist.github.com/cmelchior/1a97377df0c49cd4fca9" target="_blank" rel="external">Gist</a>å±•ç¤ºäº†å¦‚ä½•å°†JSONä¸­çš„æ•´å‹æ•°ç»„å­˜å…¥Realmã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†å…¶å®ƒåŸå§‹æ•°æ®ç±»å‹æ•°ç»„ã€‚</p>
<p><strong>Troubleshooting</strong></p>
<p>Realm å¯¹è±¡å±æ€§å¯èƒ½ä¼šåŒ…å«å¾ªç¯å¼•ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒGSON ä¼šæŠ›å‡º StackOverflowErrorã€‚ä¾‹å¦‚å¦‚ä¸‹ Realm å¯¹è±¡æ‹¥æœ‰ä¸€ä¸ª Drawable å±æ€§ï¼š</p>
<pre><code class="java">public class Person extends RealmObject {
    @Ignore
    Drawable avatar;
    // å…¶ä»–å­—æ®µ
}
</code></pre>
<p>Person ç±»å«æœ‰ä¸€ä¸ª Android Drawable å¹¶ä¸”è¢« @Ignore ä¿®é¥°ã€‚å½“ GSON åºåˆ—åŒ–æ—¶ï¼ŒDrawable è¢«è¯»å–å¹¶ä¸”é€ æˆäº†å †æ ˆæº¢å‡ºã€‚(<a href="https://github.com/realm/realm-java/issues/1798" target="_blank" rel="external">GitHub Issue</a>)ã€‚æ·»åŠ å¦‚ä¸‹ä»£ç ä»¥é¿å…ç±»ä¼¼é—®é¢˜ï¼š</p>
<pre><code class="java">public boolean shouldSkipField(FieldAttributes f) {
  return f.getDeclaringClass().equals(RealmObject.class) || f.getDeclaringClass().equals(Drawable.class);
}
</code></pre>
<p>è¯·æ³¨æ„å¯¹ Drawable.class çš„åˆ¤å®šè¯­å¥ï¼Œå®ƒå‘Šè¯‰ GSON è·³è¿‡è¿™ä¸ªå±æ€§çš„åºåˆ—åŒ–ä»¥é¿å…å †æ ˆæº¢å‡ºé”™è¯¯ã€‚</p>
<h5 id="Realmä¸Jackson-databind"><a href="#Realmä¸Jackson-databind" class="headerlink" title="Realmä¸Jackson-databind"></a>Realmä¸Jackson-databind</h5><p><a href="https://github.com/FasterXML/jackson-databind" target="_blank" rel="external">Jackson-databind</a>æ˜¯ä¸€ä¸ªå®ç°JSONæ•°æ®å’ŒJavaç±»ä¹‹é—´ç»‘å®šçš„åº“ã€‚</p>
<p>Jacksonä½¿ç”¨åå°„å®ç°äº†æ•°æ®ç»‘å®šï¼Œè€Œè¿™ä¸Realmå¯¹RxJavaçš„æ”¯æŒäº§ç”Ÿäº†å†²çªå› ä¸ºå¯¹class loaderè€Œè¨€ï¼ŒRxJavaä¸ä¸€å®šå¯ç”¨ã€‚æ‰€é€ æˆçš„å¼‚å¸¸å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code>java.lang.NoClassDefFoundError: rx.Observable
at libcore.reflect.InternalNames.getClass(InternalNames.java:55)
...
</code></pre><p>å¯ä»¥é€šè¿‡ä¸ºé¡¹ç›®å¼•å…¥RxJavaæˆ–è€…åœ¨å·¥ç¨‹åˆ›å»ºä¸€ä¸ªçœ‹èµ·æ¥åŒ…å«ä¸‹é¢çš„ä»£ç çš„ç©ºæ–‡ä»¶æ¥ä¿®æ”¹ä¸Šé¢çš„é—®é¢˜ã€‚</p>
<pre><code class="java">package rx;

public class Observable {
    // ä¸ºäº†æ”¯æŒJackson-Databindï¼Œå¦‚æœæ²¡æœ‰å¼•å…¥RxJavaä¾èµ–ï¼Œ
    // è¿™æ ·çš„ç©ºæ–‡ä»¶å°±æ˜¯å¿…é¡»çš„
}
</code></pre>
<p>issueå·²ç»è¢«æäº¤åˆ°Jacksoné¡¹ç›®äº†ï¼Œæˆ³<a href="https://github.com/FasterXML/jackson-databind/issues/1070" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h5 id="Realmä¸Kotlin"><a href="#Realmä¸Kotlin" class="headerlink" title="Realmä¸Kotlin"></a>Realmä¸Kotlin</h5><p>Realm å®Œå…¨å…¼å®¹ <a href="https://kotlinlang.org/" target="_blank" rel="external">Kotlin</a> è¯­è¨€ï¼Œä½†æœ‰äº›åœ°æ–¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>æˆ‘ä»¬çš„æ¨¡å‹ç±»éœ€è¦æ˜¯ <a href="https://kotlinlang.org/docs/reference/classes.html#overriding-members" target="_blank" rel="external">å¼€æ”¾çš„(open)</a>ã€‚</li>
<li>æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æŸäº›æƒ…å†µä¸‹æ·»åŠ æ³¨è§£ <code>@RealmCLass</code> ä»¥ä¿è¯ç¼–è¯‘é€šè¿‡ã€‚è¿™æ˜¯ç”±äº<a href="http://blog.jetbrains.com/kotlin/2015/06/better-annotation-processing-supporting-stubs-in-kapt/" target="_blank" rel="external">å½“å‰ Kotlin æ³¨è§£å¤„ç†å™¨çš„ä¸€ä¸ªé™åˆ¶</a>ã€‚</li>
<li>å¾ˆå¤š Realm API å¼•ç”¨äº† Java ç±»ã€‚æˆ‘ä»¬å¿…é¡»åœ¨ç¼–è¯‘ä¾èµ–ä¸­æ·»åŠ  <code>org.jetbrains.kotlin:kotlin-reflect:${kotlin_version}</code>ã€‚</li>
</ul>
<p><a href="https://github.com/realm/realm-java/tree/master/examples/kotlinExample" target="_blank" rel="external">å‚è§ç¤ºä¾‹</a>ã€‚</p>
<h5 id="Realmä¸Retrofit"><a href="#Realmä¸Retrofit" class="headerlink" title="Realmä¸Retrofit"></a>Realmä¸Retrofit</h5><p><a href="http://square.github.io/retrofit/" target="_blank" rel="external">Retrofit</a> æ˜¯ä¸€ä¸ªç”± <a href="https://github.com/square" target="_blank" rel="external">Square</a> å¼€å‘ï¼Œä¿è¯ç±»å‹å®‰å…¨ï¼ˆtypesafeï¼‰çš„ REST API å¤„ç†å·¥å…·ã€‚</p>
<p>Realm å¯ä»¥ä¸ Retrofit 1.x å’Œ 2.x æ— ç¼é…åˆå·¥ä½œã€‚ä½†è¯·æ³¨æ„ Retrofit ä¸ä¼šè‡ªåŠ¨å°†å¯¹è±¡å­˜å…¥ Realmã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡è°ƒç”¨ <code>Realm.copyToRealm()</code> æˆ– <code>Realm.copyToRealmOrUpdate()</code> æ¥å°†å®ƒä»¬å­˜å…¥ Realmã€‚</p>
<pre><code>GitHubService service = restAdapter.create(GitHubService.class);
List&lt;Repo&gt; repos = service.listRepos(&quot;octocat&quot;);

// ä»Retrofitå¤åˆ¶æ•°æ®å…ƒç´ åˆ°Realm
realm.beginTransaction();
List&lt;Repo&gt; realmRepos = realm.copyToRealmOrUpdate(repos);
realm.commitTransaction();
</code></pre><h5 id="Realmä¸RxJava"><a href="#Realmä¸RxJava" class="headerlink" title="Realmä¸RxJava"></a>Realmä¸RxJava</h5><p><a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="external">RxJava</a> æ˜¯ Netflix å‘å¸ƒçš„ä¸€ä¸ª <a href="http://reactivex.io/" target="_blank" rel="external">Reactive</a> çš„æ‰©å±• åº“ä»¥æ”¯æŒ <a href="https://en.wikipedia.org/wiki/Observer_pattern" target="_blank" rel="external">è§‚å¯Ÿè€…æ¨¡å¼</a>ã€‚</p>
<p>Realm åŒ…å«äº†å¯¹ RxJava çš„åŸç”Ÿæ”¯æŒã€‚å¦‚ä¸‹ç±»å¯ä»¥è¢«æš´éœ²ä¸ºä¸€ä¸ª <a href="https://github.com/ReactiveX/RxJava/wiki/Observable" target="_blank" rel="external"><code>Observable</code></a>ï¼š<a href="https://realm.io/docs/java/latest/api/io/realm/Realm.html#asObservable--" target="_blank" rel="external"><code>Realm</code></a>, <a href="https://realm.io/docs/java/latest/api/io/realm/RealmResults.html#asObservable--" target="_blank" rel="external"><code>RealmResults</code></a>, <a href="https://realm.io/docs/java/latest/api/io/realm/RealmObject.html#asObservable--" target="_blank" rel="external"><code>RealmObject</code></a>, <a href="https://realm.io/docs/java/latest/api/io/realm/DynamicRealm.html#asObservable--" target="_blank" rel="external"><code>DynamicRealm</code></a> å’Œ <a href="https://realm.io/docs/java/latest/api/io/realm/DynamicRealmObject.html#asObservable--" target="_blank" rel="external"><code>DynamicRealmObject</code></a>ã€‚</p>
<pre><code class="java">// ç»¼åˆä½¿ç”¨Realm, Retrofit å’Œ RxJava(ä½¿ç”¨Retrolambdaä½¿è¯­æ³•æ›´ç®€æ´)
// åŠ è½½æ‰€æœ‰ç”¨æˆ·å¹¶å°†å®ƒä»¬çš„GitHubçš„æœ€æ–°statsåˆå¹¶(å¦‚æœæœ‰çš„è¯)
Realm realm = Realm.getDefaultInstance();
GitHubService api = retrofit.create(GitHubService.class);
realm.where(Person.class).isNotNull(&quot;username&quot;).findAllAsync().asObservable()
    .filter(persons.isLoaded)
    .flatMap(persons -&gt; Observable.from(persons))
    .flatMap(person -&gt; api.user(person.getGithubUserName())
    .observeOn(AndroidSchedulers.mainThread())
    .subscribe(user -&gt; showUser(user));
</code></pre>
<p>è¯·æ³¨æ„ <a href="https://realm.io/cn/docs/java/latest/#asynchronous-queries" target="_blank" rel="external">å¼‚æ­¥æŸ¥è¯¢</a> ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œå¦‚ä¸Šä»£ç ä¼šç«‹å³è¿”å›ä¸€ä¸ª RealmResults å®ä¾‹ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç¡®å®šè¯¥ RealmResults å·²ç»åŠ è½½å®Œæˆè¯·ä½¿ç”¨ <a href="http://reactivex.io/documentation/operators/filter.html" target="_blank" rel="external">filter operator</a> å’Œ <a href="https://realm.io/cn/docs/java/latest/api/io/realm/RealmResults.html#isLoaded--" target="_blank" rel="external">`RealmResults<e>.isLoaded()</e></a> æ–¹æ³•ã€‚é€šè¿‡åˆ¤æ–­ RealmResults æ˜¯å¦å·²ç»åŠ è½½å¯ä»¥å¾—çŸ¥æŸ¥è¯¢æ˜¯å¦å·²ç»å®Œæˆã€‚</p>
<p>å‚è€ƒ <a href="https://github.com/realm/realm-java/tree/master/examples/rxJavaExample" target="_blank" rel="external">RxJava sample project</a>ã€‚</p>
<p><strong>é…ç½®</strong><br>RxJava æ˜¯å¯é€‰ä¾èµ–ï¼Œè¿™æ„å‘³ç€ Realm ä¸ä¼šè‡ªåŠ¨åŒ…å«å®ƒã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©éœ€è¦çš„ RxJava ç‰ˆæœ¬ä»¥åŠé˜²æ­¢è¿‡å¤šçš„æ— ç”¨æ–¹æ³•è¢«æ‰“åŒ…ã€‚å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨ç›¸å…³åŠŸèƒ½ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ  RxJava åˆ° <code>build.gradle</code> æ–‡ä»¶ã€‚</p>
<pre><code>dependencies {
  compile &#39;io.reactivex:rxjava:1.1.0&#39;
}
</code></pre><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿ <a href="https://realm.io/cn/docs/java/latest/api/io/realm/rx/RxObservableFactory.html" target="_blank" rel="external"><code>RxObservableFactory</code></a> æ¥å†³å®š <code>Observable</code> çš„ç”Ÿæˆæ–¹å¼ï¼Œç„¶åé€šè¿‡ <code>RealmConfiguration</code> è¿›è¡Œé…ç½®ã€‚</p>
<pre><code class="java">RealmConfiguration config = new RealmConfiguration.Builder()
  .rxFactory(new MyRxFactory())
  .build()
</code></pre>
<p>å¦‚æœæ²¡æœ‰ <code>RxObservableFactory</code> è¢«å®šä¹‰ï¼Œ<code>RealmObservableFactory</code> ä¼šè¢«é»˜è®¤ä½¿ç”¨ï¼Œå®ƒæ”¯æŒ RxJava &lt;= 1.1.*(ä¹Ÿå°±æ„å‘³ç€ç›®å‰åœ¨RxJava2.0ä¸Šç°åœ¨è¿˜æ²¡æœ‰åŠæ³•ä½¿ç”¨â€¦)ã€‚</p>
<h2 id="ç‰ˆæœ¬è¿ç§»"><a href="#ç‰ˆæœ¬è¿ç§»" class="headerlink" title="ç‰ˆæœ¬è¿ç§»"></a>ç‰ˆæœ¬è¿ç§»</h2><p>å½“æˆ‘ä»¬çš„æ•°æ®ç»“æ„å‘ç”Ÿäº†å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œå‡çº§äº†ã€‚è€Œåœ¨Realmä¸Šï¼Œæ•°æ®åº“çš„å‡çº§æ˜¯é€šè¿‡è¿ç§»æ“ä½œå®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯æŠŠåŸæ¥çš„æ•°æ®è¿ç§»åˆ°å…·æœ‰æ–°æ•°æ®ç»“æ„çš„æ•°æ®åº“ã€‚é€šå¸¸ï¼Œè¿™æ ·çš„æ“ä½œå¯ä»¥åˆ†æˆä¸¤éƒ¨å®Œæˆã€‚</p>
<ol>
<li><p>åˆ›å»ºè¿ç§»ç±»</p>
<pre><code class="java"> // è¿ç§»ç±»ç¤ºä¾‹
 public class MyMigration implements RealmMigration{

       @Override
       public void migrate(DynamicRealm realm, long oldVersion, long newVersion) {

          // DynamicRealm æš´éœ²äº†ä¸€ä¸ªå¯ç¼–è¾‘çš„schema
          RealmSchema schema = realm.getSchema();

          // è¿ç§»åˆ°ç‰ˆæœ¬ 1 : æ·»åŠ ä¸€ä¸ªæ–°çš„ç±»
          // ç¤ºä¾‹:
          // public Person extends RealmObject {
          //     private String name;
          //     private int age;
          //     // getters and setters left out for brevity
          // }
          if (oldVersion == 0) {
             schema.create(&quot;Person&quot;)
                 .addField(&quot;name&quot;, String.class)
                 .addField(&quot;age&quot;, int.class);
             oldVersion++;
          }

          // è¿ç§»åˆ°ç‰ˆæœ¬ 2 :æ·»åŠ ä¸€ä¸ªprimary key + å¯¹è±¡å¼•ç”¨
          // ç¤ºä¾‹:
          // public Person extends RealmObject {
          //     private String name;
          //     @PrimaryKey
          //     private int age;
          //     private Dog favoriteDog;
          //     private RealmList&lt;Dog&gt; dogs;
          //     // getters and setters left out for brevity
          // }
          if (oldVersion == 1) {
             schema.get(&quot;Person&quot;)
                 .addField(&quot;id&quot;, long.class, FieldAttribute.PRIMARY_KEY)
                 .addRealmObjectField(&quot;favoriteDog&quot;, schema.get(&quot;Dog&quot;))
                 .addRealmListField(&quot;dogs&quot;, schema.get(&quot;Dog&quot;));
             oldVersion++;
          }
       }

 }
</code></pre>
</li>
<li><p>ä½¿ç”¨<code>Builder.migration</code>å‡çº§æ•°æ®åº“</p>
<p> å°†ç‰ˆæœ¬å·æ”¹ä¸º2ï¼Œå½“Realmå‘ç°æ–°æ—§ç‰ˆæœ¬å·ä¸ä¸€è‡´æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨è¯¥è¿ç§»ç±»å®Œæˆè¿ç§»æ“ä½œã€‚</p>
<pre><code class="java"> RealmConfiguration config = new RealmConfiguration.Builder()
     .schemaVersion(2) // åœ¨schemaæ”¹å˜åï¼Œå¿…é¡»è¿›è¡Œå‡çº§
     .migration(new MyMigration()) // å¼€å§‹è¿ç§»
     .build()
</code></pre>
</li>
</ol>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>å†™åˆ°è¿™é‡Œï¼ŒåŸºæœ¬çš„å†…å®¹å°±å·®ä¸å¤šè®¨è®ºå®Œäº†ï¼Œäº‹å®ä¸Šï¼ŒRealmè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç©æ³•ï¼Œæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥æˆ³<a href="https://realm.io/" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œè¯¦ç»†çš„äº†è§£ã€‚</p>
<p>æˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªåº”ç”¨<a href="https://github.com/TonnyL/Espresso" target="_blank" rel="external">Espressoæ˜¯ä¸€æ¬¾åŸºäºMVP(Model-View-Presenter)æ¶æ„, Material Designè®¾è®¡é£æ ¼, é‡‡ç”¨RxJava2, Retrofit2, Realmæ•°æ®åº“å’ŒZXingå¼€å‘çš„å¿«é€’è¿½è¸ªåº”ç”¨</a>ï¼Œç”¨åˆ°äº†Realmï¼Œæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥çœ‹çœ‹ã€‚</p>
<p>æœ¬æ–‡åŒæ­¥å‘è¡¨äº<a href="http://www.jianshu.com/p/42584d637fb1" target="_blank" rel="external">TonnyLçš„ç®€ä¹¦</a>, <a href="https://tonnyl.github.io/2017/04/03/Realm-Java-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/">TonnyLçš„åšå®¢</a>, <a href="https://zhuanlan.zhihu.com/p/26173366" target="_blank" rel="external">çŸ¥ä¹ä¸“æ Tonnyçš„å’–å•¡é¦†-äººÂ·æŠ€æœ¯Â·ç”Ÿæ´»</a>ï¼Œè½¬è½½è¯·æ³¨æ˜ä½œè€…å’Œå‡ºå¤„ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://realm.io/" target="_blank" rel="external">Realm:Create reactive mobile apps in a fraction of time</a></p>
<p><a href="https://youngytj.github.io/2017/01/01/Realm-Java/" target="_blank" rel="external">Androidä¸‹Realmä½¿ç”¨çš„2ã€3äº‹</a></p>
<p><a href="http://www.jianshu.com/p/cd368b1996a7" target="_blank" rel="external">Android Realmå…¥å‘æŒ‡å—</a></p>
<p><a href="https://juejin.im/entry/5827f4dac4c971005438378f" target="_blank" rel="external">è¯´è¯´ Realm åœ¨ Android ä¸Šçš„å‘</a></p>
<p><a href="http://www.jianshu.com/p/37af717761cc" target="_blank" rel="external">ã€Androidã€‘Realmè¯¦è§£</a></p>
<p><a href="http://www.jianshu.com/p/8cb639a78975" target="_blank" rel="external">åœ¨Androidä¸­ä½¿ç”¨Realmä½œæœ¬åœ°å­˜å‚¨</a></p>
<p>ä»¥ä¸Šæ‰€æœ‰æµ‹è¯•å‡åŸºäºRealm 3.0, è®¾å¤‡ä¸ºOnePlus 3(Android 7.1.1), ç¯å¢ƒä¸ºmacOS 10.12.4.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[GitHubå…¥é—¨ä¸å®è·µ]]></title>
      <url>http://tonnyl.github.io/2017/03/15/GitHub%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%9E%E8%B7%B5/</url>
      <content type="html"><![CDATA[<p>æ¬¢è¿æ¥åˆ°GitHubçš„ä¸–ç•Œ~<br><a id="more"></a></p>
<blockquote>
<p>æœ¬æ–‡åŒæ­¥å‘è¡¨äº<a href="http://www.jianshu.com/p/f74b6900997b" target="_blank" rel="external">TonnyLçš„ç®€ä¹¦</a>, <a href="https://zhuanlan.zhihu.com/p/25960534" target="_blank" rel="external">çŸ¥ä¹ä¸“æ </a>, <a href="https://tonnyl.github.io/2017/03/15/GitHub%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%9E%E8%B7%B5/">TonnyLçš„åšå®¢</a>, è½¬è½½è¯·æ³¨æ˜ä½œè€…å’Œå‡ºå¤„ã€‚</p>
</blockquote>
<h2 id="Welcome-to-GitHub"><a href="#Welcome-to-GitHub" class="headerlink" title="Welcome to GitHub"></a>Welcome to GitHub</h2><h3 id="ä»€ä¹ˆæ˜¯GitHub"><a href="#ä»€ä¹ˆæ˜¯GitHub" class="headerlink" title="ä»€ä¹ˆæ˜¯GitHub"></a>ä»€ä¹ˆæ˜¯GitHub</h3><p><a href="https://github.com/" target="_blank" rel="external">GitHub</a>æ˜¯ä¸€ä¸ª<del>åŒæ€§äº¤å‹ç¤¾åŒº</del>ï¼Œä¸å¥½æ„æ€ï¼Œæ‹¿é”™å‰§æœ¬äº†ã€‚<a href="https://github.com/" target="_blank" rel="external">GitHub</a>åœ¨<a href="https://zh.wikipedia.org/wiki/Wikipedia:%E9%A6%96%E9%A1%B5" target="_blank" rel="external">Wikipedia</a>ä¸Šçš„ä»‹ç»æ˜¯<a href="https://zh.wikipedia.org/wiki/GitHub" target="_blank" rel="external">è¿™æ ·</a>çš„ï¼š</p>
<blockquote>
<p>GitHubæ˜¯ä¸€ä¸ªé€šè¿‡<a href="https://zh.wikipedia.org/wiki/Git" target="_blank" rel="external">Git</a>è¿›è¡Œ<a href="https://zh.wikipedia.org/wiki/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6" target="_blank" rel="external">ç‰ˆæœ¬æ§åˆ¶</a>çš„è½¯ä»¶æºä»£ç æ‰˜ç®¡æœåŠ¡ï¼Œç”±GitHubå…¬å¸ï¼ˆæ›¾ç§°Logical Awesomeï¼‰çš„å¼€å‘è€…Chris Wanstrathã€PJ Hyettå’ŒTom Preston-Wernerä½¿ç”¨<a href="https://zh.wikipedia.org/wiki/Ruby_on_Rails" target="_blank" rel="external">Ruby on Rails</a>ç¼–å†™è€Œæˆã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼ŒGitHubæ˜¯ä¸€ä¸ªè®©å¼€å‘è€…ä¸ä»–äººå…±äº«ä»£ç çš„åœ°æ–¹ã€‚å…¶å…¬å¸æ€»éƒ¨ä½äºç¾å›½åŠ åˆ©ç¦åˆ©äºšå·æ—§é‡‘å±±ï¼Œå…¶logoæ˜¯ä¸€åªåä¸ºOctocatçš„å¯çˆ±ç« é±¼çŒ«ï¼Œå°±æ˜¯ä¸‹é¢çš„è¿™ä¸ªå°èŒèŒäº†â†“</p>
<p><img src="https://ww3.sinaimg.cn/large/006tNbRwgy1fdng5xb7ckj30m80ih1ky.jpg" alt="Octocat"></p>
<p>å½“ç„¶ï¼Œå¥¹è¿˜æœ‰å¯èƒ½æ˜¯è¿™æ ·çš„ğŸ™ƒ<br><img src="https://ww1.sinaimg.cn/large/006tNbRwgy1fdngajog08j308c08cq33.jpg" alt="Octocat"></p>
<h3 id="GitHubä¸Gitæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#GitHubä¸Gitæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="GitHubä¸Gitæœ‰ä»€ä¹ˆåŒºåˆ«"></a>GitHubä¸Gitæœ‰ä»€ä¹ˆåŒºåˆ«</h3><p>Gitå…¶å®æ˜¯ä¸€ç§ç‰ˆæœ¬æ§åˆ¶çš„åè®®ï¼Œå®šä¹‰äº†ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶çš„å„ç§æ“ä½œï¼Œç±»ä¼¼çš„è¿˜æœ‰SVN/CVSï¼Œä½†æ˜¯å’ŒSVN/CVSä¸åŒçš„æ˜¯ï¼ŒGité‡‡ç”¨çš„æ˜¯åˆ†å¸ƒå¼çš„æ–¹å¼ï¼Œå¹¶ä¸éœ€è¦æœåŠ¡å™¨ç«¯çš„è½¯ä»¶ã€‚</p>
<p>è€ŒGitHubæ˜¯åŸºäºGitåè®®çš„ä¸€ä¸ªç½‘ç»œä»£ç ä»“åº“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGitHubä¸Šå…¬å¼€çš„è½¯ä»¶æºä»£ç éƒ½æ˜¯æœ‰Gitè¿›è¡Œç®¡ç†ï¼Œä½†æ˜¯GitHubé™¤äº†æä¾›Gitä»“åº“çš„æ‰˜ç®¡æœåŠ¡å¤–ï¼Œè¿˜ä¸ºå¼€å‘è€…æˆ–å›¢é˜Ÿæä¾›äº†ä¸€ç³»åˆ—çš„åŠŸèƒ½(åé¢ä¼šè¯¦ç»†è¯´æ˜)ï¼Œä¾‹å¦‚åœ¨çº¿æµè§ˆã€æœç´¢å’Œç®¡ç†ã€ç¤¾äº¤ç­‰ç­‰ï¼Œå¸®åŠ©å¼€å‘è€…å’Œå›¢é˜Ÿé«˜æ•ˆç‡ã€é«˜å“è´¨çš„ç¼–å†™ä»£ç ã€‚</p>
<p>(å¥½å§ï¼Œè¯´äº†è¿™ä¹ˆå¤šæ‹—å£çš„è¯ï¼Œç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥å°†Gitä¸GitHubçš„å…³ç³»ç†è§£ä¸ºã€Œé­”å…½äº‰éœ¸ã€å’Œã€Œå¯¹æˆ˜å¹³å°ã€çš„å…³ç³»ã€‚)</p>
<h3 id="GitHubçš„ä½¿ç”¨æƒ…å†µ"><a href="#GitHubçš„ä½¿ç”¨æƒ…å†µ" class="headerlink" title="GitHubçš„ä½¿ç”¨æƒ…å†µ"></a>GitHubçš„ä½¿ç”¨æƒ…å†µ</h3><p>æˆªæ­¢åˆ°2015å¹´ï¼ŒGitHubå·²ç»æœ‰è¶…è¿‡ä¹ç™¾ä¸‡æ³¨å†Œç”¨æˆ·å’Œ2110ä¸‡ä»£ç åº“ã€‚äº‹å®ä¸Šå·²ç»æˆä¸ºäº†ä¸–ç•Œä¸Šæœ€å¤§çš„ä»£ç å­˜æ”¾ç½‘ç«™å’Œå¼€æºç¤¾åŒºã€‚å…¨ä¸–ç•Œæ¯æ—¶æ¯åˆ»éƒ½æœ‰å¼€å‘è€…åœ¨ä½¿ç”¨å®ƒã€‚</p>
<h3 id="GitHubæä¾›çš„ä¸»è¦åŠŸèƒ½"><a href="#GitHubæä¾›çš„ä¸»è¦åŠŸèƒ½" class="headerlink" title="GitHubæä¾›çš„ä¸»è¦åŠŸèƒ½"></a>GitHubæä¾›çš„ä¸»è¦åŠŸèƒ½</h3><ul>
<li><p>Gitä»“åº“</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬æ³¨å†Œäº†GitHubè´¦æˆ·ä¹‹åï¼Œæˆ‘ä»¬å…è´¹æ–°å»ºä»»æ„ä¸ªGitHubæä¾›çš„Gitä»“åº“ã€‚å¦‚æœéœ€è¦å»ºç«‹åªå¯¹ç‰¹å®šç”¨æˆ·æˆ–è‡ªå·±å…¬å¼€çš„ç§æœ‰ä»“åº“ï¼Œåˆ™éœ€è¦æŒ‰ç…§<a href="https://github.com/pricing" target="_blank" rel="external">Plans for all workflows</a>æ”¯ä»˜æ¯æœˆæœ€ä½7ç¾å…ƒçš„è´¹ç”¨ã€‚<br><img src="https://ww4.sinaimg.cn/large/006tNc79gy1fdomdvwo4kj31kw0zaal1.jpg" alt="Plans for all workflows"></p>
</li>
<li><p><a href="https://github.com/blog/674-introducing-organizations" target="_blank" rel="external">Organization</a></p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœåªæ˜¯ä¸ªäººä½¿ç”¨ï¼Œä¸ªäººè´¦æˆ·å°±è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœæ˜¯å›¢é˜Ÿæˆ–è€…å…¬å¸ï¼Œå»ºè®®ä½¿ç”¨Organizationè´¦æˆ·ï¼Œå®ƒå¯ä»¥ç»Ÿä¸€ç®¡ç†è´¦æˆ·å’Œæƒé™ï¼ŒåŒæ—¶ä¹Ÿèƒ½ç»Ÿä¸€æ”¯ä»˜ä¸€äº›è´¹ç”¨ã€‚</p>
<p>å’Œä¸ªäººè´¦æˆ·ç±»ä¼¼ï¼Œå¦‚æœåªæ˜¯åˆ›å»ºå…¬å¼€ä»“åº“ï¼Œåˆ›å»ºOrganizationè´¦æˆ·æ˜¯ä¸æ”¶è´¹çš„ã€‚å› æ­¤ï¼Œå¯¹äºå°å‹å¼€å‘å›¢é˜Ÿè€Œè¨€ï¼ŒOrganizationæˆ–è®¸æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚<br><img src="https://ww3.sinaimg.cn/large/006tNc79gy1fdomm5qn0tj30sq0o6q69.jpg" alt="Organization"></p>
<p>ä¸‹é¢æ˜¯Google Organizationè´¦æˆ·ä¿¡æ¯:<br><img src="https://ww2.sinaimg.cn/large/006tNc79gy1fdprpuqo8lj31kw119gz2.jpg" alt="Google Organization Account"></p>
</li>
<li><p>Issue</p>
<p>Issueç”¨äºå¯¹æœ‰ä¸€ä¸ªä»»åŠ¡æˆ–é—®é¢˜è¿›è¡Œè¿½è¸ªå’Œç®¡ç†ã€‚è¿™æœ‰ç‚¹ç±»ä¼¼äºBUGç®¡ç†ç³»ç»Ÿ(ä¾‹å¦‚Mozillaå…¬å¸å‡ºå“çš„<a href="https://bugzilla.mozilla.org/" target="_blank" rel="external">Bugzilla</a>)ã€‚åœ¨GitHubä¸Šï¼Œæˆ‘ä»¬æ¯æ¬¡åˆ›å»ºä¸€ä¸ªPull Requestæ—¶ï¼Œéƒ½ä¼šè¦æ±‚åˆ›å»ºä¸€ä¸ªIssueã€‚</p>
<p>æ¯æ¬¡å°†è¦å¯¹åŠŸèƒ½è¿›è¡Œæ›´æ”¹æˆ–è€…ä¿®æ­£æ—¶ï¼Œéƒ½åº”è¯¥åˆ›å»ºä¸€ä¸ªIssue(é™¤éæ˜¯æœ‰ç‰¹æ®Šçš„åŸå› ï¼Œæœ€å¥½ä½¿ç”¨è‹±æ–‡ï¼Œå¦‚æœä½¿ç”¨ä¸­æ–‡ï¼Œé¡¹ç›®æ‰€æœ‰è€…è¿˜éœ€è¦è€—è´¹æ—¶é—´å’Œç²¾åŠ›æ›¿ä½ ç¿»è¯‘ï¼Œè€Œè¿™æœ¬æ˜¯ä½ åº”è¯¥å®Œæˆçš„äº‹ç‰©)ï¼Œè®¨è®ºæˆ–è€…ä¿®æ­£éƒ½å›´ç»•è¿™ä¸ªIssueä¸ºä¸­å¿ƒè¿›è¡Œã€‚åªè¦æŸ¥çœ‹Issueï¼Œå°±èƒ½äº†è§£å’Œè¿™ä¸ªæ›´æ”¹æœ‰å…³çš„ä¿¡æ¯ï¼Œå¹¶ä»¥æ­¤è¿›è¡Œç®¡ç†ã€‚</p>
<p>åœ¨Gitçš„æäº¤ä¿¡æ¯ä¸­å†™ä¸ŠIssueçš„ID(ä¾‹å¦‚ã€Œ#7ã€)ï¼ŒGitHubå°±ä¼šè‡ªåŠ¨ç”Ÿæˆä»Issueåˆ°å¯¹åº”æäº¤çš„é“¾æ¥ã€‚å¦å¤–ï¼Œåªè¦æŒ‰ç…§ç‰¹å®šçš„æ ¼å¼æè¿°æäº¤ä¿¡æ¯ï¼Œè¿˜å¯ä»¥å…³é—­Issueã€‚</p>
<p>ä¸‹é¢æ˜¯<a href="https://github.com/google/gson" target="_blank" rel="external">google-gson</a>é¡¹ç›®çš„ä¸€ä¸ªIssueã€‚<br><img src="https://ww4.sinaimg.cn/large/006tNc79gy1fdps9ly95bj31kw10348p.jpg" alt=""></p>
<p>ps:è¯·ä¸è¦åœ¨Issueä¸­è®¨è®ºå’Œé¡¹ç›®æ— å…³çš„å†…å®¹(ä¾‹å¦‚çŒæ°´ã€æ— æ„ä¹‰çš„èŠå¤©ç­‰),ä¹Ÿä¸è¦è¿ç€å‘å¸–,å› ä¸ºä½ æ¯å‘å¸ƒä¸€æ¬¡æ— æ„ä¹‰çš„å†…å®¹ï¼Œé¡¹ç›®çš„ä½œè€…å’Œå…³æ³¨(Watch)è¿™ä¸ªé¡¹ç›®çš„äººå°±ä¼šæ”¶åˆ°ä¸€å°åƒåœ¾é‚®ä»¶ã€‚æ‰€ä»¥ï¼Œè¯·å…±åŒç»´æŠ¤GitHubçš„è‰¯å¥½æ°›å›´ã€‚</p>
</li>
<li><p>Wiki</p>
<p>é€šè¿‡WikiåŠŸèƒ½ï¼Œä»»ä½•äººéƒ½å¯ä»¥éšæ—¶å¯¹ä¸€ç¯‡æ–‡ç« è¿›è¡Œæ›´æ”¹å¹¶ä¿å­˜ï¼Œå› æ­¤å¯ä»¥å¤šäººå…±åŒå®Œæˆä¸€ç¯‡æ–‡ç« ã€‚è¯¥åŠŸèƒ½å¸¸ç”¨äºåœ¨å¼€å‘æ–‡æ¡£æˆ–æ‰‹å†Œçš„ç¼–å†™ä¸­ã€‚</p>
<p>Wikiä¹Ÿæ˜¯ä½œä¸ºGitä»“åº“è¿›è¡Œç®¡ç†çš„ï¼Œæ”¹è¿›çš„å†å²è®°å½•ä¹Ÿä¼šè¢«åˆ‡å®ä¿å­˜ï¼Œä½¿ç”¨è€…å¯ä»¥æ”¾å¿ƒçš„æ”¹å†™ï¼Œå¹¶ä¸”æ”¯æŒå…‹éš†åˆ°æœ¬åœ°è¿›è¡Œç¼–è¾‘ã€‚</p>
<p>è¿™æ˜¯å¼€æºå¤§æˆ·<a href="https://github.com/square" target="_blank" rel="external">square</a>çš„é¡¹ç›®<a href="https://github.com/square/okhttp" target="_blank" rel="external">okhttp</a>çš„wikié¦–é¡µ:<br><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fdwyuitbj5j31kw101jw0.jpg" alt="[okhttp wiki](https://github.com/square/okhttp/wiki)"></p>
</li>
<li><p>Pull Request</p>
<p>å½“æˆ‘ä»¬forkäº†åˆ«äººçš„ä»£ç ï¼Œå¹¶åšäº†ç›¸åº”çš„ä¿®æ”¹ä¹‹åï¼Œå°±å¯ä»¥Pull Requestå‘ä»“åº“çš„æ‰€æœ‰è€…æå‡ºç”³è¯·ï¼Œè¯·æ±‚å¯¹æ–¹åˆå¹¶è‡ªå·±ä¿®æ”¹ä¹‹åçš„ä»£ç ã€‚å‘å‡ºPull Requestä¹‹åï¼Œå¯¹æ–¹çš„ç®¡ç†äººå‘˜å¯ä»¥æŸ¥çœ‹Pull Requestçš„å†…å®¹åŠå…¶ä¸­åŒ…å«çš„ä»£ç æ›´æ”¹ã€‚</p>
<p>åŒæ—¶ï¼Œä½ å¯ä»¥åˆ©ç”¨GitHubæä¾›çš„å¯¹Pull Requestå’Œæºä»£ç å·®åˆ«è¯„è®ºçš„åŠŸèƒ½ï¼Œä»¥è¡Œä¸ºå•ä½å¯¹ä»£ç è¿›è¡Œè®¨è®ºã€‚</p>
<p>squareçš„å¦å¤–ä¸€ä¸ªé¡¹ç›®<a href="https://github.com/square/retrofit" target="_blank" rel="external">retrofit</a>çš„<a href="https://github.com/square/retrofit/pulls" target="_blank" rel="external">Pull Request</a>:<br><img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fdwyzenqh6j31kw11gdpa.jpg" alt="[Pull Request](https://github.com/square/retrofit/pulls)"></p>
</li>
<li><p><a href="https://gist.github.com/" target="_blank" rel="external">Gist</a></p>
<p>æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸ºäº†ä¸€ä¸ªå°å°çš„ä»£ç ç‰‡æ®µè€Œå¼€å¯ä¸€ä¸ªä»“åº“ï¼Œè¿™ä¸ªæ—¶å€™Gistå°±æ´¾ä¸Šç”¨åœºäº†ã€‚Gistæ˜¯ä¸€ä¸ªæœ‰è¶£çš„æœåŠ¡ï¼Œæœ€ç®€å•çš„åŠŸèƒ½å°±æ˜¯åˆ†äº«ä»£ç ç‰‡æ®µï¼Œä½†å¥¹çš„åŠŸèƒ½å¹¶ä¸å±€é™äºæ­¤ï¼ŒGistå¹¶ä¸ä»…ä»…ä¸ºå¼€å‘è€…æœåŠ¡ï¼Œä»»ä½•äºº(å…è®¸åŒ¿å)éƒ½å¯ä»¥åˆ©ç”¨å¥¹åˆ†äº«å†…å®¹ã€‚</p>
</li>
<li><p><a href="https://pages.github.com/" target="_blank" rel="external">GitHub Pages</a></p>
<p>GitHub Pages æ˜¯å…è´¹çš„é™æ€ç©ºé—´æœåŠ¡ï¼Œå¯ä»¥æ¶è®¾é™æ€ç½‘ç«™ï¼ŒåŒ…æ‹¬é™æ€åšå®¢ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨GitHub Pagesæ­é…<a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>æˆ–è€…<a href="https://jekyllrb.com/" target="_blank" rel="external">Jekyll</a>ç­‰é™æ€åšå®¢ç³»ç»Ÿæ­å»ºæˆ‘ä»¬è‡ªå·±çš„åšå®¢ã€‚</p>
<p>è¿™æ˜¯æˆ‘åˆ©ç”¨GitHub Pageså’ŒHexoæ­é…çš„åšå®¢:<br><a href="https://tonnyl.github.io/">https://tonnyl.github.io/</a></p>
</li>
</ul>
<h3 id="GitHubä¸Šçš„ä¸€äº›çŸ¥åé¡¹ç›®"><a href="#GitHubä¸Šçš„ä¸€äº›çŸ¥åé¡¹ç›®" class="headerlink" title="GitHubä¸Šçš„ä¸€äº›çŸ¥åé¡¹ç›®"></a>GitHubä¸Šçš„ä¸€äº›çŸ¥åé¡¹ç›®</h3><ul>
<li><a href="https://github.com/torvalds/linux" target="_blank" rel="external">Linux</a> - Linux kernel source tree.(43k star, æ— ç©·ä¸ªè´¡çŒ®è€…)</li>
<li><a href="https://github.com/git/git" target="_blank" rel="external">Git</a></li>
<li><a href="https://github.com/nodejs/node" target="_blank" rel="external">node</a> - Node.js JavaScript runtime.</li>
<li><a href="https://github.com/rails/rails" target="_blank" rel="external">rails</a> - Ruby on Rails.</li>
</ul>
<h3 id="å½©è›‹"><a href="#å½©è›‹" class="headerlink" title="å½©è›‹"></a>å½©è›‹</h3><p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fdx06fy4drj30us0q8q8x.jpg" alt="[GitHub](https://github.com/TonnyL)"></p>
<p>GitHubï¼ŒåŒæ€§äº¤å‹ï¼ŒçœŸäººçº¦ä¼šï¼Œæ’è§£å¯‚å¯ï¼Œé‡Šæ”¾å‹åŠ›ã€‚ç™¾åˆ†ç™¾çœŸäººï¼Œè°æ²¡äº‹ä¼šå»æ³¨å†ŒGitHubå•Šï¼Œé€šè¿‡â€œFollowâ€äº¤åˆ°åŒæ€§å¥½å‹ï¼›é€šè¿‡Issueå’ŒPRäº’åŠ¨å’Œäº¤æµã€‚So, f**k, oh no, follow me on GitHubã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å¦‚ä½•ç”¨ä¸€å‘¨æ—¶é—´å¼€å‘ä¸€æ¬¾Android APPå¹¶åœ¨Google Playä¸Šçº¿]]></title>
      <url>http://tonnyl.github.io/2017/02/08/%E5%A6%82%E4%BD%95%E7%94%A8%E4%B8%80%E5%91%A8%E6%97%B6%E9%97%B4%E5%BC%80%E5%8F%91%E4%B8%80%E6%AC%BEAndroid-APP%E5%B9%B6%E5%9C%A8Google-Play%E4%B8%8A%E7%BA%BF/</url>
      <content type="html"><![CDATA[<p>ç›®æ ‡ï¼šå®ç°<a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">çº¸é£æœº</a>App - é‡‡ç”¨MVPæ¶æ„ï¼Œé›†åˆäº†çŸ¥ä¹æ—¥æŠ¥ã€æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„ç»¼åˆæ€§é˜…è¯»å®¢æˆ·ç«¯ã€‚æ•ˆæœå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2440049-75f9c938a87c3c46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PaperPlane"></p>
<p>æœ¬æ¬¡æ•™ç¨‹åˆ†ä¸º7å¤©ï¼Œå†…å®¹åˆ†åˆ«ä¸ºï¼š</p>
<ul>
<li>ç¬¬ä¸€å¤©ï¼Œå‡†å¤‡<ul>
<li>åŠŸèƒ½éœ€æ±‚</li>
<li>å¯è¡Œæ€§åˆ†æ</li>
<li>å…¶ä»–å‡†å¤‡</li>
</ul>
</li>
<li>ç¬¬äºŒå¤©ï¼ŒUI<ul>
<li>é€‰æ‹©åˆé€‚çš„UI</li>
</ul>
</li>
<li>ç¬¬ä¸‰å¤©ï¼Œæ•´ä½“æ¶æ„</li>
<li>ç¬¬å››å¤©ï¼Œé¦–é¡µåˆ—è¡¨<ul>
<li>ç•Œé¢ç¼–å†™</li>
<li>å®ä½“ç±»</li>
<li>æ˜¾ç¤ºæ•°æ®</li>
<li>ç¼“å­˜å†…å®¹</li>
</ul>
</li>
<li>ç¬¬äº”å¤©ï¼Œè¯¦æƒ…é¡µä¸å…¶ä»–<ul>
<li>ç•Œé¢ç¼–å†™</li>
<li>å®ä½“ç±»</li>
<li>æ˜¾ç¤ºæ•°æ®</li>
<li>è®¾ç½®ä¸å…³äº</li>
</ul>
</li>
<li>ç¬¬å…­å¤©ï¼Œé«˜çº§åŠŸèƒ½<ul>
<li>æ–‡ç« æ”¶è—</li>
<li>å¤œé—´æ¨¡å¼</li>
<li>ç‰ˆæœ¬é€‚é…</li>
</ul>
</li>
<li>ç¬¬ä¸ƒå¤©ï¼Œå‘å¸ƒä¸å¼€æº<ul>
<li>åœ¨Google Playä¸Šçº¿</li>
<li>åœ¨GitHubå¼€æº</li>
<li>Q&amp;A</li>
</ul>
</li>
</ul>
<p>å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´äº†ã€‚ç°åœ¨å°±å¼€å§‹å§ã€‚</p>
<h3 id="DAY-1"><a href="#DAY-1" class="headerlink" title="DAY 1"></a>DAY 1</h3><p>ä¿—è¯è¯´ï¼Œä¸‡äº‹å¼€å¤´éš¾ï¼Œå‡†å¤‡å·¥ä½œåšå¥½äº†ï¼Œå¯ä»¥èµ·åˆ°äº‹åŠåŠŸå€çš„ä½œç”¨ã€‚ç£¨åˆ€ä¸è¯¯ç æŸ´å·¥å˜›ã€‚</p>
<h4 id="Day-1-åŠŸèƒ½éœ€æ±‚"><a href="#Day-1-åŠŸèƒ½éœ€æ±‚" class="headerlink" title="Day 1,åŠŸèƒ½éœ€æ±‚"></a>Day 1,åŠŸèƒ½éœ€æ±‚</h4><p>åœ¨å¼€å§‹æ­£å¼ç¼–ç ä¹‹å‰ï¼Œå’±ä»¬è¿˜æ˜¯å¾—å…ˆæŠŠè¦å®ç°çš„åŠŸèƒ½ä¸€ä¸€åˆ—å‡ºæ¥ï¼Œåé¢å®ç°èµ·æ¥æ‰æœ‰æ–¹å‘å˜›ã€‚æˆ‘è®¤ä¸ºå’±ä»¬éœ€è¦å®ç°çš„åŠŸèƒ½æœ‰ï¼š</p>
<ul>
<li>æ­£ç¡®è·å–æ¶ˆæ¯åˆ—è¡¨å¹¶å±•ç¤º</li>
<li>èƒ½å¤Ÿè·å–å†å²æ¶ˆæ¯</li>
<li>å±•ç¤ºå†…å®¹è¯¦æƒ…</li>
<li>åå°è‡ªåŠ¨ç¼“å­˜å†…å®¹è¯¦æƒ…ï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨æ— ç½‘ç»œè¿æ¥æ—¶æŸ¥çœ‹</li>
<li>æ”¶è—ç‰¹å®šæ¶ˆæ¯</li>
<li>å¤œé—´æ¨¡å¼</li>
</ul>
<p>ä¸€å…±6ä¸ªå¤§çš„éœ€æ±‚ï¼Œä¸å¤šï¼Œä½†æ˜¯æˆ‘ä»¬ä»”ç»†çš„ç ”ç©¶ä¸€ä¸‹ï¼Œå®é™…ä¸Šè¿™6ä¸ªéœ€æ±‚æ¶‰åŠåˆ°äº†ç½‘ç»œï¼ŒUIï¼Œæ•°æ®å­˜å‚¨ï¼Œåå°æœåŠ¡ç­‰å†…å®¹ã€‚ç›¸ä¿¡å¯¹äºèªæ˜çš„ä½ ä¸ç®—å›°éš¾ï¼Œç°åœ¨æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹å¯è¡Œæ€§ã€‚</p>
<h4 id="Day-1ï¼Œå¯è¡Œæ€§åˆ†æ"><a href="#Day-1ï¼Œå¯è¡Œæ€§åˆ†æ" class="headerlink" title="Day 1ï¼Œå¯è¡Œæ€§åˆ†æ"></a>Day 1ï¼Œå¯è¡Œæ€§åˆ†æ</h4><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦è€ƒè™‘çš„é—®é¢˜å°±æ˜¯ï¼š<strong>æ•°æ®ä»å“ªé‡Œæ¥ï¼Ÿ</strong>æ„Ÿè°¢å¼€æºï¼ŒGitHubä¸Š<a href="https://github.com/izzyleung" target="_blank" rel="external">izzyleung</a>å¤§ç¥åˆ†æäº†çŸ¥ä¹æ—¥æŠ¥çš„APIå¹¶å¼€æºäº†ï¼Œé¡¹ç›®åœ°å€è¯·æˆ³è¿™é‡Œï¼š<a href="https://github.com/izzyleung/ZhihuDailyPurify/wiki/%E7%9F%A5%E4%B9%8E%E6%97%A5%E6%8A%A5-API-%E5%88%86%E6%9E%90" target="_blank" rel="external">çŸ¥ä¹æ—¥æŠ¥ API åˆ†æ</a>ï¼Œåˆ†æçš„éå¸¸è¯¦ç»†ï¼Œçº¸é£æœºé¡¹ç›®åœ¨åˆæœŸï¼Œä¹Ÿå°±æ˜¯ç‰ˆæœ¬3.0ä¹‹å‰ä¹Ÿåªä½¿ç”¨äº†è¿™ä¸€ä¸ªAPIï¼Œåœ¨3.0ä¹‹åè¿˜ä½¿ç”¨æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„APIã€‚å¦‚æœä½ è¿˜æƒ³è¦å±•ç¤ºæ›´å¤šçš„å†…å®¹ï¼Œå¯ä»¥æˆ³è¿™é‡Œï¼š<a href="https://github.com/TonnyL/Awesome_APIs" target="_blank" rel="external">Awsome_API</a>ï¼Œæ”¶é›†äº†ä¸€äº›å›½å†…å¤–å¸¸ç”¨çš„APIã€‚</p>
<p>æˆ‘ä»¬æ¥ç²—ç•¥çš„çœ‹ä¸€ä¸‹æ•°æ®çš„å†…å®¹ã€‚è·å–çŸ¥ä¹æ—¥æŠ¥2017å¹´1æœˆ22æ—¥çš„æ¶ˆæ¯åˆ—è¡¨ï¼š</p>
<pre><code>http://news-at.zhihu.com/api/4/news/before/20170122
</code></pre><p>æœåŠ¡å™¨å‘æˆ‘ä»¬è¿”å›JSONæ ¼å¼çš„å†…å®¹ï¼š</p>
<pre><code class="json">{
  &quot;date&quot;: &quot;20170121&quot;,
  &quot;stories&quot;: [
    {
      &quot;images&quot;: [
        &quot;http://pic1.zhimg.com/ffcca2b2853f2af791310e6a6d694e80.jpg&quot;
      ],
      &quot;type&quot;: 0,
      &quot;id&quot;: 9165434,
      &quot;ga_prefix&quot;: &quot;012121&quot;,
      &quot;title&quot;: &quot;è°è¯´æ™®é€šäººçš„ç”Ÿæ´»å°±ä¸èƒ½ç²¾å½©æœ‰è¶£å‘¢ï¼Ÿ&quot;
    },
    ...
    ]
}
</code></pre>
<p>OKï¼Œè·å–åˆ°äº†åˆ—è¡¨ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–è¯¦ç»†çš„å†…å®¹äº†ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬è·å–idä¸º9165434çš„å†…å®¹ï¼Œåªéœ€è¦å°†idæ‹¼æ¥åˆ°<code>http://news-at.zhihu.com/api/4/news/</code>ä¹‹åï¼š</p>
<pre><code>http://news-at.zhihu.com/api/4/news/9165434
</code></pre><p>è·å–åˆ°çš„å†…å®¹ä¸ºï¼š</p>
<pre><code>{
  &quot;body&quot;: &quot;htmlæ ¼å¼çš„å†…å®¹&quot;,
  &quot;image_source&quot;: &quot;ã€Šå¸•ç‰¹æ£®ã€‹&quot;,
  &quot;title&quot;: &quot;è°è¯´æ™®é€šäººçš„ç”Ÿæ´»å°±ä¸èƒ½ç²¾å½©æœ‰è¶£å‘¢ï¼Ÿ&quot;,
  &quot;image&quot;: &quot;http://pic4.zhimg.com/e39083107b7324c6dbb725da83b1d7fb.jpg&quot;,
  &quot;share_url&quot;: &quot;http://daily.zhihu.com/story/9165434&quot;,
  &quot;js&quot;: [],
  &quot;ga_prefix&quot;: &quot;012121&quot;,
  &quot;section&quot;: {
    &quot;thumbnail&quot;: &quot;http://pic1.zhimg.com/ffcca2b2853f2af791310e6a6d694e80.jpg&quot;,
    &quot;id&quot;: 28,
    &quot;name&quot;: &quot;æ”¾æ˜ æœº&quot;
  },
  &quot;images&quot;: [
    &quot;http://pic1.zhimg.com/ffcca2b2853f2af791310e6a6d694e80.jpg&quot;
  ],
  &quot;type&quot;: 0,
  &quot;id&quot;: 9165434,
  &quot;css&quot;: [
    &quot;http://news-at.zhihu.com/css/news_qa.auto.css?v=4b3e3&quot;
  ]
}
</code></pre><p><code>body</code>å­—æ®µä¸­å°±æ˜¯htmlæ ¼å¼çš„å†…å®¹è¯¦æƒ…ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨WebViewæ¥å±•ç¤ºäº†ã€‚å½“ç„¶ï¼ŒçŸ¥ä¹æ—¥æŠ¥çš„APIæ¥å£ä¸æ­¢ä¸Šé¢çš„ä¸¤ä¸ªï¼Œä½ å¯ä»¥ç‚¹å‡»ä¸Šé¢çš„é“¾æ¥æŸ¥çœ‹ã€‚è·å–æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„å†…å®¹ï¼Œä½ å¯ä»¥åœ¨æˆ‘çš„é¡¹ç›®ä¸­ç›´æ¥æŸ¥çœ‹æ–‡ä»¶<a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/util/Api.java" target="_blank" rel="external">Api</a>ã€‚</p>
<h4 id="Day-1ï¼Œå…¶ä»–å‡†å¤‡"><a href="#Day-1ï¼Œå…¶ä»–å‡†å¤‡" class="headerlink" title="Day 1ï¼Œå…¶ä»–å‡†å¤‡"></a>Day 1ï¼Œå…¶ä»–å‡†å¤‡</h4><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å·¥å…·å‡†å¤‡å¥½æ€»æ˜¯æ²¡é”™çš„ã€‚</p>
<ul>
<li>ä¸€å°ç”µè„‘ è¿™ä¸ªæ€ä¹ˆè¯´å‘¢ï¼Œæ²¡æœ‰è¿™ä¸ªçš„è¯ï¼Œè¦è¿›è¡Œå¼€å‘å·¥ä½œè¿˜æ˜¯å¾ˆéš¾çš„ï¼Œå’±ä»¬æ€»ä¸èƒ½ç”¨çŸ³å™¨å†™ä»£ç å§ã€‚</li>
<li>è½¯ä»¶ï¼š<ul>
<li><a href="https://developer.android.com/studio/index.html" target="_blank" rel="external">Android Studio</a> æ ‡é…</li>
<li><a href="https://www.google.com/chrome/" target="_blank" rel="external">Chrome</a> ç¨‹åºå‘˜ç”¨360æµè§ˆå™¨ï¼Œç™¾åº¦æµè§ˆå™¨ä»€ä¹ˆçš„æ€»è§‰å¾—æœ‰ç‚¹ä¸å¤ŸGEEKã€‚</li>
<li><a href="https://www.getpostman.com/docs/introduction" target="_blank" rel="external">Postman</a> ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ç½‘é¡µè°ƒè¯•ä¸å‘é€ç½‘é¡µHTTPè¯·æ±‚çš„Chromeæ’ä»¶ï¼Œæˆ‘ä»¬åšç½‘ç»œè¯·æ±‚åˆ†ææ—¶éœ€è¦ç”¨åˆ°ã€‚</li>
<li><a href="https://www.genymotion.com/" target="_blank" rel="external">Genymotion</a> å¦‚æœä½ å«ŒASè‡ªå¸¦çš„æ¨¡æ‹Ÿå™¨æ…¢çš„è¯ï¼Œå¯ä»¥è¯•è¯•è¿™ä¸ªã€‚</li>
<li><a href="https://git-scm.com/" target="_blank" rel="external">Git</a> ç‰ˆæœ¬æ§åˆ¶ï¼Œå‘½ä»¤è¡Œæ•²èµ·æ¥ç‚’é¸¡å¸¦æ„Ÿå“¦ã€‚</li>
</ul>
</li>
<li>æœ€å¥½æ˜¯èƒ½æœ‰ä¸€å°Androidæ‰‹æœºã€‚</li>
<li>ç§‘å­¦ä¸Šç½‘ï¼Œç¡®ä¿èƒ½å¤Ÿæ­£å¸¸è®¿é—®Googleå’ŒStackOverFlowã€‚è®©ç™¾åº¦å»æ­»å§ã€‚</li>
</ul>
<p>å¥½äº†ï¼Œç¬¬ä¸€å¤©çš„å·¥ä½œå·®ä¸å¤šå°±æ˜¯è¿™ä¹ˆå¤šï¼Œç†Ÿæ‚‰ä¸€ä¸‹APIï¼ŒæŠŠå·¥å…·å¤‡å¥½ï¼Œæ”¶æ‹¾ä¸€ä¸‹å¿ƒæƒ…ï¼Œå‡†å¤‡æ˜å¤©çš„å·¥ä½œã€‚</p>
<h3 id="DAY-2"><a href="#DAY-2" class="headerlink" title="DAY 2"></a>DAY 2</h3><p>ä»Šå¤©ä¸»è¦å®Œæˆçš„æ˜¯UIè®¾è®¡ã€‚ä½ å¯èƒ½ä¼šé—®äº†ï¼Œè¿™ä¸æ˜¯è®¾è®¡å¸ˆçš„å·¥ä½œä¹ˆã€‚ç„¶è€Œï¼Œæˆ‘åœ¨å¼€å‘çº¸é£æœºçš„è¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰å°„é¸¡æ¹¿è¿™ç§ç”Ÿç‰©ï¼ŒUIå°±æˆ‘è‡ªå·±å®Œæˆäº†ã€‚ç›¸ä¿¡å¤§å¤šæ•°çš„ç¨‹åºå‘˜ï¼Œç¾æœ¯æ–¹é¢åº”è¯¥ä¸æ˜¯é‚£ä¹ˆåœ°æ“…é•¿ã€‚</p>
<p>å½“ç„¶ï¼Œæœ‰ç¾æœ¯å’Œç›¸å…³åŸºç¡€çš„åŒå­¦å¯ä»¥è¯•è¯•ç”¨Sketchæˆ–è€…PSæŠŠåŸå‹å›¾ç”»å‡ºæ¥ï¼Œå¯¹äºæ²¡æœ‰ç¾æœ¯åŸºç¡€çš„ç«¥é‹ï¼Œæœ€ç®€å•çš„æ–¹æ³•å½“ç„¶å°±æ˜¯æ¨¡ä»¿ç°æˆçš„APPäº†ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä¸‹åˆ—ç½‘ç«™å¯»æ‰¾åˆé€‚çš„è®¾è®¡å›¾ï¼š</p>
<ul>
<li><a href="https://dribbble.com/" target="_blank" rel="external">Dribbble</a></li>
<li><a href="https://www.uplabs.com/" target="_blank" rel="external">UpLabs</a></li>
<li><a href="http://www.ui.cn/" target="_blank" rel="external">UIä¸­å›½</a></li>
<li><a href="http://www.zcool.com.cn/" target="_blank" rel="external">ç«™é…·ZCOOL</a></li>
</ul>
<p>å¦å¤–ï¼Œè¿˜æœ‰ä¸€äº›å°çš„æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>éµå®ˆ<a href="https://material.io/guidelines/" target="_blank" rel="external">Material Designè®¾è®¡è§„èŒƒ</a> - è¿™ä¸æ˜¯å¼ºåˆ¶æ€§çš„è¦æ±‚ï¼Œä½†æ˜¯ï¼Œæ—¢ç„¶æˆ‘ä»¬æ˜¯å¼€å‘ä¸€æ¬¾Android Appï¼Œå¦‚æœæˆ‘ä»¬è‡ªå·±éƒ½ä¸éµå®ˆè§„èŒƒï¼Œè¿˜æ€ä¹ˆæŒ‡æœ›Androidç¯å¢ƒå˜å¥½å‘¢ã€‚</li>
<li><strong>æ­£ç¡®ä½¿ç”¨BottomNavigation</strong> - BottomNavigationä½œä¸ºGoogleçš„æ‰“è„¸ä¹‹ä½œï¼Œè¯ç”Ÿä¹‹åˆå°±å€å—äº‰è®®ã€‚æˆ‘ä¸ªäººçš„å»ºè®®æ˜¯ä½¿ç”¨TabLayoutä»£æ›¿åº•éƒ¨å¯¼èˆªï¼Œè¿™æ˜¯æ¶‰åŠåˆ°ä¿¡ä»°çš„å¤§äº‹æƒ…ã€‚å¦‚æœä¸€å®šè¦ç”¨ï¼Œè¯·ä¸è¦æŠŠiOSä¸Šçš„æ ‡å‡†ç›´æ¥æ”¾åœ¨Androidä¸Šä½¿ç”¨ï¼Œè¯·å‚è€ƒè¿™ä¸€ç¯‡æ–‡ç« :<a href="https://zhuanlan.zhihu.com/p/22005972" target="_blank" rel="external">Material Design ä¸­çš„ Bottom Navigation å¹¶ä¸æ˜¯æ— è„‘ç§»æ¤ iOS å¯¼èˆªæ¨¡å¼çš„è®¸å¯è¯</a>,å¹¶ä¸”ï¼Œæˆ‘å‘ä½ æŠ•æ¥ä¸€ä¸ªé„™è§†çš„çœ¼ç¥ã€‚</li>
<li>ä½¿ç”¨æ­£ç¡®çš„å›¾æ ‡ - å°½é‡ä½¿ç”¨ <a href="https://material.io/icons/" target="_blank" rel="external">https://material.io/icons/</a> ç½‘ç«™ä¸Šçš„å›¾æ ‡ï¼Œå¦‚æœä½ ä½¿ç”¨iOSç‰ˆæœ¬çš„å›¾æ ‡ï¼Œæˆ‘å†æ¬¡å‘ä½ æŠ•æ¥ä¸€ä¸ªé„™è§†çš„çœ¼ç¥ã€‚</li>
</ul>
<p>çº¸é£æœºçš„æœ€ç»ˆè®¾è®¡æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2440049-75f9c938a87c3c46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PaperPlane"></p>
<p>é¦–é¡µä½¿ç”¨Drawerä½œä¸ºé¡¶çº§å¯¼èˆªï¼ŒTabä¸ºäºŒçº§å¯¼èˆªï¼Œåˆ—è¡¨é¡¹ä½¿ç”¨å¡ç‰Œå¸ƒå±€ï¼Œä½¿ç”¨FloatingActionButtonä½œä¸ºæ—¥æœŸé€‰æ‹©æŒ‰é’®ï¼›è¯¦æƒ…é¡µé¢ä½¿ç”¨å¯æ”¶ç¼©çš„Toolbarï¼Œå›¾ç‰‡æ­é…æ–‡å­—çš„å½¢å¼ã€‚å…¶ä»–é«˜æ·±çš„æˆ‘ä¹Ÿä¸æ‡‚äº†ã€‚(åˆ°åé¢ä½ ä¼šå‘ç°ï¼Œè¿™é‡Œæˆ‘çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œå¡ç‰Œå¸ƒå±€ç”¨åœ¨è¿™é‡Œæ˜¯ä¸åˆé€‚çš„ã€‚å‚è§ï¼š<a href="https://material.io/guidelines/components/cards.html#cards-usage" target="_blank" rel="external">https://material.io/guidelines/components/cards.html#cards-usage</a>)</p>
<h3 id="DAY-3"><a href="#DAY-3" class="headerlink" title="DAY 3"></a>DAY 3</h3><p>ç°åœ¨å¼€å§‹å°±è¦çœŸæ­£çš„å†™ä»£ç äº†ã€‚</p>
<p>æ–°å»ºAndroid Studioé¡¹ç›®ä»€ä¹ˆçš„å°±ä¸è¯´äº†ï¼Œä¸‹é¢çš„æ˜¯æˆ‘çš„é¡¹ç›®ç»“æ„å›¾ï¼š</p>
<p><img src="https://ww2.sinaimg.cn/large/006y8lVagy1fcfh31l5g1j30ni14qdk8.jpg" alt="é¡¹ç›®ç»“æ„"></p>
<pre><code>Â·
â”œâ”€â”€ app
|   â”œâ”€â”€ libs å­˜æ”¾ç›¸å…³çš„jaræ–‡ä»¶ç­‰
|   â”œâ”€â”€ src
|   |   â”œâ”€â”€ androidTest æµ‹è¯•ç›¸å…³ç›®å½•
|   |   â”œâ”€â”€ main
|   |   |   â”œâ”€â”€ assets å­˜æ”¾èµ„æºåŸæ–‡ä»¶
|   |   |   â”œâ”€â”€ java
|   |   |   |   â”œâ”€â”€ com.marktony.zhihudaily javaåŒ…
|   |   |   |   |   â”œâ”€â”€ about å…³äºé¡µé¢
|   |   |   |   |   â”œâ”€â”€ adapter RecyclerViewä¸ViewPagerç­‰æ§ä»¶çš„Adapter
|   |   |   |   |   â”œâ”€â”€ app Application
|   |   |   |   |   â”œâ”€â”€ bean å­˜æ”¾å®ä½“ç±»
|   |   |   |   |   â”œâ”€â”€ bookmarks æ”¶è—é¡µé¢
|   |   |   |   |   â”œâ”€â”€ customtabs Chrome Custom Tabsç›¸å…³
|   |   |   |   |   â”œâ”€â”€ db æ•°æ®åº“ç›¸å…³
|   |   |   |   |   â”œâ”€â”€ detail è¯¦ç»†å†…å®¹é¡µé¢
|   |   |   |   |   â”œâ”€â”€ homepage é¦–é¡µé¡µé¢
|   |   |   |   |   â”œâ”€â”€ innerbrowser å†…ç½®æµè§ˆå™¨é¡µé¢
|   |   |   |   |   â”œâ”€â”€ interfaze æ¥å£é›†åˆ
|   |   |   |   |   â”œâ”€â”€ license å¼€æºè®¸å¯è¯é¡µé¢
|   |   |   |   |   â”œâ”€â”€ search æœç´¢é¡µé¢
|   |   |   |   |   â”œâ”€â”€ service Serviceé›†åˆ
|   |   |   |   |   â”œâ”€â”€ settings è®¾ç½®é¡µé¢
|   |   |   |   |   â”œâ”€â”€ util å·¥å…·ç±»é›†åˆ
|   |   |   |   |   â”œâ”€â”€ BasePresenter.java PresenteråŸºç±»
|   |   |   |   |   â”œâ”€â”€ BaseView.java ViewåŸºç±»
|   |   |   â”œâ”€â”€ res
|   |   |   â”œâ”€â”€ AndroidManifest.xml æ¸…å•æ–‡ä»¶
</code></pre><p>(ä¸éš¾çœ‹å‡ºï¼Œæˆ‘æ˜¯æŒ‰ç…§é¡µé¢å’ŒåŠŸèƒ½è¿›è¡Œåˆ†åŒ…çš„ã€‚)</p>
<p>åŒ…å»ºç«‹å®Œæˆåï¼Œæˆ‘ä»¬å¼€å§‹å¯¼å…¥ç¬¬ä¸‰æ–¹çš„å¼€æºåº“ï¼Œä¾¿äºç®€åŒ–ä»£ç çš„ç¼–å†™å’Œå®ç°ç‰¹å®šçš„æ•ˆæœã€‚æ‰¾åˆ°å·¥ç¨‹ç›®å½•ä¸‹appæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€<code>build.gradle</code>æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ã€‚</p>
<pre><code>dependencies {
    compile fileTree(include: [&#39;*.jar&#39;], dir: &#39;libs&#39;)
    // ä½¿ç”¨volleyç®€åŒ–ç½‘ç»œè¯·æ±‚
    compile files(&#39;libs/library-1.0.19.jar&#39;)
    // appcompatå…¼å®¹åŒ…
    compile &#39;com.android.support:appcompat-v7:25.1.0&#39;
    // material design è®¾è®¡åŒ…
    compile &#39;com.android.support:design:25.1.0&#39;
    // recycler viewæ§ä»¶
    compile &#39;com.android.support:recyclerview-v7:25.1.0&#39;
    // preference screen è®¾ç½®å’Œå…³äºé¡µé¢çš„é…ç½®
    compile &#39;com.android.support:preference-v14:25.1.0&#39;
    // æ”¯æŒChrome Custom Tabs
    compile &#39;com.android.support:customtabs:25.1.0&#39;
    // card view æ§ä»¶
    compile &#39;com.android.support:cardview-v7:25.1.0&#39;
    // è§£æJSONæ•°æ®
    compile &#39;com.google.code.gson:gson:2.7&#39;
    // å›¾ç‰‡åŠ è½½
    compile &#39;com.github.bumptech.glide:glide:3.7.0&#39;
    // ä¸ºäº†ä¿æŒåœ¨ä½ç‰ˆæœ¬SDKä¸­çš„UIä¸€è‡´æ€§ï¼Œå¼•å…¥material data time pickeråº“
    compile &#39;com.wdullaer:materialdatetimepicker:2.5.0&#39;
    testCompile &#39;junit:junit:4.12&#39;
</code></pre><p>ç”±äºä¸€äº›å†å²é—ç•™é—®é¢˜ï¼Œæˆ‘å¹¶æ²¡æœ‰ä½¿ç”¨OkHttpä½œä¸ºç½‘ç»œè¯·æ±‚åŒ…ï¼Œè€Œæ˜¯é€‰æ‹©äº†volleyã€‚å¦‚æœä½ æœ‰ä¸€å®šçš„åŸºç¡€ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨OkHttpã€‚</p>
<p>å¯¼å…¥volleyæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><p>åœ¨<code>app</code>ç›®å½•ä¸‹çš„<code>lib</code>ç›®å½•ä¸‹ç²˜è´´volleyçš„jaråŒ…ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½åˆ°ï¼š<a href="https://github.com/TonnyL/PaperPlane/blob/master/app/libs/library-1.0.19.jar" target="_blank" rel="external">Volley</a>ã€‚</p>
</li>
<li><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡gradleå¼•å…¥ã€‚</p>
</li>
</ul>
<pre><code>compile &#39;com.android.volley:volley:1.0.0&#39;
</code></pre><p>ç„¶åç‚¹å‡»Sync Project with Gradle filesã€‚</p>
<p>é¦–å…ˆæ˜¯æ•´ä½“çš„æ¶æ„ï¼šMVPã€‚å…³äºæ•´ä½“æ¶æ„çš„é€‰æ‹©ä»¥åŠæ›´åŠ è¯¦ç»†çš„ä»‹ç»éƒ¨åˆ†ï¼Œå¯ä»¥æˆ³è¿™ç¯‡æ–‡ç« :<a href="https://TonnyL.github.io/2016/09/27/%E9%87%8D%E6%9E%84%EF%BC%81%E5%B0%86Google-MVP%E5%BA%94%E7%94%A8%E4%BA%8E%E5%B7%B2%E6%9C%89%E9%A1%B9%E7%9B%AE/">é‡æ„ï¼å°†Google-MVPåº”ç”¨äºå·²æœ‰é¡¹ç›®</a>ã€‚è¿™é‡Œæˆ‘ä»¬ä»¿ç…§Googleçš„<a href="https://github.com/googlesamples/android-architecture" target="_blank" rel="external">Android Architecture Blueprints [beta]</a>ä¸­çš„<a href="https://github.com/googlesamples/android-architecture/tree/todo-mvp/" target="_blank" rel="external">todo-mvp</a>ã€‚</p>
<ol>
<li><p>é¦–å…ˆåˆ›å»ºæœ€åŸºæœ¬çš„BaseViewå’ŒBasePresenter,ä»–ä»¬åˆ†åˆ«æ˜¯æ‰€æœ‰Viewå’ŒPresenterçš„åŸºç±»ã€‚</p>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/BaseView.java" target="_blank" rel="external">Baseview.java</a></p>
<pre><code class="java"> public interface BaseView&lt;T&gt; {
     // ä¸ºViewè®¾ç½®Presenter
     void setPresenter(T presenter);
    // åˆå§‹åŒ–ç•Œé¢æ§ä»¶
     void initViews(View view);
 }
</code></pre>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/BasePresenter.java" target="_blank" rel="external">BasePresenter.java</a></p>
<pre><code class="java"> public interface BasePresenter {
     // è·å–æ•°æ®å¹¶æ”¹å˜ç•Œé¢æ˜¾ç¤ºï¼Œåœ¨todo-mvpçš„é¡¹ç›®ä¸­çš„è°ƒç”¨æ—¶æœºä¸ºFragmentçš„OnResume()æ–¹æ³•ä¸­
     void start();
 }
</code></pre>
</li>
<li><p>ç„¶ååˆ›å»ºä¸€ä¸ªå¥‘çº¦ç±»ï¼Œç”¨äºåŒä¸€ç®¡ç†Viewå’ŒPresenterã€‚è¿™é‡Œä»¥çŸ¥ä¹æ—¥æŠ¥çš„éƒ¨åˆ†ä¸ºä¾‹(å¦‚æœæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œåé¢çš„ä»£ç å‡ä»¥çŸ¥ä¹æ—¥æŠ¥çš„éƒ¨åˆ†ä¸ºä¾‹ï¼Œæœå£³ç²¾é€‰ä¸è±†ç“£ä¸€åˆ»çš„ä»£ç ç±»ä¼¼ï¼Œè¯¦ç»†ä»£ç å¯ä»¥åœ¨GitHubçš„repoä¸­æ‰¾åˆ°)ã€‚</p>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyContract.java" target="_blank" rel="external">ZhihuDailyContract.java</a></p>
<pre><code class="java"> public interface ZhihuDailyContract {

     interface View extends BaseView&lt;Presenter&gt; {

         // æ˜¾ç¤ºåŠ è½½æˆ–å…¶ä»–ç±»å‹çš„é”™è¯¯
         void showError();
         // æ˜¾ç¤ºæ­£åœ¨åŠ è½½
         void showLoading();
         // åœæ­¢æ˜¾ç¤ºæ­£åœ¨åŠ è½½
         void stopLoading();
         // æˆåŠŸè·å–åˆ°æ•°æ®åï¼Œåœ¨ç•Œé¢ä¸­æ˜¾ç¤º
         void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; list);
         // æ˜¾ç¤ºç”¨äºåŠ è½½æŒ‡å®šæ—¥æœŸçš„date picker dialog
         void showPickDialog();

     }

     interface Presenter extends BasePresenter {
         // è¯·æ±‚æ•°æ®
         void loadPosts(long date, boolean clearing);
         // åˆ·æ–°æ•°æ®
         void refresh();
         // åŠ è½½æ›´å¤šæ–‡ç« 
         void loadMore(long date);
         // æ˜¾ç¤ºè¯¦æƒ…
         void startReading(int position);
         // éšä¾¿çœ‹çœ‹
         void feelLucky();

     }

 }
</code></pre>
</li>
<li><p>åœ¨ä¸Šé¢å·²ç»åˆ†å¥½çš„å­åŒ…ä¸­ï¼Œåˆ›å»ºç›¸åº”çš„å­ç±»Viewå’ŒPresenterã€‚</p>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyFragment.java" target="_blank" rel="external">ZhihuDailyFragment.java</a></p>
<p> ```java<br> public class ZhihuDailyFragment extends Fragment</p>
<pre><code> implements ZhihuDailyContract.View {

 public ZhihuDailyFragment() {}

 public static ZhihuDailyFragment newInstance() {
     return new ZhihuDailyFragment();
 }
</code></pre></li>
</ol>
<pre><code>    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return null;
    }

    @Override
    public void setPresenter(ZhihuDailyContract.Presenter presenter) {

    }

    @Override
    public void initViews(View view) {

    }

    @Override
    public void showError() {

    }

    @Override
    public void showLoading() {

    }

    @Override
    public void stopLoading() {

    }

    @Override
    public void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; list) {

    }

    @Override
    public void showPickDialog() {

    }

}
```


[ZhihuDailyPresenter.java](https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyPresenter.java)

```java
public class ZhihuDailyPresenter implements ZhihuDailyContract.Presenter {

    public ZhihuDailyPresenter(Context context, ZhihuDailyContract.View view) {

    }

    @Override
    public void loadPosts(long date, final boolean clearing) {

    }

    @Override
    public void refresh() {

    }

    @Override
    public void loadMore(long date) {

    }

    @Override
    public void startReading(int position) {

    }

    @Override
    public void feelLucky() {

    }

    @Override
    public void start() {

    }

}
```

ç„¶åå®Œæˆæœå£³ç²¾é€‰é¡µé¢ï¼Œè±†ç“£ä¸€åˆ»çš„å†…å®¹ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹é¢çš„å·¥ä½œäº†ã€‚
</code></pre><ol>
<li><p>åˆ›å»ºVolleySingletonï¼Œå³Volleyçš„å•ä¾‹ã€‚è¿™æ ·ï¼Œæ•´ä¸ªåº”ç”¨å°±å¯ä»¥åªç»´æŠ¤ä¸€ä¸ªè¯·æ±‚é˜Ÿåˆ—ï¼ŒåŠ å…¥æ–°çš„ç½‘ç»œè¯·æ±‚ä¹Ÿä¼šæ›´åŠ çš„æ–¹ä¾¿ã€‚</p>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/app/VolleySingleton.java" target="_blank" rel="external">VolleySingleton.java</a></p>
<pre><code class="java">     public class VolleySingleton {

     private static VolleySingleton volleySingleton;
     private RequestQueue requestQueue;

     private VolleySingleton(Context context){
         requestQueue = Volley.newRequestQueue(context.getApplicationContext());
     }

     public static synchronized VolleySingleton getVolleySingleton(Context context){
         if(volleySingleton == null){
             volleySingleton = new VolleySingleton(context);
         }
         return volleySingleton;
     }

     public RequestQueue getRequestQueue(){
         return this.requestQueue;
     }

     public &lt;T&gt; void addToRequestQueue(Request&lt;T&gt; req){
         getRequestQueue().add(req);
     }

 }
</code></pre>
</li>
<li><p>ç„¶åæ˜¯Modelå±‚çš„å®ç°ã€‚ä½¿ç”¨äº†Gsonä¹‹åï¼Œå¯¹JSONçš„è½¬æ¢æ›´åŠ æ–¹ä¾¿äº†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦è¿”å›ç±»å‹ä¸ºStringå³å¯ã€‚</p>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/interfaze/OnStringListener.java" target="_blank" rel="external">OnStringListener.java</a></p>
<pre><code class="java"> public interface OnStringListener {
     /**
      * è¯·æ±‚æˆåŠŸæ—¶å›è°ƒ
      * @param result
      */
     void onSuccess(String result);
     /**
      * è¯·æ±‚å¤±è´¥æ—¶å›è°ƒ
      * @param error
      */
     void onError(VolleyError error);
 }
</code></pre>
<p> å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºè¯·æ±‚æˆåŠŸæ—¶å’Œè¯·æ±‚å¤±è´¥æ—¶çš„å›è°ƒã€‚</p>
<p> ç„¶åå®šä¹‰ä¸€ä¸ªStringModelçš„å®ç°ç±»â€“StringModelImplã€‚</p>
<p> <a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bean/StringModelImpl.java" target="_blank" rel="external">StringModelImpl.java</a></p>
<pre><code class="java"> public class StringModelImpl {
     private Context context;
     public StringModelImpl(Context context) {
         this.context = context;
     }
     public void load(String url, final OnStringListener listener) {
         StringRequest request = new StringRequest(url, new Response.Listener&lt;String&gt;() {

 @Override
             public void onResponse(String s) {
                 listener.onSuccess(s);
             }
         }, new Response.ErrorListener() {

 @Override
             public void onErrorResponse(VolleyError volleyError) {
                 listener.onError(volleyError);
             }
         });
         VolleySingleton.getVolleySingleton(context).addToRequestQueue(request);
     }
 }
</code></pre>
</li>
<li><p>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬çš„æ¶æ„å°±æ­å»ºå®Œæˆäº†ã€‚ç°åœ¨å¯ä»¥å–æ¯å’–å•¡ï¼Œç„¶åå®Œæˆä»Šå¤©çš„æœ€åä¸€ç‚¹å·¥ä½œï¼Œä¸ºåé¢çš„å·¥ä½œåšå‡†å¤‡ã€‚</p>
<p>åˆ›å»º<code>Api.java</code>æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨appæ‰€ç”¨åˆ°çš„æ‰€æœ‰APIã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/util/Api.java" target="_blank" rel="external">Api.java</a></p>
<pre><code class="java">public class Api {

    // æ¶ˆæ¯å†…å®¹è·å–ä¸ç¦»çº¿ä¸‹è½½
    // åœ¨æœ€æ–°æ¶ˆæ¯ä¸­è·å–åˆ°çš„idï¼Œæ‹¼æ¥åˆ°è¿™ä¸ªNEWSä¹‹åï¼Œå¯ä»¥è·å¾—å¯¹åº”çš„JSONæ ¼å¼çš„å†…å®¹
    public static final String ZHIHU_NEWS = &quot;http://news-at.zhihu.com/api/4/news/&quot;;

    // è¿‡å¾€æ¶ˆæ¯
    // è‹¥è¦æŸ¥è¯¢çš„11æœˆ18æ—¥çš„æ¶ˆæ¯ï¼Œbeforeåé¢çš„æ•°å­—åº”è¯¥ä¸º20161118
    // çŸ¥ä¹æ—¥æŠ¥çš„ç”Ÿæ—¥ä¸º2013 å¹´ 5 æœˆ 19 æ—¥ï¼Œå¦‚æœbeforeåé¢çš„æ•°å­—å°äº20130520ï¼Œé‚£ä¹ˆåªèƒ½è·å–åˆ°ç©ºæ¶ˆæ¯
    public static final String ZHIHU_HISTORY = &quot;http://news.at.zhihu.com/api/4/news/before/&quot;;

    // è·å–æœå£³ç²¾é€‰çš„æ–‡ç« åˆ—è¡¨,é€šè¿‡ç»„åˆç›¸åº”çš„å‚æ•°æˆä¸ºå®Œæ•´çš„url
    public static final String GUOKR_ARTICLES = &quot;http://apis.guokr.com/handpick/article.json?retrieve_type=by_since&amp;category=all&amp;limit=25&amp;ad=1&quot;;

    // è·å–æœå£³æ–‡ç« çš„å…·ä½“ä¿¡æ¯ V1
    public static final String GUOKR_ARTICLE_LINK_V1 = &quot;http://jingxuan.guokr.com/pick/&quot;;

    // è±†ç“£ä¸€åˆ»
    // æ ¹æ®æ—¥æœŸæŸ¥è¯¢æ¶ˆæ¯åˆ—è¡¨
    public static final String DOUBAN_MOMENT = &quot;https://moment.douban.com/api/stream/date/&quot;;

    // è·å–æ–‡ç« å…·ä½“å†…å®¹
    public static final String DOUBAN_ARTICLE_DETAIL = &quot;https://moment.douban.com/api/post/&quot;;

}
</code></pre>
<p>åˆ›å»º<code>NetworkState.java</code>æ–‡ä»¶ï¼Œåˆ¤æ–­å½“å‰çš„ç½‘ç»œçŠ¶æ€ï¼Œæ˜¯å¦æœ‰ç½‘ç»œè¿æ¥ï¼ŒWiFiæˆ–è€…æ˜¯ç§»åŠ¨æ•°æ®ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/util/NetworkState.java" target="_blank" rel="external">NetworkState.java</a></p>
<pre><code class="java">public class NetworkState {

    // æ£€æŸ¥æ˜¯å¦è¿æ¥åˆ°ç½‘ç»œ
    public static boolean networkConnected(Context context){

        if (context != null){
            ConnectivityManager manager = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo info = manager.getActiveNetworkInfo();
            if (info != null)
                return info.isAvailable();
        }

        return false;
    }

    // æ£€æŸ¥WiFiæ˜¯å¦è¿æ¥
    public static boolean wifiConnected(Context context){
        if (context != null){
            ConnectivityManager manager = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo info = manager.getActiveNetworkInfo();
            if (info != null){
                if (info.getType() == ConnectivityManager.TYPE_WIFI)
                    return info.isAvailable();
            }
        }
        return false;
    }

    // æ£€æŸ¥ç§»åŠ¨ç½‘ç»œæ˜¯å¦è¿æ¥
    public static boolean mobileDataConnected(Context context){
        if (context != null){
            ConnectivityManager manager = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo info = manager.getActiveNetworkInfo();
            if (info != null){
                if (info.getType() == ConnectivityManager.TYPE_MOBILE)
                    return true;
            }
        }
        return false;
    }

}
</code></pre>
<p>åˆ›å»º<code>DateFormatter .java</code>æ–‡ä»¶ï¼Œæ–¹ä¾¿å°†<code>long</code>ç±»å‹çš„æ—¥æœŸè½¬æ¢ä¸º<code>String</code>ç±»å‹ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/util/DateFormatter.java" target="_blank" rel="external">DateFormatter.java</a></p>
<pre><code class="java">public class DateFormatter {

    /**
     * å°†longç±»dateè½¬æ¢ä¸ºStringç±»å‹
     * @param date date
     * @return String date
     */
    public String ZhihuDailyDateFormat(long date) {
        String sDate;
        Date d = new Date(date + 24*60*60*1000);
        SimpleDateFormat format = new SimpleDateFormat(&quot;yyyyMMdd&quot;);
        sDate = format.format(d);

        return sDate;
    }

    public String DoubanDateFormat(long date){
        String sDate;
        Date d = new Date(date);
        SimpleDateFormat format = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
        sDate = format.format(d);

        return sDate;
    }

}
</code></pre>
<p>OKï¼Œday 3å·¥ä½œå®Œæˆã€‚</p>
</li>
</ol>
<h3 id="DAY-4"><a href="#DAY-4" class="headerlink" title="DAY 4"></a>DAY 4</h3><p>ä»Šå¤©çš„åªè¦ä»»åŠ¡æ˜¯å®Œæˆé¦–é¡µã€‚</p>
<h4 id="Day-4ï¼Œç•Œé¢ç¼–å†™"><a href="#Day-4ï¼Œç•Œé¢ç¼–å†™" class="headerlink" title="Day 4ï¼Œç•Œé¢ç¼–å†™"></a>Day 4ï¼Œç•Œé¢ç¼–å†™</h4><p>æˆ‘ä»¬çš„é¦–é¡µï¼Œä½¿ç”¨çš„æ˜¯Activity + Fragmentæ­é…çš„æ–¹å¼ï¼Œå³ä¸€ä¸ªMainActivity + MainFragment + BookmarksFragmentçš„æ–¹å¼ã€‚å…¶ä¸­ï¼ŒMainActivityçš„å¸ƒå±€æ–‡ä»¶ä¸­åŒ…å«äº†DrawerLayout, Toolbarä»¥åŠFragmentæ‰€åœ¨çš„å®¹å™¨ã€‚</p>
<p>MainActivityå¯¹åº”å¸ƒå±€æ–‡ä»¶å¦‚ä¸‹:</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/activity_main.xml" target="_blank" rel="external">activity_main.xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.v4.widget.DrawerLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/drawer_layout&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:fitsSystemWindows=&quot;true&quot;
    tools:openDrawer=&quot;start&quot;&gt;

    &lt;include layout=&quot;@layout/app_bar_main&quot; /&gt;

    &lt;android.support.design.widget.NavigationView
        android:id=&quot;@+id/nav_view&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;match_parent&quot;
        android:layout_gravity=&quot;start&quot;
        android:fitsSystemWindows=&quot;true&quot;
        app:headerLayout=&quot;@layout/nav_header_main&quot;
        app:menu=&quot;@menu/activity_main_drawer&quot; /&gt;

&lt;/android.support.v4.widget.DrawerLayout&gt;
</code></pre><p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/nav_header_main.xml" target="_blank" rel="external">nav_header_main.xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;@dimen/nav_header_height&quot;
    android:background=&quot;@drawable/nav_header&quot;
    android:gravity=&quot;bottom&quot;
    android:orientation=&quot;vertical&quot;
    android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark&quot;&gt;

&lt;/LinearLayout&gt;
</code></pre><p>nav_headerå®é™…ä¸Šå°±åªæ˜¯ä¸€ä¸ªç®€å•çš„ImageViewã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/app_bar_main.xml" target="_blank" rel="external">app_bar_main.xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.design.widget.CoordinatorLayout
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:fitsSystemWindows=&quot;true&quot;
    tools:context=&quot;.homepage.MainActivity&quot;&gt;

    &lt;android.support.design.widget.AppBarLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        app:elevation=&quot;0dp&quot;
        android:theme=&quot;@style/AppTheme.AppBarOverlay&quot;&gt;

        &lt;android.support.v7.widget.Toolbar
            android:id=&quot;@+id/toolbar&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;?attr/actionBarSize&quot;
            android:background=&quot;@color/colorPrimary&quot;
            app:popupTheme=&quot;@style/AppTheme.PopupOverlay&quot; /&gt;

    &lt;/android.support.design.widget.AppBarLayout&gt;

    &lt;FrameLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:id=&quot;@+id/layout_fragment&quot;
        android:layout_marginTop=&quot;?actionBarSize&quot;/&gt;

&lt;/android.support.design.widget.CoordinatorLayout&gt;
</code></pre><p>OKï¼ŒActivityçš„å¸ƒå±€æ–‡ä»¶å®Œæˆã€‚ç„¶åå°±å¯ä»¥å†™javaä»£ç äº†ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/MainActivity.java" target="_blank" rel="external">MainActivity.java</a></p>
<pre><code class="java">public class MainActivity extends AppCompatActivity
        implements NavigationView.OnNavigationItemSelectedListener{

    private MainFragment mainFragment;
    private BookmarksFragment bookmarksFragment;

    private NavigationView navigationView;
    private DrawerLayout drawer;
    private Toolbar toolbar;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // åˆå§‹åŒ–æ§ä»¶
        initViews();

        // æ¢å¤fragmentçš„çŠ¶æ€
        if (savedInstanceState != null) {
            mainFragment = (MainFragment) getSupportFragmentManager().getFragment(savedInstanceState, &quot;MainFragment&quot;);
            bookmarksFragment = (BookmarksFragment) getSupportFragmentManager().getFragment(savedInstanceState, &quot;BookmarksFragment&quot;);
        } else {
            mainFragment = MainFragment.newInstance();
            bookmarksFragment = BookmarksFragment.newInstance();
        }

        if (!mainFragment.isAdded()) {
            getSupportFragmentManager().beginTransaction()
                    .add(R.id.layout_fragment, mainFragment, &quot;MainFragment&quot;)
                    .commit();
        }

        if (!bookmarksFragment.isAdded()) {
            getSupportFragmentManager().beginTransaction()
                    .add(R.id.layout_fragment, bookmarksFragment, &quot;BookmarksFragment&quot;)
                    .commit();
        }

        // å®ä¾‹åŒ–BookmarksPresenter
        new BookmarksPresenter(MainActivity.this, bookmarksFragment);

        // é»˜è®¤æ˜¾ç¤ºé¦–é¡µå†…å®¹
        showMainFragment();

    }

    // åˆå§‹åŒ–æ§ä»¶
    private void initViews() {

        toolbar = (Toolbar) findViewById(R.id.toolbar);
        setSupportActionBar(toolbar);

        drawer = (DrawerLayout) findViewById(R.id.drawer_layout);
        ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(
                this,
                drawer,
                toolbar,
                R.string.navigation_drawer_open,
                R.string.navigation_drawer_close);
        drawer.setDrawerListener(toggle);
        toggle.syncState();

        navigationView = (NavigationView) findViewById(R.id.nav_view);
        navigationView.setNavigationItemSelectedListener(this);

    }

    // æ˜¾ç¤ºMainFragmentå¹¶è®¾ç½®Title
    private void showMainFragment() {

        FragmentTransaction fragmentTransaction = getSupportFragmentManager().beginTransaction();
        fragmentTransaction.show(mainFragment);
        fragmentTransaction.hide(bookmarksFragment);
        fragmentTransaction.commit();

        toolbar.setTitle(getResources().getString(R.string.app_name));

    }

    // æ˜¾ç¤ºBookmarksFragmentå¹¶è®¾ç½®Title
    private void showBookmarksFragment() {

        FragmentTransaction fragmentTransaction = getSupportFragmentManager().beginTransaction();
        fragmentTransaction.show(bookmarksFragment);
        fragmentTransaction.hide(mainFragment);
        fragmentTransaction.commit();

        toolbar.setTitle(getResources().getString(R.string.nav_bookmarks));

    }

    @Override
    public boolean onNavigationItemSelected(@NonNull MenuItem item) {

        drawer.closeDrawer(GravityCompat.START);

        int id = item.getItemId();
        if (id == R.id.nav_home) {
            showMainFragment();
        } else if (id == R.id.nav_bookmarks) {
            showBookmarksFragment();
        } else if (id == R.id.nav_change_theme) {

        } else if (id == R.id.nav_settings) {

        } else if (id == R.id.nav_about) {

        }

        return true;
    }

    // å­˜å‚¨Fragmentçš„çŠ¶æ€
    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        if (mainFragment.isAdded()) {
            getSupportFragmentManager().putFragment(outState, &quot;MainFragment&quot;, mainFragment);
        }

        if (bookmarksFragment.isAdded()) {
            getSupportFragmentManager().putFragment(outState, &quot;BookmarksFragment&quot;, bookmarksFragment);
        }
    }

}
</code></pre>
<p>ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡º,MainActivityè´Ÿè´£å¤„ç†DrawerLayoutçš„ç‚¹å‡»äº‹ä»¶ï¼Œå³æ§åˆ¶æ˜¾ç¤ºæˆ–è€…éšè—ç‰¹å®šçš„Fragmentã€‚è€ŒFragmentçš„çŠ¶æ€çš„ä¿å­˜ä¸æ¢å¤ä¹Ÿæ˜¯åœ¨è¿™é‡Œè¿›è¡Œçš„ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/MainFragment.java" target="_blank" rel="external">MainFragment.java</a></p>
<pre><code class="java">public class MainFragment extends Fragment {

    private Context context;
    private MainPagerAdapter adapter;

    private TabLayout tabLayout;

    private ZhihuDailyFragment zhihuDailyFragment;
    private GuokrFragment guokrFragment;
    private DoubanMomentFragment doubanMomentFragment;

    private ZhihuDailyPresenter zhihuDailyPresenter;
    private GuokrPresenter guokrPresenter;
    private DoubanMomentPresenter doubanMomentPresenter;

    public MainFragment() {}

    public static MainFragment newInstance() {
        return new MainFragment();
    }

    @Override
    public void onAttach(Context context) {
        super.onAttach(context);
    }

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        this.context = getActivity();

        // FragmentçŠ¶æ€æ¢å¤
        if (savedInstanceState != null) {
            FragmentManager manager = getChildFragmentManager();
            zhihuDailyFragment = (ZhihuDailyFragment) manager.getFragment(savedInstanceState, &quot;zhihu&quot;);
            guokrFragment = (GuokrFragment) manager.getFragment(savedInstanceState, &quot;guokr&quot;);
            doubanMomentFragment = (DoubanMomentFragment) manager.getFragment(savedInstanceState, &quot;douban&quot;);
        } else {
            // åˆ›å»ºViewå®ä¾‹
            zhihuDailyFragment = ZhihuDailyFragment.newInstance();
            guokrFragment = GuokrFragment.newInstance();
            doubanMomentFragment = DoubanMomentFragment.newInstance();
        }

        // åˆ›å»ºPresenterå®ä¾‹
        zhihuDailyPresenter = new ZhihuDailyPresenter(context, zhihuDailyFragment);
        guokrPresenter = new GuokrPresenter(context, guokrFragment);
        doubanMomentPresenter = new DoubanMomentPresenter(context, doubanMomentFragment);

    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_main, container, false);

        // åˆå§‹åŒ–æ§ä»¶
        initViews(view);

        // æ˜¾ç¤ºèœå•
        setHasOptionsMenu(true);

        // å½“tab layoutä½ç½®ä¸ºæœå£³ç²¾é€‰æ—¶ï¼Œéšè—fab
        tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
            @Override
            public void onTabSelected(TabLayout.Tab tab) {
                FloatingActionButton fab = (FloatingActionButton) getActivity().findViewById(R.id.fab);
                if (tab.getPosition() == 1) {
                    fab.hide();
                } else {
                    fab.show();
                }

            }

            @Override
            public void onTabUnselected(TabLayout.Tab tab) {

            }

            @Override
            public void onTabReselected(TabLayout.Tab tab) {

            }

        });

        return view;
    }


    // åˆå§‹åŒ–æ§ä»¶
    private void initViews(View view) {

        tabLayout = (TabLayout) view.findViewById(R.id.tab_layout);
        ViewPager viewPager = (ViewPager) view.findViewById(R.id.view_pager);
        // è®¾ç½®ç¦»çº¿æ•°ä¸º3
        viewPager.setOffscreenPageLimit(3);

        adapter = new MainPagerAdapter(
                getChildFragmentManager(),
                context,
                zhihuDailyFragment,
                guokrFragment,
                doubanMomentFragment);

        viewPager.setAdapter(adapter);
        tabLayout.setupWithViewPager(viewPager);

    }

    @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        super.onCreateOptionsMenu(menu, inflater);
        inflater.inflate(R.menu.main, menu);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        int id = item.getItemId();

        if (id == R.id.action_feel_lucky) {
            feelLucky();
        }
        return true;
    }

    // ä¿å­˜çŠ¶æ€
    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        FragmentManager manager = getChildFragmentManager();
        manager.putFragment(outState, &quot;zhihu&quot;, zhihuDailyFragment);
        manager.putFragment(outState, &quot;guokr&quot;, guokrFragment);
        manager.putFragment(outState, &quot;douban&quot;, doubanMomentFragment);
    }

    // éšä¾¿çœ‹çœ‹
    public void feelLucky() {
        Random random = new Random();
        int type = random.nextInt(3);
        switch (type) {
            case 0:
                zhihuDailyPresenter.feelLucky();
                break;
            case 1:
                guokrPresenter.feelLucky();
                break;
            default:
                doubanMomentPresenter.feelLucky();
                break;
        }
    }

    public MainPagerAdapter getAdapter() {
        return adapter;
    }
}
</code></pre>
<p>é¦–é¡µçš„MainFragmentä¸»è¦è´Ÿè´£æ˜¾ç¤ºä¸TabLayout + ViewPagerç›¸å…³çš„å†…å®¹ã€‚</p>
<p>OKï¼Œç»ˆäºæŠŠé¦–é¡µçš„UIæ¡†æ¶æ­å»ºå¥½äº†ï¼Œå–æ¯å’–å•¡ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Œå†·é™å†·é™ã€‚</p>
<p>ç°åœ¨å¼€å§‹å®ç°å…·ä½“çš„<code>ZhihuDailyFragment</code>çš„å¸ƒå±€ã€‚ä»”ç»†è§‚å¯Ÿï¼Œå®é™…ä¸Šï¼ŒZhihuDailyFragmentæ‰€åŒ…å«çš„æ§ä»¶å°±åªæœ‰ä¸€ä¸ª<code>RecyclerView</code>ï¼Œå°†è·å–åˆ°çš„å†…å®¹ä»¥åˆ—è¡¨çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚å¹¶ä¸”ï¼Œä¸éš¾å‘ç°ï¼Œæœå£³ç²¾é€‰ä¸è±†ç“£ä¸€åˆ»çš„å¸ƒå±€ä¸çŸ¥ä¹æ—¥æŠ¥çš„åˆ—è¡¨å¸ƒå±€ç›¸åŒï¼Œå¯ä»¥å¤ç”¨ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/fragment_list.xml" target="_blank" rel="external">fragment_list.xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.v4.widget.SwipeRefreshLayout
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:id=&quot;@+id/refreshLayout&quot;&gt;

    &lt;FrameLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:focusable=&quot;true&quot;
        android:clickable=&quot;true&quot;&gt;

        &lt;android.support.v7.widget.RecyclerView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;match_parent&quot;
            android:id=&quot;@+id/recyclerView&quot;
            android:scrollbars=&quot;vertical&quot;
            android:scrollbarFadeDuration=&quot;1&quot;
            android:fadeScrollbars=&quot;true&quot;/&gt;

    &lt;/FrameLayout&gt;

&lt;/android.support.v4.widget.SwipeRefreshLayout&gt;
</code></pre><p>å¸ƒå±€å®é™…ä¸Šè¿˜åŒ…å«äº†SwipeRefreshLayoutï¼Œç”¨äºæ˜¾ç¤ºæ­£åœ¨åŠ è½½å’Œæ‰‹åŠ¨åˆ·æ–°ã€‚</p>
<p>åˆ—è¡¨å­é¡¹çš„å¸ƒå±€æœ‰å¾ˆå¤šç§ï¼Œåˆ†åˆ«æ˜¯:</p>
<ol>
<li>æ™®é€šä»…æ–‡å­—</li>
<li>æ™®é€šæ–‡å­— + å›¾ç‰‡</li>
<li>å¤´éƒ¨é¡¹ï¼Œç”¨äºæ˜¾ç¤ºå­é¡¹ç±»å‹(å¦‚çŸ¥ä¹æ—¥æŠ¥ï¼Œåœ¨æ”¶è—é¡µé¢ä¼šç”¨åˆ°)</li>
<li>åº•éƒ¨é¡¹ï¼ŒåŠ è½½æ›´å¤šç­‰</li>
</ol>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/home_list_item_without_image.xml" target="_blank" rel="external">home_list_item_without_image.xml</a> - æ™®é€šä»…æ–‡å­—</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.v7.widget.CardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_height=&quot;96dp&quot;
    android:layout_width=&quot;match_parent&quot;
    android:focusable=&quot;true&quot;
    android:clickable=&quot;true&quot;
    android:foreground=&quot;?android:attr/selectableItemBackground&quot;
    app:cardCornerRadius=&quot;4dp&quot;
    app:cardElevation=&quot;1dp&quot;
    app:cardPreventCornerOverlap=&quot;true&quot;
    android:layout_marginTop=&quot;8dp&quot;
    android:layout_marginLeft=&quot;8dp&quot;
    android:layout_marginRight=&quot;8dp&quot;&gt;

    &lt;TextView
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:id=&quot;@+id/textViewTitle&quot;
        android:paddingTop=&quot;8dp&quot;
        android:paddingBottom=&quot;8dp&quot;
        android:paddingLeft=&quot;8dp&quot;
        android:paddingRight=&quot;8dp&quot;
        android:gravity=&quot;center_vertical&quot;
        android:maxLines=&quot;3&quot;
        android:ellipsize=&quot;end&quot;
        android:textSize=&quot;18sp&quot; /&gt;

&lt;/android.support.v7.widget.CardView&gt;
</code></pre><p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/home_list_item_layout.xml" target="_blank" rel="external">home_list_item_layout.xml</a> - æ™®é€šæ–‡å­— + å›¾ç‰‡</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.v7.widget.CardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_height=&quot;96dp&quot;
    android:layout_width=&quot;match_parent&quot;
    android:focusable=&quot;true&quot;
    android:clickable=&quot;true&quot;
    android:foreground=&quot;?android:attr/selectableItemBackground&quot;
    app:cardCornerRadius=&quot;4dp&quot;
    app:cardElevation=&quot;1dp&quot;
    app:cardPreventCornerOverlap=&quot;true&quot;
    android:layout_marginTop=&quot;8dp&quot;
    android:layout_marginLeft=&quot;8dp&quot;
    android:layout_marginRight=&quot;8dp&quot;&gt;

    &lt;LinearLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:orientation=&quot;horizontal&quot;
        android:paddingLeft=&quot;8dp&quot;
        android:paddingRight=&quot;8dp&quot; &gt;

        &lt;TextView
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;match_parent&quot;
            android:layout_weight=&quot;1&quot;
            android:id=&quot;@+id/textViewTitle&quot;
            android:paddingTop=&quot;8dp&quot;
            android:paddingBottom=&quot;8dp&quot;
            android:layout_marginRight=&quot;8dp&quot;
            android:layout_marginEnd=&quot;8dp&quot;
            android:gravity=&quot;center_vertical&quot;
            android:maxLines=&quot;3&quot;
            android:ellipsize=&quot;end&quot;
            android:textSize=&quot;18sp&quot; /&gt;

        &lt;ImageView
            android:layout_width=&quot;80dp&quot;
            android:layout_height=&quot;80dp&quot;
            android:id=&quot;@+id/imageViewCover&quot;
            android:layout_gravity=&quot;center_vertical&quot; /&gt;

    &lt;/LinearLayout&gt;

&lt;/android.support.v7.widget.CardView&gt;
</code></pre><p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/bookmark_header.xml" target="_blank" rel="external">bookmark_header.xml</a> - å¤´éƒ¨é¡¹</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;TextView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;wrap_content&quot;
    android:id=&quot;@+id/textViewType&quot;
    android:paddingLeft=&quot;8dp&quot;
    android:paddingStart=&quot;8dp&quot;
    android:paddingRight=&quot;8dp&quot;
    android:paddingEnd=&quot;8dp&quot;
    android:paddingTop=&quot;8dp&quot;
    android:gravity=&quot;center_vertical&quot;
    android:textColor=&quot;@color/colorPrimary&quot;
    android:textAllCaps=&quot;true&quot;/&gt;
</code></pre><p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/list_footer.xml" target="_blank" rel="external">list_footer.xml</a> - åº•éƒ¨é¡¹ï¼ŒåŠ è½½æ›´å¤š</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:orientation=&quot;horizontal&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;48dp&quot;
    android:layout_marginTop=&quot;8dp&quot;
    android:layout_marginBottom=&quot;8dp&quot;
    android:gravity=&quot;center_horizontal&quot;
    android:background=&quot;@color/viewBackground&quot;&gt;

    &lt;android.support.v4.widget.ContentLoadingProgressBar
        android:id=&quot;@+id/address_looking_up&quot;
        style=&quot;?android:attr/progressBarStyleInverse&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_gravity=&quot;center_horizontal&quot;
        android:visibility=&quot;visible&quot; /&gt;

    &lt;TextView
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;match_parent&quot;
        android:text=&quot;@string/loading_more&quot;
        android:layout_marginLeft=&quot;16dp&quot;
        android:layout_marginStart=&quot;8dp&quot;
        android:gravity=&quot;center_vertical&quot;/&gt;

&lt;/LinearLayout&gt;
</code></pre><p>å¸ƒå±€æ–‡ä»¶åˆ°è¿™é‡ŒåŸºæœ¬å°±å®Œæˆäº†ã€‚</p>
<h4 id="Day-4ï¼Œå®ä½“ç±»"><a href="#Day-4ï¼Œå®ä½“ç±»" class="headerlink" title="Day 4ï¼Œå®ä½“ç±»"></a>Day 4ï¼Œå®ä½“ç±»</h4><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡JSONæ ¼å¼çš„è¿”å›æ•°æ®è®¾è®¡å®ä½“ç±»ã€‚å¯ä»¥æ‰‹åŠ¨ç¼–å†™ä»£ç ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨Android Studioæ’ä»¶<a href="https://github.com/zzz40500/GsonFormat" target="_blank" rel="external">GsonFormat</a>å®ç°ã€‚</p>
<p>Jsonæ ¼å¼æ•°æ®:</p>
<pre><code class="json">{
  &quot;date&quot;: &quot;20170121&quot;,
  &quot;stories&quot;: [
    {
      &quot;images&quot;: [
        &quot;http://pic1.zhimg.com/ffcca2b2853f2af791310e6a6d694e80.jpg&quot;
      ],
      &quot;type&quot;: 0,
      &quot;id&quot;: 9165434,
      &quot;ga_prefix&quot;: &quot;012121&quot;,
      &quot;title&quot;: &quot;è°è¯´æ™®é€šäººçš„ç”Ÿæ´»å°±ä¸èƒ½ç²¾å½©æœ‰è¶£å‘¢ï¼Ÿ&quot;
    },
    ...
    ]
}
</code></pre>
<p>å¯¹åº”çš„bean:<a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bean/ZhihuDailyNews.java" target="_blank" rel="external">ZhihuDailyNews.java</a></p>
<pre><code class="java">public class ZhihuDailyNews {

    private String date;
    private ArrayList&lt;Question&gt; stories;

    public String getDate() {
        return date;
    }

    public void setDate(String date) {
        this.date = date;
    }

    public ArrayList&lt;Question&gt; getStories() {
        return stories;
    }

    public void setStories(ArrayList&lt;Question&gt; stories) {
        this.stories = stories;
    }

    public class Question {

        private ArrayList&lt;String&gt; images;
        private int type;
        private int id;
        private String ga_prefix;
        private String title;

        public ArrayList&lt;String&gt; getImages() {
            return images;
        }

        public void setImages(ArrayList&lt;String&gt; images) {
            this.images = images;
        }

        public int getType() {
            return type;
        }

        public void setType(int type) {
            this.type = type;
        }

        public int getId() {
            return id;
        }

        public void setId(int id) {
            this.id = id;
        }

        public String getGa_prefix() {
            return ga_prefix;
        }

        public void setGa_prefix(String ga_prefix) {
            this.ga_prefix = ga_prefix;
        }

        public String getTitle() {
            return title;
        }

        public void setTitle(String title) {
            this.title = title;
        }

    }

}
</code></pre>
<h4 id="Day-4ï¼Œæ˜¾ç¤ºæ•°æ®"><a href="#Day-4ï¼Œæ˜¾ç¤ºæ•°æ®" class="headerlink" title="Day 4ï¼Œæ˜¾ç¤ºæ•°æ®"></a>Day 4ï¼Œæ˜¾ç¤ºæ•°æ®</h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¾—æœ‰ä¸€ä¸ªadapterã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/adapter/ZhihuDailyNewsAdapter.java" target="_blank" rel="external">ZhihuDailyNewsAdapter.java</a></p>
<pre><code class="java">public class ZhihuDailyNewsAdapter extends RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt; {

    private final Context context;
    private final LayoutInflater inflater;
    private List&lt;ZhihuDailyNews.Question&gt; list = new ArrayList&lt;ZhihuDailyNews.Question&gt;();
    private OnRecyclerViewOnClickListener mListener;

    // æ–‡å­— + å›¾ç‰‡
    private static final int TYPE_NORMAL = 0;
    // footerï¼ŒåŠ è½½æ›´å¤š
    private static final int TYPE_FOOTER = 1;

    public ZhihuDailyNewsAdapter(Context context, List&lt;ZhihuDailyNews.Question&gt; list){
        this.context = context;
        this.list = list;
        this.inflater = LayoutInflater.from(context);
    }

    @Override
    public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
        // æ ¹æ®ViewTypeåŠ è½½ä¸åŒå¸ƒå±€
        switch (viewType) {
            case TYPE_NORMAL:
                return new NormalViewHolder(inflater.inflate(R.layout.home_list_item_layout, parent, false), mListener);
            case TYPE_FOOTER:
                return new FooterViewHolder(inflater.inflate(R.layout.list_footer, parent, false));
        }
        return null;
    }

    @Override
    public void onBindViewHolder(RecyclerView.ViewHolder holder, int position) {

        // å¯¹ä¸åŒçš„ViewHolderåšä¸åŒçš„å¤„ç†
        if (holder instanceof NormalViewHolder) {

            ZhihuDailyNews.Question item = list.get(position);

            if (item.getImages().get(0) == null){
                ((NormalViewHolder)holder).itemImg.setImageResource(R.drawable.placeholder);
            } else {
                Glide.with(context)
                        .load(item.getImages().get(0))
                        .asBitmap()
                        .placeholder(R.drawable.placeholder)
                        .diskCacheStrategy(DiskCacheStrategy.SOURCE)
                        .error(R.drawable.placeholder)
                        .centerCrop()
                        .into(((NormalViewHolder)holder).itemImg);
            }
            ((NormalViewHolder)holder).tvLatestNewsTitle.setText(item.getTitle());
        }

    }

    // å› ä¸ºå«æœ‰footerï¼Œè¿”å›å€¼éœ€è¦ + 1
    @Override
    public int getItemCount() {
        return list.size() + 1;
    }

    @Override
    public int getItemViewType(int position) {
        if (position == list.size()) {
            return ZhihuDailyNewsAdapter.TYPE_FOOTER;
        }
        return ZhihuDailyNewsAdapter.TYPE_NORMAL;
    }

    public void setItemClickListener(OnRecyclerViewOnClickListener listener){
        this.mListener = listener;
    }

    public class NormalViewHolder extends RecyclerView.ViewHolder implements View.OnClickListener {

        private ImageView itemImg;
        private TextView tvLatestNewsTitle;
        private OnRecyclerViewOnClickListener listener;

        public NormalViewHolder(View itemView, OnRecyclerViewOnClickListener listener) {
            super(itemView);
            itemImg = (ImageView) itemView.findViewById(R.id.imageViewCover);
            tvLatestNewsTitle = (TextView) itemView.findViewById(R.id.textViewTitle);
            this.listener = listener;
            itemView.setOnClickListener(this);
        }

        @Override
        public void onClick(View v) {
            if (listener != null){
                listener.OnItemClick(v,getLayoutPosition());
            }
        }
    }

    public class FooterViewHolder extends RecyclerView.ViewHolder{

        public FooterViewHolder(View itemView) {
            super(itemView);
        }

    }

}
</code></pre>
<p>adapterä¸­å«æœ‰ä¸¤ä¸ªå¸¸é‡ï¼Œ<code>TYPE_NORMAL</code>,<code>TYPE_FOOTER</code>,ç”¨äºåŒºåˆ«itemçš„ç±»å‹ï¼Œä»è€ŒåŠ è½½ä¸åŒçš„å¸ƒå±€ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒRecyclerViewåŸç”Ÿå¹¶æ²¡æœ‰è®¾ç½®itemç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªæ¥å£â€“<code>OnRecyclerViewOnClickListener</code>ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/interfaze/OnRecyclerViewOnClickListener.java" target="_blank" rel="external">OnRecyclerViewOnClickListener.java</a></p>
<pre><code class="java">package com.marktony.zhihudaily.interfaze;

import android.view.View;

public interface OnRecyclerViewOnClickListener {

    void OnItemClick(View v,int position);

}
</code></pre>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyPresenter.java" target="_blank" rel="external">ZhihuDailyPresenter.java</a></p>
<p>å®ç°<code>ZhihuDailyPresenter</code>ä¸­çš„<code>loadPosts</code>æ–¹æ³•ï¼Œè®°å¾—è¦åœ¨manifestæ¸…å•æ–‡ä»¶ä¸­æ·»åŠ ç½‘ç»œè®¿é—®æƒé™ï¼š</p>
<pre><code class="java">model.load(Api.ZHIHU_HISTORY + formatter.ZhihuDailyDateFormat(date), new OnStringListener() {
                @Override
                public void onSuccess(String result) {

                    try {
                        ZhihuDailyNews post = gson.fromJson(result, ZhihuDailyNews.class);

                        if (clearing) {
                            list.clear();
                        }

                        for (ZhihuDailyNews.Question item : post.getStories()) {
                            list.add(item);                          
                        }
                        view.showResults(list);

                    } catch (JsonSyntaxException e) {
                        view.showError();
                    }

                    view.stopLoading();
                }

                @Override
                public void onError(VolleyError error) {
                    view.stopLoading();
                    view.showError();
                }
            });
</code></pre>
<p>æˆ‘ä»¬é€šè¿‡Gsonï¼Œå¯ä»¥å¾ˆç®€å•å°†JSONæ ¼å¼æ•°æ®è½¬æ¢ä¸ºJavaå¯¹è±¡ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyFragment.java" target="_blank" rel="external">ZhihuDailyFragment</a></p>
<p>å®ç°<code>ZhihuDailyFragment</code>çš„<code>showResults</code>æ–¹æ³•ã€‚</p>
<pre><code class="java">@Override
public void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; list) {
    if (adapter == null) {
        adapter = new ZhihuDailyNewsAdapter(getContext(), list);
        adapter.setItemClickListener(new OnRecyclerViewOnClickListener() {
            @Override
            public void OnItemClick(View v, int position) {
                presenter.startReading(position);
            }
        });
        recyclerView.setAdapter(adapter);
    } else {
        adapter.notifyDataSetChanged();
    }
}
</code></pre>
<h4 id="Day-4ï¼Œç¼“å­˜å†…å®¹"><a href="#Day-4ï¼Œç¼“å­˜å†…å®¹" class="headerlink" title="Day 4ï¼Œç¼“å­˜å†…å®¹"></a>Day 4ï¼Œç¼“å­˜å†…å®¹</h4><p>å®Œæˆä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬è¿˜åªæ˜¯å®ç°äº†åœ¨æœ‰ç½‘ç»œçŠ¶æ€ä¸‹çš„æ­£å¸¸è¿è¡Œï¼Œå¦‚æœç”¨æˆ·å¹¶æ²¡æœ‰é‚£ä¹ˆç•…é€šæ— é˜»çš„ç½‘ç»œè¿æ¥å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ç¼“å­˜å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œåªè¦ç”¨æˆ·åŠ è½½è¿‡ä¸€æ¬¡ï¼Œä»¥åå°±ç®—æ²¡æœ‰ç½‘ç»œè¿æ¥ï¼Œç”¨æˆ·ä¹Ÿèƒ½æŸ¥çœ‹ä¹‹å‰å·²ç»ç¦»çº¿çš„å†…å®¹ã€‚æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨AndroidåŸç”ŸSQLiteæ•°æ®åº“æ¥å­˜å‚¨æ•°æ®(å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©<a href="https://realm.io/" target="_blank" rel="external">Realm</a>)ã€‚</p>
<p>é¦–å…ˆå½“ç„¶æ˜¯è¦å»ºç«‹æ•°æ®åº“äº†(ç”±äºçº¸é£æœºå·²ç»è¿›è¡Œå¤šä¸ªç‰ˆæœ¬çš„è¿­ä»£ï¼Œæ‰€ä»¥ä½ åˆ›å»ºæ•°æ®åº“çš„SQLè¯­å¥æˆ–å…¶ä»–å†…å®¹å’Œæˆ‘çš„æ–‡ä»¶åº”è¯¥ä¸å®Œå…¨ç›¸åŒ)ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/db/DatabaseHelper.java" target="_blank" rel="external">DatabaseHelper.java</a></p>
<pre><code class="java">public class DatabaseHelper extends SQLiteOpenHelper {


    public DatabaseHelper(Context context, String name, SQLiteDatabase.CursorFactory factory, int version) {
        super(context, name, factory, version);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        db.execSQL(&quot;create table if not exists Zhihu(&quot;
                + &quot;id integer primary key autoincrement,&quot;
                + &quot;zhihu_id integer not null,&quot;
                + &quot;zhihu_news text,&quot;
                + &quot;zhihu_time real,&quot;
                + &quot;zhihu_content text)&quot;);

        db.execSQL(&quot;alter table Zhihu add column bookmark integer default 0&quot;);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

   }
}
</code></pre>
<p>ç›¸ä¿¡å¤§ç‰›åº”è¯¥çœ‹å‡ºæ¥äº†ï¼Œè¿™æ•°æ®åº“è®¾è®¡çš„çœŸå¿ƒä¸æ€ä¹ˆæ ·ğŸ˜‚ï¼Œå› ä¸ºæˆ‘æ•°æ®åº“å­¦çš„ç¡®å®å¾ˆä¸€èˆ¬ã€‚æ±‚å¤§ç‰›ä¸å–·ã€‚</p>
<table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>ç±»å‹</th>
<th>å«ä¹‰</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td> id</td>
<td>integer</td>
<td>ä¸»é”®</td>
<td>è‡ªå¢é•¿</td>
</tr>
<tr>
<td> zhihu_id</td>
<td>integer</td>
<td>çŸ¥ä¹æ—¥æŠ¥æ¶ˆæ¯id</td>
<td>ç”±çŸ¥ä¹æä¾›</td>
</tr>
<tr>
<td> zhihu_news</td>
<td>text</td>
<td>çŸ¥ä¹æ—¥æŠ¥æ¶ˆæ¯å†…å®¹</td>
<td>ä¸Javaå®ä½“ç±»å¯¹åº”</td>
</tr>
<tr>
<td> zhihu_time</td>
<td>real</td>
<td>çŸ¥ä¹æ—¥æŠ¥æ¶ˆæ¯å‘å¸ƒçš„æ—¶é—´</td>
<td>ç”±çŸ¥ä¹æä¾›</td>
</tr>
<tr>
<td> zhihu_content</td>
<td>text</td>
<td>çŸ¥ä¹æ—¥æŠ¥æ¶ˆæ¯è¯¦ç»†å†…å®¹</td>
<td>ä¸Javaå®ä½“ç±»å¯¹åº”</td>
</tr>
<tr>
<td> bookmark</td>
<td>integer</td>
<td>æ˜¯å¦è¢«æ”¶è—</td>
<td>ç”±äºSQLiteå¹¶æ²¡æœ‰booleanç±»å‹ï¼Œä½¿ç”¨integerçš„ä¸åŒå€¼ä»£æ›¿</td>
</tr>
</tbody>
</table>
<p>OK,å½“æˆ‘ä»¬æ­£ç¡®è¯·æ±‚åˆ°æ•°æ®åï¼Œå°±å¯ä»¥è¿›è¡Œå­˜å‚¨äº†ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyPresenter.java" target="_blank" rel="external">ZhihuDailyPresenter.java</a></p>
<pre><code class="java">if ( !queryIfIDExists(item.getId())) {
    db.beginTransaction();
    try {
        DateFormat format = new SimpleDateFormat(&quot;yyyyMMdd&quot;);
        Date date = format.parse(post.getDate());
        values.put(&quot;zhihu_id&quot;, item.getId());
        values.put(&quot;zhihu_news&quot;, gson.toJson(item));
        values.put(&quot;zhihu_content&quot;, &quot;&quot;);
        values.put(&quot;zhihu_time&quot;, date.getTime() / 1000);
        db.insert(&quot;Zhihu&quot;, null, values);
        values.clear();
        db.setTransactionSuccessful();
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        db.endTransaction();
    }
}

// æŸ¥è¯¢æ•°æ®åº“è¡¨ä¸­æ˜¯å¦å·²ç»å­˜åœ¨äº†æ­¤id
private boolean queryIfIDExists(int id){

    Cursor cursor = db.query(&quot;Zhihu&quot;,null,null,null,null,null,null);
    if (cursor.moveToFirst()){
        do {
            if (id == cursor.getInt(cursor.getColumnIndex(&quot;zhihu_id&quot;))){
                return true;
            }
        } while (cursor.moveToNext());
    }
    cursor.close();

    return false;
}
</code></pre>
<p>ç»†å¿ƒçš„ç«¥é‹å¯èƒ½å‘ç°äº†ï¼Œè¯¶ï¼Œæ•°æ®è¡¨ä¸­è¿˜æœ‰ä¸€ä¸ªå­—æ®µâ€“zhihu_contentï¼Œä½ æ²¡æœ‰å­˜å‚¨å‘€ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨è¯·æ±‚çŸ¥ä¹æ¶ˆæ¯åˆ—è¡¨çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰è¿”å›æ¶ˆæ¯çš„è¯¦ç»†å†…å®¹å‘€ã€‚ä¸è¿‡è¯¦ç»†å†…å®¹æˆ‘ä»¬è¿˜æ˜¯éœ€è¦ç¼“å­˜çš„ï¼Œç½‘ç»œè¯·æ±‚åœ¨UIçº¿ç¨‹ä¸Šè¿›è¡Œå¯èƒ½ä¼šå¼•èµ·ANRï¼Œé‚£æ›´å¥½çš„è§£å†³åŠæ³•å°±æ˜¯åœ¨Serviceé‡Œé¢å®Œæˆäº†ã€‚</p>
<p>æˆ‘ä»¬å…ˆå°†ä¸€äº›å¿…é¡»çš„æ•°æ®é€šè¿‡æœ¬åœ°å¹¿æ’­çš„å½¢å¼ï¼Œå‘é€å‡ºå»ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyPresenter.java" target="_blank" rel="external">ZhihuDailyPresenter.java</a></p>
<pre><code class="java">Intent intent = new Intent(&quot;com.marktony.zhihudaily.LOCAL_BROADCAST&quot;);
intent.putExtra(&quot;type&quot;, CacheService.TYPE_ZHIHU);
intent.putExtra(&quot;id&quot;, item.getId());
LocalBroadcastManager.getInstance(context).sendBroadcast(intent);
</code></pre>
<p>ç„¶ååœ¨<code>CacheService</code>é‡Œæ¥æ”¶å¹¿æ’­ï¼Œè·å–ä¼ é€çš„æ•°æ®ï¼Œç„¶åè¿›è¡Œç½‘ç»œè¯·æ±‚å’Œæ•°æ®å­˜å‚¨ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/service/CacheService.java" target="_blank" rel="external">CacheService.java</a></p>
<pre><code class="java">public class CacheService extends Service {

    private DatabaseHelper dbHelper;
    private SQLiteDatabase db;

    private static final String TAG = CacheService.class.getSimpleName();

    public static final int TYPE_ZHIHU = 0x00;
    public static final int TYPE_GUOKR = 0x01;
    public static final int TYPE_DOUBAN = 0x02;

    @Override
    public void onCreate() {
        super.onCreate();
        dbHelper = new DatabaseHelper(this, &quot;History.db&quot;, null, 5);
        db = dbHelper.getWritableDatabase();

        IntentFilter filter = new IntentFilter();
        filter.addAction(&quot;com.marktony.zhihudaily.LOCAL_BROADCAST&quot;);
        LocalBroadcastManager manager = LocalBroadcastManager.getInstance(this);
        manager.registerReceiver(new LocalReceiver(), filter);

    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        return super.onStartCommand(intent, flags, startId);
    }

    @Override
    public boolean onUnbind(Intent intent) {
        return super.onUnbind(intent);
    }

    /**
     * ç½‘ç»œè¯·æ±‚idå¯¹åº”çš„çŸ¥ä¹æ—¥æŠ¥çš„å†…å®¹ä¸»ä½“
     * å½“typeä¸º0æ—¶ï¼Œå­˜å‚¨bodyä¸­çš„æ•°æ®
     * å½“typeä¸º1æ—¶ï¼Œå†æ¬¡è¯·æ±‚share urlä¸­çš„å†…å®¹å¹¶å‚¨å­˜
     * @param id æ‰€è¦è·å–çš„çŸ¥ä¹æ—¥æŠ¥æ¶ˆæ¯å†…å®¹å¯¹åº”çš„id
     */
    private void startZhihuCache(final int id) {

        Cursor cursor = db.query(&quot;Zhihu&quot;, null, null, null, null, null, null);
        if (cursor.moveToFirst()) {
            do {
                if ((cursor.getInt(cursor.getColumnIndex(&quot;zhihu_id&quot;)) == id)
                        &amp;&amp; (cursor.getString(cursor.getColumnIndex(&quot;zhihu_content&quot;)).equals(&quot;&quot;))) {
                    StringRequest request = new StringRequest(Request.Method.GET, Api.ZHIHU_NEWS + id, new Response.Listener&lt;String&gt;() {
                        @Override
                        public void onResponse(String s) {
                            Gson gson = new Gson();
                            ZhihuDailyStory story = gson.fromJson(s, ZhihuDailyStory.class);
                            if (story.getType() == 1) {
                                StringRequest request = new StringRequest(Request.Method.GET, story.getShare_url(), new Response.Listener&lt;String&gt;() {
                                    @Override
                                    public void onResponse(String s) {
                                        ContentValues values = new ContentValues();
                                        values.put(&quot;zhihu_content&quot;, s);
                                        db.update(&quot;Zhihu&quot;, values, &quot;zhihu_id = ?&quot;, new String[] {String.valueOf(id)});
                                        values.clear();
                                    }
                                }, new Response.ErrorListener() {
                                    @Override
                                    public void onErrorResponse(VolleyError volleyError) {

                                    }
                                });
                                request.setTag(TAG);
                                VolleySingleton.getVolleySingleton(CacheService.this).addToRequestQueue(request);
                            } else {
                                ContentValues values = new ContentValues();
                                values.put(&quot;zhihu_content&quot;, s);
                                db.update(&quot;Zhihu&quot;, values, &quot;zhihu_id = ?&quot;, new String[] {String.valueOf(id)});
                                values.clear();
                            }

                        }
                    }, new Response.ErrorListener() {
                        @Override
                        public void onErrorResponse(VolleyError volleyError) {

                        }
                    });
                    request.setTag(TAG);
                    VolleySingleton.getVolleySingleton(CacheService.this).addToRequestQueue(request);
                }
            } while (cursor.moveToNext());
        }
        cursor.close();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        VolleySingleton.getVolleySingleton(this).getRequestQueue().cancelAll(TAG);
    }

    class LocalReceiver extends BroadcastReceiver {

        @Override
        public void onReceive(Context context, Intent intent) {
            int id = intent.getIntExtra(&quot;id&quot;, 0);
            switch (intent.getIntExtra(&quot;type&quot;, -1)) {
                case TYPE_ZHIHU:
                    startZhihuCache(id);
                    break;
                case TYPE_GUOKR:
                    startGuokrCache(id);
                    break;
                case TYPE_DOUBAN:
                    startDoubanCache(id);
                    break;
                default:
                case -1:
                    break;
            }
        }
    }

}
</code></pre>
<p>æˆ‘ä»¬å…ˆéå†ä¸€ä¸‹æ•°æ®åº“ï¼Œå¦‚æœæ•°æ®åº“ä¸­æŒ‡å®šidçš„æ¶ˆæ¯è¯¦æƒ…å†…å®¹å·²ç»ä¸ä¸ºç©ºï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥è·³è¿‡äº†ï¼Œå¯ä»¥èŠ‚çœç”¨æˆ·çš„æµé‡ä»¥åŠç”µé‡ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œæ•°æ®çš„å­˜å‚¨æ˜¯å®Œæˆäº†ã€‚å¯æ˜¯æ€ä¹ˆè¯»å–å‡ºæ¥å‘¢ï¼Ÿå“ˆï¼Œå…¶å®ä¹Ÿç®€å•ï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹å½“å‰çš„ç½‘ç»œçŠ¶æ€ï¼Œå¦‚æœç”¨æˆ·è®¾å¤‡æ²¡æœ‰è¿æ¥åˆ°ç½‘è·¯ï¼Œæˆ‘ä»¬å°±ç›´æ¥å»æ•°æ®åº“ä¸­è¯»å–ï¼Œç„¶åè§£æå°±è¡Œäº†ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyPresenter.java" target="_blank" rel="external">ZhihuDailyPresenter.java</a></p>
<pre><code class="java">if (NetworkState.networkConnected(context)) {
    // balabala
} else {
    Cursor cursor = db.query(&quot;Zhihu&quot;, null, null, null, null, null, null);
    if (cursor.moveToFirst()) {
        do {
            ZhihuDailyNews.Question question = gson.fromJson(cursor.getString(cursor.getColumnIndex(&quot;zhihu_news&quot;)), ZhihuDailyNews.Question.class);
            list.add(question);
        } while (cursor.moveToNext());
    }
    cursor.close();
    view.stopLoading();
    view.showResults(list);
}
</code></pre>
<p>åˆ°è¿™é‡Œï¼Œä»Šå¤©çš„å·¥ä½œå·®ä¸å¤šå·²ç»å®Œæˆäº†ï¼Œç­‰ç­‰ï¼Œæ˜¯ä¸æ˜¯å¿˜äº†ä»€ä¹ˆï¼Ÿæˆ‘ä»¬çš„Serviceå¹¶æ²¡æœ‰å¯åŠ¨å‘€ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/MainActivity.java" target="_blank" rel="external">MainActivity.java</a></p>
<pre><code class="java">@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    initViews();

    // å¯åŠ¨æœåŠ¡
    startService(new Intent(this, CacheService.class));

}

@Override
protected void onDestroy() {
    ActivityManager manager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
    for (ActivityManager.RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) {
        if (CacheService.class.getName().equals(service.service.getClassName())) {
            stopService(new Intent(this, CacheService.class));
        }
    }
    super.onDestroy();
}
</code></pre>
<p>åˆ°è¿™é‡Œï¼Œä»Šå¤©çš„å†…å®¹å°±ç®—ç»“æŸäº†ï¼Œå†…å®¹æ˜¯ä¸€å‘¨ä¹‹ä¸­æœ€å¤šçš„ä¸€å¤©ï¼Œå¯èƒ½æ¯”å‰å‡ å¤©çš„æ€»å’Œè¿˜è¦å¤šï¼Œå¯èƒ½éœ€è¦ä½ åŠ ç­æ‰èƒ½å®Œå…¨å®Œæˆï¼Œä¹‹å‰Activity, Presenter, Fragmentä¸­å„è¿˜æœ‰ä¸€éƒ¨åˆ†å†…å®¹æ²¡æœ‰å®Œæˆï¼Œéœ€è¦ä½ è‡ªè¡Œè¡¥å……å®Œæˆã€‚ä¸è¿‡ï¼Œçœ‹åˆ°è‡ªå·±çš„Appæ­£ç¡®çš„è·‘äº†èµ·æ¥ï¼Œæœ‰æœ¨æœ‰å¾ˆå…´å¥‹å‘¢ï¼Ÿä¼‘æ¯ä¼‘æ¯ï¼Œå‡†å¤‡æ˜å¤©çš„å·¥ä½œå§ã€‚</p>
<h3 id="DAY-5"><a href="#DAY-5" class="headerlink" title="DAY 5"></a>DAY 5</h3><p>ä»Šå¤©çš„å†…å®¹æ˜¯æ˜¾ç¤ºæ¶ˆæ¯è¯¦æƒ…å†…å®¹ã€‚å› ä¸ºæˆ‘ä»¬çš„æ¶ˆæ¯å†…å®¹å®é™…ä¸Šæœ‰ä¸‰ç§ç±»å‹ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤ã€‚æ€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿæˆ‘çš„æ–¹æ³•æ˜¯å®šä¹‰äº†ä¸€ä¸ªæšä¸¾ç±»å‹:</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bean/BeanType.java" target="_blank" rel="external">BeanType.java</a></p>
<pre><code class="java">public enum BeanType {

    TYPE_ZHIHU,TYPE_GUOKR,TYPE_DOUBAN;

}
</code></pre>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½æ ¹æ®ä¸åŒçš„æ¶ˆæ¯ç±»å‹ï¼Œè·å–å’ŒåŠ è½½ä¸åŒçš„æ¶ˆæ¯è¯¦æƒ…å†…å®¹äº†ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/homepage/ZhihuDailyPresenter.java" target="_blank" rel="external">ZhihuDailyPresenter.java</a></p>
<pre><code class="java">@Override
public void startReading(int position) {

    context.startActivity(new Intent(context, DetailActivity.class)
            .putExtra(&quot;type&quot;, BeanType.TYPE_ZHIHU)
            .putExtra(&quot;id&quot;, list.get(position).getId())
            .putExtra(&quot;title&quot;, list.get(position).getTitle())
            .putExtra(&quot;coverUrl&quot;, list.get(position).getImages().get(0)));

}
</code></pre>
<h4 id="Day-5-ç•Œé¢ç¼–å†™"><a href="#Day-5-ç•Œé¢ç¼–å†™" class="headerlink" title="Day 5,ç•Œé¢ç¼–å†™"></a>Day 5,ç•Œé¢ç¼–å†™</h4><p>ä»çŸ¥ä¹ç»™æˆ‘ä»¬çš„è¯¦æƒ…å†…å®¹ä¸ºHTMLæ ¼å¼æ¥çœ‹ï¼Œç”¨WebViewä½œä¸ºæ˜¾ç¤ºæ§ä»¶æœ€åˆé€‚ä¸è¿‡äº†(å®é™…ä¸Šæœå£³å’Œè±†ç“£çš„è¯¦æƒ…é¡µå†…å®¹è¦ä¹ˆæ˜¯è¿”å›äº†HTMLæ ¼å¼ï¼Œè¦ä¹ˆæ˜¯ç›´æ¥ç»™å‡ºäº†è¯¦æƒ…é¡µçš„ç½‘é¡µåœ°å€ï¼Œåšç®€å•å¤„ç†å³å¯ï¼Œå¯ä»¥å®ç°å¤ç”¨)ã€‚</p>
<p>å…ˆçœ‹å¸ƒå±€æ–‡ä»¶ä»£ç ï¼š</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/layout/universal_read_layout.xml" target="_blank" rel="external">universal_read_layout.xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.design.widget.CoordinatorLayout
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:fitsSystemWindows=&quot;true&quot;
    android:id=&quot;@+id/coordinatorLayout&quot;&gt;

    &lt;android.support.design.widget.AppBarLayout
        android:id=&quot;@+id/app_bar&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;@dimen/app_bar_height&quot;
        android:fitsSystemWindows=&quot;true&quot;
        android:theme=&quot;@style/AppTheme.AppBarOverlay&quot;&gt;

        &lt;android.support.design.widget.CollapsingToolbarLayout
            android:id=&quot;@+id/toolbar_layout&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;match_parent&quot;
            android:fitsSystemWindows=&quot;true&quot;
            app:contentScrim=&quot;@color/colorPrimary&quot;
            app:layout_scrollFlags=&quot;scroll|enterAlwaysCollapsed|enterAlways&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;match_parent&quot;
                android:layout_height=&quot;match_parent&quot;
                android:id=&quot;@+id/image_view&quot;
                android:fitsSystemWindows=&quot;true&quot;
                android:scaleType=&quot;centerCrop&quot;
                android:scrollbarStyle=&quot;insideInset&quot;
                android:scrollbarAlwaysDrawVerticalTrack=&quot;true&quot; /&gt;

            &lt;android.support.v7.widget.Toolbar
                android:id=&quot;@+id/toolbar&quot;
                android:layout_width=&quot;match_parent&quot;
                android:layout_height=&quot;?attr/actionBarSize&quot;
                app:layout_collapseMode=&quot;pin&quot;
                app:popupTheme=&quot;@style/AppTheme.PopupOverlay&quot;
                app:background=&quot;@color/colorPrimary&quot;/&gt;

        &lt;/android.support.design.widget.CollapsingToolbarLayout&gt;

    &lt;/android.support.design.widget.AppBarLayout&gt;

    &lt;android.support.v4.widget.SwipeRefreshLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;
        android:id=&quot;@+id/refreshLayout&quot;&gt;

        &lt;android.support.v4.widget.NestedScrollView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;match_parent&quot;
            android:id=&quot;@+id/scrollView&quot;
            android:scrollbars=&quot;vertical&quot;
            android:scrollbarFadeDuration=&quot;1&quot;
            android:fadeScrollbars=&quot;true&quot;&gt;

            &lt;WebView
                android:layout_width=&quot;match_parent&quot;
                android:layout_height=&quot;match_parent&quot;
                android:id=&quot;@+id/web_view&quot; /&gt;

        &lt;/android.support.v4.widget.NestedScrollView&gt;

    &lt;/android.support.v4.widget.SwipeRefreshLayout&gt;

&lt;/android.support.design.widget.CoordinatorLayout&gt;
</code></pre><p>å°†<code>ImageView</code>åµŒå…¥Toolbarä¸­ï¼Œç„¶åæ­é…<code>CollapsingToolbarLayout</code>å¯æ”¶ç¼©çš„ToolbarLayoutï¼Œå®ç°æ”¶ç¼©å’Œå±•å¼€æ•ˆæœã€‚<code>SwipeRefreshLayout</code>ä»ç„¶ç”¨äºæ˜¾ç¤ºåŠ è½½çŠ¶æ€å’Œåˆ·æ–°ã€‚ç„¶åå°±é½æ´»äº†ã€‚</p>
<p>æ¥ç€æ˜¯Activityã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/detail/DetailActivity.java" target="_blank" rel="external">DetailActivity.java</a></p>
<pre><code class="java">public class DetailActivity extends AppCompatActivity {

    private DetailFragment fragment;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.frame);

        if (savedInstanceState != null) {
            fragment = (DetailFragment) getSupportFragmentManager().getFragment(savedInstanceState,&quot;detailFragment&quot;);
        } else {
            fragment = new DetailFragment();
            getSupportFragmentManager().beginTransaction()
                    .replace(R.id.container, fragment)
                    .commit();
        }

        Intent intent = getIntent();

        DetailPresenter presenter = new DetailPresenter(DetailActivity.this, fragment);

        presenter.setType((BeanType) intent.getSerializableExtra(&quot;type&quot;));
        presenter.setId(intent.getIntExtra(&quot;id&quot;, 0));
        presenter.setTitle(intent.getStringExtra(&quot;title&quot;));
        presenter.setCoverUrl(intent.getStringExtra(&quot;coverUrl&quot;));

    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        if (fragment.isAdded()) {
            getSupportFragmentManager().putFragment(outState, &quot;detailFragment&quot;, fragment);
        }
    }
}
</code></pre>
<p>å†…å®¹ä¸é¦–é¡µç±»ä¼¼ï¼Œç›¸ä¿¡ä½ èƒ½ç†è§£ï¼Œä¹Ÿæ˜¯é€šè¿‡Activity + Fragmentæ­é…çš„æ–¹å¼è¿›è¡Œçš„ã€‚é‚£ä¹ˆï¼ŒViewå±‚ä¹Ÿå°±æ˜¯Fragmentéœ€è¦å®Œæˆé‚£äº›åŠŸèƒ½å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å¥‘çº¦ç±»ä¸­å®šä¹‰å¥½ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/detail/DetailContract.java" target="_blank" rel="external">DetailContract.java</a></p>
<pre><code class="java">public class DetailContract {

    interface View extends BaseView&lt;Presenter&gt; {

        // æ˜¾ç¤ºæ­£åœ¨åŠ è½½
        void showLoading();
        // åœæ­¢åŠ è½½
        void stopLoading();
        // æ˜¾ç¤ºåŠ è½½é”™è¯¯
        void showLoadingError();
        // æ˜¾ç¤ºåˆ†äº«æ—¶é”™è¯¯
        void showSharingError();
        // æ­£ç¡®è·å–æ•°æ®åæ˜¾ç¤ºå†…å®¹
        void showResult(String result);
        // å¯¹äºbodyå­—æ®µçš„æ¶ˆæ¯ï¼Œç›´æ¥æ¥åœ¨urlçš„å†…å®¹
        void showResultWithoutBody(String url);
        // è®¾ç½®é¡¶éƒ¨å¤§å›¾
        void showCover(String url);
        // è®¾ç½®æ ‡é¢˜
        void setTitle(String title);
        // è®¾ç½®æ˜¯å¦æ˜¾ç¤ºå›¾ç‰‡
        void setImageMode(boolean showImage);
        // ç”¨æˆ·é€‰æ‹©åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ—¶ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…æµè§ˆå™¨ï¼Œæ˜¾ç¤ºæ²¡æœ‰æ‰¾åˆ°æµè§ˆå™¨é”™è¯¯
        void showBrowserNotFoundError();
        // æ˜¾ç¤ºå·²å¤åˆ¶æ–‡å­—å†…å®¹
        void showTextCopied();
        // æ˜¾ç¤ºæ–‡å­—å¤åˆ¶å¤±è´¥
        void showCopyTextError();
        // æ˜¾ç¤ºå·²æ·»åŠ è‡³æ”¶è—å¤¹
        void showAddedToBookmarks();
        // æ˜¾ç¤ºå·²ä»æ”¶è—å¤¹ä¸­ç§»é™¤
        void showDeletedFromBookmarks();

    }

    interface Presenter extends BasePresenter{

        // åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
        void openInBrowser();
        // ä½œä¸ºæ–‡å­—åˆ†äº«
        void shareAsText();
        // æ‰“å¼€æ–‡ç« ä¸­çš„é“¾æ¥
        void openUrl(WebView webView, String url);
        // å¤åˆ¶æ–‡å­—å†…å®¹
        void copyText();
        // å¤åˆ¶æ–‡ç« é“¾æ¥
        void copyLink();
        // æ·»åŠ è‡³æ”¶è—å¤¹æˆ–è€…ä»æ”¶è—å¤¹ä¸­åˆ é™¤
        void addToOrDeleteFromBookmarks();
        // æŸ¥è¯¢æ˜¯å¦å·²ç»è¢«æ”¶è—äº†
        boolean queryIfIsBookmarked();
        // è¯·æ±‚æ•°æ®
        void requestData();

    }

}
</code></pre>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/detail/DetailFragment.java" target="_blank" rel="external">DetailFragment.java</a></p>
<pre><code class="java">public class DetailFragment extends Fragment
        implements DetailContract.View {

    public DetailFragment() {}


    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.universal_read_layout, container, false);

        initViews(view);

        setHasOptionsMenu(true);

        return view;
    }

    @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        inflater.inflate(R.menu.menu_more, menu);
        super.onCreateOptionsMenu(menu, inflater);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        int id = item.getItemId();
        if (id == android.R.id.home) {
            getActivity().onBackPressed();
        } else if (id == R.id.action_more) {

        }
        return true;
    }

    @Override
    public void showLoading() {

    }

    @Override
    public void stopLoading() {

    }

    @Override
    public void showLoadingError() {

    }

    @Override
    public void showSharingError() {

    }

    @Override
    public void showResult(String result) {

    }

    @Override
    public void showResultWithoutBody(String url) {

    }

    @Override
    public void showCover(String url) {

    }

    @Override
    public void setTitle(String title) {

    }

    // WebView æä¾›äº†æ˜¯å¦æ˜¾ç¤ºå›¾ç‰‡çš„æ–¹æ³•
    @Override
    public void setImageMode(boolean showImage) {
        webView.getSettings().setBlockNetworkImage(showImage);
    }

    @Override
    public void showBrowserNotFoundError() {

    }

    @Override
    public void showTextCopied() {

    }

    @Override
    public void showCopyTextError() {

    }

    @Override
    public void showAddedToBookmarks() {

    }

    @Override
    public void showDeletedFromBookmarks() {

    }

    @Override
    public void setPresenter(DetailContract.Presenter presenter) {

    }

    @Override
    public void initViews(View view) {

    }

    // to change the title&#39;s font size of toolbar layout
    private void setCollapsingToolbarLayoutTitle(String title) {
        toolbarLayout.setTitle(title);
        toolbarLayout.setExpandedTitleTextAppearance(R.style.ExpandedAppBar);
        toolbarLayout.setCollapsedTitleTextAppearance(R.style.CollapsedAppBar);
        toolbarLayout.setExpandedTitleTextAppearance(R.style.ExpandedAppBarPlus1);
        toolbarLayout.setCollapsedTitleTextAppearance(R.style.CollapsedAppBarPlus1);
    }

}
</code></pre>
<h4 id="Day-5-å®ä½“ç±»"><a href="#Day-5-å®ä½“ç±»" class="headerlink" title="Day 5,å®ä½“ç±»"></a>Day 5,å®ä½“ç±»</h4><p>å¸ƒå±€æ–‡ä»¶å®Œæˆäº†ï¼Œç°åœ¨å¼€å§‹å†™å®ä½“ç±»ã€‚æ–¹æ³•å’Œæ˜¨å¤©å†™åˆ—è¡¨é¡¹å®ä½“ç±»ä¸€æ ·ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–å†™ï¼Œä¹Ÿå¯ä»¥ç”¨æ’ä»¶ç›´æ¥ç”Ÿæˆã€‚ç›´æ¥æ”¾ä»£ç ã€‚</p>
<p>JSONæ ¼å¼æ•°æ®:</p>
<pre><code class="json">{
  &quot;body&quot;: &quot;HTMLæ ¼å¼å†…å®¹&quot;,
  &quot;image_source&quot;: &quot;ã€Šé‚£äº›å¹´ï¼Œæˆ‘ä»¬ä¸€èµ·è¿½çš„å¥³å­©ã€‹&quot;,
  &quot;title&quot;: &quot;çæ‰¯ Â· å¦‚ä½•æ­£ç¡®åœ°åæ§½&quot;,
  &quot;image&quot;: &quot;http://pic1.zhimg.com/13ee386166c53553ea6997d821609e0c.jpg&quot;,
  &quot;share_url&quot;: &quot;http://daily.zhihu.com/story/9195072&quot;,
  &quot;js&quot;: [],
  &quot;ga_prefix&quot;: &quot;020706&quot;,
  &quot;section&quot;: {
    &quot;thumbnail&quot;: &quot;http://pic2.zhimg.com/1dc9cf1556c7b0b1527c18476698c5cd.jpg&quot;,
    &quot;id&quot;: 2,
    &quot;name&quot;: &quot;çæ‰¯&quot;
  },
  &quot;images&quot;: [
    &quot;http://pic2.zhimg.com/1dc9cf1556c7b0b1527c18476698c5cd.jpg&quot;
  ],
  &quot;type&quot;: 0,
  &quot;id&quot;: 9195072,
  &quot;css&quot;: [
    &quot;http://news-at.zhihu.com/css/news_qa.auto.css?v=4b3e3&quot;
  ]
}
</code></pre>
<p>å¯¹åº”çš„å®ä½“ç±»ï¼š<br><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bean/ZhihuDailyStory.java" target="_blank" rel="external">ZhihuDailyStory.java</a></p>
<pre><code class="java">public class ZhihuDailyStory {

    private String body;
    private String image_source;
    private String title;
    private String image;
    private String share_url;
    private ArrayList&lt;String&gt; js;
    private String ga_prefix;
    private ArrayList&lt;String&gt; images;
    private int type;
    private int id;
    private ArrayList&lt;String&gt; css;

    public String getBody() {
        return body;
    }

    public void setBody(String body) {
        this.body = body;
    }

    public String getImage_source() {
        return image_source;
    }

    public void setImage_source(String image_source) {
        this.image_source = image_source;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getImage() {
        return image;
    }

    public void setImage(String image) {
        this.image = image;
    }

    public String getShare_url() {
        return share_url;
    }

    public void setShare_url(String share_url) {
        this.share_url = share_url;
    }

    public ArrayList&lt;String&gt; getJs() {
        return js;
    }

    public void setJs(ArrayList&lt;String&gt; js) {
        this.js = js;
    }

    public String getGa_prefix() {
        return ga_prefix;
    }

    public void setGa_prefix(String ga_prefix) {
        this.ga_prefix = ga_prefix;
    }

    public ArrayList&lt;String&gt; getImages() {
        return images;
    }

    public void setImages(ArrayList&lt;String&gt; images) {
        this.images = images;
    }

    public int getType() {
        return type;
    }

    public void setType(int type) {
        this.type = type;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public ArrayList&lt;String&gt; getCss() {
        return css;
    }

    public void setCss(ArrayList&lt;String&gt; css) {
        this.css = css;
    }

}
</code></pre>
<h4 id="Day-5-æ˜¾ç¤ºæ•°æ®"><a href="#Day-5-æ˜¾ç¤ºæ•°æ®" class="headerlink" title="Day 5,æ˜¾ç¤ºæ•°æ®"></a>Day 5,æ˜¾ç¤ºæ•°æ®</h4><p>å˜»å˜»ï¼Œé¦–å…ˆå½“ç„¶æ˜¯è·å–æ•°æ®äº†â˜ºï¸ï¼Œéœ€è¦è€ƒè™‘ç½‘ç»œè¿æ¥çš„æƒ…å†µï¼Œå¦‚æœç½‘ç»œé€šç•…ï¼Œåˆ™ç›´æ¥ä»ç½‘ç»œä¸­è·å–ï¼Œå¦åˆ™å»æ•°æ®åº“ä¸­è·å–ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/detail/DetailPresenter.java" target="_blank" rel="external">DetailPresenter.java</a></p>
<pre><code class="java">if (NetworkState.networkConnected(context)) {
    model.load(Api.ZHIHU_NEWS + id, new OnStringListener() {
        @Override
        public void onSuccess(String result) {
            {
                Gson gson = new Gson();
                try {
                    zhihuDailyStory = gson.fromJson(result, ZhihuDailyStory.class);
                    if (zhihuDailyStory.getBody() == null) {
                        view.showResultWithoutBody(zhihuDailyStory.getShare_url());
                    } else {
                        view.showResult(convertZhihuContent(zhihuDailyStory.getBody()));
                    }
                } catch (JsonSyntaxException e) {
                    view.showLoadingError();
                }
                view.stopLoading();
            }
        }

        @Override
        public void onError(VolleyError error) {
            view.stopLoading();
            view.showLoadingError();
        }
    });
} else {
    Cursor cursor = dbHelper.getReadableDatabase()
            .query(&quot;Zhihu&quot;, null, null, null, null, null, null);
    if (cursor.moveToFirst()) {
        do {
            if (cursor.getInt(cursor.getColumnIndex(&quot;zhihu_id&quot;)) == id) {
                String content = cursor.getString(cursor.getColumnIndex(&quot;zhihu_content&quot;));
                try {
                    zhihuDailyStory = gson.fromJson(content, ZhihuDailyStory.class);
                } catch (JsonSyntaxException e) {
                    view.showResult(content);
                }
                view.showResult(convertZhihuContent(zhihuDailyStory.getBody()));
            }
        } while (cursor.moveToNext());
    }
    cursor.close();
}

private String convertZhihuContent(String preResult) {

    preResult = preResult.replace(&quot;&lt;div class=\&quot;img-place-holder\&quot;&gt;&quot;, &quot;&quot;);
    preResult = preResult.replace(&quot;&lt;div class=\&quot;headline\&quot;&gt;&quot;, &quot;&quot;);

    // åœ¨apiä¸­ï¼Œcssçš„åœ°å€æ˜¯ä»¥ä¸€ä¸ªæ•°ç»„çš„å½¢å¼ç»™å‡ºï¼Œè¿™é‡Œéœ€è¦è®¾ç½®
    // apiä¸­è¿˜æœ‰jsçš„éƒ¨åˆ†ï¼Œè¿™é‡Œä¸å†è§£æjs
    // ä¸å†é€‰æ‹©åŠ è½½ç½‘ç»œcssï¼Œè€Œæ˜¯åŠ è½½æœ¬åœ°assetsæ–‡ä»¶å¤¹ä¸­çš„css
    String css = &quot;&lt;link rel=\&quot;stylesheet\&quot; href=\&quot;file:///android_asset/zhihu_daily.css\&quot; type=\&quot;text/css\&quot;&gt;&quot;;

    String theme = &quot;&lt;body className=\&quot;\&quot; onload=\&quot;onLoaded()\&quot;&gt;&quot;;

    return new StringBuilder()
            .append(&quot;&lt;!DOCTYPE html&gt;\n&quot;)
            .append(&quot;&lt;html lang=\&quot;en\&quot; xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;\n&quot;)
            .append(&quot;&lt;head&gt;\n&quot;)
            .append(&quot;\t&lt;meta charset=\&quot;utf-8\&quot; /&gt;&quot;)
            .append(css)
            .append(&quot;\n&lt;/head&gt;\n&quot;)
            .append(theme)
            .append(preResult)
            .append(&quot;&lt;/body&gt;&lt;/html&gt;&quot;).toString();
}
</code></pre>
<p>å¯¹è·å–çš„æ•°æ®è¿›è¡Œä¸€ä¸‹æ‹¼æ¥ï¼Œç»„æˆä¸€ä¸ªå®Œæ•´çš„HTMLé¡µé¢çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯CSSæ–‡ä»¶ï¼Œå®ƒè´Ÿè´£æ•´ä¸ªHTMLçš„æ ·å¼ï¼Œå¯ä»¥åœ¨<a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/assets/zhihu_daily.css" target="_blank" rel="external">è¿™é‡Œ</a>æŸ¥çœ‹æ•´ä¸ªCSSæ–‡ä»¶çš„å†…å®¹æˆ–ä¸‹è½½CSSæ–‡ä»¶ã€‚</p>
<p>æœ€åçš„æ˜¾ç¤ºå°±éå¸¸ç®€å•äº†ï¼š</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/detail/DetailFragment.java" target="_blank" rel="external">DetailFragment.java</a></p>
<pre><code class="java">@Override
public void showResult(String result) {
    webView.loadDataWithBaseURL(&quot;x-data://base&quot;,result,&quot;text/html&quot;,&quot;utf-8&quot;,null);
}
</code></pre>
<p>è‡³æ­¤ï¼Œæœ€åŸºæœ¬çš„æ˜¾ç¤ºè¯¦æƒ…å†…å®¹çš„éƒ¨åˆ†å°±å·²ç»å®Œæˆäº†ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šçš„å·¥ä½œç»†å¾®çš„å·¥ä½œæ²¡æœ‰å®Œæˆï¼Œå–æ¯å’–å•¡ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Œå†å›æ¥ç»§ç»­å§ã€‚</p>
<h4 id="Day-5-è®¾ç½®ä¸å…³äº"><a href="#Day-5-è®¾ç½®ä¸å…³äº" class="headerlink" title="Day 5,è®¾ç½®ä¸å…³äº"></a>Day 5,è®¾ç½®ä¸å…³äº</h4><p>è®¾ç½®ä¸å…³äºä¹Ÿå’Œé¦–é¡µåŠè¯¦æƒ…ç›¸åŒï¼Œé‡‡ç”¨çš„æ˜¯Activity + Fragmentæ­é…çš„å½¢å¼ã€‚ä¸è¿‡ï¼Œè¿™é‡Œçš„Fragmentå¹¶ä¸æ˜¯æˆ‘ä»¬å‰é¢æ‰€è§åˆ°çš„<code>android.support.v4.app.Fragment</code>ä¸‹çš„Fragmentï¼Œè€Œæ˜¯<code>android.support.v7.preference.PreferenceFragmentCompat</code>ã€‚é€šè¿‡<br><code>PreferenceFragmentCompat</code>ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«çš„å®ç°è®¾ç½®ä¸å…³äºé¡µé¢ã€‚(ç”±äºäºŒè€…çš„å®ç°æ–¹æ³•ç±»ä¼¼ï¼Œæˆ‘å°±ä»¥å®ç°å…³äºé¡µé¢ä¸ºä¾‹)</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code>res</code>ç›®å½•ä¸‹æ–°å»º<code>xml</code>æ–‡ä»¶å¤¹ï¼Œæ–°å»º<code>about_preference_fragment.xml</code>æ–‡ä»¶ï¼Œä½œä¸ºè®¾ç½®å’Œå…³äºé¡µé¢çš„å¸ƒå±€æ–‡ä»¶ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/res/xml/about_preference_fragment.xml" target="_blank" rel="external">about_preference_fragment.xml</a></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.v7.preference.PreferenceScreen
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;android.support.v7.preference.PreferenceCategory android:title=&quot;@string/app_name&quot;&gt;

        &lt;android.support.v7.preference.Preference android:title=&quot;@string/version&quot; /&gt;

        &lt;android.support.v7.preference.Preference android:title=&quot;@string/rate&quot;
            android:key=&quot;rate&quot;
            android:summary=&quot;@string/rate_description&quot; /&gt;

    &lt;/android.support.v7.preference.PreferenceCategory&gt;

    &lt;android.support.v7.preference.PreferenceCategory android:title=&quot;@string/author&quot;&gt;

        &lt;android.support.v7.preference.Preference android:title=&quot;@string/author_name&quot;
            android:key=&quot;author&quot;
            android:summary=&quot;@string/author_description&quot;/&gt;

        &lt;android.support.v7.preference.Preference
            android:title=&quot;@string/follow_me_on_github&quot;
            android:key=&quot;follow_me_on_github&quot;
            android:summary=&quot;@string/github_url&quot;/&gt;

        &lt;android.support.v7.preference.Preference
            android:title=&quot;@string/follow_me_on_zhihu&quot;
            android:key=&quot;follow_me_on_zhihu&quot;
            android:summary=&quot;@string/zhihu_account&quot;/&gt;

    &lt;/android.support.v7.preference.PreferenceCategory&gt;

    &lt;android.support.v7.preference.PreferenceCategory android:title=&quot;@string/support&quot;&gt;

        &lt;android.support.v7.preference.Preference android:title=&quot;@string/feedback&quot;
            android:key=&quot;feedback&quot;
            android:summary=&quot;@string/feedback_description&quot;/&gt;

        &lt;android.support.v7.preference.Preference android:title=&quot;@string/coffee&quot;
            android:key=&quot;coffee&quot;
            android:summary=&quot;@string/coffee_description&quot;/&gt;

        &lt;android.support.v7.preference.Preference android:title=&quot;@string/open_source_license&quot;
            android:key=&quot;open_source_license&quot; /&gt;

    &lt;/android.support.v7.preference.PreferenceCategory&gt;

&lt;/android.support.v7.preference.PreferenceScreen&gt;
</code></pre><p>è¿™æ ·ï¼Œå¸ƒå±€æ–‡ä»¶å°±å·²ç»å®Œæˆäº†ã€‚æ¥ä¸‹æ¥æ˜¯å’Œé¦–é¡µç­‰ç±»ä¼¼çš„ï¼Œåˆ†åˆ«å®Œæˆ<code>Contract</code>,<code>Activity</code>,<code>Fragment</code>,<code>Presenter</code>ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/about/AboutContract.java" target="_blank" rel="external">AboutContract.java</a></p>
<pre><code class="java">public interface AboutContract {

    interface View extends BaseView&lt;Presenter&gt;{

        // å¦‚æœç”¨æˆ·è®¾å¤‡æ²¡æœ‰å®‰è£…å•†åº—åº”ç”¨ï¼Œæç¤ºæ­¤é”™è¯¯
        void showRateError();
        // å¦‚æœç”¨æˆ·è®¾å¤‡æ²¡æœ‰å®‰è£…é‚®ä»¶åº”ç”¨ï¼Œæç¤ºæ­¤é”™è¯¯
        void showFeedbackError();
        // å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æµè§ˆå™¨ï¼Œæç¤ºæ­¤é”™è¯¯
        void showBrowserNotFoundError();

    }

    interface Presenter extends BasePresenter {
        // åœ¨åº”ç”¨å•†åº—ä¸­è¯„åˆ†
        void rate();
        // å±•ç¤ºå¼€æºè®¸å¯é¡µ
        void openLicense();
        // åœ¨GitHubä¸Šå…³æ³¨æˆ‘
        void followOnGithub();
        // åœ¨çŸ¥ä¹ä¸Šå…³æ³¨æˆ‘
        void followOnZhihu();
        // é€šè¿‡é‚®ä»¶åé¦ˆ
        void feedback();
        // æèµ 
        void donate();
        // æ˜¾ç¤ºå°å½©è›‹
        void showEasterEgg();

    }

}
</code></pre>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/about/AboutPreferenceActivity.java" target="_blank" rel="external">AboutPreferenceActivity.java</a></p>
<pre><code class="java">public class AboutPreferenceActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_about);

        initViews();

        AboutPreferenceFragment fragment = new AboutPreferenceFragment();

        getSupportFragmentManager()
                .beginTransaction()
                .add(R.id.about_container,fragment)
                .commit();

        new AboutPresenter(AboutPreferenceActivity.this, fragment);

    }

    private void initViews() {
        setSupportActionBar((Toolbar) findViewById(R.id.toolbar));
        getSupportActionBar().setDisplayHomeAsUpEnabled(true);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        if (item.getItemId() == android.R.id.home){
            onBackPressed();
        }
        return super.onOptionsItemSelected(item);
    }

}
</code></pre>
<p>æ˜¯ä¸æ˜¯æœ‰ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰å‘¢ğŸ˜‰ï¼Ÿ</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/about/AboutPreferenceFragment.java" target="_blank" rel="external">AboutPreferenceFragment.java</a></p>
<pre><code class="java">public class AboutPreferenceFragment extends PreferenceFragmentCompat
        implements AboutContract.View {

    private Toolbar toolbar;
    private AboutContract.Presenter presenter;

    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {

        addPreferencesFromResource(R.xml.about_preference_fragment);

        initViews(getView());

        findPreference(&quot;rate&quot;).setOnPreferenceClickListener(new android.support.v7.preference.Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(android.support.v7.preference.Preference preference) {
                presenter.rate();
                return false;
            }
        });

        findPreference(&quot;open_source_license&quot;).setOnPreferenceClickListener(new android.support.v7.preference.Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(android.support.v7.preference.Preference preference) {
                return false;
            }
        });

        findPreference(&quot;follow_me_on_github&quot;).setOnPreferenceClickListener(new android.support.v7.preference.Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(android.support.v7.preference.Preference preference) {
                return false;
            }
        });

        findPreference(&quot;follow_me_on_zhihu&quot;).setOnPreferenceClickListener(new android.support.v7.preference.Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(android.support.v7.preference.Preference preference) {
                return false;
            }
        });

        findPreference(&quot;feedback&quot;).setOnPreferenceClickListener(new android.support.v7.preference.Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(android.support.v7.preference.Preference preference) {
                return false;
            }
        });

        findPreference(&quot;coffee&quot;).setOnPreferenceClickListener(new android.support.v7.preference.Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(android.support.v7.preference.Preference preference) {
                return false;
            }
        });

        findPreference(&quot;author&quot;).setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(Preference preference) {
                return false;
            }
        });

    }

    @Override
    public void onResume() {
        super.onResume();
        presenter.start();
    }

    @Override
    public void setPresenter(AboutContract.Presenter presenter) {
        if (presenter != null){
            this.presenter = presenter;
        }
    }

    @Override
    public void initViews(View view) {

    }

    @Override
    public void showRateError() {

    }

    @Override
    public void showFeedbackError() {

    }

    @Override
    public void showBrowserNotFoundError() {

    }

}
</code></pre>
<p>ä¸çŸ¥é“ä½ ä¸»è¦åˆ°æ²¡æœ‰ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä»£ç å’Œæˆ‘ä»¬å¸¸è§çš„æœ‰æ‰€ä¸åŒã€‚ä¾‹å¦‚ï¼Œ<code>onCreatePreferences</code>æ–¹æ³•ï¼Œ<code>addPreferencesFromResource</code>æ–¹æ³•ç­‰ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/about/AboutPresenter.java" target="_blank" rel="external">AboutPresenter.java</a></p>
<pre><code class="java">public class AboutPresenter implements AboutContract.Presenter {

    public AboutPresenter(AppCompatActivity activity, AboutContract.View view) {

    }

    @Override
    public void start() {

    }


    @Override
    public void rate() {
        try {
            Uri uri = Uri.parse(&quot;market://details?id=&quot; + activity.getPackageName());
            Intent intent = new Intent(Intent.ACTION_VIEW,uri);
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            activity.startActivity(intent);
        } catch (android.content.ActivityNotFoundException ex){
            view.showRateError();
        }

    }

    @Override
    public void openLicense() {
        activity.startActivity(new Intent(activity,OpenSourceLicenseActivity.class));
    }

   @Override
    public void followOnGithub() {
        if (sp.getBoolean(&quot;in_app_browser&quot;,true)){
            CustomTabActivityHelper.openCustomTab(
                    activity,
                    customTabsIntent.build(),
                    Uri.parse(activity.getString(R.string.github_url)),
                    new CustomFallback() {
                        @Override
                        public void openUri(Activity activity, Uri uri) {
                            super.openUri(activity, uri);
                        }
                    });
        } else {
            try{
                activity.startActivity(new Intent(Intent.ACTION_VIEW).setData(Uri.parse( activity.getString(R.string.github_url))));
            } catch (android.content.ActivityNotFoundException ex){
                view.showBrowserNotFoundError();
            }
        }
    }

    @Override
    public void followOnZhihu() {

    }

    @Override
    public void feedback() {
        try{
            Uri uri = Uri.parse(activity.getString(R.string.sendto));
            Intent intent = new Intent(Intent.ACTION_SENDTO,uri);
            intent.putExtra(Intent.EXTRA_SUBJECT, activity.getString(R.string.mail_topic));
            intent.putExtra(Intent.EXTRA_TEXT,
                    activity.getString(R.string.device_model) + Build.MODEL + &quot;\n&quot;
                            + activity.getString(R.string.sdk_version) + Build.VERSION.RELEASE + &quot;\n&quot;
                            + activity.getString(R.string.version));
            activity.startActivity(intent);
        }catch (android.content.ActivityNotFoundException ex){
            view.showFeedbackError();
        }
    }

    @Override
    public void donate() {

    }

    @Override
    public void showEasterEgg() {

    }

}
</code></pre>
<p>å…·ä½“çš„å®ç°é€»è¾‘æˆ‘æ²¡æœ‰ç»™å‡ºï¼Œä½ å¯ä»¥åœ¨æºä»£ç ä¸­æ‰¾åˆ°ã€‚éœ€è¦æ³¨æ„çš„ä¸€äº›å°ç»†èŠ‚ï¼Œä¾‹å¦‚ï¼Œåœ¨åé¦ˆæ“ä½œä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡è°ƒç”¨é‚®ä»¶Appå®ç°çš„ã€‚å¦‚ä¸‹:</p>
<pre><code class="java">@Override
public void feedback() {
    try{
        Uri uri = Uri.parse(activity.getString(R.string.sendto));
        Intent intent = new Intent(Intent.ACTION_SENDTO,uri);
        intent.putExtra(Intent.EXTRA_SUBJECT, activity.getString(R.string.mail_topic));
        intent.putExtra(Intent.EXTRA_TEXT,
                activity.getString(R.string.device_model) + Build.MODEL + &quot;\n&quot;
                        + activity.getString(R.string.sdk_version) + Build.VERSION.RELEASE + &quot;\n&quot;
                        + activity.getString(R.string.version));
        activity.startActivity(intent);
    }catch (android.content.ActivityNotFoundException ex){
        view.showFeedbackError();
    }
}
</code></pre>
<p>ä¸ºæ¯›è¦åštryâ€¦catchçš„æ“ä½œå‘¢ï¼Ÿéš¾é“ç”¨æˆ·çš„è®¾å¤‡ä¸Šä¼šè¿é‚®ä»¶Appéƒ½æ²¡æœ‰å®‰è£…å—ï¼Ÿå½“ç„¶ä¼šã€‚æœ‰çš„è®¾å¤‡ä¸Šç”šè‡³è¿æµè§ˆå™¨éƒ½æ²¡æœ‰å®‰è£…ï¼Œæ‰€ä»¥ï¼Œtryâ€¦catchè¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p>
<p>éœ€è¦æèµ·çš„æ˜¯ï¼Œè®¾ç½®é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç”¨æˆ·çš„åå¥½è¿›è¡Œå­˜å‚¨ï¼Œç„¶ååœ¨éœ€è¦çš„åœ°æ–¹è·å–è¿™ä¸ªå€¼å°±å¥½äº†ï¼Œè€ŒPreferenceScreenæœ¬èº«å°±å…·æœ‰è¿™æ ·çš„åŠŸèƒ½ï¼Œä¸å†éœ€è¦é¢å¤–çš„SharedPreferenceå»å­˜å‚¨ã€‚åœ¨æˆ‘çš„ä»£ç ä½ å¯èƒ½ä¼šçœ‹åˆ°è¿™æ ·çš„æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºæˆ‘å¹¶ä¸æ˜¯åœ¨é¡¹ç›®çš„æœ€åˆå°±å¼•è¿›äº†<code>PreferenceScreen</code>ï¼Œå½“æ—¶å°±æ˜¯ç›´æ¥ç”¨ä¸åŒçš„æ§ä»¶æ­é…æˆçš„è®¾ç½®ç•Œé¢ï¼Œç”¨<code>SharedPreference</code>å­˜å‚¨ä¿¡æ¯ï¼Œåæ¥å¼•å…¥äº†æ”¯æŒåº“ä¹‹åï¼Œä¸ºäº†ä¸ç ´åç”¨æˆ·çš„ä½“éªŒ(ä¾‹å¦‚ï¼ŒæŸæ¬¡ç‰ˆæœ¬å‡çº§ç›´æ¥å¯¼è‡´ä¹‹å‰çš„è®¾ç½®åå¥½å…¨éƒ¨å¤±æ•ˆ)ï¼ŒåšæŒä½¿ç”¨äº†è¿™æ ·ä¸€ä¸ªâ€˜å¤šæ­¤ä¸€ä¸¾â€™çš„æ–¹æ³•ã€‚</p>
<p>è‡³æ­¤ï¼Œä»Šå¤©çš„å·¥ä½œå°±å®Œæˆçš„å·®ä¸å¤šäº†ï¼Œå¥½å¥½ä¼‘æ¯ä¸€ä¸‹ï¼Œå·¥ä½œæœ€å¤šçš„ä¸¤å¤©å·²ç»è¿‡å»äº†ã€‚å†¬å¤©è¿‡å»äº†ï¼Œæ˜¥å¤©è¿˜ä¼šè¿œå—ï¼Ÿåœ¨æ­£å¼ç»“æŸä»Šå¤©çš„å·¥ä½œä¹‹å‰ï¼Œè¯·å…ˆçœ‹ä¸€ä¸‹ <strong>DAY 7</strong> ä¸­ <strong>åœ¨Google Playä¸Šçº¿</strong> ç¬¬ä¸€å°èŠ‚çš„å†…å®¹ï¼Œæˆ‘ä»¬æœ‰ä¸€é¡¹ä»»åŠ¡éœ€è¦å®Œæˆâ€“æ³¨å†ŒGoogle Playå¼€å‘è€…è´¦å·ï¼Œå› ä¸ºGPå¯¹å¼€å‘è€…è´¦å·çš„å®¡æ ¸48å°æ—¶(å®é™…ä½“éªŒä¸éœ€è¦é‚£ä¹ˆä¹…ï¼Œå¤§æ¦‚24å°æ—¶å·¦å³ï¼Œçœ‹äººå“ç½—)ï¼Œæ‰€ä»¥ï¼Œå’±ä»¬å…ˆåšå¥½å‡†å¤‡å·¥ä½œå§ã€‚</p>
<h3 id="DAY-6"><a href="#DAY-6" class="headerlink" title="DAY 6"></a>DAY 6</h3><p>ç»ˆäºæ¥åˆ°äº†Day 6ï¼Œè¿˜æœ‰ä¸€å¤©å°±è¦å®Œæˆæ­¤æ¬¡æ•™ç¨‹äº†ã€‚åŠ æ²¹ï¼</p>
<h4 id="Day-6-æ–‡ç« æ”¶è—"><a href="#Day-6-æ–‡ç« æ”¶è—" class="headerlink" title="Day 6,æ–‡ç« æ”¶è—"></a>Day 6,æ–‡ç« æ”¶è—</h4><p>æˆ‘ä»¬åœ¨ä¹‹å‰è®¾è®¡æ•°æ®åº“æ—¶ï¼Œå°±åœ¨è¡¨ä¸­æ’å…¥äº†ä¸€ä¸ª<code>bookmark</code>å­—æ®µï¼Œç”¨äºæ ‡ç¤ºå½“å‰ä¸€è¡Œæ˜¯å¦è¢«æ”¶è—ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹å¦‚ä½•æ·»åŠ æ”¶è—å’Œå–æ¶ˆæ”¶è—ã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/detail/DetailPresenter.java" target="_blank" rel="external">DetailPresenter.java</a></p>
<pre><code class="java">if (queryIfIsBookmarked()) {
    // delete
    // update Zhihu set bookmark = 0 where zhihu_id = id
    ContentValues values = new ContentValues();
    values.put(&quot;bookmark&quot;, 0);
    dbHelper.getWritableDatabase().update(tmpTable, values, tmpId + &quot; = ?&quot;, new String[]{String.valueOf(id)});
    values.clear();
} else {
    // add
    // update Zhihu set bookmark = 1 where zhihu_id = id
    ContentValues values = new ContentValues();
    values.put(&quot;bookmark&quot;, 1);
    dbHelper.getWritableDatabase().update(tmpTable, values, tmpId + &quot; = ?&quot;, new String[]{String.valueOf(id)});
    values.clear();
}
</code></pre>
<p>é‚£ä¹ˆå¦‚æœåœ¨æ”¶è—é¡µé¢ä¸­å±•ç¤ºå‡ºæ¥å‘¢ï¼Ÿå¥—è·¯ï¼Œä»ç„¶æ˜¯ä¹‹å‰çš„å¥—è·¯ã€‚è¿˜æ˜¯ç†Ÿæ‚‰çš„é…æ–¹ï¼Œè¿˜æ˜¯åŸæ¥çš„å‘³é“ã€‚</p>
<p>å¸ƒå±€æ–‡ä»¶ä¹Ÿå°±æ˜¯ç®€å•çš„ä¸€ä¸ªåˆ—è¡¨ï¼Œä»£ç å’Œä¹‹å‰é¦–é¡µçš„ä»£ç ç›¸åŒï¼Œä¸å†å†™å‡ºã€‚</p>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bookmarks/BookmarksContract.java" target="_blank" rel="external">BookmarksContract.java</a></p>
<pre><code class="java">public interface BookmarksContract {

    interface View extends BaseView&lt;Presenter&gt; {

        // æ˜¾ç¤ºç»“æœ
        void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; zhihuList,
                         ArrayList&lt;GuokrHandpickNews.result&gt; guokrList,
                         ArrayList&lt;DoubanMomentNews.posts&gt; doubanList,
                         ArrayList&lt;Integer&gt; types);

        // æç¤ºæ•°æ®å˜åŒ–
        void notifyDataChanged();

        // æ˜¾ç¤ºæ­£åœ¨åŠ è½½
        void showLoading();

        // åœæ­¢åŠ è½½
        void stopLoading();

    }

    interface Presenter extends BasePresenter {

        // è¯·æ±‚ç»“æœ
        void loadResults(boolean refresh);

        // è·³è½¬åˆ°è¯¦æƒ…é¡µé¢
        void startReading(BeanType type, int position);

        // è¯·æ±‚æ–°æ•°æ®
        void checkForFreshData();

        // éšä¾¿çœ‹çœ‹
        void feelLucky();

    }

}
</code></pre>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bookmarks/BookmarksFragment.java" target="_blank" rel="external">BookmarksFragment.java</a></p>
<pre><code class="java">public class BookmarksFragment extends Fragment
        implements BookmarksContract.View {

    private RecyclerView recyclerView;
    private SwipeRefreshLayout refreshLayout;
    private BookmarksAdapter adapter;
    private BookmarksContract.Presenter presenter;

    public BookmarksFragment() {}

    public static BookmarksFragment newInstance() {
        return new BookmarksFragment();
    }

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_list, container, false);

        initViews(view);

        setHasOptionsMenu(true);

        presenter.loadResults(false);

        refreshLayout.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {
            @Override
            public void onRefresh() {
                presenter.loadResults(true);
            }
        });

        return view;
    }

    @Override
    public void setPresenter(BookmarksContract.Presenter presenter) {
        if (presenter != null) {
            this.presenter = presenter;
        }
    }

    @Override
    public void initViews(View view) {

        recyclerView = (RecyclerView) view.findViewById(R.id.recyclerView);
        recyclerView.setLayoutManager(new LinearLayoutManager(getActivity()));

        refreshLayout = (SwipeRefreshLayout) view.findViewById(R.id.refreshLayout);
        refreshLayout.setColorSchemeResources(R.color.colorPrimary);

    }

    @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        inflater.inflate(R.menu.menu_bookmarks, menu);
        super.onCreateOptionsMenu(menu, inflater);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        int id = item.getItemId();
        if (id == R.id.action_search) {
            startActivity(new Intent(getActivity(), SearchActivity.class));
        } else if (id == R.id.action_feel_lucky) {
            presenter.feelLucky();
        }
        return true;
    }

    @Override
    public void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; zhihuList,
                            ArrayList&lt;GuokrHandpickNews.result&gt; guokrList,
                            ArrayList&lt;DoubanMomentNews.posts&gt; doubanList,
                            ArrayList&lt;Integer&gt; types) {

        if (adapter == null) {

            adapter = new BookmarksAdapter(getActivity(), zhihuList, guokrList, doubanList, types);
            adapter.setItemListener(new OnRecyclerViewOnClickListener() {
                @Override
                public void OnItemClick(View v, int position) {
                    int type = recyclerView.findViewHolderForLayoutPosition(position).getItemViewType();
                    if (type == BookmarksAdapter.TYPE_ZHIHU_NORMAL) {
                        presenter.startReading(BeanType.TYPE_ZHIHU, position);
                    } else if (type == BookmarksAdapter.TYPE_GUOKR_NORMAL) {
                        presenter.startReading(BeanType.TYPE_GUOKR, position);
                    } else if (type == BookmarksAdapter.TYPE_DOUBAN_NORMAL) {
                        presenter.startReading(BeanType.TYPE_DOUBAN, position);
                    }
                }
            });
            recyclerView.setAdapter(adapter);
        } else {
            adapter.notifyDataSetChanged();
        }

    }

    @Override
    public void notifyDataChanged() {
        presenter.loadResults(true);
        adapter.notifyDataSetChanged();
    }

    @Override
    public void showLoading() {
        refreshLayout.setRefreshing(true);
    }

    @Override
    public void stopLoading() {
        refreshLayout.setRefreshing(false);
    }

}
</code></pre>
<p><a href="https://github.com/TonnyL/PaperPlane/blob/master/app/src/main/java/com/marktony/zhihudaily/bookmarks/BookmarksPresenter.java" target="_blank" rel="external">BookmarksPresenter.java</a></p>
<pre><code class="java">public class BookmarksPresenter implements BookmarksContract.Presenter {

    private BookmarksContract.View view;
    private Context context;
    private Gson gson;

    private ArrayList&lt;DoubanMomentNews.posts&gt; doubanList;
    private ArrayList&lt;GuokrHandpickNews.result&gt; guokrList;
    private ArrayList&lt;ZhihuDailyNews.Question&gt; zhihuList;

    private ArrayList&lt;Integer&gt; types;

    private DatabaseHelper dbHelper;
    private SQLiteDatabase db;

    public BookmarksPresenter(Context context, BookmarksContract.View view) {
        this.context = context;
        this.view = view;
        this.view.setPresenter(this);
        gson = new Gson();
        dbHelper = new DatabaseHelper(context, &quot;History.db&quot;, null, 5);
        db = dbHelper.getWritableDatabase();

        zhihuList = new ArrayList&lt;&gt;();
        guokrList = new ArrayList&lt;&gt;();
        doubanList = new ArrayList&lt;&gt;();

        types = new ArrayList&lt;&gt;();

    }

    @Override
    public void start() {

    }

    @Override
    public void loadResults(boolean refresh) {

        if (!refresh) {
            view.showLoading();
        } else {
            zhihuList.clear();
            guokrList.clear();
            doubanList.clear();
            types.clear();
        }

        checkForFreshData();

        view.showResults(zhihuList, guokrList, doubanList, types);

        view.stopLoading();

    }

    @Override
    public void startReading(BeanType type, int position) {
        Intent intent = new Intent(context, DetailActivity.class);
        switch (type) {
            case TYPE_ZHIHU:
                ZhihuDailyNews.Question q = zhihuList.get(position - 1);
                intent.putExtra(&quot;type&quot;, BeanType.TYPE_ZHIHU);
                intent.putExtra(&quot;id&quot;,q.getId());
                intent.putExtra(&quot;title&quot;, q.getTitle());
                intent.putExtra(&quot;coverUrl&quot;, q.getImages().get(0));
                break;

            case TYPE_GUOKR:
                GuokrHandpickNews.result r = guokrList.get(position - zhihuList.size() - 2);
                intent.putExtra(&quot;type&quot;, BeanType.TYPE_GUOKR);
                intent.putExtra(&quot;id&quot;, r.getId());
                intent.putExtra(&quot;title&quot;, r.getTitle());
                intent.putExtra(&quot;coverUrl&quot;, r.getHeadline_img());
                break;
            case TYPE_DOUBAN:
                DoubanMomentNews.posts p = doubanList.get(position - zhihuList.size() - guokrList.size() - 3);
                intent.putExtra(&quot;type&quot;, BeanType.TYPE_DOUBAN);
                intent.putExtra(&quot;id&quot;, p.getId());
                intent.putExtra(&quot;title&quot;, p.getTitle());
                if (p.getThumbs().size() == 0){
                    intent.putExtra(&quot;coverUrl&quot;, &quot;&quot;);
                } else {
                    intent.putExtra(&quot;image&quot;, p.getThumbs().get(0).getMedium().getUrl());
                }
                break;
            default:
                break;
        }
        context.startActivity(intent);
    }

    @Override
    public void checkForFreshData() {

        // every first one of the 3 lists is with header
        // add them in advance

        types.add(TYPE_ZHIHU_WITH_HEADER);
        Cursor cursor = db.rawQuery(&quot;select * from Zhihu where bookmark = ?&quot;, new String[]{&quot;1&quot;});
        if (cursor.moveToFirst()) {
            do {
                ZhihuDailyNews.Question question = gson.fromJson(cursor.getString(cursor.getColumnIndex(&quot;zhihu_news&quot;)), ZhihuDailyNews.Question.class);
                zhihuList.add(question);
                types.add(TYPE_ZHIHU_NORMAL);
            } while (cursor.moveToNext());
        }

        types.add(TYPE_GUOKR_WITH_HEADER);
        cursor = db.rawQuery(&quot;select * from Guokr where bookmark = ?&quot;, new String[]{&quot;1&quot;});
        if (cursor.moveToFirst()) {
            do {
                GuokrHandpickNews.result result = gson.fromJson(cursor.getString(cursor.getColumnIndex(&quot;guokr_news&quot;)), GuokrHandpickNews.result.class);
                guokrList.add(result);
                types.add(TYPE_GUOKR_NORMAL);
            } while (cursor.moveToNext());
        }

        types.add(TYPE_DOUBAN_WITH_HEADER);
        cursor = db.rawQuery(&quot;select * from Douban where bookmark = ?&quot;, new String[]{&quot;1&quot;});
        if (cursor.moveToFirst()) {
            do {
                DoubanMomentNews.posts post = gson.fromJson(cursor.getString(cursor.getColumnIndex(&quot;douban_news&quot;)), DoubanMomentNews.posts.class);
                doubanList.add(post);
                types.add(TYPE_DOUBAN_NORMAL);
            } while (cursor.moveToNext());
        }

        cursor.close();

    }

    @Override
    public void feelLucky() {
        Random random = new Random();
        int p = random.nextInt(types.size());
        while (true) {
            if (types.get(p) == BookmarksAdapter.TYPE_ZHIHU_NORMAL) {
                startReading(BeanType.TYPE_ZHIHU, p);
                break;
            } else if (types.get(p) == BookmarksAdapter.TYPE_GUOKR_NORMAL) {
                startReading(BeanType.TYPE_GUOKR, p);
                break;
            } else if (types.get(p) == BookmarksAdapter.TYPE_DOUBAN_NORMAL) {
                startReading(BeanType.TYPE_DOUBAN, p);
                break;
            } else {
                p = random.nextInt(types.size());
            }
        }
    }

}
</code></pre>
<p>ğŸ¤”ï¼Œç”¨æˆ·å¯ä»¥ä»æ”¶è—åˆ—è¡¨é¡µé¢æŸ¥çœ‹å†…å®¹è¯¦æƒ…ï¼Œå¯èƒ½åœ¨è¿™é‡Œï¼Œç”¨æˆ·å–æ¶ˆäº†æ”¶è—ï¼Œè€Œæˆ‘ä»¬å°±éœ€è¦åŠæ—¶åœ°åˆ·æ–°ç•Œé¢æ•°æ®ï¼Œå¦åˆ™å°±ä¼šå½±å“ç”¨æˆ·çš„ä½“éªŒã€‚</p>
<h4 id="Day-6-å¤œé—´æ¨¡å¼"><a href="#Day-6-å¤œé—´æ¨¡å¼" class="headerlink" title="Day 6,å¤œé—´æ¨¡å¼"></a>Day 6,å¤œé—´æ¨¡å¼</h4><p>å…³äºå¤œé—´æ¨¡å¼çš„å®ç°ï¼Œè¯·æŸ¥çœ‹æ–‡ç« <a href="https://TonnyL.github.io/2016/12/31/%E7%AE%80%E6%B4%81%E4%BC%98%E9%9B%85%E5%9C%B0%E5%AE%9E%E7%8E%B0%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F/">ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼</a>æˆ–è€…<a href="http://www.jianshu.com/p/dcfcfcbda7ac" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h4 id="Day-6-ç‰ˆæœ¬é€‚é…"><a href="#Day-6-ç‰ˆæœ¬é€‚é…" class="headerlink" title="Day 6,ç‰ˆæœ¬é€‚é…"></a>Day 6,ç‰ˆæœ¬é€‚é…</h4><p>äº‹å®ä¸Šï¼Œç‰ˆæœ¬é€‚é…çš„èŒƒå›´éå¸¸çš„å¹¿æ³›ã€‚ä¾‹å¦‚ï¼Œå¤šè¯­è¨€é€‚é…ï¼Œé«˜ä½Androidç‰ˆæœ¬çš„é€‚é…ï¼Œè¿˜æœ‰å¯¹å¤šå±å¹•çš„é€‚é…ï¼Œç‰¹æ®Šç”¨æˆ·çš„é€‚é…ç­‰ç­‰ã€‚</p>
<ol>
<li><p>å¤šè¯­è¨€é€‚é…</p>
<p> åœ¨<code>res</code>ç›®å½•ä¸‹æ–°å»ºä¸åŒçš„<code>values</code>ç›®å½•ï¼Œä¾‹å¦‚ï¼Œéœ€è¦é€‚é…è‹±è¯­å°±æ–°å»º<code>values-en</code>ç›®å½•ï¼Œç®€ä½“ä¸­æ–‡<code>values-zh-rCN</code>ï¼Œç¹ä½“ä¸­æ–‡(å°æ¹¾)<code>values-zh-rTW</code>ï¼Œç¹ä½“ä¸­æ–‡(é¦™æ¸¯)<code>values-zh-rHK</code>ï¼Œç­‰ç­‰ã€‚(è¿™äº›ä»£ç ä¸åŒºåˆ†å¤§å°å†™ï¼›r å‰ç¼€ç”¨äºåŒºåˆ†åŒºåŸŸç ã€‚ ä¸èƒ½å•ç‹¬æŒ‡å®šåŒºåŸŸã€‚)</p>
<pre><code> .
 â”œâ”€â”€ app
 â”œâ”€â”€â”œâ”€â”€ res
 â”œâ”€â”€  â”€â”€ â”œâ”€â”€ values
 â”œâ”€â”€  â”€â”€  â”€â”€ â”œâ”€â”€ strings.xml
 â”œâ”€â”€  â”€â”€ â”œâ”€â”€ values-en
 â”œâ”€â”€  â”€â”€  â”€â”€ â”œâ”€â”€ strings.xml
 â”œâ”€â”€  â”€â”€ â”œâ”€â”€ values-zh-rCN
 â”œâ”€â”€  â”€â”€  â”€â”€ â”œâ”€â”€ strings.xml
 â”œâ”€â”€  â”€â”€ â”œâ”€â”€ values-zh-rHK
 â”œâ”€â”€  â”€â”€  â”€â”€ â”œâ”€â”€ strings.xml
</code></pre><p> <img src="http://upload-images.jianshu.io/upload_images/2440049-ce4abc2ef966df77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Multi-language"></p>
<p> æ›´å¤šå†…å®¹è¯·ç‚¹å‡»<a href="https://developer.android.com/training/basics/supporting-devices/languages.html" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
<li><p>é«˜ä½Androidç‰ˆæœ¬é€‚é…</p>
<p> å…³äºAndroidç¢ç‰‡åŒ–çš„è®¨è®ºå·²ç»éå¸¸å¤šäº†ï¼Œè¿™é‡Œæˆ‘å°±ä¸å†é­å°¸äº†ã€‚åªç®€å•çš„ä¸¾ä¸¤ä¸ªä¾‹å­ã€‚åœ¨Android 4.1 Jelly Beanç³»ç»Ÿçš„åä¸ºæ‰‹æœºä¸Šï¼Œç³»ç»Ÿçš„DatePickerçš„æ ·å¼æ˜¯è¿™æ ·çš„ã€‚</p>
<p> <img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fcity9flprj30dc0nqmxv.jpg" alt="JellyBean"></p>
<p> å¾ˆæ˜æ˜¾ï¼Œè¿™å’Œæˆ‘ä»¬Material Designçš„è®¾è®¡è¯­è¨€å¾ˆè¿å’Œï¼Œä½¿ç”¨å¼€æºåº“<code>materialdatetimepicker</code>å°±å¯ä»¥åœ¨è¿™æ ·çš„ä½ç‰ˆæœ¬çš„è®¾å¤‡ä¸Šå®ç°MDç‰ˆæœ¬çš„Date Picker Dialogã€‚å®ç°UIçš„ç»Ÿä¸€å¯¹æå‡ç”¨æˆ·ä½“éªŒè¿˜æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚</p>
<p> å¯¹äºé«˜ç‰ˆæœ¬ï¼Œä¾‹å¦‚Android 7.x Nougatï¼Œæœ‰å¾ˆå¤šçš„æ–°ç‰¹æ€§ï¼Œä¾‹å¦‚æ–°çš„é€šçŸ¥æ ï¼ŒShortcutsç­‰ç­‰ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç« <a href="http://www.jianshu.com/p/f56f2e709ad8" target="_blank" rel="external">è€å¸æœºå¸¦ä½ åƒç‰›è½§ç³–â€“é€‚é…Android 7.1 Nougatæ–°ç‰¹æ€§</a>ï¼Œè™½ç„¶ç”¨ä¸Šæœ€æ–°ç³»ç»Ÿçš„ç”¨æˆ·é‡å¯èƒ½ä¸å¤§ï¼Œä½†æ˜¯å½“è¿™äº›ç”¨æˆ·çœ‹åˆ°æˆ‘ä»¬çš„åº”ç”¨é€‚é…äº†è¿™äº›æ–°ç‰¹æ€§æ—¶ï¼Œåº”è¯¥ä¹Ÿä¼šæ„Ÿè§‰åˆ°çœ¼å‰ä¸€äº®å§ï¼Œèµ·åˆ°äº†é”¦ä¸Šæ·»èŠ±çš„ä½œç”¨ã€‚</p>
</li>
<li><p>æ”¯æŒå¤šç§å±å¹•</p>
<p> å’Œå¤šè¯­è¨€é€‚é…ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æä¾›ä¸åŒèµ„æºæ–‡ä»¶çš„æ–¹å¼å®ç°é€‚é…ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹åº”ç”¨èµ„æºç›®å½• ä¸ºä¸åŒå±å¹•å°ºå¯¸å’Œä¸åŒå¯ç»˜åˆ¶å¯¹è±¡æä¾›ä¸åŒçš„å¸ƒå±€è®¾è®¡ã€‚ä½¿ç”¨ mipmap/ æ–‡ä»¶å¤¹æ”¾ç½® å¯åŠ¨å™¨å›¾æ ‡ã€‚</p>
<pre><code> res/layout/my_layout.xml              // layout for normal screen size (&quot;default&quot;)
 res/layout-large/my_layout.xml        // layout for large screen size
 res/layout-xlarge/my_layout.xml       // layout for extra-large screen size
 res/layout-xlarge-land/my_layout.xml  // layout for extra-large in landscape orientation

 res/drawable-mdpi/graphic.png         // bitmap for medium-density
 res/drawable-hdpi/graphic.png         // bitmap for high-density
 res/drawable-xhdpi/graphic.png        // bitmap for extra-high-density
 res/drawable-xxhdpi/graphic.png       // bitmap for extra-extra-high-density

 res/mipmap-mdpi/my_icon.png         // launcher icon for medium-density
 res/mipmap-hdpi/my_icon.png         // launcher icon for high-density
 res/mipmap-xhdpi/my_icon.png        // launcher icon for extra-high-density
 res/mipmap-xxhdpi/my_icon.png       // launcher icon for extra-extra-high-density
 res/mipmap-xxxhdpi/my_icon.png      // launcher icon for extra-extra-extra-high-density
</code></pre><p> æ›´å¤šå†…å®¹è¯·ç‚¹å‡»<a href="https://developer.android.com/guide/practices/screens_support.html" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
<li><p>å…¶ä»–é€‚é…</p>
<p>ä¾‹å¦‚ï¼Œ<a href="http://www.jianshu.com/p/f952d9c71d91" target="_blank" rel="external">æå‡ä½“éªŒ-æ”¯æŒChrome Custom Tabs</a>ã€‚</p>
</li>
</ol>
<p>å“ˆï¼Œåšå®Œä»Šå¤©çš„å·¥ä½œï¼Œç¼–ç çš„å·¥ä½œå°±å®Œæˆçš„å·®ä¸å¤šäº†ã€‚å¥½å¥½çš„ç¡ä¸€è§‰ï¼Œå‡†å¤‡æ˜å¤©çš„å·¥ä½œã€‚</p>
<h3 id="DAY-7"><a href="#DAY-7" class="headerlink" title="DAY 7"></a>DAY 7</h3><h4 id="Day-7-åœ¨Google-Playä¸Šçº¿"><a href="#Day-7-åœ¨Google-Playä¸Šçº¿" class="headerlink" title="Day 7,åœ¨Google Playä¸Šçº¿"></a>Day 7,åœ¨Google Playä¸Šçº¿</h4><ol>
<li><p>æ³¨å†ŒGoogle Playå¼€å‘è€…è´¦å·</p>
<p> å·¥å…·å‡†å¤‡ï¼š</p>
<ul>
<li>ç§‘å­¦ä¸Šç½‘ï¼Œä½ æ‡‚çš„</li>
<li>Chromeæµè§ˆå™¨æˆ–Firefoxæµè§ˆå™¨</li>
<li>$25ï¼Œ25åˆ€çš„æ³¨å†Œè´¹ç”¨</li>
<li><p>æ”¯æŒå›½é™…æ”¯ä»˜åŠŸèƒ½(VISA, Masterç­‰)çš„ä¿¡ç”¨å¡ï¼Œä¾¿äºæ”¯ä»˜25åˆ€çš„æ³¨å†Œè´¹</p>
<p>å¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹æ­£å¼çš„æäº‹æƒ…ã€‚</p>
</li>
</ul>
<ol>
<li><p>æ³¨å†ŒGoogleè´¦å·</p>
<p> å¦‚æœä½ å·²ç»æœ‰äº†Googleè´¦å·ï¼Œå°±ç›´æ¥è·³è¿‡è¿™ä¸€å°æ­¥å§ã€‚</p>
<p> æˆ‘ä»¬å…ˆå» <a href="https://accounts.google.com/SignUp" target="_blank" rel="external">https://accounts.google.com/SignUp</a> æ³¨å†Œè´¦å·ã€‚æŒ‰ç…§è‡ªèº«çš„ä¿¡æ¯å¡«å†™å³å¯ã€‚<br> <img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fcixwzqtxcj31hv23eqi8.jpg" alt="åˆ›å»ºæ‚¨çš„ Google å¸å·"></p>
</li>
<li><p>ç™»å½•å¼€å‘è€…åå°</p>
<p> ç™»å½• <a href="https://play.google.com/apps/publish/signup/" target="_blank" rel="external">https://play.google.com/apps/publish/signup/</a> ã€‚<br> <img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fciycauuj7j31kw106drh.jpg" alt="Google Play Console"></p>
<p> å‹¾é€‰åŒæ„å¹¶ç‚¹å‡»ç»§ç»­ä»˜æ¬¾ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¦å…ˆè¿›åˆ°ä»˜æ¬¾é¡µé¢ï¼Œç„¶åå†ç»‘å®šGoogle Walletã€‚å¦åˆ™çš„è¯ï¼Œå°±ä¸èƒ½ä¿è¯ä»˜æ¬¾æˆåŠŸäº†ã€‚</p>
</li>
<li><p>ä»˜æ¬¾</p>
<p> ç‚¹å‡»æ·»åŠ æ–°çš„ä»˜æ¬¾æ–¹å¼ï¼Œä¸€è·¯æŒ‰æç¤ºè¾“å…¥å³å¯(ç”±äºæˆ‘ä¹‹å‰å·²ç»æ³¨å†Œè¿‡äº†ï¼Œè¿™é‡Œç›—ç”¨ä¸€ä¸‹è¢«äººçš„å›¾ï¼ŒåŸä½œè€…è¯·ä¸è¦æ‰“æˆ‘ğŸ˜‚)ã€‚<br> <img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fciyt3vjxuj310i0nhgnd.jpg" alt="Payment"><br> <img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fciytuwh7wj310i0nhwg8.jpg" alt="Payment"></p>
<p> å¦‚æœç»‘å®šæˆåŠŸï¼ŒGoogleå¯èƒ½ä¼šå…ˆä»ä¿¡ç”¨å¡ä¸­æ‰£é™¤$1è¿›è¡Œæˆæƒã€‚</p>
</li>
<li><p>å®¡æ ¸</p>
<p> Googleæœ€å¤šéœ€è¦48å°æ—¶è¿›è¡Œå®¡æ ¸ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<a href="https://wallet.google.com/" target="_blank" rel="external">Google Wallet</a>æŸ¥çœ‹è¯¥è®¢å•çš„æ”¯ä»˜çŠ¶æ€ã€‚å¦‚æœæ˜¾ç¤º<code>å·²å®Œæˆ</code>ï¼Œå°±è¯´æ˜GPè´¦å·ç”³è¯·æˆåŠŸäº†ã€‚</p>
</li>
<li><p>æ²¡æœ‰ä¿¡ç”¨å¡æ€ä¹ˆåŠï¼Ÿ</p>
<p> ç›¸ä¿¡æœ‰å¾ˆå¤šåƒæˆ‘ä¸€æ ·çš„å­¦ç”Ÿå…šï¼Œæ²¡æœ‰ä¿¡ç”¨å¡æˆ–è€…ä¿¡ç”¨å¡ä¸æ”¯æŒå›½é™…æ”¯ä»˜åŠŸèƒ½ï¼Œè¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œå°±æ˜¯ä¸‡èƒ½çš„æŸå®å‘æŒ¥ä½œç”¨çš„æ—¶å€™äº†ã€‚æœ‰ä¸€ç§ä¿¡ç”¨å¡å«åš<code>è™šæ‹Ÿä¿¡ç”¨å¡</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘è™šæ‹Ÿä¿¡ç”¨å¡å……å€¼ï¼Œç„¶åç”¨è¿™æ ·çš„å¡å»æ”¯ä»˜é‚£25åˆ€ã€‚å…·ä½“çš„åœ°å€ç­‰å’¨è¯¢åº—å°äºŒå³å¯ã€‚å¦‚æœä½ è§‰å¾—è¿™æ ·çš„æ–¹æ³•å¤ªç¹çï¼Œæˆ–è€…æˆ‘æœ‰é’±ä»»æ€§ï¼Œé‚£ä¹ˆç›´æ¥åœ¨é©¬çˆ¸çˆ¸çš„ç½‘ç«™ä¸Šç›´æ¥ä¹°ä¸€ä¸ªå¼€å‘è€…è´¦å·å§ï¼Œä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè´¹ç”¨è‚¯å®šæ˜¯é«˜äº25ç¾åˆ€çš„ï¼Œè€Œä¸”å®‰å…¨æ€§ä¹Ÿå€¼å¾—æ£€éªŒ(å¦‚æœä½ æ‰“ç®—ä¹°è´¦å·ï¼Œé‚£ä¹ˆåŠ¡å¿…åœ¨æ‹¿åˆ°è´¦å·ä¹‹åç¬¬ä¸€æ—¶é—´ä¿®æ”¹å¯†ç å’Œè®¤è¯ä¿¡æ¯ç­‰ç­‰)ã€‚</p>
<p>é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬ç”³è¯·åˆ°çš„è´¦å·è¿˜åªèƒ½å‘å¸ƒå…è´¹çš„åº”ç”¨ã€‚å¦‚æœå¯¹åº”ç”¨è¿›è¡Œæ”¶è´¹ï¼Œä½ å¯ä»¥æŸ¥çœ‹æ§åˆ¶å°ä¸­<code>è´¢åŠ¡æŠ¥è¡¨</code>ï¼Œè·å–æ›´å¤šå•†å®¶è´¦æˆ·çš„ä¿¡æ¯ã€‚</p>
<p>æ›´å¤šä¿¡æ¯ï¼Œè¯·ç‚¹å‡»<a href="https://support.google.com/googleplay/android-developer/answer/6112435?hl=zh-Hans" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</li>
</ol>
</li>
<li><p>æœ‰äº†è´¦å·ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”ŸæˆAPKæ–‡ä»¶äº†ã€‚</p>
<p> åœ¨ä¿è¯é¡¹ç›®æ­£ç¡®è¿è¡Œçš„æƒ…å†µä¸‹(è®°å¾—æ›´æ¢åº”ç”¨å›¾æ ‡)ï¼Œæˆ‘ä»¬ç‚¹å‡»èœå•é¡¹ä¸­çš„<code>Build</code> â€“&gt; <code>Generate Signed APK...</code>ï¼Œå¯¹APKè¿›è¡Œç­¾åã€‚</p>
<p> <img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fcizu57nbqj30k40iygq3.jpg" alt="Generate Signed APK..."></p>
<p> é€‰æ‹©ç”ŸæˆAPKçš„Moduleã€‚</p>
<p> <img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fcizxsepj2j30uo0mqwh6.jpg" alt="app"></p>
<p> è¿™æ—¶å€™éœ€è¦æˆ‘ä»¬é€‰æ‹©keyï¼Œç”¨äºå¯¹APKç­¾åã€‚</p>
<p> <img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fcizygdo80j30uo0mqgoz.jpg" alt="key"></p>
<p> Keyçš„ä½œç”¨æ˜¯ä¸ºäº†ä¿è¯æ¯ä¸ªåº”ç”¨ç¨‹åºå¼€å‘å•†åˆæ³•IDï¼Œé˜²æ­¢éƒ¨åˆ†å¼€æ”¾å•†å¯èƒ½é€šè¿‡ä½¿ç”¨ç›¸åŒçš„Package Nameæ¥æ··æ·†æ›¿æ¢å·²ç»å®‰è£…çš„ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦å¯¹æˆ‘ä»¬å‘å¸ƒçš„APKæ–‡ä»¶è¿›è¡Œå”¯ä¸€ç­¾åï¼Œä¿è¯æˆ‘ä»¬æ¯æ¬¡å‘å¸ƒçš„ç‰ˆæœ¬çš„ä¸€è‡´æ€§(å¦‚è‡ªåŠ¨æ›´æ–°ä¸ä¼šå› ä¸ºç‰ˆæœ¬ä¸ä¸€è‡´è€Œæ— æ³•å®‰è£…)ã€‚</p>
<p> å¦‚æœæ²¡æœ‰Keyï¼Œæˆ‘ä»¬å°±éœ€è¦åˆ›å»ºä¸€ä¸ªã€‚é€‰æ‹©<code>Create new...</code>åˆ›å»ºã€‚</p>
<p> <img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fcj095fzroj30ze0vqdl0.jpg" alt="Create new key"></p>
<p> å„ç§ä¿¡æ¯å¯¹åº”å¦‚ä¸‹ï¼š</p>
<p> åç§° | æè¿°<br> â€” | â€”<br> Key store path | keyçš„å­˜å‚¨è·¯å¾„<br> Password | keyçš„å¯†ç <br> Confirm | ç¡®è®¤å¯†ç <br> Alias | åˆ«å<br> Validity(years) | æœ‰æ•ˆæœŸé™(å¹´)<br> First and Last Name | å§“å<br> Organizational Unit | ç»„ç»‡å•ä½<br> Organization | ç»„ç»‡<br> City of Location | æ‰€åœ¨åŸå¸‚<br> State or Province | çœ<br> Country Code(XX) | å›½å®¶ä»£ç </p>
<p> å¡«å†™å®Œä¿¡æ¯åï¼Œç‚¹å‡»OKç”Ÿæˆã€‚è¿™é‡Œç”Ÿæˆçš„keyä¸€å®šè¦å¦¥å–„ä¿ç®¡ï¼Œä»¥åæˆ‘ä»¬å¯¹åº”ç”¨è¿›è¡Œç‰ˆæœ¬æ›´æ–°æ—¶ï¼Œéœ€è¦ç”¨åˆ°ã€‚</p>
<p> æ–°å»ºæˆåŠŸåï¼Œæˆ‘ä»¬é€‰æ‹©åˆšåˆšç”Ÿæˆçš„keyï¼Œè¾“å…¥å¯†ç ï¼Œç‚¹å‡»<code>Next</code> â€“&gt; <code>Finish</code>ã€‚</p>
<p> <img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fcj0nfxqiaj30uo0mqtcd.jpg" alt="Next"></p>
<p> <img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fcj0o691u1j30uo0mqadm.jpg" alt="Finish"></p>
</li>
<li><p>ä¸Šä¼ åº”ç”¨</p>
<p> ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æŠŠåº”ç”¨ä¸Šä¼ åˆ°Google Playäº†ã€‚</p>
<p> 3.1. æ·»åŠ APK</p>
<ul>
<li><p>3.1.1. è½¬åˆ° <a href="https://play.google.com/apps/publish/" target="_blank" rel="external">Google Play Developer Console</a>ã€‚</p>
</li>
<li><p>3.1.2. ä¾æ¬¡é€‰æ‹©<code>æ‰€æœ‰åº”ç”¨</code> â€“&gt; <code>+ åˆ›å»ºåº”ç”¨</code>ã€‚</p>
<p>  <img src="https://ww1.sinaimg.cn/large/006tKfTcgy1fcj10u1etcj31kw08y40b.jpg" alt="Google Play Console"></p>
</li>
<li><p>3.1.3 ä½¿ç”¨ä¸‹æ‹‰èœå•é€‰æ‹©é»˜è®¤è¯­è¨€ï¼Œå¹¶ä¸ºæ‚¨çš„åº”ç”¨æ·»åŠ æ ‡é¢˜ã€‚è¾“å…¥æ‚¨æƒ³è¦åœ¨ Google Play ä¸­æ˜¾ç¤ºçš„åº”ç”¨åç§°ã€‚</p>
<p>  <img src="https://ww2.sinaimg.cn/large/006tKfTcgy1fcj1bo68lpj31kw106aj8.jpg" alt="Create new app"></p>
</li>
<li><p>3.1.4 é€‰æ‹©ä¸Šä¼  APKã€‚</p>
<p>  <img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fcj1k3x3yuj31kw10648b.jpg" alt=""></p>
<p>3.2. è®¾ç½®å•†å“è¯¦æƒ…</p>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fcj1h9a33lj31kw106k1i.jpg" alt=""></p>
<p>æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„åº”ç”¨è®¾ç½®<code>å•†å“è¯¦æƒ…</code>ï¼Œ<code>å›¾ç‰‡èµ„æº</code>ï¼Œ<code>è¯­è¨€å’Œç¿»è¯‘</code>ï¼Œ<code>åˆ†ç±»</code>ï¼Œ<code>è¯¦ç»†è”ç³»ä¿¡æ¯</code>ï¼Œ<code>éšç§æƒæ”¿ç­–</code>ï¼Œç­‰ã€‚å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œæœ€å›°éš¾çš„åº”è¯¥å°±æ˜¯å„ç§å›¾ç‰‡äº†å§ï¼Œåœ¨æ²¡æœ‰è®¾è®¡å¸ˆçš„æƒ…å†µä¸‹ï¼Œå°±è®©æˆ‘ä»¬ç¨‹åºå‘˜å‘æŒ¥çµé­‚ç”»å¸ˆçš„åŠŸåŠ›å§ï¼Œå“ˆå“ˆğŸ˜†ã€‚</p>
<p>3.3. åç»­æ­¥éª¤</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦å®Œæˆçš„æ­¥éª¤æœ‰ï¼š</p>
</li>
<li><p>å¡«å†™åº”ç”¨çš„å†…å®¹åˆ†çº§é—®å·</p>
</li>
<li>äº†è§£å¦‚ä½•å°†åº”ç”¨å‘å¸ƒåˆ°ä¸åŒçš„å›½å®¶/åœ°åŒºä»¥åŠAndroidè®¡åˆ’</li>
<li>ä½¿ç”¨æ ‡å‡†æˆ–å®šæ—¶å‘å¸ƒåº”ç”¨</li>
<li><p>é€šè¿‡å®éªŒä¼˜åŒ–å•†å“è¯¦æƒ…</p>
<p>æ›´å¤šä¿¡æ¯ï¼Œè¯·ç‚¹å‡»<a href="https://support.google.com/googleplay/android-developer/answer/113469?hl=zh-Hans" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p>å“ˆï¼Œåˆ°è¿™é‡Œï¼Œåº”ç”¨ä¸Šä¼ å°±å®Œæˆäº†ï¼Œç°åœ¨ç­‰å¾…åº”ç”¨å‘å¸ƒå®¡æ ¸æˆåŠŸå°±å¥½äº†ã€‚</p>
</li>
</ul>
</li>
</ol>
<h4 id="Day-7-åœ¨GitHubå¼€æº"><a href="#Day-7-åœ¨GitHubå¼€æº" class="headerlink" title="Day 7,åœ¨GitHubå¼€æº"></a>Day 7,åœ¨GitHubå¼€æº</h4><ol>
<li><p>æ³¨å†ŒGitHub</p>
<p> <a href="https://github.com" target="_blank" rel="external">GitHub</a>æ˜¯ä¸€ä¸ª <del>åŒæ€§äº¤å‹ç¤¾åŒº</del> é¢å‘å¼€æºåŠç§æœ‰è½¯ä»¶é¡¹ç›®çš„æ‰˜ç®¡å¹³å°ï¼Œä½œä¸ºå¼€æºä»£ç åº“ä»¥åŠç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ŒGithubæ‹¥æœ‰è¶…è¿‡900ä¸‡å¼€å‘è€…ç”¨æˆ·ã€‚éšç€è¶Šæ¥è¶Šå¤šçš„åº”ç”¨ç¨‹åºè½¬ç§»åˆ°äº†äº‘ä¸Šï¼ŒGithubå·²ç»æˆä¸ºäº†ç®¡ç†è½¯ä»¶å¼€å‘ä»¥åŠå‘ç°å·²æœ‰ä»£ç çš„é¦–é€‰æ–¹æ³•ã€‚</p>
<p> æˆ‘ä»¬å…ˆæ³¨å†Œè´¦å·ï¼Œåœ°å€ä¸º: <a href="https://github.com" target="_blank" rel="external">https://github.com</a> ã€‚</p>
<p> <img src="https://ww4.sinaimg.cn/large/006y8lVagy1fcj2es7qjbj31kw106x6p.jpg" alt="GitHub"></p>
<p> è´¦å·æ³¨å†ŒæˆåŠŸåï¼Œè¿›å…¥ <del>GayHub</del> GitHub ä¸ªäººä¿¡æ¯é¡µï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­çš„ã€‚</p>
<p> <img src="https://ww1.sinaimg.cn/large/006y8lVagy1fcj2kj9rahj31kw106gxt.jpg" alt="MyGitHub"></p>
<p> ç¬¬ä¸€æ­¥çš„å·¥ä½œå°±å®Œæˆäº†ã€‚</p>
</li>
<li><p>å®‰è£…Git</p>
<p> <a href="https://git-scm.com/" target="_blank" rel="external">Git</a>æ˜¯ä¸€æ¬¾å…è´¹ã€å¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç”¨äºæ•æ·é«˜æ•ˆåœ°å¤„ç†ä»»ä½•æˆ–å°æˆ–å¤§çš„é¡¹ç›®ã€‚å®˜ç½‘çš„ä»‹ç»æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>Git is a free and open source distributed version control system designed to handle everything from small to very large projects with speed and efficiency.</p>
</blockquote>
<p> ä¸‹è½½Gitï¼Œåœ°å€ä¸º <a href="https://git-scm.com/downloads" target="_blank" rel="external">https://git-scm.com/downloads</a> ï¼Œä¸‹è½½å¯¹åº”ç‰ˆæœ¬å³å¯ã€‚</p>
<ul>
<li>åœ¨macOSä¸Šï¼Œåœ¨ Mac ä¸Šå®‰è£… Git æœ‰å¤šç§æ–¹å¼ã€‚<ul>
<li>æœ€ç®€å•çš„æ–¹æ³•æ˜¯å®‰è£… Xcode Command Line Toolsã€‚ Mavericks ï¼ˆ10.9ï¼‰ æˆ–æ›´é«˜ç‰ˆæœ¬çš„ç³»ç»Ÿä¸­ï¼Œåœ¨ Terminal é‡Œå°è¯•é¦–æ¬¡è¿è¡Œ git å‘½ä»¤å³å¯ã€‚ å¦‚æœæ²¡æœ‰å®‰è£…è¿‡å‘½ä»¤è¡Œå¼€å‘è€…å·¥å…·ï¼Œå°†ä¼šæç¤ºä½ å®‰è£…ã€‚</li>
<li>å¦‚æœä½ æƒ³å®‰è£…æ›´æ–°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…ç¨‹åºã€‚ å®˜æ–¹ç»´æŠ¤çš„ OSX Git å®‰è£…ç¨‹åºå¯ä»¥åœ¨ Git å®˜æ–¹ç½‘ç«™ä¸‹è½½ï¼Œç½‘å€ä¸º <a href="http://git-scm.com/download/macã€‚" target="_blank" rel="external">http://git-scm.com/download/macã€‚</a></li>
</ul>
</li>
<li><p>åœ¨Windowsä¸Šï¼Œåœ¨ Windows ä¸Šå®‰è£… Git ä¹Ÿæœ‰å‡ ç§å®‰è£…æ–¹æ³•ã€‚</p>
<ul>
<li><p>å®˜æ–¹ç‰ˆæœ¬å¯ä»¥åœ¨ Git å®˜æ–¹ç½‘ç«™ä¸‹è½½ã€‚ æ‰“å¼€ <a href="http://git-scm.com/download/winï¼Œä¸‹è½½ä¼šè‡ªåŠ¨å¼€å§‹ã€‚" target="_blank" rel="external">http://git-scm.com/download/winï¼Œä¸‹è½½ä¼šè‡ªåŠ¨å¼€å§‹ã€‚</a> è¦æ³¨æ„è¿™æ˜¯ä¸€ä¸ªåä¸º Git for Windowsçš„é¡¹ç›®ï¼ˆä¹Ÿå«åš msysGitï¼‰ï¼Œå’Œ Git æ˜¯åˆ†åˆ«ç‹¬ç«‹çš„é¡¹ç›®ï¼›æ›´å¤šä¿¡æ¯è¯·è®¿é—® <a href="http://msysgit.github.io/ã€‚" target="_blank" rel="external">http://msysgit.github.io/ã€‚</a></p>
</li>
<li><p>å¦ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯å®‰è£… GitHub for Windowsã€‚ è¯¥å®‰è£…ç¨‹åºåŒ…å«å›¾å½¢åŒ–å’Œå‘½ä»¤è¡Œç‰ˆæœ¬çš„ Gitã€‚ å®ƒä¹Ÿèƒ½æ”¯æŒ Powershellï¼Œæä¾›äº†ç¨³å®šçš„å‡­è¯ç¼“å­˜å’Œå¥å…¨çš„ CRLF è®¾ç½®ã€‚ ç¨åæˆ‘ä»¬ä¼šå¯¹è¿™æ–¹é¢æœ‰æ›´å¤šäº†è§£ï¼Œç°åœ¨åªè¦ä¸€å¥è¯å°±å¤Ÿäº†ï¼Œè¿™äº›éƒ½æ˜¯ä½ æ‰€éœ€è¦çš„ã€‚ ä½ å¯ä»¥åœ¨ GitHub for Windows ç½‘ç«™ä¸‹è½½ï¼Œç½‘å€ä¸º <a href="http://windows.github.comã€‚" target="_blank" rel="external">http://windows.github.comã€‚</a></p>
</li>
</ul>
</li>
<li><p>åœ¨Linuxä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•å®‰è£…ã€‚</p>
<p>   å¦‚æœä½ æƒ³åœ¨ Linux ä¸Šç”¨äºŒè¿›åˆ¶å®‰è£…ç¨‹åºæ¥å®‰è£… Gitï¼Œå¯ä»¥ä½¿ç”¨å‘è¡Œç‰ˆåŒ…å«çš„åŸºç¡€è½¯ä»¶åŒ…ç®¡ç†å·¥å…·æ¥å®‰è£…ã€‚</p>
<ul>
<li><p>å¦‚æœä»¥ Fedora ä¸Šä¸ºä¾‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ yum:</p>
<pre><code>  $ sudo yum install git
</code></pre><ul>
<li><p>å¦‚æœä½ åœ¨åŸºäº Debian çš„å‘è¡Œç‰ˆä¸Šï¼Œè¯·å°è¯•ç”¨ apt-getï¼š</p>
<pre><code>$ sudo apt-get install git
</code></pre></li>
</ul>
<p>è¦äº†è§£æ›´å¤šé€‰æ‹©ï¼ŒGit å®˜æ–¹ç½‘ç«™ä¸Šæœ‰åœ¨å„ç§ Unix é£æ ¼çš„ç³»ç»Ÿä¸Šå®‰è£…æ­¥éª¤ï¼Œç½‘å€ä¸º <a href="http://git-scm.com/download/linuxã€‚" target="_blank" rel="external">http://git-scm.com/download/linuxã€‚</a></p>
</li>
</ul>
<p>æ›´å¤šä¿¡æ¯ï¼Œè¯·ç‚¹å‡»<a href="https://git-scm.com/book/zh/v2/%E8%B5%B7%E6%AD%A5-%E5%AE%89%E8%A3%85-Git" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p>OKï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸‹Gitæ˜¯å¦å®‰è£…æˆåŠŸã€‚åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤<code>git --version</code>æŸ¥çœ‹git çš„ç‰ˆæœ¬ä¿¡æ¯ï¼š</p>
<p><img src="https://ww4.sinaimg.cn/large/006y8lVagy1fcj3gn7ux4j312q0qk77y.jpg" alt="Git Version"></p>
</li>
</ul>
</li>
<li><p>åœ¨Android Studioä¸­é…ç½®Gitå’ŒGitHub</p>
<ol>
<li><p>æ‰“å¼€Android Stuidoï¼Œè¿›å…¥<code>Android Studio</code> â€“&gt; <code>Preferences</code> â€“&gt; <code>Version Control</code> â€“&gt; <code>Git</code>ï¼Œ(Windowsä¸º<code>File</code> â€“&gt; <code>Settings</code> â€“&gt; <code>Version Control</code> â€“&gt; <code>Git</code>)ï¼Œåœ¨<code>Path to Git executable</code>ä¸­å®šä½åˆ°ä½ çš„Gitå®‰è£…ç›®å½•ï¼Œç„¶åç‚¹å‡»Testï¼Œå¦‚æœæˆåŠŸä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„æç¤ºä¿¡æ¯ã€‚</p>
<p> <img src="https://ww3.sinaimg.cn/large/006y8lVagy1fcj46ixzqmj31kw131ah9.jpg" alt="Init Git"></p>
<p> <img src="https://ww1.sinaimg.cn/large/006tNc79gy1fcj497m0pqj30oo0a4t9s.jpg" alt="Git test success"></p>
</li>
<li><p>ç„¶ååœ¨å·¦ä¾§è®¾ç½®é¡¹ä¸­é€‰æ‹©GitHubï¼Œç„¶åè¾“å…¥ä½ åˆšåˆšæ³¨å†Œå¥½çš„GitHubè´¦å·ä¿¡æ¯ï¼Œç‚¹å‡»testï¼Œå¦‚æœæˆåŠŸä½ å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„æç¤ºä¿¡æ¯ã€‚</p>
<p> <img src="https://ww4.sinaimg.cn/large/006tNc79gy1fcj4gvunlbj31kw13144p.jpg" alt="Init GitHub"></p>
<p> <img src="https://ww1.sinaimg.cn/large/006tNc79gy1fcj4j85oz5j30oo0a474y.jpg" alt="GitHub test success"></p>
</li>
</ol>
</li>
<li><p>æ‰˜ç®¡ä»£ç </p>
<ol>
<li><p>ä¸ºå½“å‰å·¥ç¨‹åˆ›å»ºä¸€ä¸ªå®ç”¨ä¸”æ¼‚äº®çš„<code>README.MD</code>æ–‡ä»¶å§ã€‚</p>
<p> åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>README.MD</code>æ–‡ä»¶ï¼Œ<code>MD</code>è¡¨ç¤ºè¿™æ˜¯ä¸€ä»½<code>Markdown</code>æ–‡ä»¶ã€‚</p>
<p> <img src="https://ww2.sinaimg.cn/large/006tNc79gy1fcj55v5oqlj30lw0ls413.jpg" alt="Add a readme file"></p>
<p> <code>README</code>æ–‡ä»¶ä½œä¸ºè¯´æ˜æ–‡ä»¶ï¼Œä½œç”¨æ˜¯è®©æµè§ˆè€…èƒ½å¤Ÿå¿«é€Ÿåœ°äº†è§£é¡¹ç›®ã€‚<br> å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å†™ä½œREADMEæ—¶ï¼Œåº”è¯¥åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé¡¹ç›®ï¼Œä»‹ç»é¡¹ç›®å¼€å‘çš„èƒŒæ™¯</li>
<li>é¡¹ç›®çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Œä»‹ç»é¡¹ç›®æ‰€è§£å†³çš„é—®é¢˜</li>
<li>æ€æ ·ä½¿ç”¨è¯¥é¡¹ç›®</li>
<li>é¡¹ç›®çš„å¼€å‘å†ç¨‹ï¼Œç‰ˆæœ¬å˜åŒ–(å¯é€‰)</li>
<li>æœªæ¥çš„å¼€å‘è®¡åˆ’(å¯é€‰)</li>
<li>Q&amp;A(å¯é€‰)</li>
<li>é¡¹ç›®æ‰€ä½¿ç”¨çš„è®¸å¯æ¡æ¬¾æ–‡ä»¶</li>
</ul>
<p>(æˆ‘çš„å»ºè®®æ˜¯æä¾›ä¸€ä»½è‹±æ–‡ç‰ˆçš„README.MDæ–‡æ¡£ï¼Œè®©æˆ‘ä»¬çš„é¡¹ç›®ä¸ä»…ä»…å¸®åŠ©åŒèƒï¼Œä¹Ÿå¸®åŠ©æ­ªæœä»å§ã€‚)</p>
</li>
<li><p>å°†å½“å‰å·¥ç¨‹å¯¼å…¥ç‰ˆæœ¬æ§åˆ¶ï¼Œåˆ›å»ºGitä»“åº“(å¯é€‰)</p>
<p> <img src="https://ww1.sinaimg.cn/large/006tNc79gy1fcj4ql3vs3j30yi0okwmo.jpg" alt="Create Git Repository"></p>
</li>
<li><p>åˆ†äº«åˆ°GitHubä¸Š</p>
<p> <img src="https://ww3.sinaimg.cn/large/006tNc79gy1fcj5jifdx3j30y20q0n5l.jpg" alt="Share Project on GitHub"></p>
<p> <img src="https://ww2.sinaimg.cn/large/006tNc79gy1fcj5o47zsqj30tm0jcq60.jpg" alt="Share Project on GitHub"></p>
<p> ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨GitHubçš„ç½‘ç«™ä¸Šçœ‹åˆ°æˆ‘ä»¬çš„é¡¹ç›®äº†ã€‚ä¸‹é¢æ˜¯æˆ‘çš„<a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">çº¸é£æœº</a>çš„é¡¹ç›®ä¸»é¡µã€‚</p>
<p> <img src="https://ww2.sinaimg.cn/large/006tNc79gy1fcj5vq0sqaj31kw106qfk.jpg" alt="GitHub Repository"></p>
</li>
</ol>
</li>
</ol>
<h4 id="Day-7-Q-amp-A"><a href="#Day-7-Q-amp-A" class="headerlink" title="Day 7,Q&amp;A"></a>Day 7,Q&amp;A</h4><p>è‡³æ­¤ï¼Œé¡¹ç›®å®Œæˆï¼Œæ•™ç¨‹ä¹Ÿæ¥è¿‘å°¾å£°ã€‚æ³¡æ¯å’–å•¡ï¼Œæˆ‘ä»¬æ¥èŠèŠä»£ç ä¹‹å¤–çš„äº‹æƒ…ã€‚</p>
<ul>
<li>Q: ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç¯‡æ–‡ç« ï¼Ÿ</li>
<li><p>A: ä¸€æ–¹é¢æ˜¯å—åˆ°å„ç§å¤§ç‰›çš„å½±å“ï¼Œè¿«åˆ‡åœ°æƒ³è¦ä¸ºå¼€æºè´¡çŒ®è‡ªå·±çš„åŠ›é‡ï¼›å¦ä¸€æ–¹é¢ï¼Œ<a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">çº¸é£æœº</a>é¡¹ç›®çš„ç»´æŠ¤æ—¶é—´å·²ç»æ¥è¿‘ä¸€å¹´ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿç®—æ˜¯ä¸€ä¸ªå°å°çš„æ€»ç»“ï¼›ç„¶åæ˜¯å¸Œæœ›é€šè¿‡æˆ‘çš„æ–‡ç« ï¼Œèƒ½å¤Ÿè®©åé¢çš„ç«¥é‹ä»¬å°‘è¸©ä¸€äº›å‘ã€‚</p>
</li>
<li><p>Q: ä¸€å‘¨æ—¶é—´å¹¶æ²¡æœ‰å®Œæˆé¡¹ç›®ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
</li>
<li><p>A: é¡¹ç›®çš„ä»£ç é‡è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œè€Œé¡¹ç›®ç°åœ¨çš„ä»£ç ä¹Ÿæ˜¯æˆ‘ç”¨MVPæ¶æ„é‡æ„ä¹‹åçš„ã€‚å°±æˆ‘è‡ªå·±è€Œè¨€ï¼Œç†è§£MVPæ¶æ„æˆ‘å°±èŠ±äº†ä¸€æ®µæ—¶é—´ï¼Œè€Œä¸”ï¼ŒMVPè¾ƒMVCï¼Œä»£ç é‡æœ¬èº«ä¹Ÿæ˜¯å¢åŠ çš„ã€‚æ²¡æœ‰å®Œæˆçš„è¯ï¼Œå°±å¤šèŠ±ç‚¹æ—¶é—´å§ã€‚(æ–‡ç« çš„æ ‡é¢˜ä¼¼ä¹æœ‰ç‚¹æ ‡é¢˜å…šçš„å«Œç–‘å‘¢)</p>
</li>
<li><p>Q: ç‰ˆæƒé—®é¢˜ï¼Ÿ</p>
</li>
<li><p>A: æ©ï¼Œä¸Šçº¿æœªç»ç‰ˆæƒæ‰€æœ‰æ–¹å¦‚çŸ¥ä¹ç­‰çš„è®¸å¯ï¼Œæˆ‘ä»¬çš„ç¡®æ˜¯ä¾µæƒäº†ã€‚æ‰€ä»¥ï¼Œè¯·åŠ¡å¿…çŸ¥æ™“å¯èƒ½æ‰¿æ‹…çš„åæœã€‚(è²Œä¼¼æ˜¯æŒ–äº†ä¸ªå‘å‘¢ğŸ˜‚)</p>
</li>
<li><p>Q: ä¸ºä»€ä¹ˆæ˜¯Google Playï¼Œè€Œä¸æ˜¯å‡ 60åº”ç”¨å•†åº—ï¼ŒæŸåº¦åº”ç”¨å•†åº—å‘¢ï¼Ÿ</p>
</li>
<li><p>A: ç§ä¸ä¸Šã€‚(æˆ‘ä¸æ˜¯é’ˆå¯¹åœ¨åº§çš„æŸä¸€ä¸ªåº”ç”¨å•†åº—ï¼Œæˆ‘æ˜¯è¯´åœ¨åº§çš„å„ä¸ªåº”ç”¨å•†åº—ï¼Œé™¤äº†Google Playï¼Œéƒ½æ˜¯é‚£å•¥)</p>
</li>
<li><p>Q: æˆ‘æœ‰é—®é¢˜éœ€è¦æ¢è®¨ï¼Œæ€ä¹ˆè”ç³»ï¼Ÿ</p>
</li>
<li><p>A:</p>
<ul>
<li>marktonymengyi#gmail.com</li>
<li><a href="https://www.zhihu.com/people/kirin-momo" target="_blank" rel="external">çŸ¥ä¹</a></li>
<li><a href="http://weibo.com/5313690193/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">å¾®åš</a></li>
<li><a href="https://github.com/TonnyL" target="_blank" rel="external">GitHub</a></li>
<li>æˆ‘çš„ä¸ªäººåšå®¢åœ°å€:<a href="https://TonnyL.github.io/">https://TonnyL.github.io/</a></li>
</ul>
</li>
<li><p>Q: æœ€åæœ‰ä»€ä¹ˆæƒ³è¯´çš„ï¼Ÿ</p>
</li>
<li>A: å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œè¯·ç»™æ–‡ç« ç‚¹ä¸€ä¸ªèµï¼Œæˆ–è€…ç»™é¡¹ç›®ä¸€ä¸ªStarï¼ŒåœŸè±ªè¯·éšæ„æ‰“èµï¼Œé›†é½30å—é’±æˆ‘æƒ³è¦ä¹°æœ¬å…³äºGitçš„ä¹¦ğŸ˜‚ã€‚(å¦‚æœæœ‰å¤§ç‰›æœ‰å®ä¹ æœºä¼šçš„è¯ï¼Œè¯·æ¨èä¸€ä¸‹æˆ‘å‘€)(æ–‡ç¬”ä¸å¥½ï¼Œè¿˜è¯·å¤šåŒ…æ¶µ)</li>
</ul>
<p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»~~~</p>
<p>æœ¬æ–‡ç”±<a href="http://www.jianshu.com/u/49606f4d970f" target="_blank" rel="external">TonnyL</a>åŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜ä½œè€…åŠå‡ºå¤„ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š(æ¯›ç»ç’ƒ/ç£¨ç ‚)æ•ˆæœ]]></title>
      <url>http://tonnyl.github.io/2017/01/12/%E4%BD%BF%E7%94%A8RenderScript%E5%AE%9E%E7%8E%B0%E9%AB%98%E6%96%AF%E6%A8%A1%E7%B3%8A-%E6%AF%9B%E7%8E%BB%E7%92%83-%E7%A3%A8%E7%A0%82-%E6%95%88%E6%9E%9C/</url>
      <content type="html"><![CDATA[<p>æäº‹æƒ…ï¼Œå®ç°Instagramå¯¹è¯æ¡†èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>é€›insçš„æ—¶å€™ï¼Œå¶ç„¶å‘ç°ï¼Œinstagramçš„å¯¹è¯æ¡†è®¾è®¡çš„å¾ˆæœ‰æ„æ€ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/ins.jpeg" alt="instagram" title="instagram">
<p>å®ƒçš„dialogçš„èƒŒæ™¯ç«Ÿç„¶æ˜¯æ¯›ç»ç’ƒæ•ˆæœçš„ï¼Œåœ¨æˆ‘çœ‹æ¥çœŸæ¼‚äº®ï¼Œæ©ï¼Œå¯¹è¯æ¡†å’Œè¿ªä¸½çƒ­å·´éƒ½æ¼‚äº®ğŸ˜‚ã€‚çœ‹åˆ°è¿™ä¹ˆå¥½çš„æ•ˆæœï¼Œå½“ç„¶å°±è¦å¼€å§‹æäº‹æƒ…äº†ï¼Œè‡ªå·±åŠ¨æ‰‹å®ç°å·®ä¸å¤šçš„æ•ˆæœã€‚æœ€ç»ˆçš„å®ç°æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p>
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/demo.png" alt="æ•ˆæœ" title="æ•ˆæœ">
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/demo1.jpeg" alt="æ‰‹åŠ¨è°ƒèŠ‚" title="æ‰‹åŠ¨è°ƒèŠ‚">
<p>åˆ†åˆ«å®ç°äº†å¯¹è¯æ¡†èƒŒæ™¯çš„è™šåŒ–å’Œæ‰‹åŠ¨è°ƒèŠ‚è™šåŒ–ç¨‹åº¦ã€‚</p>
<h3 id="å®ç°æ–¹æ³•å¯¹æ¯”"><a href="#å®ç°æ–¹æ³•å¯¹æ¯”" class="headerlink" title="å®ç°æ–¹æ³•å¯¹æ¯”"></a>å®ç°æ–¹æ³•å¯¹æ¯”</h3><p>æœ€å¼€å§‹æƒ³è¦å®ç°æ¯›ç»ç’ƒæ•ˆæœæ—¶ï¼Œæˆ‘æ˜¯ä¸€è„¸æ‡µé€¼çš„ï¼Œä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ã€‚å¹¸äºï¼Œæœ‰ä¸‡èƒ½çš„Googleã€‚æœç´¢ä¹‹åå‘ç°å¸¸è§çš„å®ç°æ–¹æ³•æœ‰4ç§ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>RenderScript</li>
<li>Javaç®—æ³•</li>
<li>NDKç®—æ³•</li>
<li>openGL</li>
</ul>
<p>å¤„ç†ä¸€æ•´å¼ å›¾ç‰‡è¿™ä¹ˆå¤§è®¡ç®—é‡çš„å·¥ä½œï¼ŒopenGLçš„æ€§èƒ½æœ€å¥½ï¼Œè€Œç”¨javaå®ç°è‚¯å®šæ˜¯æœ€å·®çš„äº†ã€‚è€ŒRenderScriptå’ŒNDKçš„æ€§èƒ½ç›¸å½“ï¼Œä½†æ˜¯ä½ æ‡‚å¾—ï¼ŒNDKå’ŒopenGLæˆ‘æ— å¯å¥ˆä½•ï¼Œç»¼åˆè€ƒè™‘ï¼ŒRenderScriptåº”è¯¥æ˜¯æœ€é€‚åˆçš„ã€‚</p>
<p>ä½†å¹¶ä¸æ˜¯è¯´RenderScriptå°±æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ï¼š</p>
<ol>
<li>æ¨¡ç³ŠåŠå¾„(radius)è¶Šå¤§ï¼Œæ€§èƒ½è¦æ±‚è¶Šé«˜ï¼Œæ¨¡ç³ŠåŠå¾„ä¸èƒ½è¶…è¿‡25ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½å¾—åˆ°æ¨¡ç³Šåº¦éå¸¸é«˜çš„å›¾ç‰‡ã€‚</li>
<li>ScriptIntrinsicBluråœ¨API 17æ—¶æ‰è¢«å¼•å…¥ï¼Œå¦‚æœéœ€è¦åœ¨Android 4.2ä»¥ä¸‹çš„è®¾å¤‡ä¸Šå®ç°ï¼Œå°±éœ€è¦å¼•å…¥RenderScript Support Libraryï¼Œå½“ç„¶ï¼Œå®‰è£…åŒ…ä½“ç§¯ä¼šç›¸åº”çš„å¢å¤§ã€‚</li>
</ol>
<h3 id="RenderScriptå®ç°"><a href="#RenderScriptå®ç°" class="headerlink" title="RenderScriptå®ç°"></a>RenderScriptå®ç°</h3><p>é¦–å…ˆåœ¨<code>app</code>ç›®å½•ä¸‹<code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code>defaultConfig {
        applicationId &quot;io.github.marktony.gaussianblur&quot;
        minSdkVersion 19
        targetSdkVersion 25
        versionCode 1
        versionName &quot;1.0&quot;
        renderscriptTargetApi 19
        renderscriptSupportModeEnabled true
    }
</code></pre><p>RenderScriptIntrinsicsæä¾›äº†ä¸€äº›å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®ç°å„ç§å›¾ç‰‡å¤„ç†çš„æ“ä½œç±»ï¼Œä¾‹å¦‚ï¼Œ<code>ScriptIntrinsicBlur</code>ï¼Œå¯ä»¥ç®€å•é«˜æ•ˆå®ç°    é«˜æ–¯æ¨¡ç³Šæ•ˆæœã€‚</p>
<pre><code class="java">package io.github.marktony.gaussianblur;

import android.content.Context;
import android.graphics.Bitmap;
import android.support.annotation.IntRange;
import android.support.annotation.NonNull;
import android.support.v8.renderscript.Allocation;
import android.support.v8.renderscript.Element;
import android.support.v8.renderscript.RenderScript;
import android.support.v8.renderscript.ScriptIntrinsicBlur;

public class RenderScriptGaussianBlur {

    private RenderScript renderScript;

    public RenderScriptGaussianBlur(@NonNull Context context) {
        this.renderScript = RenderScript.create(context);
    }

    public Bitmap gaussianBlur(@IntRange(from = 1, to = 25) int radius, Bitmap original) {
        Allocation input = Allocation.createFromBitmap(renderScript, original);
        Allocation output = Allocation.createTyped(renderScript, input.getType());
        ScriptIntrinsicBlur scriptIntrinsicBlur = ScriptIntrinsicBlur.create(renderScript, Element.U8_4(renderScript));
        scriptIntrinsicBlur.setRadius(radius);
        scriptIntrinsicBlur.setInput(input);
        scriptIntrinsicBlur.forEach(output);
        output.copyTo(original);
        return original;
    }

}
</code></pre>
<p>ç„¶åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨RenderScriptGaussianBlurï¼Œæ„‰å¿«åœ°æ ¹æ®SeekBarçš„å€¼ï¼Œå®ç°ä¸åŒç¨‹åº¦çš„æ¨¡ç³Šäº†ã€‚</p>
<pre><code class="java">package io.github.marktony.gaussianblur;

import android.content.DialogInterface;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.support.v7.app.AlertDialog;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.FrameLayout;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.SeekBar;
import android.widget.TextView;

public class MainActivity extends AppCompatActivity {

    private ImageView imageView;
    private ImageView container;
    private LinearLayout layout;
    private TextView textViewProgress;
    private RenderScriptGaussianBlur blur;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        imageView = (ImageView) findViewById(R.id.imageView);
        container = (ImageView) findViewById(R.id.container);

        container.setVisibility(View.GONE);

        layout = (LinearLayout) findViewById(R.id.layout);

        layout.setVisibility(View.VISIBLE);

        SeekBar seekBar = (SeekBar) findViewById(R.id.seekBar);
        textViewProgress = (TextView) findViewById(R.id.textViewProgress);
        TextView textViewDialog = (TextView) findViewById(R.id.textViewDialog);
        blur = new RenderScriptGaussianBlur(MainActivity.this);

        seekBar.setMax(25);
        seekBar.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
            @Override
            public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
                textViewProgress.setText(String.valueOf(progress));
            }

            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {

            }

            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {
                int radius = seekBar.getProgress();
                if (radius &lt; 1) {
                    radius = 1;
                }
                Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.image);
                imageView.setImageBitmap(blur.gaussianBlur(radius, bitmap));
            }
        });

        textViewDialog.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                container.setVisibility(View.VISIBLE);

                layout.setDrawingCacheEnabled(true);
                layout.setDrawingCacheQuality(View.DRAWING_CACHE_QUALITY_LOW);

                Bitmap bitmap = layout.getDrawingCache();

                container.setImageBitmap(blur.gaussianBlur(25, bitmap));

                layout.setVisibility(View.INVISIBLE);

                AlertDialog dialog = new AlertDialog.Builder(MainActivity.this).create();
                dialog.setTitle(&quot;Title&quot;);
                dialog.setMessage(&quot;Message&quot;);
                dialog.setButton(DialogInterface.BUTTON_POSITIVE, &quot;OK&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        dialog.dismiss();
                    }
                });
                dialog.setButton(DialogInterface.BUTTON_NEGATIVE, &quot;Cancel&quot;, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {

                    }
                });
                dialog.setOnCancelListener(new DialogInterface.OnCancelListener() {
                    @Override
                    public void onCancel(DialogInterface dialog) {

                    }
                });

                dialog.setOnCancelListener(new DialogInterface.OnCancelListener() {
                    @Override
                    public void onCancel(DialogInterface dialog) {
                        container.setVisibility(View.GONE);
                        layout.setVisibility(View.VISIBLE);
                    }
                });

                dialog.show();
            }
        });

    }
}
</code></pre>
<p>åœ¨ä»£ç é‡Œåšäº†ä¸€äº›viewçš„å¯è§æ€§çš„æ“ä½œï¼Œæ¯”è¾ƒç®€å•ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹æ‡‚çš„ã€‚å’Œinstagramä¸­dialogçš„å®ç°æœ‰ä¸€ç‚¹ä¸åŒçš„æ˜¯ï¼Œæˆ‘æ²¡æœ‰æˆªå–æ•´ä¸ªé¡µé¢çš„bitmapï¼Œåªæ˜¯æˆªå–äº†actionbarä¸‹çš„å†…å®¹ï¼Œå¦‚æœä¸€å®šè¦å®ç°ä¸€æ ·çš„æ•ˆæœï¼Œè°ƒæ•´ä¸€ä¸‹é¡µé¢çš„å¸ƒå±€å°±å¯ä»¥äº†ã€‚è¿™é‡Œä¸å¤šè¯´äº†ã€‚</p>
<p>æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿ</p>
<h3 id="è½®å­"><a href="#è½®å­" class="headerlink" title="è½®å­"></a>è½®å­</h3><p>é™¤äº†RenderScriptå¤–ï¼Œè¿˜æœ‰ä¸€äº›ä¼˜ç§€çš„è½®å­ï¼š</p>
<ul>
<li><a href="https://github.com/500px/500px-android-blur" target="_blank" rel="external">500px-android-blur</a></li>
<li><a href="https://github.com/wasabeef/Blurry" target="_blank" rel="external">Blurry</a></li>
<li><a href="https://github.com/kikoso/android-stackblur" target="_blank" rel="external">android-stackblur</a></li>
<li><a href="https://github.com/paveldudka/blurring/blob/master/app/src/main/java/com/paveldudka/util/FastBlur.java" target="_blank" rel="external">FastBlur</a>:Javaç®—æ³•å®ç°</li>
</ul>
<p><a href="https://github.com/patrickfav/BlurTestAndroid" target="_blank" rel="external">BlurTestAndroid</a>å¯¹ä¸åŒç±»åº“çš„å®ç°æ–¹å¼ã€é‡‡å–çš„ç®—æ³•å’Œæ‰€è€—è´¹çš„æ—¶é—´åšäº†ç»Ÿè®¡å’Œæ¯”è¾ƒï¼Œä½ ä¹Ÿå¯ä»¥ä¸‹è½½å®ƒçš„demo appï¼Œè‡ªè¡Œæµ‹è¯•ã€‚</p>
<img src="/2017/01/12/ä½¿ç”¨RenderScriptå®ç°é«˜æ–¯æ¨¡ç³Š-æ¯›ç»ç’ƒ-ç£¨ç ‚-æ•ˆæœ/BlurTestAndroid.png" alt="BlurTestAndroid" title="BlurTestAndroid">
<p>ç¤ºä¾‹ä»£ç åœ¨è¿™é‡Œï¼š<a href="https://github.com/TonnyL/GaussianBlur" target="_blank" rel="external">GaussianBlur</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[æˆ‘çš„2016]]></title>
      <url>http://tonnyl.github.io/2017/01/10/%E6%88%91%E7%9A%842016/</url>
      <content type="html"><![CDATA[<p>å¼€æºï¼Œåšå®¢ï¼Œæ•°ç ï¼Œç”µå½±ä¸ç”µè§†å‰§ã€‚<br><a id="more"></a><br>æ—¶é—´èµ°ç€èµ°ç€ï¼Œæˆ‘è¯»å®Œäº†å¤§ä¸‰ç¬¬ä¸€ä¸ªå­¦æœŸï¼Œè·ç¦»å…¬å…ƒ2016å¹´ä¹Ÿå·²ç»è¿‡å»äº†10å¤©ï¼Œæ˜¯æ—¶å€™å¯¹è¿‡å»çš„ä¸€å¹´åšä¸€ä¸ªæ€»ç»“äº†ã€‚æœ¬æ¥è¿˜æƒ³ç€1å·çš„æ—¶å€™å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œç»“æœï¼Œæ­£å¼åº”äº†é‚£å¥è¯ï¼š</p>
<blockquote>
<p>åœ¨è®©è‡ªå·±å¤±æœ›è¿™ä»¶äº‹æƒ…ä¸Šï¼Œæˆ‘ä»æ²¡è®©è‡ªå·±å¤±æœ›è¿‡ã€‚</p>
</blockquote>
<p>ä¸€æ‹–å°±æ‹–åˆ°äº†10å·æ‰å¼€å§‹åŠ¨ç¬”ï¼Œä¸å¯¹ï¼ŒåŠ¨é”®ç›˜ï¼Œæ­£å¼çš„å¯¹è¿‡å»ä¸€å¹´è¿›è¡Œä¸€ä¸ªå°½é‡å®Œæ•´çš„æ€»ç»“ï¼ˆä»¥ä¸‹æ‰€æœ‰çš„ç»Ÿè®¡æ—¥æœŸå‡ä¸ºæˆªæ­¢è‡³2017å¹´1æœˆ10æ—¥ï¼‰ã€‚</p>
<h3 id="é¡¹ç›®"><a href="#é¡¹ç›®" class="headerlink" title="é¡¹ç›®"></a>é¡¹ç›®</h3><p>è¯´åˆ°é¡¹ç›®å°±ä¸å¾—ä¸è¯´<a href="https://github.com/TonnyL" target="_blank" rel="external">GitHub</a>, è™½ç„¶åœ¨15å¹´çš„æ—¶å€™æ³¨å†Œäº†è´¦å·ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šæ²¡æœ‰æäº¤æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼ŒçœŸæ­£å¼€å§‹ç”¨å¿ƒçš„ç»´æŠ¤è¿˜æ˜¯åœ¨16å¹´ã€‚</p>
<img src="/2017/01/10/æˆ‘çš„2016/github_contribution.png" alt="GitHub Contributions" title="GitHub Contributions">
<p>ä¸€å…±æœ‰422æ¬¡contributionã€‚</p>
<p>staræ¯”è¾ƒå¤šçš„é¡¹ç›®:</p>
<img src="/2017/01/10/æˆ‘çš„2016/github_pop_repos.png" alt="GitHub pop repos" title="GitHub pop repos">
<p>æ‰€æœ‰çš„é¡¹ç›®ä¸€å…±æ”¶è·535ä¸ªstar(ä»æ— åˆ°æœ‰)ï¼Œè¢«fork140æ¬¡(ä»æ— åˆ°æœ‰)ï¼Œfollower96(ä»æ— åˆ°æœ‰)ã€‚</p>
<p>å…¶ä¸­æ¯”è¾ƒåœ¨æˆ‘çœ‹æ¥æ¯”è¾ƒä¼˜ç§€çš„æœ‰ï¼š</p>
<ul>
<li><a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">çº¸é£æœº(çŸ¥ä¹å°æŠ¥ PaperPlane)</a>,é‡‡ç”¨MVPæ¶æ„ï¼Œé›†åˆäº†çŸ¥ä¹æ—¥æŠ¥ã€æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„ç»¼åˆæ€§é˜…è¯»å®¢æˆ·ç«¯ï¼Œåœ¨<a href="https://play.google.com/store/apps/details?id=com.marktony.zhihudaily" target="_blank" rel="external">Google Play</a>ä¸Šä¸‹è½½é‡ä¸º13354æ¬¡ï¼Œç»¼åˆè¯„åˆ†4.62ï¼ˆæ»¡åˆ†5ï¼‰ï¼›<a href="http://app.mi.com/detail/312703?ref=search" target="_blank" rel="external">å°ç±³åº”ç”¨å•†åº—</a>ä¸‹è½½é‡ä¸º12602æ¬¡ï¼›<a href="http://app.flyme.cn/apps/public/detail?package_name=com.marktony.zhihudaily" target="_blank" rel="external">é­…æ—åº”ç”¨å•†åº—</a>ä¸‹è½½é‡ä¸º5208ï¼Œç»¼åˆè¯„åˆ†9.6ï¼ˆæ»¡åˆ†ä¸º10ï¼‰ï¼›<a href="http://www.coolapk.com/apk/com.marktony.zhihudaily" target="_blank" rel="external">é…·å¸‚åœº</a>ä¸‹è½½é‡ä¸º4.3ä¸‡ï¼Œç»¼åˆè¯„åˆ†4.5ï¼ˆæ»¡åˆ†ä¸º5ï¼‰ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/paper_plane.png" alt="Paper Plane" title="Paper Plane">
<ul>
<li><a href="https://github.com/TonnyL/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ APPåŠAPIåˆ†æ</a>ï¼Œç”±äºç‰ˆæƒé—®é¢˜ï¼ŒAPPå·²ç»åœæ­¢ç»´æŠ¤ï¼ŒAPIåˆ†æéƒ¨åˆ†å¯ä»¥æŸ¥çœ‹<a href="https://github.com/TonnyL/zhuanlan/wiki" target="_blank" rel="external">wiki</a>æˆ–è€…<a href="https://TonnyL.github.io/2016/05/14/%E7%9F%A5%E4%B9%8E%E4%B8%93%E6%A0%8FAPI%E5%88%86%E6%9E%90/">æˆ‘çš„åšå®¢</a></li>
<li><a href="https://github.com/TonnyL/FanfouHandpick" target="_blank" rel="external">é¥­å¦ç²¾é€‰</a>,ä½¿ç”¨Kotlinå¼€å‘çš„é¥­å¦ç²¾é€‰å®¢æˆ·ç«¯ã€‚è¿™ä¸ªé¡¹ç›®ä¸»è¦æ˜¯ç»ƒæ‰‹ï¼Œå°é²œä½¿ç”¨Kotlinï¼Œç°é˜¶æ®µåœ¨é¡¹ç›®ä¸­ä½¿ç”¨Kotlinçš„å¯èƒ½æ€§è¿˜æ˜¯è›®å°çš„ã€‚</li>
<li><a href="https://github.com/TonnyL/Translator" target="_blank" rel="external">ç®€å•ç¿»è¯‘</a></li>
<li><a href="https://github.com/TonnyL/Reader" target="_blank" rel="external">Reader</a>ï¼šå†…å®¹åŒ…å«äº†ç³—äº‹ç™¾ç§‘ï¼Œç…è›‹ï¼Œå’Œå†…æ¶µæ®µå­</li>
</ul>
<p>æ‰€æœ‰é¡¹ç›®å‡ç”±æˆ‘è‡ªå·±å®Œæˆè®¾è®¡ï¼Œç¼–ç ï¼Œæµ‹è¯•ï¼Œä¸Šçº¿åŠè¿­ä»£ç»´æŠ¤å·¥ä½œã€‚</p>
<h3 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h3><ul>
<li><a href="https://TonnyL.github.io">Tonnyâ€™s Blog</a>ï¼Œä½¿ç”¨GitHub Pageså’ŒHexoæ­å»ºçš„åšå®¢ï¼Œæ‰€æœ‰æ–‡ç« éƒ½é¦–å‘äºæ­¤ï¼Œä¹Ÿæ˜¯åœ¨16å¹´ä¸­æ‰æ­å»ºå®Œæˆï¼Œä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ˜¯<a href="https://github.com/A-limon/pacman" target="_blank" rel="external">Pacman</a>ä¸»é¢˜ï¼Œå¹´åº•å‰æ¢äº†<a href="https://github.com/viosey/hexo-theme-material" target="_blank" rel="external">Material</a>ä¸»é¢˜ï¼Œæ„Ÿè§‰ç¾è§‚äº†å¾ˆå¤š(è°è®©æˆ‘æ˜¯Googleçš„ç²‰ä¸å‘¢)ã€‚ä¸€å…±å®Œæˆäº†21ç¯‡æ–‡ç« ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/Tonny%27sBlog.png" alt="Tonny's Blog" title="Tonny's Blog">
<ul>
<li><p><a href="http://www.jianshu.com/u/49606f4d970f" target="_blank" rel="external">ç®€ä¹¦-TonnyL</a>:åŠå¹´æ—¶é—´ï¼Œä¸€å…±å†™äº†10ç¯‡æ–‡ç« ï¼Œ17898ä¸ªå­—ï¼Œæ”¶è·äº†195ä¸ªå–œæ¬¢ï¼Œ64ä¸ªç²‰ä¸ã€‚</p>
</li>
<li><p><a href="https://gold.xitu.io/user/582c81cb128fe10069509b49" target="_blank" rel="external">ç¨€åœŸæ˜é‡‘-Tonny</a>:ä½¿ç”¨æ—¶é—´ä¸€ä¸ªæœˆï¼Œåˆ†äº«6ç¯‡æ–‡ç« ï¼Œæ”¶è·734ä¸ªå–œæ¬¢ã€‚</p>
</li>
</ul>
<h3 id="è®¾å¤‡"><a href="#è®¾å¤‡" class="headerlink" title="è®¾å¤‡"></a>è®¾å¤‡</h3><ul>
<li>ç”µè„‘ï¼šå•Šå“ˆå“ˆå“ˆå“ˆï¼Œç»ˆäºåœ¨ä»Šå¹´åæœˆä»½çš„æ—¶å€™ï¼ŒæŠŠåŸæ¥çš„åç¡•A550å–äº†ï¼Œä¹°äº†ç°åœ¨çš„MBPï¼ŒåŸæ¥çš„åç¡•çš„çœŸçš„å¤ªåšäº†ï¼Œè€Œä¸”é‡ï¼Œå¸¦ç€èµ°å¤ªä¸æ–¹ä¾¿äº†ã€‚ç¬¬ä¸€æ¬¡æ‹¿åˆ°MBPçš„æ—¶å€™ï¼ŒçœŸçš„ä¸ç”±è‡ªä¸»çš„æ„Ÿå¹ï¼ŒåŸæ¥ç”Ÿäº§åŠ›å·¥å…·æ˜¯å¯ä»¥è¿™ä¹ˆè–„çš„ã€‚å½“ç„¶ï¼Œæ¢ç”µè„‘çš„ä»£ä»·å°±æ˜¯åƒäº†ä¸€ä¸ªå­¦æœŸçš„åœŸï¼ˆæ‰‹åŠ¨å¾®ç¬‘è„¸ï¼‰ã€‚</li>
<li>é”®ç›˜ï¼šé˜¿ç±³æ´›VA87MèŒ¶è½´ï¼Œå¤§æ¦‚5æœˆä»½çš„æ—¶å€™ï¼Œå–æ‰äº†ä¹‹å‰RK68ï¼Œæ²¡æœ‰æ–¹å‘é”®çš„é”®ç›˜ï¼Œç”¨ç€å¤ªåˆ«æ‰­ã€‚</li>
<li>æ‰‹æœºï¼šä¸€åŠ 3ã€‚è¿˜åœ¨åˆ†æœŸä¸­ã€‚</li>
</ul>
<p>ï¼ˆæ±‚åœŸè±ªä¸å–·ï¼Œæˆ‘ç©·é€¼ä¸€ä¸ªã€‚ï¼‰</p>
<h3 id="è¯»ä¹¦"><a href="#è¯»ä¹¦" class="headerlink" title="è¯»ä¹¦"></a>è¯»ä¹¦</h3><p>ç”±äºæˆ‘ä¸å–œæ¬¢çœ‹ç”µå­ä¹¦ï¼Œæ‰€ä»¥ä¹¦åŸºæœ¬ä¸Šéƒ½æ˜¯çœ‹çš„çº¸è´¨çš„ä¹¦ï¼ˆä¹°ä¸èµ·Kindleï¼‰ã€‚å¤§æ¦‚çœ‹äº†ï¼š</p>
<ul>
<li>ç¬¬ä¸€è¡Œä»£ç Androidï¼Œå…¥é—¨å¿…å¤‡ï¼Œå¹´æœ«çš„æ—¶å€™åˆå…¥æ‰‹äº†ç¬¬äºŒç‰ˆçš„ï¼Œå·©å›ºåŸºç¡€è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</li>
<li>Androidå¼€å‘è‰ºæœ¯æ¢ç´¢ï¼Œæå‡ï¼Œè¿˜åœ¨ç ”è¯»ã€‚</li>
<li>Thinking in Javaï¼Œå·©å›ºåŸºç¡€ä¸æå‡éƒ½é ä»–ï¼ŒJavaç•Œçš„é‡‘å·åƒã€‚</li>
</ul>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>çœ‹äº†ä¸€äº›ç”µå½±å’Œç”µè§†å‰§ã€‚</p>
<ul>
<li>åŒ—äº¬é‡ä¸Šè¥¿é›…å›¾ä¹‹ä¸äºŒæƒ…ä¹¦ï¼Œè™½ç„¶è¿˜æ˜¯å•èº«ç‹—ä¸€ä¸ªï¼Œè¿˜æ˜¯å’ŒåŒå­¦ä¸€èµ·å»çœ‹äº†è¿™éƒ¨ç”µå½±ï¼Œæ±¤å”¯å¥½å¸…ï¼</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/buerqingshu.jpg" alt="ä¸äºŒæƒ…ä¹¦" title="ä¸äºŒæƒ…ä¹¦">
<ul>
<li>é©´å¾—æ°´ï¼Œç¬‘ç€ç¬‘ç€å°±å“­çš„ç”µå½±ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/lvdeshui.jpg" alt="é©´å¾—æ°´" title="é©´å¾—æ°´">
<ul>
<li>The Big Bang Theory S10,Sheltonéƒ½å’ŒAmyåœ¨ä¸€èµ·äº†ï¼Œæˆ‘è¿˜æ˜¯æ²¡å¥³æœ‹å‹ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/tbbt.jpg" alt="ç”Ÿæ´»å¤§çˆ†ç‚¸" title="ç”Ÿæ´»å¤§çˆ†ç‚¸">
<ul>
<li>Westworld S1ï¼ŒHBOå‡ºå“ï¼Œå¿…å±ç²¾å“ã€‚çƒ§è„‘çš„ç”µè§†å‰§ï¼Œè€Œä¸”Deloriså¥½æ¼‚äº®å•Šã€‚ä¸è¿‡æˆ‘è§‰å¾—æœ‰ç‚¹å‘çˆ¹çš„ï¼Œæˆ‘å–œæ¬¢çš„Halseyæ€ä¹ˆè¯´æ²¡å°±æ²¡äº†å‘¢ï¼Ÿä¸è¿‡å¥½æ¶ˆæ¯æ˜¯ï¼ŒHalseyä¼šåœ¨S2å›å½’ï¼Œè¿™æ‰ç¨å¾®å®‰æ…°äº†ä¸€ä¸‹æˆ‘å—ä¼¤çš„å¿ƒçµã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/westworld.jpg" alt="è¥¿éƒ¨ä¸–ç•Œ" title="è¥¿éƒ¨ä¸–ç•Œ">
<ul>
<li>è¯·å›ç­”1988ï¼Œæš‘å‡çš„æ—¶å€™æ‰çœ‹å®Œï¼Œæˆ‘çš„è¯„ä»·æ˜¯ï¼Œç¥å‰§ã€‚çœŸçš„ç¥ï¼Œæ„Ÿè§‰ä»–ä»¬ä¸æ˜¯ç”Ÿæ´»åœ¨åŒé—¨æ´ï¼Œè€Œæ˜¯ç”Ÿæ´»åœ¨æˆ‘èº«è¾¹ã€‚ä»£å…¥æ„Ÿå¤ªå¼ºï¼Œè¿˜æœ‰å„ç§ç¥ç»†èŠ‚ï¼Œå„ç§ä¸åšä½œçš„ç…½æƒ…ï¼Œæ„ŸåŠ¨åœ°æµæ³ªã€‚çœ‹å®Œäº†å‰¯ä½œç”¨ä¹ŸæŒºæ˜æ˜¾çš„ï¼Œé‚£å°±æ˜¯ç°åœ¨æˆ‘é€¢äººå°±å®‰åˆ©è¿™éƒ¨å‰§ï¼ˆå¾®ç¬‘è„¸ï¼‰ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/qinghuida1988.jpg" alt="è¯·å›ç­”1988" title="è¯·å›ç­”1988">
<ul>
<li>è¾©æŠ¤äººï¼Œè¿™ä¸æ˜¯16å¹´å‡ºå“çš„ç”µå½±ï¼Œä½†æ˜¯çœŸçš„å¯¹æˆ‘çš„å¯å‘å¤ªå¤§äº†ã€‚ç²¾å“ã€‚</li>
</ul>
<img src="/2017/01/10/æˆ‘çš„2016/bianhuren.jpg" alt="è¾©æŠ¤äºº" title="è¾©æŠ¤äºº">
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><blockquote>
<p>é©å‘½å°šæœªæˆåŠŸï¼ŒåŒå¿—ä»éœ€åŠªåŠ›ã€‚</p>
</blockquote>
<h3 id="å°ç›®æ ‡"><a href="#å°ç›®æ ‡" class="headerlink" title="å°ç›®æ ‡"></a>å°ç›®æ ‡</h3><p>2017å¹´ï¼Œå…ˆç»™è‡ªå·±å®šä¸€ä¸ªå°ç›®æ ‡ï¼Œæ¯”å¦‚ï¼Œå‡è‚¥5kgï¼ˆå¾®ç¬‘è„¸ï¼‰ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Lambdaåœ¨Androidä¸­çš„ä½¿ç”¨]]></title>
      <url>http://tonnyl.github.io/2017/01/06/Lambda%E5%9C%A8Android%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>æç®€ä¸»ä¹‰ã€‚<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Androidæ”¯æŒå®Œæ•´çš„Java7ç‰¹æ€§ï¼Œè€Œå‡çº§åˆ°Android Nougat(API Level 24)ä¹‹åï¼Œæ”¯æŒäº†Java8è¯­è¨€çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼š</p>
<ul>
<li><a href="https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html" target="_blank" rel="external">é»˜è®¤å’Œé™æ€æ¥å£æ–¹æ³•</a></li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html" target="_blank" rel="external">Lambdaè¡¨è¾¾å¼</a>(åœ¨ API çº§åˆ« 23 åŠæ›´ä½ç‰ˆæœ¬ä¸­ä¹Ÿå¯ç”¨)</li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/annotations/repeating.html" target="_blank" rel="external">é‡å¤æ³¨è§£</a></li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html" target="_blank" rel="external">æ–¹æ³•å¼•ç”¨</a>(åœ¨ API çº§åˆ« 23 åŠæ›´ä½ç‰ˆæœ¬ä¸­ä¹Ÿå¯ç”¨)</li>
<li><a href="https://docs.oracle.com/javase/tutorial/java/annotations/type_annotations.html" target="_blank" rel="external">ç±»å‹æ³¨è§£</a>(åœ¨ API çº§åˆ« 23 åŠæ›´ä½ç‰ˆæœ¬ä¸­ä¹Ÿå¯ç”¨)</li>
</ul>
<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>ä½¿ç”¨è¿™ä¸€éƒ¨åˆ†æ”¯æŒçš„åŠŸèƒ½éœ€è¦ä¸€ä¸ªåä¸º<a href="https://source.android.com/source/jack.html" target="_blank" rel="external">Jack</a>çš„æ–°ç¼–è¯‘ã€‚è€ŒJackè¦æ±‚Android Studio 2.1æˆ–æ›´é«˜ï¼Œæ‰€ä»¥ï¼Œæ²¡æœ‰å‡çº§åˆ°2.1æˆ–ä»¥ä¸Šçš„ç«¥é‹ï¼Œéœ€è¦å…ˆå‡çº§æ‰èƒ½æ”¯æŒä½¿ç”¨Jackå“Ÿã€‚</p>
<blockquote>
<p><a href="https://developer.android.com/tools/building/building-studio.html#instant-run" target="_blank" rel="external">Instant Run</a>ç›®å‰ä¸èƒ½åº”ç”¨äºJack</p>
</blockquote>
<p>åœ¨<code>app</code>ç›®å½•ä¸‹<code>build.gradle</code>æ–‡ä»¶ä¸‹æ·»åŠ ï¼š</p>
<pre><code>android {
  ...
  defaultConfig {
    ...
    jackOptions {
      enabled true
    }
    // åœ¨æ›´è€çš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨
    // useJack true
    // å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ
  }
  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }
}
</code></pre><h3 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h3><p>Lambdaçš„è¯­æ³•æ ¼å¼å¦‚ä¸‹:</p>
<pre><code class="java">(arg1, arg2...) -&gt; { body }

(type1 arg1, type2 arg2...) -&gt; { body }
</code></pre>
<p>åœ¨æœªä½¿ç”¨Lambdaè¡¨è¾¾å¼ä¹‹å‰ï¼Œæˆ‘ä»¬è®¾ç½®ç›‘å¬å™¨çš„ä»£ç æ˜¯è¿™æ ·çš„:</p>
<pre><code class="java">fab.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // blah, blah
    }
});
</code></pre>
<p>è€Œä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œä»£ç æ˜¯è¿™æ ·çš„:</p>
<pre><code class="java">fab.setOnClickListener(v -&gt; {
    // blah, blah            
});
</code></pre>
<p>æ˜¯ä¸æ˜¯æ›´ç®€æ´äº†å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹<code>OnClickListener</code>çš„æºç ï¼Œå‘ç°è¿™ä¸ªæ¥å£ä¸­åªæœ‰ä¸€ä¸ªå¾…å®ç°çš„æ–¹æ³•ã€‚</p>
<pre><code class="java">/**
 * Interface definition for a callback to be invoked when a view is clicked.
 */
public interface OnClickListener {
    /**
     * Called when a view has been clicked.
     *
     * @param v The view that was clicked.
     */
    void onClick(View v);
}
</code></pre>
<p>åƒè¿™ç§åªæœ‰ä¸€ä¸ªå¾…å®ç°æ–¹æ³•çš„æ¥å£ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œç®€åŒ–ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ¥å£ï¼Œç„¶åç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œå®ç°ã€‚</p>
<h3 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h3><p>æœ‰æ—¶ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼ŒLambdaè¡¨è¾¾å¼ä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼Œä»…ä»…æ˜¯è°ƒç”¨äº†å·²ç»å­˜åœ¨çš„æ–¹æ³•ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç å°±èƒ½è¿›ä¸€æ­¥ç²¾ç®€äº†ã€‚</p>
<pre><code>fab.setOnClickListener( view2 -&gt; showSnackBar(view2));

private void showSnackBar(View view) {
        Snackbar.make(view, &quot;blah, blah&quot;, Snackbar.LENGTH_SHORT).show();
}
</code></pre><p>ä½¿ç”¨æ–¹æ³•å¼•ç”¨ä¹‹åï¼š</p>
<pre><code>fab.setOnClickListener(this::showSnackBar);
</code></pre><h3 id="ä¸Šä¸‹æ–‡æ¨æ–­"><a href="#ä¸Šä¸‹æ–‡æ¨æ–­" class="headerlink" title="ä¸Šä¸‹æ–‡æ¨æ–­"></a>ä¸Šä¸‹æ–‡æ¨æ–­</h3><p>ä¸‹é¢æ¥å®ç°ä¸€äº›ä¾‹å­æ¥äº†è§£Lambdaçš„ä¸Šä¸‹æ–‡æ¨æ–­ã€‚</p>
<pre><code class="java">public interface TestOp {
   String operate (String s, int i);
}

// ä½¿ç”¨Lambdaè¡¨è¾¾å¼è¿›è¡Œå®ç°
// é€šè¿‡ä¸Šä¸‹æ–‡ï¼Œlambdaè¡¨è¾¾å¼å¯ä»¥æ¨æ–­å‡ºsä¸ºStringç±»å‹ï¼Œè€Œiä¸ºintç±»å‹
// è¿”å›å€¼ä¸ºString
TestOp myOp = (s,i) -&gt; s + i;
</code></pre>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Lambdaè¡¨è¾¾å¼ä½¿ç”¨è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œèƒ½å¤Ÿå‡å°‘ç¼–å†™å’Œç»´æŠ¤çš„ä»£ç æ•°é‡ã€‚ä½†æ˜¯ï¼Œè¿™ç§æç®€ä¸»ä¹‰çš„å†™æ³•ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½æ¥å—çš„ã€‚å¯¹äºæˆ‘è€Œè¨€ï¼ŒæŠ€å¤šä¸å‹èº«ï¼Œå­¦ä¹ ä¸€ä¸‹ï¼Œæé«˜å§¿åŠ¿è¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[æå‡ä½“éªŒ-Chrome Custom Tabs]]></title>
      <url>http://tonnyl.github.io/2017/01/05/%E6%8F%90%E5%8D%87%E4%BD%93%E9%AA%8C-Chrome-Custom-Tabs/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨Chrome Custom TabsåŠ è½½ç½‘é¡µå¯ä»¥æœ‰æ•ˆçš„æå‡ç”¨æˆ·çš„ä½“éªŒ<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ–‡ç« æ¯”è¾ƒé•¿ï¼Œå…ˆæ”¾é¡¹ç›®åœ°å€:<a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">PaperPlane</a></p>
<p>ä¿—è¯è¯´ï¼Œæ²¡å›¾è¯´ä¸ªé‚£å•¥ï¼Œå…ˆçœ‹å®é™…æ•ˆæœã€‚<br><img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/telegram.gif" alt="telegram" title="telegram"><br><img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/paper_plane.gif" alt="paper plane" title="paper plane"></p>
<h3 id="ä»€ä¹ˆæ˜¯Custom-Tabs"><a href="#ä»€ä¹ˆæ˜¯Custom-Tabs" class="headerlink" title="ä»€ä¹ˆæ˜¯Custom Tabs?"></a>ä»€ä¹ˆæ˜¯Custom Tabs?</h3><p>æ‰€æœ‰çš„APPå¼€å‘è€…éƒ½é¢ä¸´è¿™æ ·ä¸€ä¸ªé€‰æ‹©ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªURLæ—¶ï¼Œæ˜¯åº”è¯¥ç”¨æµè§ˆå™¨æ‰“å¼€è¿˜æ˜¯åº”è¯¥ç”¨åº”ç”¨å†…ç½®çš„WebViewæ‰“å¼€å‘¢ï¼Ÿ</p>
<p>ä¸¤ä¸ªé€‰é¡¹éƒ½é¢ä¸´ç€ä¸€äº›é—®é¢˜ã€‚é€šè¿‡æµè§ˆå™¨æ‰“å¼€æ˜¯ä¸€ä¸ªéå¸¸é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¹¶ä¸”æ˜¯æ— æ³•å®šåˆ¶çš„ã€‚è€ŒWebViewä¸èƒ½å’Œæµè§ˆå™¨å…±äº«æ•°æ®å¹¶ä¸”éœ€è¦éœ€è¦æ‰‹åŠ¨å»å¤„ç†æ›´å¤šçš„åœºæ™¯ã€‚</p>
<p>Chrome Custom Tabsè®©APPåœ¨è¿›è¡Œç½‘é¡µæµè§ˆæ—¶æ›´å¤šçš„æ§åˆ¶æƒé™ï¼Œåœ¨ä¸é‡‡ç”¨WebViewçš„æƒ…å†µä¸‹ï¼Œè¿™æ—¢èƒ½ä¿è¯Native APPå’Œç½‘é¡µä¹‹é—´æµç•…çš„åˆ‡æ¢ï¼Œåˆå…è®¸APPå®šåˆ¶Chromeçš„å¤–è§‚å’Œæ“ä½œã€‚å¯å®šä¹‰çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>toolbarçš„é¢œè‰²</li>
<li>è¿›åœºå’Œé€€åœºåŠ¨ç”»</li>
<li>ç»™Chromeçš„toolbarã€overflow menuå’Œbottom toolbaræ·»åŠ è‡ªå®šä¹‰æ“ä½œ</li>
</ul>
<p>å¹¶ä¸”ï¼ŒChrome Custom Tabså…è®¸å¼€å‘è€…å¯¹Chromeè¿›è¡Œé¢„å¯åŠ¨å’Œç½‘é¡µå†…å®¹çš„é¢„åŠ è½½ï¼Œä»¥æ­¤æå‡åŠ è½½çš„é€Ÿåº¦ã€‚<br><img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/performance.gif" alt="preformance" title="preformance"></p>
<h3 id="Chrome-Custom-Tabs-VS-WebView-æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ"><a href="#Chrome-Custom-Tabs-VS-WebView-æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ" class="headerlink" title="Chrome Custom Tabs VS WebView, æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ"></a>Chrome Custom Tabs VS WebView, æˆ‘åº”è¯¥ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</h3><p>å¦‚æœé¡µé¢çš„å†…å®¹æ˜¯ç”±æˆ‘ä»¬è‡ªå·±æ§åˆ¶çš„ï¼Œå¯ä»¥å’ŒAndroidç»„ä»¶è¿›è¡Œäº¤äº’ï¼Œé‚£ä¹ˆ,WebViewæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Œå¦‚æœæˆ‘ä»¬çš„åº”ç”¨éœ€è¦æ‰“å¼€å¤–éƒ¨çš„ç½‘ç«™ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨Chrome Custom Tabsï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¼å…¥éå¸¸ç®€å•ã€‚ä¸éœ€è¦ç¼–å†™é¢å¤–çš„ä»£ç æ¥ç®¡ç†è¯·æ±‚ï¼Œæˆäºˆæƒé™æˆ–è€…å­˜å‚¨cookie</li>
<li>å®šåˆ¶UIï¼š<ul>
<li>Toolbar é¢œè‰²</li>
<li>åŠ¨ä½œæŒ‰é’® (Action Button)</li>
<li>å®šåˆ¶èœå•é¡¹</li>
<li>å®šåˆ¶è¿›åœºé€€åœºåŠ¨ç”»</li>
<li>Bottom Toolbar</li>
</ul>
</li>
<li>å¯¼èˆªæ„ŸçŸ¥ï¼šæµè§ˆå™¨é€šçŸ¥å›è°ƒæ¥å£é€šçŸ¥åº”ç”¨ç½‘é¡µçš„å¯¼èˆªæƒ…å†µ</li>
<li>å®‰å…¨æ€§ï¼šæµè§ˆå™¨ä½¿ç”¨äº†Googleâ€™s Safe Browsingï¼Œç”¨äºä¿æŠ¤ç”¨æˆ·å’Œè®¾å¤‡å…å—å±é™©ç½‘ç«™çš„ä¾µå®³</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼š<ul>
<li>æµè§ˆå™¨ä¼šåœ¨åå°è¿›è¡Œé¢„çƒ­ï¼Œé¿å…äº†åº”ç”¨å ç”¨å¤§é‡èµ„æºçš„æƒ…å†µ</li>
<li>æå‰å‘æµè§ˆå™¨å‘é€å¯èƒ½çš„URLï¼Œæé«˜äº†é¡µé¢åŠ è½½é€Ÿåº¦</li>
</ul>
</li>
<li>ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šåœ¨ç”¨æˆ·ä¸Custom Tabsè¿›è¡Œäº¤äº’æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†åº”ç”¨æ ‡ç¤ºä¸ºå‰å°åº”ç”¨ï¼Œé¿å…äº†åº”ç”¨è¢«ç³»ç»Ÿæ‰€å›æ”¶</li>
<li>å…±äº«cookieæ•°æ®å’Œæƒé™ï¼Œè¿™æ ·ï¼Œç”¨æˆ·åœ¨å·²ç»æˆæƒè¿‡çš„ç½‘ç«™ï¼Œå°±ä¸éœ€è¦é‡æ–°ç™»å½•æˆ–è€…æˆæƒæƒé™äº†</li>
<li>å¦‚æœç”¨æˆ·å¼€å¯äº†æ•°æ®èŠ‚çœåŠŸèƒ½ï¼Œåœ¨è¿™é‡Œä»ç„¶å¯ä»¥ä»ä¸­å—ç›Š</li>
<li>åŒæ­¥çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</li>
<li>ä»…ä»…éœ€è¦ç‚¹å‡»ä¸€ä¸‹å·¦ä¸Šè§’æŒ‰é’®å°±å¯ä»¥ç›´æ¥è¿”å›åŸåº”ç”¨</li>
<li>æƒ³è¦åœ¨Lollipopä¹‹å‰çš„è®¾å¤‡ä¸Šæœ€æ–°å¼•å…¥çš„æµè§ˆå™¨(Auto updating WebView),è€Œä¸æ˜¯æ—§ç‰ˆæœ¬çš„WebView</li>
</ul>
<h3 id="ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™å¯ç”¨ï¼Ÿ</h3><p>ä»Chrome 45ç‰ˆæœ¬å¼€å§‹ï¼Œæ‰€æœ‰çš„Chromeç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ï¼Œç›®å‰ä»…æ”¯æŒAndroidç³»ç»Ÿã€‚</p>
<h3 id="å¼€å‘æŒ‡å—"><a href="#å¼€å‘æŒ‡å—" class="headerlink" title="å¼€å‘æŒ‡å—"></a>å¼€å‘æŒ‡å—</h3><p>å®Œæ•´çš„ç¤ºä¾‹å¯ä»¥æŸ¥çœ‹<a href="https://github.com/GoogleChrome/custom-tabs-client" target="_blank" rel="external">https://github.com/GoogleChrome/custom-tabs-client</a>ã€‚åŒ…å«äº†å®šåˆ¶UIã€è¿æ¥åå°æœåŠ¡ã€å¤„ç†åº”ç”¨å’ŒCustom Tab Activityç”Ÿå‘½å‘¨æœŸçš„å¯å¤ç”¨çš„ç±»ã€‚</p>
<p>ç¬¬ä¸€æ­¥å½“ç„¶æ˜¯å°†<a href="http://developer.android.com/tools/support-library/features.html#custom-tabs" target="_blank" rel="external"> Custom Tabs Support Library </a>æ·»åŠ åˆ°å·¥ç¨‹ä¸­æ¥ã€‚æ‰“å¼€<code>build.gradle</code>æ–‡ä»¶ï¼Œæ·»åŠ support libraryçš„ä¾èµ–ã€‚</p>
<pre><code>dependencies {
    ...
    compile &#39;com.android.support:customtabs:23.3.0&#39;
}
</code></pre><p>ä¸€æ—¦Support Libraryæ·»åŠ é¡¹ç›®æˆåŠŸäº†ï¼Œæˆ‘ä»¬å°±æœ‰ä¸¤ç§å¯èƒ½çš„å®šåˆ¶æ“ä½œäº†ï¼š</p>
<ul>
<li>å®šåˆ¶UIå’Œä¸Chrome Custom Tabsçš„äº¤äº’</li>
<li>ä½¿é¡µé¢åŠ è½½æ›´å¿«é€Ÿï¼Œä¿æŒåº”ç”¨æ¿€æ´»</li>
</ul>
<p>UIçš„å®šåˆ¶æ˜¯é€šè¿‡ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html" target="_blank" rel="external"> CustomTabsIntent </a>å’Œ<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html" target="_blank" rel="external"> CustomTabsIntent.Builder</a>ç±»å®Œæˆçš„ï¼›è€Œé€Ÿåº¦çš„æå‡åˆ™æ˜¯é€šè¿‡ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html" target="_blank" rel="external"> CustomTabsClient </a>é“¾æ¥Custom TabsæœåŠ¡ï¼Œé¢„çƒ­Chromeå’Œè®©ChromeçŸ¥æ™“å°†è¦æ‰“å¼€çš„URLå®ç°çš„ã€‚</p>
<h4 id="æ‰“å¼€ä¸€ä¸ªChrome-Custom-Tab"><a href="#æ‰“å¼€ä¸€ä¸ªChrome-Custom-Tab" class="headerlink" title="æ‰“å¼€ä¸€ä¸ªChrome Custom Tab"></a>æ‰“å¼€ä¸€ä¸ªChrome Custom Tab</h4><pre><code class="java">// ä½¿ç”¨CustomTabsIntent.Builderé…ç½®CustomTabsIntent
// å‡†å¤‡å®Œæˆåï¼Œè°ƒç”¨CustomTabsIntent.Builder.build()æ–¹æ³•åˆ›å»ºä¸€ä¸ªCustomTabsIntent
// å¹¶é€šè¿‡CustomTabsIntent.launchUrl()æ–¹æ³•åŠ è½½å¸Œæœ›åŠ è½½çš„url

String url = Â¨https://github.com/TonnyLÂ¨;
CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder();
CustomTabsIntent customTabsIntent = builder.build();
customTabsIntent.launchUrl(this, Uri.parse(url));
</code></pre>
<h4 id="é…ç½®åœ°å€æ çš„é¢œè‰²"><a href="#é…ç½®åœ°å€æ çš„é¢œè‰²" class="headerlink" title="é…ç½®åœ°å€æ çš„é¢œè‰²"></a>é…ç½®åœ°å€æ çš„é¢œè‰²</h4><p>Chrome Custom Tabsä¸€ä¸ªå¾ˆé‡è¦çš„åŠŸèƒ½å°±æ˜¯æˆ‘ä»¬èƒ½å¤Ÿæ”¹å˜åœ°å€æ çš„é¢œè‰²ï¼Œä½¿ä¹‹å’Œæˆ‘ä»¬åº”ç”¨çš„é¢œè‰²åè°ƒã€‚</p>
<pre><code class="java">// æ”¹å˜toolbarçš„èƒŒæ™¯è‰²ã€‚colorIntå°±æ˜¯æƒ³è¦æŒ‡å®šçš„intå€¼

builder.setToolbarColor(colorInt);
</code></pre>
<h4 id="é…ç½®å®šåˆ¶åŒ–çš„action-button"><a href="#é…ç½®å®šåˆ¶åŒ–çš„action-button" class="headerlink" title="é…ç½®å®šåˆ¶åŒ–çš„action button"></a>é…ç½®å®šåˆ¶åŒ–çš„action button</h4><p>ä½œä¸ºåº”ç”¨çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬å¯¹å‘ˆç°åœ¨ç”¨æˆ·çœ¼å‰çš„Chrome Custom Tabå†…çš„Action Buttonæ‹¥æœ‰å®Œå…¨çš„æ§åˆ¶æƒã€‚</p>
<p>åœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·ä¼šæ‰§è¡Œæœ€åŸºç¡€çš„æ“ä½œåƒåˆ†äº«ï¼Œæˆ–è€…æ˜¯å…¶ä»–å…¬å…±çš„Activityã€‚</p>
<p>Action Buttonè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªaction buttonçš„å›¾æ ‡å’Œç”¨æˆ·ç‚¹å‡»action buttonä¹‹åChromeå°†è¦æ‰§è¡Œçš„pendingIntentã€‚å›¾æ ‡çš„é«˜åº¦ä¸€èˆ¬ä¸º24dpï¼Œå®½åº¦ä¸€èˆ¬ä¸º24-48dpã€‚</p>
<img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/tumblr_action.png" alt="actions" title="actions">
<pre><code class="java">// å‘toolbaræ·»åŠ ä¸€ä¸ªAction Button
// â€˜iconâ€™æ˜¯ä¸€å¼ ä½å›¾(Bitmap)ï¼Œä½œä¸ºaction buttonçš„å›¾ç‰‡èµ„æºä½¿ç”¨

// &#39;description&#39;æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½œä¸ºæŒ‰é’®çš„æ— éšœç¢æè¿°æ‰€ä½¿ç”¨

// &#39;pendingIntent&#39; æ˜¯ä¸€ä¸ªPendingIntentï¼Œå½“action buttonæˆ–è€…èœå•é¡¹è¢«ç‚¹å‡»æ—¶è°ƒç”¨ã€‚
// åœ¨urlä½œä¸ºdataè¢«æ·»åŠ ä¹‹åï¼ŒChrome ä¼šè°ƒç”¨PendingIntent#send()æ–¹æ³•ã€‚
// å®¢æˆ·ç«¯åº”ç”¨ä¼šé€šè¿‡è°ƒç”¨Intent#getDataString()è·å–åˆ°URL

// &#39;tint&#39;æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå®šä¹‰äº†Action Buttonæ˜¯å¦åº”è¯¥è¢«ç€è‰²

builder.setActionButton(icon, description, pendingIntent, tint);
</code></pre>
<h4 id="é…ç½®å®šåˆ¶åŒ–èœå•"><a href="#é…ç½®å®šåˆ¶åŒ–èœå•" class="headerlink" title="é…ç½®å®šåˆ¶åŒ–èœå•"></a>é…ç½®å®šåˆ¶åŒ–èœå•</h4><p>Chromeæµè§ˆå™¨æ‹¥æœ‰éå¸¸å…¨é¢çš„actionèœå•ï¼Œç”¨æˆ·åœ¨æµè§ˆå™¨å†…æ“ä½œéå¸¸é¡ºç•…ã€‚ç„¶è€Œï¼Œå¯¹äºæˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ï¼Œå¯èƒ½å°±ä¸é€‚åˆäº†ã€‚</p>
<p>Chrome Custom Tabsé¡¶éƒ¨æœ‰ä¸‰ä¸ªæ¨ªå‘æ’åˆ—çš„å›¾æ ‡ï¼Œåˆ†åˆ«æ˜¯â€œå‰è¿›â€ã€â€é¡µé¢ä¿¡æ¯â€å’Œâ€åˆ·æ–°â€œã€‚åœ¨èœå•çš„åº•éƒ¨åˆ†åˆ«æ˜¯â€æŸ¥æ‰¾é¡µé¢â€å’Œâ€œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€â€ã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬æœ€å¤šå¯ä»¥åœ¨é¡¶éƒ¨æ¨ªå‘å›¾æ ‡å’Œåº•éƒ¨èœå•ä¹‹é—´æ·»åŠ 5ä¸ªè‡ªå®šä¹‰èœå•é€‰é¡¹ã€‚</p>
<p>èœå•é¡¹é€šè¿‡è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html#addMenuItem(java.lang.String, android.app.PendingIntent" target="_blank" rel="external">CustomTabsIntent.Builder#addMenuItem</a>)æ·»åŠ ï¼Œtitleå’Œç”¨æˆ·ç‚¹å‡»èœå•é€‰é¡¹åChromeè°ƒç”¨çš„pendingIntentéœ€è¦ä½œä¸ºå‚æ•°è¢«ä¼ å…¥ã€‚</p>
<img src="/2017/01/05/æå‡ä½“éªŒ-Chrome-Custom-Tabs/twitter_menu.png" alt="menu" title="menu">
<pre><code class="java">builder.addMenuItem(menuItemTitle, menuItemPendingIntent);
</code></pre>
<h4 id="é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»"><a href="#é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»" class="headerlink" title="é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»"></a>é…ç½®è¿›åœºå’Œé€€åœºåŠ¨ç”»</h4><p>è®¸å¤šçš„Androidéƒ½ä¼šåœ¨Activityä¹‹é—´åˆ‡æ¢æ—¶ä½¿ç”¨è‡ªå®šä¹‰çš„è§†å›¾è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»ã€‚Chrome Custom Tabsä¹Ÿä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»ï¼Œä»¥æ­¤ä¿æŒChrome Custom Tabså’Œåº”ç”¨å…¶ä»–å†…å®¹çš„åè°ƒæ€§å’Œä¸€è‡´æ€§ã€‚</p>
<pre><code class="java">builder.setStartAnimations(this, R.anim.slide_in_right, R.anim.slide_out_left);
builder.setExitAnimations(this, R.anim.slide_in_left, R.anim.slide_out_right);
</code></pre>
<h4 id="é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦"><a href="#é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦" class="headerlink" title="é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦"></a>é¢„çƒ­Chromeï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html#launchUrl(android.app.Activity, android.net.Uri" target="_blank" rel="external"> CustomTabsIntent#launchUrl </a>)è¢«è°ƒç”¨æ—¶ä¼šæ¿€æ´»Chromeï¼ŒåŠ è½½URLã€‚è¿™ä¼šèŠ±è´¹æˆ‘ä»¬å®è´µçš„æ—¶é—´å¹¶ä¸”å½±å“æµç•…åº¦ã€‚</p>
<p>Chromeå›¢é˜Ÿäº†è§£ç”¨æˆ·å¯¹äºæµç•…ä½“éªŒçš„æ¸´æœ›ï¼Œæ‰€ä»¥ä»–ä»¬åœ¨Chromeä¸­æä¾›äº†ä¸€ä¸ªServiceä½¿æˆ‘ä»¬çš„APPèƒ½å¤Ÿè¿æ¥å¹¶ä¸”é¢„çƒ­æµè§ˆå™¨å’ŒåŸç”Ÿç»„ä»¶ã€‚ä»–ä»¬ä¹ŸæŠŠè¿™ç§èƒ½åŠ›åˆ†äº«ç»™äº†æˆ‘ä»¬æ™®é€šå¼€å‘è€…ï¼Œå¼€å‘è€…èƒ½å¤Ÿå‘ŠçŸ¥Chromeç”¨æˆ·è®¿é—®é¡µé¢çš„å¯èƒ½æ€§ã€‚ç„¶åï¼ŒChromeå°±èƒ½å®Œæˆå¦‚ä¸‹çš„æ“ä½œï¼š</p>
<ul>
<li>ä¸»åŸŸåçš„DNSé¢„è§£æ</li>
<li>æœ€æœ‰å¯èƒ½åŠ è½½çš„èµ„æºçš„DNSé¢„è§£æ</li>
<li>åŒ…æ‹¬HTTPS/TLSéªŒè¯åœ¨å†…çš„é¢„è¿æ¥</li>
</ul>
<p>é¢„çƒ­Chromeçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService(android.content.Context, java.lang.String, android.support.customtabs.CustomTabsServiceConnection" target="_blank" rel="external">CustomTabsClient#bindCustomTabsService</a>)è¿æ¥service</li>
<li>ä¸€æ—¦serviceè¿æ¥æˆåŠŸï¼Œåå°è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup(long" target="_blank" rel="external"> CustomTabsClient#warmup</a>)å¯åŠ¨Chrome</li>
<li>è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#newSession(android.support.customtabs.CustomTabsCallback" target="_blank" rel="external"> CustomTabsClient#newSession </a>)åˆ›å»ºä¸€ä¸ªæ–°çš„session.è¿™ä¸ªsessionè¢«ç”¨ä½œæ‰€æœ‰çš„APIè¯·æ±‚</li>
<li>æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºsessionæ—¶é€‰æ‹©æ€§çš„æ·»åŠ ä¸€ä¸ª<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsCallback.html" target="_blank" rel="external"> CustomTabsCallback</a>ä½œä¸ºå‚æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½çŸ¥é“é¡µé¢æ˜¯å¦è¢«åŠ è½½å®Œæˆ</li>
<li>é€šè¿‡<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl(android.net.Uri, android.os.Bundle, java.util.List&lt;android.os.Bundle" target="_blank" rel="external"> CustomTabsSession#mayLaunchUrl</a>)å‘ŠçŸ¥Chromeç”¨æˆ·æœ€æœ‰å¯èƒ½åŠ è½½çš„é¡µé¢</li>
<li>è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.Builder.html" target="_blank" rel="external"> CustomTabsIntent.Builder </a>æ„é€ æ–¹æ³•ï¼Œå¹¶ä¼ å…¥å·²ç»åˆ›å»ºå¥½çš„<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html" target="_blank" rel="external">CustomTabsSession</a>ä½œä¸ºå‚æ•°ä¼ å…¥</li>
</ul>
<h4 id="è¿æ¥ChromeæœåŠ¡"><a href="#è¿æ¥ChromeæœåŠ¡" class="headerlink" title="è¿æ¥ChromeæœåŠ¡"></a>è¿æ¥ChromeæœåŠ¡</h4><p><a href="("> CustomTabsClient#bindCustomTabsService </a><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService(android.content.Context" target="_blank" rel="external">http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#bindCustomTabsService(android.content.Context</a>, java.lang.String, android.support.customtabs.CustomTabsServiceConnectio)) æ–¹æ³•ç®€åŒ–äº†è¿æ¥Custom TabsæœåŠ¡çš„è¿‡ç¨‹ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsServiceConnection.html" target="_blank" rel="external">CustomTabsServiceConnection</a>çš„ç±»å¹¶ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsServiceConnection.html#onCustomTabsServiceConnected(android.content.ComponentName, android.support.customtabs.CustomTabsClient" target="_blank" rel="external">onCustomTabsServiceConnected </a>)æ–¹æ³•è·å–<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html" target="_blank" rel="external"> CustomTabsClient</a>çš„å®ä¾‹ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ä¼šç”¨åˆ°æ­¤å®ä¾‹ï¼š</p>
<pre><code class="java">// å®˜æ–¹ç¤ºä¾‹
// å®¢æˆ·ç«¯éœ€è¦è¿æ¥çš„Chromeçš„åŒ…åï¼Œå–å†³äºchannelçš„åç§°
// Stable(å‘è¡Œç‰ˆ) = com.android.chrome
// Beta(æµ‹è¯•ç‰ˆ) = com.chrome.beta
// Dev(å¼€å‘ç‰ˆ) = com.chrome.dev
public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.android.chrome&quot;;  // Change when in stable

CustomTabsServiceConnection connection = new CustomTabsServiceConnection() {
    @Override
    public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {
        mCustomTabsClient = client;
    }

    @Override
    public void onServiceDisconnected(ComponentName name) {

    }
};
boolean ok = CustomTabsClient.bindCustomTabsService(this, mPackageNameToBind, connection);
</code></pre>
<pre><code class="java">// æˆ‘çš„ç¤ºä¾‹
package com.marktony.zhihudaily.customtabs;

import android.support.customtabs.CustomTabsServiceConnection;
import android.content.ComponentName;
import android.support.customtabs.CustomTabsClient;

import java.lang.ref.WeakReference;

/**
 * Created by Lizhaotailang on 2016/9/4.
 * Implementation for the CustomTabsServiceConnection that avoids leaking the
 * ServiceConnectionCallback
 */

public class ServiceConnection extends CustomTabsServiceConnection {

    // A weak reference to the ServiceConnectionCallback to avoid leaking it.
    private WeakReference&lt;ServiceConnectionCallback&gt; mConnectionCallback;

    public ServiceConnection(ServiceConnectionCallback connectionCallback) {
        mConnectionCallback = new WeakReference&lt;&gt;(connectionCallback);
    }

    @Override
    public void onCustomTabsServiceConnected(ComponentName name, CustomTabsClient client) {
        ServiceConnectionCallback connectionCallback = mConnectionCallback.get();
        if (connectionCallback != null) connectionCallback.onServiceConnected(client);
    }

    @Override
    public void onServiceDisconnected(ComponentName name) {
        ServiceConnectionCallback connectionCallback = mConnectionCallback.get();
        if (connectionCallback != null) connectionCallback.onServiceDisconnected();
    }

}
</code></pre>
<h4 id="é¢„çƒ­æµè§ˆå™¨"><a href="#é¢„çƒ­æµè§ˆå™¨" class="headerlink" title="é¢„çƒ­æµè§ˆå™¨"></a>é¢„çƒ­æµè§ˆå™¨</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup(long" target="_blank" rel="external">boolean warmup(long flags)</a>)</p>
<p>é¢„çƒ­æµè§ˆå™¨è¿›ç¨‹å¹¶åŠ é‡åŸç”Ÿåº“æ–‡ä»¶ã€‚é¢„çƒ­æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œè¿”å›å€¼è¡¨ç¤ºè¯·æ±‚æ˜¯å¦è¢«æ¥æ”¶ã€‚å¤šä¸ªæˆåŠŸçš„è¯·æ±‚éƒ½ä¼šè¿”å›trueã€‚</p>
<p><code>true</code>ä»£è¡¨ç€æˆåŠŸã€‚</p>
<h4 id="åˆ›å»ºæ–°çš„tab-sessioin"><a href="#åˆ›å»ºæ–°çš„tab-sessioin" class="headerlink" title="åˆ›å»ºæ–°çš„tab sessioin"></a>åˆ›å»ºæ–°çš„tab sessioin</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#newSession(android.support.customtabs.CustomTabsCallback" target="_blank" rel="external">boolean newSession(CustomTabsCallback callback)</a>)</p>
<p>sessionç”¨äºåœ¨è¿ç»­è¯·æ±‚ä¸­é“¾æ¥mayLaunchUrlæ–¹æ³•ã€‚CustomTabsIntentå’Œtabäº’ç›¸è”ç³»ã€‚è¿™é‡Œæ‰€æä¾›çš„å›è°ƒå’Œå·²ç»åˆ›å»ºæˆåŠŸçš„sessionç›¸å…³ã€‚é€šè¿‡è¿™ä¸ªå›è°ƒï¼Œä»»ä½•å…³äºå·²ç»æˆåŠŸåˆ›å»ºçš„sessionçš„æ›´æ–°éƒ½ä¼šè¢«æ¥æ”¶åˆ°ã€‚è¿”å›sessionæ˜¯å¦è¢«æˆåŠŸåˆ›å»ºã€‚å¤šä¸ªå…·æœ‰ç›¸åŒCustomTabsCallbackæˆ–è€…nullå€¼çš„è¯·æ±‚éƒ½ä¼šè¿”å›falseã€‚</p>
<h4 id="å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥"><a href="#å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥" class="headerlink" title="å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥"></a>å‘ŠçŸ¥Chromeç”¨æˆ·å¯èƒ½æ‰“å¼€çš„é“¾æ¥</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl(android.net.Uri, android.os.Bundle, java.util.List&lt;android.os.Bundle" target="_blank" rel="external">boolean mayLaunchUrl(Uri url, Bundle extras, List otherLikelyBundles)</a>)</p>
<p>CustomTabsSessionæ–¹æ³•å‘ŠçŸ¥æµè§ˆå™¨æœªæ¥å¯èƒ½å¯¼èˆªåˆ°çš„urlã€‚<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup(long" target="_blank" rel="external">warmup()</a>)æ–¹æ³•åº”è¯¥å…ˆè¢«è°ƒç”¨ã€‚æœ€æœ‰å¯èƒ½çš„urlåº”è¯¥æœ€å…ˆè¢«æŒ‡å‡ºã€‚ä¹Ÿå¯ä»¥é€‰æ‹©æ€§çš„æä¾›å¯èƒ½åŠ è½½çš„urlçš„åˆ—è¡¨ã€‚åˆ—è¡¨ä¸­çš„æ•°æ®è¢«è®¤ä¸ºè¢«åŠ è½½çš„å¯èƒ½æ€§å°äºæœ€åˆçš„é‚£ä¸€ä¸ªï¼Œè€Œä¸”å¿…é¡»æŒ‰ç…§ä¼˜å…ˆçº§é™åºæ’åˆ—ã€‚è¿™äº›é¢å¤–çš„urlå¯èƒ½è¢«å¿½ç•¥æ‰ã€‚æ‰€æœ‰ä¹‹å‰å¯¹äºè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè¢«å»ä¼˜å…ˆåŒ–ã€‚è¿”å›æ“ä½œæ˜¯å¦æˆåŠŸå®Œæˆã€‚</p>
<h4 id="Custom-Tabsè¿æ¥å›è°ƒ"><a href="#Custom-Tabsè¿æ¥å›è°ƒ" class="headerlink" title="Custom Tabsè¿æ¥å›è°ƒ"></a>Custom Tabsè¿æ¥å›è°ƒ</h4><p><a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsCallback.html#onNavigationEvent(int, android.os.Bundle" target="_blank" rel="external">void onNavigationEvent(int navigationEvent, Bundle extras)</a>)</p>
<p>åœ¨custom tabä¸­ï¼Œå¯¼èˆªäº‹ä»¶å‘ç”Ÿæ—¶è¢«è°ƒç”¨ã€‚â€˜navigationEvent intâ€™æ˜¯å…³äºé¡µé¢å†…çš„6ä¸ªçŠ¶æ€å€¼ä¹‹ä¸€ã€‚6ä¸ªçŠ¶æ€å€¼å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="java">/**
* é¡µé¢å¼€å§‹åŠ è½½æ—¶è¢«å‘é€
*/
public static final int NAVIGATION_STARTED = 1;

/**
* é¡µé¢å®ŒæˆåŠ è½½æ—¶è¢«å‘é€
*/
public static final int NAVIGATION_FINISHED = 2;

/**
* ç”±äºé”™è¯¯tabä¸èƒ½å®ŒæˆåŠ è½½æ—¶è¢«å‘é€
*/
public static final int NAVIGATION_FAILED = 3;

/**
* åœ¨åŠ è½½å®Œæˆä¹‹å‰ï¼ŒåŠ è½½å› ä¸ºç”¨æˆ·åŠ¨ä½œä¾‹å¦‚ç‚¹å‡»äº†å¦å¤–ä¸€ä¸ªé“¾æ¥æˆ–è€…åˆ·æ–°é¡µé¢
* åŠ è½½è¢«ä¸­æ­¢æ—¶è¢«å‘é€
*/
public static final int NAVIGATION_ABORTED = 4;

/**
* tabçŠ¶æ€å˜ä¸ºå¯è§æ—¶å‘é€
*/
public static final int TAB_SHOWN = 5;

/**
* tabçŠ¶æ€å˜ä¸ºä¸å¯è§æ—¶å‘é€
*/
public static final int TAB_HIDDEN = 6;
</code></pre>
<h4 id="å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ"><a href="#å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ"></a>å¦‚æœç”¨æˆ·æ²¡æœ‰å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Chromeï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</h4><p>Custom Tabsé€šè¿‡å¸¦æœ‰key Extrasçš„ ACTION_VIEW Intentæ¥å®šåˆ¶UIã€‚è¿™å°±æ„å‘³ç€å°†è¦æ‰“å¼€çš„é¡µé¢ä¼šé€šè¿‡ç³»ç»Ÿæµè§ˆå™¨æˆ–è€…ç”¨æˆ·é»˜è®¤æµè§ˆå™¨æ‰“å¼€ã€‚</p>
<p>å¦‚æœç”¨æˆ·å·²ç»å®‰è£…äº†Chromeå¹¶ä¸”æ˜¯é»˜è®¤æµè§ˆå™¨ï¼Œå®ƒä¼šè‡ªåŠ¨çš„è·å–EXTRASçš„å€¼å¹¶æä¾›ä¸€ä¸ªå®šåˆ¶åŒ–çš„UIã€‚å…¶ä»–çš„æµè§ˆå™¨ä½¿ç”¨Intent extrasæä¾›ç›¸åŒçš„å®šåˆ¶UIä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ã€‚</p>
<h4 id="æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome-Custom-Tabs"><a href="#æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome-Custom-Tabs" class="headerlink" title="æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome Custom Tabs?"></a>æ€æ ·æ£€æµ‹Chromeæ˜¯å¦æ”¯æŒChrome Custom Tabs?</h4><p>æ‰€æœ‰æ”¯æŒChrome Custom Tabsçš„Chromeæµè§ˆå™¨éƒ½æš´éœ²äº†ä¸€ä¸ªserviceã€‚ä¸ºäº†æ£€æµ‹æ˜¯å¦æ”¯æŒChrome Custom Tabsï¼Œå¯ä»¥å°è¯•ç€ç»‘å®šserviceï¼Œå¦‚æœæˆåŠŸçš„è¯ï¼Œé‚£ä¹ˆCustoms Tabså¯ä»¥æˆåŠŸçš„ä½¿ç”¨ã€‚</p>
<h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><p>å¯ç”¨Chrome Custom Tabså,æˆ‘ä»¬çœ‹åˆ°äº†å„ç§ä¸åŒè´¨é‡ç•Œåˆ«çš„å®ç°æ•ˆæœã€‚è¿™é‡Œä»‹ç»ä¸€ç»„å®ç°ä¼˜ç§€é›†æˆçš„æœ€ä½³å®è·µã€‚</p>
<h4 id="è¿æ¥Custome-Tabs-Serviceå¹¶å‘èµ·é¢„çƒ­"><a href="#è¿æ¥Custome-Tabs-Serviceå¹¶å‘èµ·é¢„çƒ­" class="headerlink" title="è¿æ¥Custome Tabs Serviceå¹¶å‘èµ·é¢„çƒ­"></a>è¿æ¥Custome Tabs Serviceå¹¶å‘èµ·é¢„çƒ­</h4><p>è¿æ¥åˆ°Custom Tabs Serviceå¹¶é¢„åŠ è½½Chromeä¹‹åï¼Œé€šè¿‡Custom Tabsæ‰“å¼€é“¾æ¥ <strong>æœ€å¤šå¯ä»¥èŠ‚çœ700ms</strong> ã€‚</p>
<p>åœ¨æˆ‘ä»¬æ‰“ç®—å¯ç”¨Custom Tabsçš„Activityçš„ <a href="http://developer.android.com/reference/android/app/Activity.html#onStart(" target="_blank" rel="external">onStart()</a>) æ–¹æ³•ä¸­è¿æ¥ Custom Tabs serviceã€‚è¿æ¥æˆåŠŸåï¼Œè°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsClient.html#warmup%28long%29" target="_blank" rel="external">warmup()</a>æ–¹æ³•ã€‚</p>
<p>Custom Tabsä½œä¸ºä¸€ä¸ªéå¸¸ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ <strong>å®ƒä¸ä¼šå¯¹æˆ‘ä»¬çš„åº”ç”¨ä¸ä¼šæœ‰ä»»ä½•çš„è´Ÿé¢çš„å½±å“</strong>ï¼Œä½†æ˜¯å½“åŠ è½½é“¾æ¥æ—¶ï¼Œä¼šè·å¾—éå¸¸å¥½çš„å¯åŠ¨æ€§èƒ½ã€‚</p>
<h4 id="å†…å®¹é¢„æ¸²æŸ“"><a href="#å†…å®¹é¢„æ¸²æŸ“" class="headerlink" title="å†…å®¹é¢„æ¸²æŸ“"></a>å†…å®¹é¢„æ¸²æŸ“</h4><p>é¢„æ¸²æŸ“è®©å†…å®¹æ‰“å¼€éå¸¸è¿…é€Ÿã€‚æ‰€ä»¥ï¼Œå¦‚æœç”¨æˆ· <strong>è‡³å°‘æœ‰50%çš„å¯èƒ½æ€§</strong> æ‰“å¼€æŸä¸ªé“¾æ¥ï¼Œè°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl%28android.net.Uri,%20android.os.Bundle,%20java.util.List%3Candroid.os.Bundle%3E%29" target="_blank" rel="external">mayLaunchUrl()</a><br>æ–¹æ³•ã€‚</p>
<p>è°ƒç”¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsSession.html#mayLaunchUrl%28android.net.Uri,%20android.os.Bundle,%20java.util.List%3Candroid.os.Bundle%3E%29" target="_blank" rel="external">mayLaunchUrl()</a><br>æ–¹æ³•æ–¹æ³•èƒ½ä½¿Custom Tabsé¢„è·å–ä¸»é¡µé¢æ‰€æ”¯æŒçš„å†…å®¹å¹¶é¢„æ¸²æŸ“ã€‚è¿™ä¼šæœ€å¤§ç¨‹åº¦çš„åŠ å¿«é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€‚ä½†æ˜¯ä¼šä¸å¯é¿å…çš„æœ‰ <strong>ä¸€ç‚¹æµé‡å’Œç”µé‡çš„æ¶ˆè€—</strong>ã€‚</p>
<p>Custom Tabséå¸¸çš„æ™ºèƒ½ï¼Œèƒ½å¤Ÿæ„ŸçŸ¥ç”¨æˆ·æ˜¯å¦åœ¨ä½¿ç”¨æ”¶è´¹çš„ç½‘ç»œæˆ–è€…è®¾å¤‡ç”µé‡ä¸è¶³ï¼Œé¢„æ¸²æŸ“å¯¹è®¾å¤‡çš„æ•´ä½“æ€§èƒ½æœ‰è´Ÿé¢çš„å½±å“ï¼Œåœ¨è¿™æ ·çš„åœºæ™¯ä¸‹ï¼ŒCustom Tabså°±ä¸ä¼šè¿›è¡Œé¢„è·å–æˆ–è€…é¢„æ¸²æŸ“ã€‚æ‰€ä»¥ï¼Œä¸ç”¨æ‹…å¿ƒåº”ç”¨çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h4 id="å½“Custom-Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ"><a href="#å½“Custom-Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ" class="headerlink" title="å½“Custom Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ"></a>å½“Custom Tabsæ²¡æœ‰å®‰è£…æ—¶ï¼Œæä¾›å¤‡é€‰æ–¹æ¡ˆ</h4><p>å°½ç®¡Custom Tabså¯¹äºå¤§å¤šæ•°ç”¨æˆ·éƒ½æ˜¯é€‚ç”¨çš„ï¼Œä»ç„¶æœ‰ä¸€äº›åœºæ™¯ä¸é€‚ç”¨ï¼Œä¾‹å¦‚è®¾å¤‡ä¸Šæ²¡æœ‰å®‰è£…æ”¯æŒCustom Tabsçš„æµè§ˆå™¨æˆ–è€…æ˜¯è®¾å¤‡ä¸Šçš„æµè§ˆå™¨ç‰ˆæœ¬ä¸æ”¯æŒCustom Tabsã€‚</p>
<p><strong>ç¡®ä¿æä¾›äº†å¤‡é€‰æ–¹æ¡ˆä»¥æä¾›å¥½çš„åº”ç”¨ä½“éªŒ</strong>ã€‚æ‰“å¼€é»˜è®¤æµè§ˆå™¨æˆ–è€…å¼•å…¥WebViewéƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p>
<h4 id="å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer-å¼•èæ¥æº"><a href="#å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer-å¼•èæ¥æº" class="headerlink" title="å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer(å¼•èæ¥æº)"></a>å°†æˆ‘ä»¬çš„åº”ç”¨ä½œä¸ºreferrer(å¼•èæ¥æº)</h4><p>é€šå¸¸ï¼Œå¯¹äºç½‘ç«™è€Œè¨€ï¼Œè¿½ç”¨è®¿é—®çš„æ¥æºéå¸¸åœ°é‡è¦ã€‚å½“åŠ è½½äº†Custom Tabsæ—¶ï¼Œé€šè¿‡è®¾ç½®referrerï¼Œè®©ä»–ä»¬çŸ¥æ™“æˆ‘ä»¬æ­£åœ¨ç»™ä»–ä»¬æé«˜è®¿é—®é‡ã€‚</p>
<pre><code class="java">intent.putExtra(Intent.EXTRA_REFERRER,
        Uri.parse(Intent.URI_ANDROID_APP_SCHEME + &quot;//&quot; + context.getPackageName()));
</code></pre>
<h4 id="æ·»åŠ å®šåˆ¶åŠ¨ç”»"><a href="#æ·»åŠ å®šåˆ¶åŠ¨ç”»" class="headerlink" title="æ·»åŠ å®šåˆ¶åŠ¨ç”»"></a>æ·»åŠ å®šåˆ¶åŠ¨ç”»</h4><p>å®šåˆ¶çš„åŠ¨ç”»èƒ½å¤Ÿä½¿æˆ‘ä»¬çš„åº”ç”¨åˆ‡æ¢åˆ°ç½‘é¡µå†…å®¹æ—¶æ›´åŠ åœ°é¡ºç•…ã€‚ ç¡®ä¿è¿›åœºåŠ¨ç”»å’Œå‡ºå‚åŠ¨ç”»æ˜¯åå‘çš„ï¼Œè¿™æ ·èƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·ç†è§£è·³è½¬çš„å…³ç³»ã€‚</p>
<pre><code class="java">   //è®¾ç½®å®šåˆ¶çš„è¿›å…¥/é€€å‡ºåŠ¨ç”»
    CustomTabsIntent.Builder intentBuilder = new CustomTabsIntent.Builder();
    intentBuilder.setStartAnimations(this, R.anim.slide_in_right, R.anim.slide_out_left);
    intentBuilder.setExitAnimations(this, android.R.anim.slide_in_left,
        android.R.anim.slide_out_right);

    //æ‰“å¼€Custom Tab        
    intentBuilder.build().launchUrl(context, Uri.parse(&quot;https://github.com/TonnyL&quot;));
</code></pre>
<h4 id="ä¸ºAction-Buttoné€‰æ‹©ä¸€ä¸ªicon"><a href="#ä¸ºAction-Buttoné€‰æ‹©ä¸€ä¸ªicon" class="headerlink" title="ä¸ºAction Buttoné€‰æ‹©ä¸€ä¸ªicon"></a>ä¸ºAction Buttoné€‰æ‹©ä¸€ä¸ªicon</h4><p>æ·»åŠ ä¸€ä¸ªAction Buttonèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´åŠ ç†è§£APPçš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ²¡æœ‰å¥½çš„iconä»£è¡¨Action Buttonå°†è¦æ‰§è¡Œçš„æ“ä½œï¼Œæœ‰å¿…è¦åˆ›å»ºä¸€ä¸ªå¸¦æ“ä½œæ–‡å­—æè¿°çš„ä½å›¾ã€‚</p>
<p>ç‰¢è®°ä½å›¾çš„æœ€å¤§å°ºå¯¸ä¸ºé«˜åº¦24dpï¼Œå®½åº¦48dpã€‚</p>
<pre><code class="java">    String shareLabel = getString(R.string.label_action_share);
    Bitmap icon = BitmapFactory.decodeResource(getResources(),
            android.R.drawable.ic_menu_share);

    // ä¸ºæˆ‘ä»¬çš„BroadCastReceiveråˆ›å»ºä¸€ä¸ªPendingIntent
    Intent actionIntent = new Intent(
            this.getApplicationContext(), ShareBroadcastReceiver.class);
    PendingIntent pendingIntent =
            PendingIntent.getBroadcast(getApplicationContext(), 0, actionIntent, 0);            

     // è®¾ç½®pendingIntentä½œä¸ºæŒ‰é’®è¢«ç‚¹å‡»åå°†è¦æ‰§è¡Œçš„æ“ä½œ    
    intentBuilder.setActionButton(icon, shareLabel, pendingIntent);
</code></pre>
<h4 id="ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡"><a href="#ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡" class="headerlink" title="ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡"></a>ä¸ºå…¶ä»–æµè§ˆå™¨åšå‡†å¤‡</h4><p>ç‰¢è®°ç”¨æˆ·å®‰è£…çš„æµè§ˆå™¨ä¸­ï¼Œæ”¯æŒCustom Tabsçš„æ•°é‡å¯èƒ½ä¸æ­¢ä¸€ä¸ªã€‚å¦‚æœæœ‰ä¸æ­¢ä¸€ä¸ªæµè§ˆå™¨æ”¯æŒCustom Tabsï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•ä¸€ä¸ªæµè§ˆå™¨è¢«è®¾ç½®ä¸ºåå¥½æµè§ˆå™¨ï¼Œéœ€è¦è¯¢é—®ç”¨æˆ·å¦‚ä½•æ‰“å¼€é“¾æ¥</p>
<pre><code class="java">    /**
     * è¿”å›æ”¯æŒCustom Tabsçš„åº”ç”¨çš„åŒ…å
     */
    public static ArrayList getCustomTabsPackages(Context context) {
        PackageManager pm = context.getPackageManager();
        // Get default VIEW intent handler.
        Intent activityIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(&quot;http://www.example.com&quot;));

        // è·å–æ‰€æœ‰èƒ½å¤Ÿå¤„ç†VIEW intentsçš„åº”ç”¨
        List resolvedActivityList = pm.queryIntentActivities(activityIntent, 0);
        ArrayList packagesSupportingCustomTabs = new ArrayList&lt;&gt;();
        for (ResolveInfo info : resolvedActivityList) {
            Intent serviceIntent = new Intent();
            serviceIntent.setAction(ACTION_CUSTOM_TABS_CONNECTION);
            serviceIntent.setPackage(info.activityInfo.packageName);
            // Check if this package also resolves the Custom Tabs service.
            if (pm.resolveService(serviceIntent, 0) != null) {
                packagesSupportingCustomTabs.add(info);
            }
        }
        return packagesSupportingCustomTabs;
    }
</code></pre>
<h4 id="å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom-Tabs"><a href="#å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom-Tabs" class="headerlink" title="å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom Tabs"></a>å…è®¸ç”¨æˆ·ä¸ä½¿ç”¨Custom Tabs</h4><p>ä¸ºåº”ç”¨æ·»åŠ ä¸€ä¸ªè®¾ç½®é€‰é¡¹ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡é»˜è®¤æµè§ˆå™¨è€Œä¸æ˜¯Custom Tabæ‰“å¼€é“¾æ¥ã€‚å¦‚æœæˆ‘ä»¬çš„åº”ç”¨åœ¨æ·»åŠ Custom Tabsä¹‹å‰ï¼Œéƒ½æ˜¯é€šè¿‡é»˜è®¤æµè§ˆå™¨æ‰“å¼€é“¾æ¥æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p>
<h4 id="å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL"><a href="#å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL" class="headerlink" title="å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL"></a>å°½é‡è®©Nativeåº”ç”¨å¤„ç†URL</h4><p>Nativeåº”ç”¨å¯ä»¥å¤„ç†ä¸€äº›urlã€‚å¦‚æœç”¨æˆ·å®‰è£…äº†Twitter APPï¼Œåœ¨ç‚¹å‡»tweetå†…çš„é“¾æ¥æ—¶ï¼Œå¥¹æ›´åŠ å¸Œæœ›Twitteråº”ç”¨èƒ½å¤Ÿå¤„ç†è¿™äº›é“¾æ¥ã€‚</p>
<p>åœ¨åº”ç”¨å†…æ‰“å¼€é“¾æ¥ä¹‹å‰ï¼Œæ£€æŸ¥æ‰‹æœºé‡Œæœ‰æ²¡æœ‰å…¶ä»–APPèƒ½å¤Ÿå¤„ç†è¿™äº›urlã€‚</p>
<h4 id="å®šåˆ¶Toolbarçš„é¢œè‰²"><a href="#å®šåˆ¶Toolbarçš„é¢œè‰²" class="headerlink" title="å®šåˆ¶Toolbarçš„é¢œè‰²"></a>å®šåˆ¶Toolbarçš„é¢œè‰²</h4><p>å¦‚æœæƒ³è¦è®©ç”¨æˆ·æ„Ÿè§‰ç½‘é¡µå†…å®¹æ˜¯æˆ‘ä»¬åº”ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œå°†toolbarçš„é¢œè‰²è®¾ç½®ä¸ºprimaryColorã€‚</p>
<p>å¦‚æœæƒ³è¦è®©ç”¨æˆ·æ¸…æ¥šçš„äº†è§£åˆ°å·²ç»ç¦»å¼€äº†æˆ‘ä»¬çš„åº”ç”¨ï¼Œé‚£å°±å®Œå…¨ä¸è¦å®šä¹‰toolbarçš„é¢œè‰²ã€‚</p>
<pre><code class="java">    // è®¾ç½®è‡ªå®šä¹‰çš„toolbarçš„é¢œè‰²
    CustomTabsIntent.Builder intentBuilder = new CustomTabsIntent.Builder();
    intentBuilder.setToolbarColor(Color.BLUE);
</code></pre>
<h4 id="å¢åŠ åˆ†äº«æŒ‰é’®"><a href="#å¢åŠ åˆ†äº«æŒ‰é’®" class="headerlink" title="å¢åŠ åˆ†äº«æŒ‰é’®"></a>å¢åŠ åˆ†äº«æŒ‰é’®</h4><p>ç¡®ä¿åœ¨overflowèœå•ä¸­æ·»åŠ äº†ä¸€ä¸ªåˆ†äº«çš„æ“ä½œï¼Œåœ¨å¤§å¤šæ•°çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¸Œæœ›èƒ½å¤Ÿåˆ†äº«å½“å‰æ‰€è§ç½‘é¡µå†…å®¹çš„é“¾æ¥ï¼ŒCustom Tabsé»˜è®¤æ²¡æœ‰æ·»åŠ åˆ†äº«çš„æŒ‰é’®ã€‚</p>
<pre><code class="java">    // åœ¨BroadCastReceiverä¸­åˆ†äº«æ¥è‡ªCustomTabsçš„å†…å®¹
    public void onReceive(Context context, Intent intent) {
        String url = intent.getDataString();

        if (url != null) {
            Intent shareIntent = new Intent(Intent.ACTION_SEND);
            shareIntent.setType(&quot;text/plain&quot;);
            shareIntent.putExtra(Intent.EXTRA_TEXT, url);

            Intent chooserIntent = Intent.createChooser(shareIntent, &quot;Share url&quot;);
            chooserIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

            context.startActivity(chooserIntent);
        }
    }
</code></pre>
<h4 id="å®šåˆ¶å…³é—­æŒ‰é’®"><a href="#å®šåˆ¶å…³é—­æŒ‰é’®" class="headerlink" title="å®šåˆ¶å…³é—­æŒ‰é’®"></a>å®šåˆ¶å…³é—­æŒ‰é’®</h4><p>è‡ªå®šä¹‰å…³é—­æŒ‰é’®ä½¿CustomTabsçœ‹èµ·æ¥åƒåº”ç”¨çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>å¦‚æœå¸Œæœ›CustomTabsåœ¨ç”¨æˆ·çœ‹æ¥åƒä¸€ä¸ªDialog, ä½¿ç”¨â€™xâ€™(å‰å‰)æŒ‰é’®ã€‚å¦‚æœå¸Œæœ›Custom Tabæ˜¯ç”¨æˆ·çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨è¿”å›ç®­å¤´ã€‚</p>
<pre><code class="java">    //è®¾ç½®è‡ªå®šä¹‰çš„å…³é—­æŒ‰é’®
    CustomTabsIntent.Builder intentBuilder = new CustomTabsIntent.Builder();
    intentBuilder.setCloseButtonIcon(BitmapFactory.decodeResource(
        getResources(), R.drawable.ic_arrow_back));
</code></pre>
<h4 id="å¤„ç†å†…éƒ¨é“¾æ¥"><a href="#å¤„ç†å†…éƒ¨é“¾æ¥" class="headerlink" title="å¤„ç†å†…éƒ¨é“¾æ¥"></a>å¤„ç†å†…éƒ¨é“¾æ¥</h4><p>å½“ç›‘å¬åˆ°é“¾æ¥æ˜¯ç”±<a href="http://developer.android.com/reference/android/widget/TextView.html#attr_android:autoLink" target="_blank" rel="external">android:autoLink</a>ç”Ÿæˆçš„æˆ–è€…åœ¨WebViewä¸­å¤å†™äº†clickæ–¹æ³•ï¼Œç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨å¤„ç†äº†è¿™äº›å†…å®¹çš„é“¾æ¥ï¼Œè®©CustomTabså¤„ç†å¤–éƒ¨é“¾æ¥ã€‚</p>
<pre><code class="java">WebView webView = (WebView)findViewById(R.id.webview);
webView.setWebViewClient(new WebViewClient() {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        return true;
    }

    @Override
    public void onLoadResource(WebView view, String url) {
        if (url.startsWith(&quot;http://www.example.com&quot;)) {
            //Handle Internal Link...
        } else {
            //Open Link in a Custom Tab
            Uri uri = Uri.parse(url);
            CustomTabsIntent.Builder intentBuilder =
                    new CustomTabsIntent.Builder(mCustomTabActivityHelper.getSession());
           //Open the Custom Tab        
            intentBuilder.build().launchUrl(context, url));                            
        }
    }
});
</code></pre>
<h4 id="å¤„ç†è¿å‡»"><a href="#å¤„ç†è¿å‡»" class="headerlink" title="å¤„ç†è¿å‡»"></a>å¤„ç†è¿å‡»</h4><p>å¦‚æœå¸Œæœ›åœ¨ç”¨æˆ·ç‚¹å‡»é“¾æ¥å’Œæ‰“å¼€CustomTabsä¹‹é—´åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œç¡®ä¿æ‰€èŠ±è´¹çš„æ—¶é—´ä¸è¶…è¿‡100msã€‚å¦åˆ™ç”¨æˆ·ä¼šè®¤ä¸ºAPPæ²¡æœ‰å“åº”ï¼Œå¯èƒ½æ˜¯è¯•ç€ç‚¹å‡»é“¾æ¥å¤šæ¬¡ã€‚</p>
<p>å¦‚æœä¸èƒ½é¿å…å»¶è¿Ÿï¼Œç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨å¯¹å¯èƒ½çš„æƒ…å†µåšå¥½å‡†å¤‡ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ç›¸åŒçš„é“¾æ¥å¤šæ¬¡æ—¶ï¼Œä¸è¦å¤šæ¬¡æ‰“å¼€CustomTabã€‚</p>
<h3 id="ä½ç‰ˆæœ¬API"><a href="#ä½ç‰ˆæœ¬API" class="headerlink" title="ä½ç‰ˆæœ¬API"></a>ä½ç‰ˆæœ¬API</h3><p>å°½ç®¡æ•´åˆCustom Tabsçš„æ¨èæ–¹å¼æ˜¯ä½¿ç”¨Custom Tabs Support Libraryï¼Œä½APIç‰ˆæœ¬çš„ç³»ç»Ÿä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚</p>
<p>å®Œæ•´çš„Support Libraryçš„å¯¼å…¥æ–¹æ³•å¯ä»¥å‚è§<a href="https://github.com/GoogleChrome/custom-tabs-client/tree/master/customtabs" target="_blank" rel="external">GitHub</a>,å¹¶å¯ä»¥åšä¸ºä¸€ä¸ªèµ·ç‚¹ã€‚è¿æ¥serviceçš„<a href="http://developer.android.com/guide/components/aidl.html" target="_blank" rel="external">AIDLæ–‡ä»¶</a>ä¹Ÿè¢«åŒ…å«åœ¨å…¶ä¸­ï¼ŒChromiumä»“åº“ä¸­ä¹ŸåŒ…å«äº†è¿™äº›æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶åœ¨Android Studioä¸­æ˜¯ä¸èƒ½ç›´æ¥è¢«ä½¿ç”¨çš„ã€‚</p>
<h4 id="åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom-Tabsçš„åŸºæœ¬æ–¹æ³•"><a href="#åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom-Tabsçš„åŸºæœ¬æ–¹æ³•" class="headerlink" title="åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom Tabsçš„åŸºæœ¬æ–¹æ³•"></a>åœ¨ä½ç‰ˆæœ¬APIä¸­ä½¿ç”¨Custom Tabsçš„åŸºæœ¬æ–¹æ³•</h4><pre><code class="java">
String url = Â¨https://github.com/TonnyLÂ¨;
Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));

private static final String EXTRA_CUSTOM_TABS_SESSION = &quot;android.support.customtabs.extra.SESSION&quot;;
Bundle extras = new Bundle;
extras.putBinder(EXTRA_CUSTOM_TABS_SESSION,
   sessionICustomTabsCallback.asBinder() /* ä¸éœ€è¦sessionæ—¶è®¾ç½®ä¸ºnull */);
intent.putExtras(extras);
</code></pre>
<h4 id="å®šåˆ¶UI"><a href="#å®šåˆ¶UI" class="headerlink" title="å®šåˆ¶UI"></a>å®šåˆ¶UI</h4><p>UIå®šåˆ¶æ˜¯é€šè¿‡å‘ACTION_VIEW Intentæ·»åŠ Extraså®ç°çš„ã€‚ç”¨äºå®šåˆ¶UIçš„å®Œæ•´çš„extras keysçš„åˆ—è¡¨å¯ä»¥åœ¨<a href="http://developer.android.com/reference/android/support/customtabs/CustomTabsIntent.html" target="_blank" rel="external"> CustomTabsIntent docs </a>æ‰¾åˆ°ã€‚ä¸‹é¢æ˜¯æ·»åŠ è‡ªå®šä¹‰çš„toolbarçš„é¢œè‰²çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="java">private static final String EXTRA_CUSTOM_TABS_TOOLBAR_COLOR = &quot;android.support.customtabs.extra.TOOLBAR_COLOR&quot;;
intent.putExtra(EXTRA_CUSTOM_TABS_TOOLBAR_COLOR, colorInt);
</code></pre>
<h4 id="è¿æ¥Custom-Tabs-Service"><a href="#è¿æ¥Custom-Tabs-Service" class="headerlink" title="è¿æ¥Custom Tabs Service"></a>è¿æ¥Custom Tabs Service</h4><p>Custom Tabs serviceå’Œå…¶ä»–Android Serviceçš„ä½¿ç”¨æ–¹æ³•ç›¸åŒã€‚æ¥å£é€šè¿‡AIDLåˆ›å»ºå¹¶ä¸”ä»£ç†serviceç±»ä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p>
<pre><code>// å®¢æˆ·ç«¯éœ€è¦è¿æ¥çš„Chromeçš„åŒ…åï¼Œå–å†³äºchannelçš„åç§°
// Stable(å‘è¡Œç‰ˆ) = com.android.chrome
// Beta(æµ‹è¯•ç‰ˆ) = com.chrome.beta
// Dev(å¼€å‘ç‰ˆ) = com.chrome.dev
public static final String CUSTOM_TAB_PACKAGE_NAME = &quot;com.chrome.dev&quot;;  // Change when in stable

public static final String ACTION_CUSTOM_TABS_CONNECTION =
       &quot;android.support.customtabs.action.CustomTabsService&quot;;
Intent serviceIntent = new Intent(ACTION_CUSTOM_TABS_CONNECTION);

serviceIntent.setPackage(CUSTOM_TAB_PACKAGE_NAME);
context.bindService(serviceIntent, mServiceConnection,
                    Context.BIND_AUTO_CREATE | Context.BIND_WAIVE_PRIORITY);
</code></pre><h3 id="ä¸€äº›æœ‰ç”¨çš„ç½‘å€"><a href="#ä¸€äº›æœ‰ç”¨çš„ç½‘å€" class="headerlink" title="ä¸€äº›æœ‰ç”¨çš„ç½‘å€"></a>ä¸€äº›æœ‰ç”¨çš„ç½‘å€</h3><ul>
<li><a href="https://github.com/GoogleChrome/custom-tabs-client" target="_blank" rel="external">Github Demo</a></li>
<li><a href="http://stackoverflow.com/questions/tagged/chrome-custom-tabs" target="_blank" rel="external">Chrome Custom Tabs on StackOverflow</a></li>
<li>æˆ‘çš„é¡¹ç›®åœ°å€:<a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">PaperPlane</a></li>
</ul>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ˜¯é¢å‘å›½å¤–ç”¨æˆ·çš„ï¼Œé‚£ç†æ‰€å½“ç„¶çš„ï¼Œåº”è¯¥åŠ å…¥Chrome Custom Tabsçš„æ”¯æŒï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šèƒ½å¤Ÿæå‡ç”¨æˆ·çš„ä½“éªŒã€‚å¦‚æœæˆ‘ä»¬çš„åº”ç”¨åªæ˜¯é¢å‘å›½å†…ç”¨æˆ·ï¼Œæˆ‘çš„å»ºè®®è¿˜æ˜¯åº”è¯¥åŠ ä¸Šè¿™é¡¹åŠŸèƒ½ï¼Œæ¯•ç«Ÿï¼Œè¿˜æ˜¯æœ‰éƒ¨åˆ†ç”¨æˆ·å®‰è£…äº†Chromeæµè§ˆå™¨ï¼Œå½“ç”¨æˆ·æµè§ˆåˆ°Custom Tabé¡µé¢ï¼Œåº”è¯¥ä¹Ÿä¼šåƒæˆ‘ä¸€æ ·ï¼Œæ„Ÿè§‰åˆ°çœ¼å‰ä¸€äº®å§ã€‚</p>
<p>æ–‡ç« æ¯”è¾ƒé•¿ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼]]></title>
      <url>http://tonnyl.github.io/2016/12/31/%E7%AE%80%E6%B4%81%E4%BC%98%E9%9B%85%E5%9C%B0%E5%AE%9E%E7%8E%B0%E5%A4%9C%E9%97%B4%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨å®˜æ–¹Support Libraryå®ç°æ—¥é—´ä¸å¤œé—´æ¨¡å¼<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Android 6.0 Marshmallow é¢„è§ˆç‰ˆä¸­æ›¾ç»çŸ­æš‚å‡ºç°è¿‡ç›¸å…³çš„å¤œé—´æ¨¡å¼çš„åŠŸèƒ½ï¼Œåªæ˜¯åœ¨æ­£å¼ç‰ˆä¸­è¢«ç§»é™¤äº†ï¼Œåœ¨Android 7.0 Nougatä¸Šï¼Œç”¨æˆ·ä»¬å†æ¬¡ç»å†äº†ã€Œå¾—è€Œå¤å¤±ã€çš„é—æ†¾ï¼Œåœ¨å¼€å‘è€…é¢„è§ˆç‰ˆä¸­ï¼Œå¤œé—´æ¨¡å¼å’Œæš—è‰²æ¨¡å¼å…ˆæ˜¯å¼€å¯ï¼Œç„¶åæœ‰å†æ¬¡è¢«ç§»é™¤ã€‚è€Œåœ¨æ­£å¼ç‰ˆä¸­ï¼Œå¤œé—´æ¨¡å¼ä¹Ÿæ²¡æœ‰å‡ºç°ã€‚ä½†å…¶å®ç›¸å…³çš„ä»£ç ä¸€ç›´å­˜åœ¨äºç³»ç»Ÿä¸­ï¼Œåªæ˜¯é»˜è®¤æ²¡æœ‰è¢«å¼€å¯ã€‚å¦‚ä½•å¼€å¯è¿™é¡¹åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒå°‘æ•°æ´¾çš„è¿™ä¸€ç¯‡æ–‡ç« ï¼Œ<a href="http://sspai.com/35273" target="_blank" rel="external">å¸®ä½ æ‰¾å› Android 7.0 å¤œé—´æ¨¡å¼çš„ 2 æ¬¾åº”ç”¨</a>ã€‚</p>
<p>ä¸è¿‡ï¼Œä»Šå¤©è¦ä»‹ç»çš„ä¸»è¦å†…å®¹å¹¶ä¸æ˜¯å…³äºç³»ç»Ÿçš„å¤œé—´æ¨¡å¼ï¼Œè€Œæ˜¯å¦‚ä½•ç»™æˆ‘ä»¬å¼€å‘çš„APPæ·»åŠ å¤œé—´æ¨¡å¼çš„åŠŸèƒ½ã€‚æ¯«ä¸å¤¸å¼ çš„è¯´ï¼Œå¤œé—´æ¨¡å¼ç°åœ¨å·²ç»æ˜¯é˜…è¯»ç±»Appçš„æ ‡é…äº†ã€‚äº‹å®ä¸Šï¼Œæ—¥é—´æ¨¡å¼ä¸å¤œé—´æ¨¡å¼å°±æ˜¯ç»™APPå®šä¹‰å¹¶åº”ç”¨ä¸¤å¥—ä¸åŒé¢œè‰²çš„ä¸»é¢˜ã€‚ç”¨æˆ·å¯ä»¥è‡ªåŠ¨æˆ–è€…æ‰‹åŠ¨çš„å¼€å¯ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸¤ä¸ªæˆ‘è®¤ä¸ºå®ç°åœ°å¾ˆä¼˜é›…çš„ä¾‹å­ï¼šçŸ¥ä¹å’ŒTwitterã€‚</p>
<img src="/2016/12/31/ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼/zhihu_twitter_nightmode.gif" alt="zhihu_twitter_nightmode" title="zhihu_twitter_nightmode">
<p>è¿™ä¸¤ä¸ªAPPåœ¨åˆ‡æ¢çš„å·¥ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰å‡ºç°é—ªç°é»‘å±çš„æƒ…å†µï¼Œåˆ‡æ¢ä¹Ÿæ¯”è¾ƒé¡ºæ»‘ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åˆ©ç”¨Support Libraryå®ç°åŒæ ·çš„æ•ˆæœã€‚</p>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h3 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h3><pre><code>compile &#39;com.android.support:appcompat-v7:25.1.0&#39;
</code></pre><p>ç”±äºSupport Libraryåœ¨23.2.0çš„ç‰ˆæœ¬ä¸­æ‰æ·»åŠ äº†Theme.AppCompat.DayNightä¸»é¢˜ï¼Œæ‰€ä»¥ä¾èµ–çš„ç‰ˆæœ¬å¿…é¡»æ˜¯é«˜äº23.2.0çš„ï¼Œå¹¶ä¸”ï¼Œè¿™ä¸ªç‰¹æ€§æ”¯æŒçš„æœ€ä½SDKç‰ˆæœ¬ä¸º14ï¼Œæ‰€ä»¥ï¼Œéœ€è¦å…¼å®¹Android 4.0çš„è®¾å¤‡ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨è¿™ä¸ªç‰¹æ€§çš„ï¼Œåœ¨API Level 14ä»¥ä¸‹çš„è®¾å¤‡ä¼šé»˜è®¤ä½¿ç”¨äº®è‰²ä¸»é¢˜ã€‚ä¸è¿‡ç°åœ¨4.0ä»¥ä¸‹çš„è®¾å¤‡åº”è¯¥æ¯”è¾ƒå°‘äº†å§ï¼Œæ¯•ç«Ÿå¾®ä¿¡çš„minSdkVersionéƒ½è®¾ç½®ä¸º14äº†ã€‚</p>
<h3 id="å‡†å¤‡èµ„æº"><a href="#å‡†å¤‡èµ„æº" class="headerlink" title="å‡†å¤‡èµ„æº"></a>å‡†å¤‡èµ„æº</h3><ol>
<li><p>è®©æˆ‘ä»¬è‡ªå·±çš„ä¸»é¢˜ç»§æ‰¿å¹¶åº”ç”¨DayNightä¸»é¢˜ã€‚</p>
<pre><code class="xml"> &lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.DayNight.DarkActionBar&quot;&gt;

         &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;
         &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;
         &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;
         &lt;!--customize your theme here--&gt;

 &lt;/style&gt;
</code></pre>
</li>
<li><p>æ–°å»ºå¤œé—´æ¨¡å¼èµ„æºæ–‡ä»¶å¤¹:åœ¨<code>res</code>ç›®å½•ä¸‹æ–°å»º<code>values-night</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨æ­¤ç›®å½•ä¸‹æ–°å»º<code>colors.xml</code>æ–‡ä»¶åœ¨å¤œé—´æ¨¡å¼ä¸‹çš„åº”ç”¨çš„èµ„æºã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦æ–°å»º<code>drawable-night</code>,<code>layout-night</code>ç­‰åç¼€ä¸º<code>-night</code>çš„å¤œé—´èµ„æºæ–‡ä»¶å¤¹ã€‚<br>æˆ‘çš„<code>values</code>å’Œ<code>values-night</code>ç›®å½•ä¸‹çš„<code>colors.xml</code>çš„å†…å®¹å¦‚ä¸‹:</p>
<pre><code class="xml"> &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 &lt;!--values-colors.xml--&gt;
 &lt;resources&gt;
     &lt;color name=&quot;colorPrimary&quot;&gt;#009688&lt;/color&gt;
     &lt;color name=&quot;colorPrimaryDark&quot;&gt;#00796B&lt;/color&gt;
     &lt;color name=&quot;colorAccent&quot;&gt;#009688&lt;/color&gt;
     &lt;color name=&quot;textColorPrimary&quot;&gt;#616161&lt;/color&gt;
     &lt;color name=&quot;viewBackground&quot;&gt;@android:color/white&lt;/color&gt;
 &lt;/resources&gt;
</code></pre>
<pre><code class="xml"> &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 &lt;!--values-night-colors.xml&gt;
 &lt;resources&gt;
     &lt;color name=&quot;colorPrimary&quot;&gt;#35464e&lt;/color&gt;
     &lt;color name=&quot;colorPrimaryDark&quot;&gt;#212a2f&lt;/color&gt;
     &lt;color name=&quot;colorAccent&quot;&gt;#212a2f&lt;/color&gt;
     &lt;color name=&quot;textColorPrimary&quot;&gt;#616161&lt;/color&gt;
     &lt;color name=&quot;viewBackground&quot;&gt;#212a2f&lt;/color&gt;
 &lt;/resources&gt;
</code></pre>
</li>
<li><p>ä½¿Activityç»§æ‰¿è‡ªAppCompatActivityã€‚</p>
<pre><code class="java"> public class MainActivity extends AppCompatActivity {

     // code here
     @Override
     protected void onCreate(Bundle savedInstanceState) {

     }

 }
</code></pre>
</li>
</ol>
<h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="é™æ€åº”ç”¨"><a href="#é™æ€åº”ç”¨" class="headerlink" title="é™æ€åº”ç”¨"></a>é™æ€åº”ç”¨</h4><p>åœ¨Applicationçš„ç»§æ‰¿ç±»ä¸‹è®¾ç½®åˆå§‹ä¸»é¢˜ã€‚</p>
<pre><code class="java">public class App extends Application {

    @Override
    public void onCreate() {
        super.onCreate();

        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
        // other code here

}
</code></pre>
<p>è¿™é‡Œ<code>AppCompatDelegate.setDefaultNightMode()</code>æ–¹æ³•å¯ä»¥æ¥å—çš„å‚æ•°å€¼æœ‰4ä¸ªï¼š</p>
<ul>
<li>MODE_NIGHT_NO. Always use the day (light) theme(ä¸€ç›´åº”ç”¨æ—¥é—´(light)ä¸»é¢˜).</li>
<li>MODE_NIGHT_YES. Always use the night (dark) theme(ä¸€ç›´ä½¿ç”¨å¤œé—´(dark)ä¸»é¢˜).</li>
<li>MODE_NIGHT_AUTO. Changes between day/night based on the time of day(æ ¹æ®å½“å‰æ—¶é—´åœ¨day/nightä¸»é¢˜é—´åˆ‡æ¢).</li>
<li>MODE_NIGHT_FOLLOW_SYSTEM(é»˜è®¤é€‰é¡¹). This setting follows the systemâ€™s setting, which is essentially MODE_NIGHT_NO(è·Ÿéšç³»ç»Ÿï¼Œé€šå¸¸ä¸ºMODE_NIGHT_NO).</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯é™æ€çš„ã€‚ä½†æ˜¯è¿™ä¸ªå€¼å¹¶ä¸æ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œæ¯æ¬¡åœ¨å¼€å¯è¿›ç¨‹æ—¶éœ€è¦é‡æ–°è®¾ç½®ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘æ˜¯åœ¨<code>onCreate()</code>æ–¹æ³•ä¸­è®¾ç½®çš„ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¤§ç¥å»ºè®®åœ¨Activityæˆ–è€…Applicationçš„<strong>static</strong>ä»£ç å—ä¸­è®¾ç½®ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="java">public class App extends Application {

    static {
        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
    }

    @Override
    public void onCreate() {
        super.onCreate();

        // other code here

}
</code></pre>
<h4 id="åŠ¨æ€åº”ç”¨"><a href="#åŠ¨æ€åº”ç”¨" class="headerlink" title="åŠ¨æ€åº”ç”¨"></a>åŠ¨æ€åº”ç”¨</h4><p>è™½ç„¶ä¸Šé¢çš„é™æ€åº”ç”¨çš„è®¾ç½®éå¸¸ç®€å•ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼çš„åº”ç”¨åœºæ™¯è¿˜æ˜¯å¤ªå°‘äº†ã€‚æˆ‘ä»¬æ›´å¤šçš„è¿˜æ˜¯éœ€è¦åŠ¨æ€çš„æ ¹æ®éœ€è¦åŠ¨æ€çš„åˆ‡æ¢ã€‚</p>
<ol>
<li><p>æ£€æµ‹å½“å‰ä¸»é¢˜æ¨¡å¼</p>
<pre><code class="java"> int mode = getResources().getConfiguration().uiMode &amp; Configuration.UI_MODE_NIGHT_MASK;
</code></pre>
</li>
<li><p>è®¾ç½®ä¸»é¢˜</p>
<pre><code class="java"> if(mode == Configuration.UI_MODE_NIGHT_YES) {
     AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);
 } else if(mode == Configuration.UI_MODE_NIGHT_NO) {
     AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
 } else {
     // blah blah
 }

 recreate();
</code></pre>
<p> åœ¨è°ƒç”¨<code>recreate()</code>æ–¹æ³•ä¹‹å‰ï¼Œè¿˜å¯ä»¥åˆ›å»ºä¸€äº›åŠ¨ç”»è¿›è¡Œè¿‡æ¸¡ã€‚è€Œä¸”ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œè°ƒç”¨<code>recreate()</code>éœ€è¦å¯¹ä¸€äº›æ•°æ®è¿›è¡Œä¿å­˜ï¼Œä¾‹å¦‚fragmentï¼ŒCheckBox,RadioBoxç­‰ã€‚å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code class="java"> public class MainFragment extends Fragment {

     @Override
     public void onCreate(@Nullable Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);

          if (savedInstanceState != null) {
              FragmentManager manager = getChildFragmentManager();
             doubanMomentFragment = (DoubanMomentFragment) manager.getFragment(savedInstanceState, &quot;douban&quot;);
          } else {
              doubanMomentFragment = DoubanMomentFragment.newInstance();
          }
     }

     @Override
     public void onSaveInstanceState(Bundle outState) {
         super.onSaveInstanceState(outState);
         FragmentManager manager = getChildFragmentManager();
         manager.putFragment(outState, &quot;douban&quot;, doubanMomentFragment);
 }
</code></pre>
<p> æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä¸»é¢˜çš„å€¼å­˜å‚¨åˆ°SharedPreferenceä¸­ï¼Œå·²ä¾¿äºåº”ç”¨åœ¨ä¸‹ä¸€æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åº”ç”¨ä¸»é¢˜ã€‚</p>
</li>
</ol>
<h4 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h4><ul>
<li><p>Q:ç³»ç»Ÿé»˜è®¤çš„é¢œè‰²ä¸åˆæˆ‘çš„å£å‘³æ€ä¹ˆåŠï¼Ÿ</p>
<p>A:ä½¿ç”¨ä¸»é¢˜å±æ€§,ä¾‹å¦‚:<code>textColor:?android:attr/textColorPrimary</code>,<code>color:?attr/colorControlNormal</code>ç­‰ã€‚</p>
</li>
<li><p>Q:ä¸ºä»€ä¹ˆæˆ‘çš„WebViewé¢œè‰²æ²¡æœ‰å˜åŒ–ï¼Ÿ</p>
<p>A:å› ä¸ºWebViewä¸èƒ½ä½¿ç”¨ä¸»é¢˜å±æ€§ã€‚WebViewçš„é¢œè‰²å®é™…ä¸Šå–å†³äºç½‘é¡µå†…å®¹é¢œè‰²ã€‚ç½‘é¡µçš„é»˜è®¤èƒŒæ™¯è‰²æ˜¯ç™½è‰²ï¼Œæ‰€ä»¥å°½ç®¡è®¾ç½®äº†ä¸»é¢˜ä¸º<code>AppCompatDelegate.MODE_NIGHT_YES</code>ï¼Œç½‘é¡µä»ç„¶æ˜¯ç™½è‰²ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å°±å¾ˆä¸æ­äº†ã€‚æ‰€ä»¥ï¼Œç½‘é¡µçš„å†…å®¹å’ŒèƒŒæ™¯è‰²ç­‰èµ„æºä¹Ÿéœ€è¦é€‚é…äº†ã€‚</p>
</li>
<li><p>Q:ä¸ºä»€ä¹ˆä¸ç›´æ¥è®¾ç½®ä¸º<code>MODE_NIGHT_AUTO</code>å‘¢ï¼Ÿ</p>
<p>A:å› ä¸ºä½¿ç”¨<code>MODE_NIGHT_AUTO</code>éœ€è¦è¯·æ±‚åæ ‡æƒé™ï¼Œè·å–ç³»ç»Ÿçš„ä½ç½®ã€‚ä½ è‚¯å®šä¼šè¯´äº†ï¼Œè¿™å°¼ç›ä¸æ˜¯å‘çˆ¹å—ï¼Ÿå¦‚æœç¨‹åºå·²ç»æˆäºˆäº†åæ ‡æƒé™(location permission)(å¦‚æœä½ çš„target SDKä¸º23æˆ–è€…æ›´é«˜ï¼Œéœ€è¦è€ƒè™‘è¿è¡Œæ—¶æƒé™)ï¼ŒAppCompatä¼šè¯•ç€å»è·å–ä¸Šæ¬¡ä¿å­˜çš„åæ ‡ï¼Œæ ¹æ®åæ ‡æ¥è®¡ç®—æ—¥å‡ºä¸æ—¥è½çš„æ—¶é—´ã€‚å¦‚æœç¨‹åºæ²¡æœ‰ä½ç½®æƒé™æˆ–è€…LocationManageræ²¡æœ‰å­˜å‚¨ä¸Šæ¬¡åæ ‡çš„ä¿¡æ¯å‘¢ï¼Ÿç³»ç»Ÿæˆ–é»˜è®¤è®¾ç½®ä¸ºæ—©ä¸Š6ç‚¹é’Ÿä¸ºæ—¥å‡ºï¼Œä¸‹åˆ10ç‚¹ä¸ºæ—¥è½ã€‚ç”¨æˆ·è°ƒæ•´ç³»ç»Ÿæ—¶é—´ï¼Œå½“å‰çš„ä¸»é¢˜ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚å¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·åœ¨è®¾å®šä¸»é¢˜åï¼Œä¸»é¢˜è¿˜ä¼šéšç€æ—¶é—´æ”¹å˜,<code>MODE_NIGHT_AUTO</code>å°±ä¸é€‚ç”¨äº†ã€‚</p>
</li>
</ul>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>æœ¬é¡¹ç›®ä»£ç <a href="https://github.com/TonnyL/PaperPlane" target="_blank" rel="external">PaperPlane</a> .<br>è¿è¡Œæ•ˆæœ</p>
<img src="/2016/12/31/ç®€æ´ä¼˜é›…åœ°å®ç°å¤œé—´æ¨¡å¼/paper_plane.gif" alt="Paper Plane" title="Paper Plane">
<p>åœ¨Android 6.0åŠä»¥ä¸‹çš„è®¾å¤‡ä¸Šï¼Œæœ¬é¡¹ç›®è¿è¡Œæ—¶ä¼šæœ‰åˆ‡æ¢çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæœï¼Œä½†æ˜¯ä¸æ”¯æŒAndroid 7.0åŠä»¥ä¸Šçš„è®¾å¤‡ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[é€‚é…Android 7.1 Nougatæ–°ç‰¹æ€§]]></title>
      <url>http://tonnyl.github.io/2016/12/29/%E9%80%82%E9%85%8DAndroid-7-1-Nougat%E6%96%B0%E7%89%B9%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>è€å¸æœºå¸¦ä½ åƒç‰›è½§ç³–<br><a id="more"></a></p>
<h3 id="Whatâ€™s-new-in-Android-7-1-Nougat"><a href="#Whatâ€™s-new-in-Android-7-1-Nougat" class="headerlink" title="Whatâ€™s new in Android 7.1 Nougat?"></a>Whatâ€™s new in Android 7.1 Nougat?</h3><p>Android 7.1 Nougat å·²ç»æ¨å‡ºæœ‰ä¸€æ®µæ—¶é—´ï¼Œç›¸ä¿¡å¤§å¤šæ•°äººå’Œæˆ‘ä¸€æ ·ï¼Œå¹¶æ²¡æœ‰ç”¨ä¸Šæœ€æ–°çš„ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œæ€»æœ‰ä¸€ç¾¤èµ°åœ¨æ—¶ä»£çš„å‰åˆ—çº¿ä¸Šçš„Geekä»¬ï¼Œå‹‡äºå°é²œï¼Œè‰°è‹¦å¥‹æ–—ï¼Œä¸ºåˆ·æ–°ç‰ˆæœ¬å·è´¡çŒ®è‡ªå·±çš„åŠ›é‡ã€‚å¥½å§ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘è¿˜æ²¡æœ‰ç”¨ä¸Š7.1ï¼Œæœ‰äº›çœ¼é¦‹äº†ã€‚é‚£ä¹ˆï¼Œå’Œå¼€å‘è€…æ¯æ¯ç›¸å…³çš„æœ‰å“ªäº›æ–°ç‰¹æ€§å‘¢ï¼Ÿ</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/android_nougat.png" alt="Android 7.1 Nougat" title="Android 7.1 Nougat">
<p>æœ¬æ¬¡ä¸»è¦ä»‹ç»3ä¸ªæ–°ç‰¹æ€§:<strong>App Shortcuts</strong>, <strong>Round Icon Resource</strong> å’Œ <strong>Image Keyboard Support</strong>ã€‚æ‰€æœ‰çš„æ–°ç‰¹æ€§å¯ä»¥è®¿é—®è°·æ­Œå¼€å‘è€…ä¸­æ–‡åšå®¢çš„æ–‡ç« <a href="http://developers.googleblog.cn/2016/12/android-711-nougat_20.html" target="_blank" rel="external">æ¬¢è¿ä½¿ç”¨Android 7.1.1 Nougat</a>ã€‚</p>
<h3 id="App-Shortcuts"><a href="#App-Shortcuts" class="headerlink" title="App Shortcuts"></a>App Shortcuts</h3><p>ä½œä¸ºä¸€ä¸ªå¯†åˆ‡å…³æ³¨Androidå‘å±•çš„ä¼ªGeekï¼Œåœ¨7.1æ­£å¼ç‰ˆæœªå‘å¸ƒä¹‹å‰ï¼Œé€šè¿‡ç½‘ä¸Šçš„ä¸€äº›çˆ†æ–™æ–‡ç« ï¼Œæˆ‘å°±äº†è§£åˆ°äº†è¿™ä¸€æ–°åŠŸèƒ½ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªåŠŸèƒ½åˆšå¼€å§‹å‡ºç°æ—¶ï¼Œæˆ‘è¿˜ä»¥ä¸ºGoogle Pixelè¦ä¸Šå‹æ„Ÿå±äº†å‘¢ï¼Œäº‹å®è¯æ˜ï¼Œçš„ç¡®æ˜¯æˆ‘æƒ³å¤šäº†ã€‚</p>
<p>App Shortcutså…è®¸ç”¨æˆ·ç›´æ¥åœ¨å¯åŠ¨å™¨ä¸­æ˜¾ç¤ºä¸€äº›æ“ä½œï¼Œè®©ç”¨æˆ·ç«‹å³æ‰§è¡Œåº”ç”¨çš„æ·±å±‚æ¬¡çš„åŠŸèƒ½ã€‚è§¦å‘è¿™ä¸€åŠŸèƒ½çš„æ“ä½œå°±æ˜¯ã€Œé•¿æŒ‰ã€ã€‚è¿™ä¸€åŠŸèƒ½ç±»ä¼¼äºiOSä¸­çš„ã€Œ3D Touchã€ã€‚</p>
<p>ä¸‹é¢é€šè¿‡ä¸€å¼ GIFï¼Œç›´è§‚çš„æ„Ÿå—ä¸€ä¸‹App Shortcutsæ˜¯æ€æ ·çš„ã€‚ï¼ˆç”±äºæˆ‘çš„ä¸€åŠ 3å¹¶æ²¡æœ‰å‡çº§åˆ°æœ€æ–°çš„7.1ï¼Œè¿˜åªæ˜¯7.0ï¼Œæ‰€ä»¥æˆ‘å®‰è£…äº†Nova Launcheræ¥ä½“éªŒã€‚ï¼‰</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/app_shortcuts.gif" alt="App Shortcuts" title="App Shortcuts">
<p>é•¿æŒ‰å›¾æ ‡ï¼Œæ”¶åˆ°éœ‡åŠ¨åæ¾æ‰‹ï¼Œå¦‚æœèƒ½å¤Ÿçœ‹åˆ°å›¾æ ‡ä¸Šå¼¹å‡ºäº†æ”¯æŒçš„è·³è½¬æ“ä½œï¼Œè¯´æ˜æˆåŠŸçš„å‘¼å‡ºäº†ShortcutsåŠŸèƒ½ï¼Œå¦‚æœä¸æ”¯æŒè¿™ä¸€åŠŸèƒ½ï¼Œåœ¨Nova Launcherä¸Šå¼¹å‡ºçš„å°±æ˜¯å¸è½½æˆ–è€…ç§»é™¤æ“ä½œï¼Œåœ¨Pixel Launcherä¸Šä¸ä¼šå‡ºç°å¼¹å‡ºèœå•ï¼Œæ˜¾ç¤ºçš„æ˜¯å¸¸è§çš„é•¿æŒ‰æ“ä½œã€‚é•¿æŒ‰å¼¹å‡ºçš„æ“ä½œï¼Œå¯ä»¥å°†è¿™ä¸ªæ“ä½œå·²å¿«æ·æ–¹å¼å›¾æ ‡çš„å½¢å¼ç›´æ¥æ”¾ç½®åœ¨ä¸»å±ä¸Šã€‚å¦‚æœé•¿æŒ‰ä¸»å›¾æ ‡ä¸æ¾æ‰‹ï¼Œå°±å¯ä»¥è°ƒæ•´ä½ç½®äº†ã€‚</p>
<p>ç›®å‰ï¼Œä¸€ä¸ªåº”ç”¨æœ€å¤šå¯ä»¥æ”¯æŒ <strong>5</strong> ä¸ªShortcut,å¯ä»¥é€šè¿‡<a href="https://developer.android.com/reference/android/content/pm/ShortcutManager.html#getMaxShortcutCountPerActivity(" target="_blank" rel="external">getMaxShortcutCountPerActivity</a>)æŸ¥çœ‹Launcheræœ€å¤šæ”¯æŒShortcutçš„æ•°é‡ã€‚æ¯ä¸€ä¸ªShortcutéƒ½å¯¹åº”ç€ä¸€ä¸ªæˆ–è€…å¤šä¸ªintentï¼Œå½“ç”¨æˆ·é€‰æ‹©æŸä¸€ä¸ªShortcutæ—¶ï¼Œåº”è¯¥åšå‡ºç‰¹å®šçš„åŠ¨ä½œã€‚ä¸‹é¢æ˜¯ä¸€äº›å°†ä¸€äº›ç‰¹å®šçš„åŠ¨ä½œä½œä¸ºShortcutsçš„ä¾‹å­ï¼š</p>
<ul>
<li><p>åœ¨åœ°å›¾APPä¸­ï¼ŒæŒ‡å¼•ç”¨æˆ·è‡³æœ€å¸¸ç”¨çš„ä½ç½®</p>
</li>
<li><p>åœ¨èŠå¤©APPä¸­ï¼Œå‘é€ä¿¡æ¯è‡³æŸä¸ªå¥½å‹</p>
</li>
<li><p>åœ¨å¤šåª’ä½“APPä¸­ï¼Œæ’­æ”¾ä¸‹ä¸€ä¸ªç”µè§†èŠ‚ç›®</p>
</li>
<li><p>åœ¨æ¸¸æˆAPPä¸­ï¼ŒåŠ è½½è‡³ä¸Šæ¬¡ä¿å­˜çš„åœ°æ–¹</p>
</li>
</ul>
<p>App Shortcutå¯ä»¥åˆ†ä¸ºä¸¤ç§ä¸åŒçš„ç±»å‹ï¼š Static Shortcutsï¼ˆé™æ€å¿«æ·æ–¹å¼ï¼‰ å’Œ Dynamic Shortcutsï¼ˆåŠ¨æ€å¿«æ·æ–¹å¼ï¼‰ã€‚</p>
<ul>
<li>Static Shortcutsï¼šåœ¨æ‰“åŒ…åˆ°apkçš„èµ„æºæ–‡ä»¶ä¸­å®šä¹‰ï¼Œæ‰€ä»¥ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡æ›´æ–°ç‰ˆæœ¬æ—¶æ‰èƒ½æ”¹å˜é™æ€å¿«æ·æ–¹å¼çš„è¯¦ç»†è¯´æ˜ã€‚</li>
<li>Dynamic Shortcutsï¼šé€šè¿‡ShortcutManager APIåœ¨è¿è¡Œæ—¶å‘å¸ƒï¼Œåœ¨è¿è¡Œæ—¶ï¼Œåº”ç”¨å¯ä»¥å‘å¸ƒï¼Œå‡çº§å’Œç§»é™¤å¿«æ·æ–¹å¼ã€‚</li>
</ul>
<h4 id="Using-Static-Shortcuts"><a href="#Using-Static-Shortcuts" class="headerlink" title="Using Static Shortcuts"></a>Using Static Shortcuts</h4><p>åˆ›å»ºStatic Shortcutsåˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>
<p>1.åœ¨å·¥ç¨‹çš„manifestæ–‡ä»¶ (AndroidManifest.xml)ä¸‹ï¼Œæ‰¾åˆ° intent filterè®¾ç½®ä¸º <strong>android.intent.action.MAIN</strong> å’Œ <strong>android.intent.category.LAUNCHER</strong> çš„Activityã€‚</p>
<p>2.åœ¨æ¬¡Activityä¸‹æ·»åŠ <meta-data>æ ‡ç­¾ï¼Œå¼•ç”¨å®šä¹‰shortcutsçš„èµ„æºæ–‡ä»¶ã€‚</meta-data></p>
<pre><code class="xml">&lt;activity
        android:name=&quot;.homepage.MainActivity&quot;
        android:configChanges=&quot;orientation|keyboardHidden|screenSize|screenLayout&quot;
        android:label=&quot;@string/app_name&quot;
        android:theme=&quot;@style/AppTheme.NoActionBar&quot;&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

            &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
        &lt;/intent-filter&gt;

        &lt;meta-data
            android:name=&quot;android.app.shortcuts&quot;
            android:resource=&quot;@xml/shortcuts&quot; /&gt;
    &lt;/activity&gt;
</code></pre>
<p>3.åˆ›å»ºæ–°çš„èµ„æºæ–‡ä»¶<code>res/xml/shortcuts.xml</code></p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;shortcuts xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;shortcut
        android:enabled=&quot;true&quot;
        android:icon=&quot;@drawable/ic_search_circle&quot;
        android:shortcutId=&quot;search_bookmarks&quot;
        android:shortcutShortLabel=&quot;@string/search_bookmarks&quot;
        android:shortcutLongLabel=&quot;@string/search_bookmarks&quot;&gt;

        &lt;intent
            android:action=&quot;android.intent.action.VIEW&quot;
            android:targetPackage=&quot;com.marktony.zhihudaily&quot;
            android:targetClass=&quot;com.marktony.zhihudaily.search.SearchActivity&quot; /&gt;

        &lt;!--å¦‚æœä½ çš„ä¸€ä¸ªshortcutå…³è”ç€å¤šä¸ªintentï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œç»§ç»­æ·»
            åŠ ã€‚æœ€åä¸€ä¸ªintentå†³å®šç€ç”¨æˆ·åœ¨åŠ è½½è¿™ä¸ªshortcutæ—¶ä¼šçœ‹åˆ°ä»€ä¹ˆ--&gt;

        &lt;categories android:name=&quot;android.shortcut.conversation&quot; /&gt;

    &lt;/shortcut&gt;

    &lt;!--åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„shortcut--&gt;

&lt;/shortcuts&gt;
</code></pre>
<p><strong>shortcut</strong>ä¸‹æ ‡ç­¾çš„å«ä¹‰ï¼š</p>
<ul>
<li><p>enabled:è§åçŸ¥æ„ï¼Œshortcutæ˜¯å¦å¯ç”¨ã€‚å¦‚æœä½ å†³å®šè®©è¿™ä¸ªstatic shortcutä¸åœ¨å¯ç”¨çš„è¯ï¼Œå¯ç›´æ¥å°†å…¶è®¾ç½®ä¸º <strong>false</strong> ï¼Œæˆ–è€…ç›´æ¥ä» <strong>shortcuts</strong> æ ‡ç­¾ä¸­ç§»é™¤ã€‚</p>
</li>
<li><p>icon:æ˜¾ç¤ºåœ¨å·¦è¾¹çš„å›¾æ ‡ï¼Œå¯ç”¨ä½¿ç”¨<em>Vector drawable</em>ã€‚</p>
</li>
<li><p>shortcutDisabledMessage:å½“ç¦ç”¨æ­¤shortcutåï¼Œå®ƒä»ç„¶ä¼šå‡ºç°åœ¨ç”¨æˆ·é•¿æŒ‰åº”ç”¨å›¾æ ‡åçš„å¿«æ·æ–¹å¼åˆ—è¡¨é‡Œï¼Œä¹Ÿå¯ä»¥è¢«æ‹–åŠ¨å¹¶å›ºå®šåˆ°æ¡Œé¢ä¸Šï¼Œä½†æ˜¯å®ƒä¼šå‘ˆç°ç°è‰²å¹¶ä¸”ç”¨æˆ·ç‚¹å‡»æ—¶ä¼šå¼¹å‡ºToastè¿™ä¸ªæ ‡ç­¾æ‰€å®šä¹‰çš„å†…å®¹ã€‚</p>
</li>
<li><p>shortcutLongLabel:å½“å¯åŠ¨å™¨æœ‰è¶³å¤Ÿå¤šçš„ç©ºé—´æ—¶ï¼Œä¼šæ˜¾ç¤ºè¿™ä¸ªæ ‡ç­¾æ‰€å®šä¹‰çš„å†…å®¹ã€‚</p>
</li>
<li><p>shortcutShortLabel:shortcutçš„ç®€è¦è¯´æ˜ï¼Œæ˜¯å¿…éœ€å­—æ®µã€‚å½“shortcutè¢«æ·»åŠ åˆ°æ¡Œé¢ä¸Šæ—¶ï¼Œæ˜¾ç¤ºçš„ä¹Ÿæ˜¯è¿™ä¸ªå­—æ®µã€‚</p>
</li>
<li><p>intent:shortcutå…³è”çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªintentï¼Œå½“ç”¨æˆ·ç‚¹å‡»shortcutæ—¶è¢«æ‰“å¼€ã€‚</p>
</li>
<li><p>shortcutId:shortcutçš„å”¯ä¸€æ ‡ç¤ºidï¼Œè‹¥å­˜åœ¨å…·æœ‰ç›¸åŒshortcutIdçš„shortcutï¼Œåˆ™åªæ˜¾ç¤ºä¸€ä¸ªã€‚</p>
</li>
</ul>
<p>åˆ°è¿™é‡Œï¼Œæœ€ç®€å•çš„shortcutå°±æ·»åŠ æˆåŠŸäº†ã€‚è¿è¡ŒåŒ…å«ä¸Šé¢çš„æ–‡ä»¶çš„é¡¹ç›®ï¼Œç‚¹å‡»shortcutå°±å¯ä»¥ç›´æ¥è¿›å…¥ <strong>SearchActivity</strong>ï¼Œå½“æŒ‰ä¸‹backé”®æ—¶ï¼Œç›´æ¥å°±é€€å‡ºäº†åº”ç”¨ã€‚å¦‚æœå¸Œæœ›ä¸é€€å‡ºåº”ç”¨ï¼Œè€Œæ˜¯è¿›å…¥ <strong>MainActivity</strong> æ—¶ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä¸ç”¨ç€æ€¥ï¼Œåœ¨shortcutç»§ç»­æ·»åŠ intentå°±å¯ä»¥äº†ã€‚</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;shortcuts xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;shortcut
        android:enabled=&quot;true&quot;
        android:icon=&quot;@drawable/ic_search_circle&quot;
        android:shortcutId=&quot;search_bookmarks&quot;
        android:shortcutShortLabel=&quot;@string/search_bookmarks&quot;
        android:shortcutLongLabel=&quot;@string/search_bookmarks&quot;&gt;

        &lt;intent
                android:action=&quot;android.intent.action.MAIN&quot;
                android:targetClass=&quot;com.marktony.zhihudaily.homepage.MainActivity&quot;
            android:targetPackage=&quot;com.marktony.zhihudaily&quot; /&gt;

        &lt;intent
            android:action=&quot;android.intent.action.VIEW&quot;
            android:targetPackage=&quot;com.marktony.zhihudaily&quot;
            android:targetClass=&quot;com.marktony.zhihudaily.search.SearchActivity&quot; /&gt;

        &lt;categories android:name=&quot;android.shortcut.conversation&quot; /&gt;

    &lt;/shortcut&gt;

      &lt;!--åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„shortcut--&gt;

 &lt;/shortcuts&gt;
</code></pre>
<h4 id="Using-Dynamic-Shortcuts"><a href="#Using-Dynamic-Shortcuts" class="headerlink" title="Using Dynamic Shortcuts"></a>Using Dynamic Shortcuts</h4><p>åŠ¨æ€å¿«æ·æ–¹å¼åº”è¯¥å’Œåº”ç”¨å†…çš„ç‰¹å®šçš„ã€ä¸Šä¸‹æ–‡æ•æ„Ÿçš„actioné“¾æ¥ã€‚è¿™äº›actionåº”è¯¥å¯ä»¥åœ¨ç”¨æˆ·çš„å‡ æ¬¡ä½¿ç”¨ä¹‹é—´ã€ç”šè‡³æ˜¯åœ¨åº”ç”¨è¿è¡Œè¿‡ç¨‹ä¸­è¢«æ”¹å˜ã€‚å¥½çš„å€™é€‰actionåŒ…æ‹¬æ‰“ç”µè¯ç»™ç‰¹å®šçš„äººã€å¯¼èˆªè‡³ç‰¹å®šçš„åœ°æ–¹ã€æˆ–è€…å±•ç¤ºå½“å‰æ¸¸æˆçš„åˆ†æ•°ã€‚</p>
<p><a href="https://developer.android.com/reference/android/content/pm/ShortcutManager.html" target="_blank" rel="external">ShortcutManager</a> APIå…è®¸æˆ‘ä»¬åœ¨åŠ¨æ€å¿«æ·æ–¹å¼ä¸Šå®Œæˆä¸‹é¢çš„æ“ä½œï¼š</p>
<ul>
<li><p>å‘å¸ƒ:ä½¿ç”¨setDynamicShortcuts()é‡æ–°å®šä¹‰æ•´ä¸ªåŠ¨æ€å¿«æ·æ–¹å¼åˆ—è¡¨ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨addDynamicShortcuts()å‘å·²å­˜åœ¨çš„åŠ¨æ€å¿«æ·æ–¹å¼åˆ—è¡¨ä¸­æ·»åŠ å¿«æ·æ–¹å¼ã€‚</p>
</li>
<li><p>æ›´æ–°:ä½¿ç”¨updateShortcuts()æ–¹æ³•ã€‚</p>
</li>
<li><p>ç§»é™¤:ä½¿ç”¨removeDynamicShortcuts()æ–¹æ³•ç§»é™¤ç‰¹å®šåŠ¨æ€å¿«æ·æ–¹å¼æˆ–è€…ä½¿ç”¨removeAllDynamicShortcuts()ç§»é™¤æ‰€æœ‰åŠ¨æ€å¿«æ·æ–¹å¼ã€‚</p>
</li>
</ul>
<p>ä¸‹é¢æ˜¯åœ¨MainActivityçš„onCreate()ä¸­åˆ›å»ºåŠ¨æ€å¿«æ·æ–¹å¼çš„ä¾‹å­ï¼š</p>
<pre><code class="java">@Override
protected void onCreate(Bundle savedInstanceState) {

    ...

    ShortcutManager shortcutManager = getSystemService(ShortcutManager.class);

    ShortcutInfo webShortcut = new ShortcutInfo.Builder(this, &quot;shortcut_web&quot;)
            .setShortLabel(&quot;github&quot;)
            .setLongLabel(&quot;Open Tonny&#39;s github web site&quot;)
            .setIcon(Icon.createWithResource(this, R.drawable.ic_dynamic_shortcut))
            .setIntent(new Intent(Intent.ACTION_VIEW, Uri.parse(&quot;https://TonnyL.github.io&quot;)))
            .build();

    shortcutManager.setDynamicShortcuts(Collections.singletonList(webShortcut));
}
</code></pre>
<p>ä¹Ÿå¯ä»¥ä¸ºåŠ¨æ€å¿«æ·æ–¹å¼åˆ›å»ºè¿”å›æ ˆã€‚</p>
<pre><code class="java">@Override
protected void onCreate(Bundle savedInstanceState) {

    ...

    ShortcutInfo dynamicShortcut = new ShortcutInfo.Builder(this, &quot;shortcut_dynamic&quot;)
            .setShortLabel(&quot;Dynamic&quot;)
            .setLongLabel(&quot;Open dynamic shortcut&quot;)
            .setIcon(Icon.createWithResource(this, R.drawable.ic_dynamic_shortcut_2))
            .setIntents(
                    new Intent[]{
                            new Intent(Intent.ACTION_MAIN, Uri.EMPTY, this, MainActivity.class).setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK),
                            new Intent(DynamicShortcutActivity.ACTION)
                    })
            .build();

    shortcutManager.setDynamicShortcuts(Arrays.asList(webShortcut, dynamicShortcut));
}
</code></pre>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºçš„Activityï¼Œåå­—å«åšDynamicShortcutActivityï¼Œåœ¨manifestæ–‡ä»¶ä¸­æ³¨å†Œã€‚</p>
<pre><code class="xml">&lt;activity  
      android:name=&quot;.DynamicShortcutActivity&quot;
      android:label=&quot;Dynamic shortcut activity&quot;&gt;
      &lt;intent-filter&gt;
        &lt;action android:name=&quot;com.marktony.zhihudaily.OPEN_DYNAMIC_SHORTCUT&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
      &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre>
<p>é€šè¿‡æ¸…é™¤arrayä¸­çš„æ’åºè¿‡çš„intentsï¼Œå½“æˆ‘ä»¬é€šè¿‡åˆ›å»ºå¥½çš„shortcutè¿›å…¥DynamicShortcutActivityä¹‹åï¼ŒæŒ‰ä¸‹backé”®ï¼ŒMainActivityå°±ä¼šè¢«åŠ è½½ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨åŠ¨æ€åˆ›å»ºå¿«æ·æ–¹å¼ä¹‹å‰ï¼Œæœ€å¥½æ˜¯æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦è¶…è¿‡äº†æ‰€å…è®¸çš„æœ€å¤§å€¼ã€‚å¦åˆ™ä¼šæŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ã€‚</p>
<h4 id="Extra-Bits"><a href="#Extra-Bits" class="headerlink" title="Extra Bits"></a>Extra Bits</h4><ul>
<li><p>å½“static shortcut å’Œ dynamic shortcutä¸€èµ·å±•ç¤ºæ—¶ï¼Œå…¶å‡ºç°çš„é¡ºåºæ˜¯æ€æ ·å®šåˆ¶å‘¢ï¼Ÿ</p>
<p>  åœ¨ <strong>ShortcutInfo.Builder</strong> ä¸­æœ‰ä¸€ä¸ªä¸“é—¨çš„æ–¹æ³• <strong>setRank(int)</strong> ,é€šè¿‡è®¾ç½®ä¸åŒçš„ç­‰çº§ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶åŠ¨æ€å¿«æ·æ–¹å¼çš„å‡ºç°é¡ºåºï¼Œç­‰çº§è¶Šé«˜ï¼Œå‡ºç°åœ¨å¿«æ·æ–¹å¼åˆ—è¡¨ä¸­çš„ä½ç½®å°±è¶Šé«˜ã€‚</p>
</li>
<li><p>æˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®åŠ¨æ€å¿«æ·æ–¹å¼çš„shortLabelçš„å­—ä½“é¢œè‰²ã€‚</p>
<pre><code class="java">  ForegroundColorSpan colorSpan = new ForegroundColorSpan(getResources().getColor(android.R.color.holo_red_dark, getTheme()));
  String label = &quot;github&quot;;
  SpannableStringBuilder colouredLabel = new SpannableStringBuilder(label);
  colouredLabel.setSpan(colorSpan, 0, label.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);

  ShortcutInfo webShortcut = new ShortcutInfo.Builder(MainActivity.this, &quot;shortcut_web&quot;)
          .setShortLabel(colouredLabel)
          .setRank(1)
          .build();
</code></pre>
</li>
</ul>
<h4 id="App-Shortcuts-Best-Practices"><a href="#App-Shortcuts-Best-Practices" class="headerlink" title="App Shortcuts Best Practices"></a>App Shortcuts Best Practices</h4><p>å½“è®¾è®¡å’Œåˆ›å»ºåº”ç”¨çš„shortcutsæ—¶ï¼Œåº”è¯¥éµå®ˆä¸‹é¢çš„æŒ‡å¯¼å»ºè®®ï¼š</p>
<ul>
<li><p>éµå¾ªè®¾è®¡è§„èŒƒ:ä¸ºäº†ä¿æŒæˆ‘ä»¬çš„åº”ç”¨å’Œç³»ç»Ÿåº”ç”¨çš„å¿«æ·æ–¹å¼åœ¨è§†è§‰ä¸Šä¸€è‡´æ€§ï¼Œåº”è¯¥éµå®ˆ<a href="https://developer.android.com/shareables/design/app-shortcuts-design-guidelines.pdf" target="_blank" rel="external">App Shortcuts Design Guidelines</a>ã€‚</p>
</li>
<li><p>å‘å¸ƒ4ä¸ªä¸åŒçš„å¿«æ·æ–¹å¼:å°½ç®¡ç°åœ¨çš„APIæ”¯æŒé™æ€å’ŒåŠ¨æ€æ€»å…±5ä¸ªå¿«æ·æ–¹å¼ï¼Œä½†æ˜¯ä¸ºäº†æé«˜shortcutçš„è§†è§‰æ•ˆæœï¼Œå»ºè®®åªæ·»åŠ 4ä¸ªä¸åŒçš„å¿«æ·æ–¹å¼ã€‚</p>
</li>
<li><p>é™åˆ¶å¿«æ·æ–¹å¼æè¿°çš„æ–‡æœ¬é•¿åº¦:åœ¨Launcherä¸­ï¼Œæ˜¾ç¤ºå¿«æ·æ–¹å¼æ—¶ï¼Œç©ºé—´é•¿åº¦å—åˆ°äº†é™åˆ¶ã€‚å¦‚æœå¯èƒ½çš„è¯ï¼Œåº”è¯¥å°†ã€Œshort descriptionã€çš„æ–‡å­—é•¿åº¦æ§åˆ¶åœ¨10ä¸ªå­—æ¯ä»¥å†…ï¼Œå°†ã€Œlong discriptionã€çš„é•¿åº¦é™åˆ¶åœ¨25ä¸ªå­—æ¯ä»¥å†…ã€‚</p>
</li>
<li><p>ä¿å­˜shortcutå’Œactionçš„å†å²è®°å½•:åˆ›å»ºçš„æ¯ä¸€ä¸ªshortcutï¼Œåº”è¯¥è€ƒè™‘åˆ°ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ä¸åŒçš„æ–¹å¼å®Œæˆç›¸åŒçš„ä»»åŠ¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®°å¾—è°ƒç”¨ <strong>reportShortcutUsed()</strong> æ–¹æ³•ï¼Œè¿™æ ·ï¼Œlauncherå°±å¯ä»¥æé«˜shortcutå¯¹åº”çš„actionsçš„ååº”é€Ÿåº¦ã€‚</p>
</li>
<li><p>åªæœ‰åœ¨shortcutsçš„æ„ä¹‰å­˜åœ¨æ—¶æ›´æ–°ï¼šå½“æ”¹å˜åŠ¨æ€å¿«æ·æ–¹å¼æ—¶ï¼Œåªæœ‰åœ¨shortcutä»ç„¶ä¿æŒç€å®ƒçš„å«ä¹‰æ—¶ï¼Œè°ƒç”¨ <strong>updateShortcuts()</strong> æ–¹æ³•æ”¹å˜å®ƒçš„ä¿¡æ¯ã€‚å¦åˆ™ï¼Œåº”è¯¥ä½¿ç”¨<strong>addDynamicShortcuts()</strong> æˆ–è€… <strong>setDynamicShortcuts()</strong> åˆ›å»ºä¸€ä¸ªå…·æœ‰æ–°å«ä¹‰çš„IDçš„å¿«æ·æ–¹å¼ã€‚</p>
<p>  ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»åˆ›å»ºäº†å¯¼èˆªåˆ°ä¸€ä¸ªè¶…å¸‚çš„å¿«æ·æ–¹å¼ï¼Œå¦‚æœè¶…å¸‚çš„åç§°æ”¹å˜äº†ä½†æ˜¯ä½ç½®å¹¶æ²¡æœ‰å˜åŒ–æ—¶ï¼Œåªæ›´æ–°ä¿¡æ¯æ˜¯åˆé€‚çš„ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·å¼€å§‹åœ¨ä¸€ä¸ªä¸åŒä½ç½®çš„è¶…å¸‚è´­ç‰©æ—¶ï¼Œæœ€å¥½æ˜¯åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¿«æ·æ–¹å¼(è€Œä¸ä»…ä»…æ˜¯æ›´æ–°ä¿¡æ¯äº†)ã€‚</p>
</li>
<li><p>åœ¨å¤‡ä»½å’Œæ¢å¤æ—¶ï¼ŒåŠ¨æ€shortcutsä¸åº”è¯¥è¢«ä¿å­˜:æ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ¨èæˆ‘ä»¬åœ¨éœ€è¦APPå¯åŠ¨å’Œé‡æ–°å‘å¸ƒåŠ¨æ€å¿«æ·æ–¹å¼æ—¶ï¼Œæ£€æŸ¥ <strong>getDynamicShortcuts()</strong> çš„å¯¹è±¡çš„æ•°é‡ã€‚å¯ä»¥å‚è€ƒ<a href="https://developer.android.com/guide/topics/ui/shortcuts.html#backup-and-restore" target="_blank" rel="external">Backup and Restore</a>éƒ¨åˆ†çš„ä»£ç ç‰‡æ®µã€‚</p>
</li>
</ul>
<h3 id="Round-Icon-Resources"><a href="#Round-Icon-Resources" class="headerlink" title="Round Icon Resources"></a>Round Icon Resources</h3><p>åœ¨Android 7.1ä¸Šï¼ŒGoogleæ¨å‡ºäº†ä¸€ä¸ªéƒ¨åˆ†ç”¨æˆ·å¯èƒ½ä¸å¤ªå–œæ¬¢çš„ç‰¹æ€§â€“åœ†å½¢å›¾æ ‡ã€‚åœ†å½¢å›¾æ ‡é•¿ä»€ä¹ˆæ ·ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„å›¾ã€‚</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/round_icon.png" alt="round icon" title="round icon">
<blockquote>
<p>åŒæ—¶ï¼Œåœ†å½¢å›¾æ ‡è§„èŒƒä¹Ÿä½œä¸ºä¸€éƒ¨åˆ†å†…å®¹åŠ å…¥åˆ°äº†æ›´æ–°è¯´æ˜å’Œå¼€å‘æ–‡æ¡£ä¸­ã€‚<br>åº”ç”¨ç¨‹åºç°åœ¨å¯ä»¥å®šä¹‰åœ†å½¢å¯åŠ¨å™¨å›¾æ ‡ä»¥ç”¨äºç‰¹å®šçš„ç§»åŠ¨è®¾å¤‡ä¹‹ä¸Šã€‚å½“å¯åŠ¨å™¨è¯·æ±‚åº”ç”¨ç¨‹åºå›¾æ ‡æ—¶ï¼Œç¨‹åºæ¡†æ¶åº”è¿”å› androidï¼šicon æˆ– androidï¼šroundIconï¼Œè§†è®¾å¤‡å…·ä½“è¦æ±‚è€Œå®šã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºåœ¨å¼€å‘æ—¶åº”è¯¥ç¡®ä¿åŒæ—¶å®šä¹‰ androidï¼šiconå’Œ androidï¼šroundIcon ä¸¤ä¸ªå˜é‡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Image Asset Studio æ¥è®¾è®¡åœ†å½¢å›¾æ ‡ã€‚</p>
<p>æ‚¨åº”è¯¥ç¡®ä¿åœ¨æ”¯æŒæ–°çš„åœ†å½¢å›¾æ ‡çš„è®¾å¤‡ä¸Šæµ‹è¯•æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºå›¾æ ‡çš„å¤–è§‚æ— è™å’Œå®é™…æ•ˆæœã€‚æµ‹è¯•æ‚¨çš„èµ„æºçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨ Google Pixel è®¾å¤‡ä¸Šå®‰è£…æ‚¨çš„åº”ç”¨ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡è¿è¡Œ Android æ¨¡æ‹Ÿå™¨å¹¶ä½¿ç”¨ Google API æ¨¡æ‹Ÿå™¨ç³»ç»Ÿï¼ˆç›®æ ‡ API ç­‰çº§ä¸º 25ï¼‰æµ‹è¯•æ‚¨çš„å›¾æ ‡ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <strong>Android Studio</strong> è‡ªå¸¦çš„ <strong>Image Asset Studio</strong>è®¾è®¡å›¾æ ‡ã€‚åœ¨é¡¹ç›®çš„ <strong>res</strong> ç›®å½•ä¸‹ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹© <strong>new</strong> â€“&gt; <strong>Image Asset</strong> å³å¯è®¾è®¡å›¾æ ‡ã€‚</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/ImageAssetStudio.png" alt="Image Asset Studio" title="Image Asset Studio">
<p>æ›´å¤šå…³äºè®¾è®¡åº”ç”¨å›¾æ ‡çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ<a href="https://material.google.com/style/icons.html#icons-product-icons" target="_blank" rel="external">Material Design guidelines</a>ã€‚</p>
<h3 id="Image-Keyboard-Support"><a href="#Image-Keyboard-Support" class="headerlink" title="Image Keyboard Support"></a>Image Keyboard Support</h3><p>åœ¨è¾ƒæ—©ç‰ˆæœ¬çš„Androidç³»ç»Ÿä¸­ï¼Œè½¯é”®ç›˜(ä¾‹å¦‚æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„Input Method Editorsï¼Œæˆ–è€…è¯´IME)ï¼Œåªèƒ½å¤Ÿç»™åº”ç”¨å‘é€unicodeç¼–ç çš„emojiï¼Œå¯¹äºrich contentï¼Œåº”ç”¨åªèƒ½é€šè¿‡ä½¿ç”¨è‡ªå»ºçš„ç§æœ‰çš„APIå®ç°å‘é€å›¾ç‰‡çš„åŠŸèƒ½ã€‚è€Œåœ¨Android 7.1ä¸­ï¼ŒSDKåŒ…å«äº†ä¸€ä¸ªå…¨æ–°çš„Commit Content APIï¼Œè¾“å…¥æ³•åº”ç”¨ä¸ä»…å¯ä»¥è°ƒç”¨æ­¤ API å®ç°å‘é€å›¾ç‰‡å’Œå…¶ä»–rich contentï¼Œä¸€äº›é€šè®¯åº”ç”¨ï¼ˆæ¯”å¦‚ Google Messengerï¼‰ä¹Ÿå¯ä»¥é€šè¿‡æ­¤ API æ¥æ›´å¥½åœ°å¤„ç†è¿™äº›æ¥è‡ªè¾“å…¥æ³•çš„å›¾ç‰‡ã€ç½‘é¡µä¿¡æ¯å’Œ GIF å†…å®¹ã€‚</p>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/image-keyboard-sample.png" alt="image keyboard" title="image keyboard">
<h4 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works"></a>How it works</h4><ol>
<li><p>å½“ç”¨æˆ·ç‚¹å‡»EditTextæ—¶ï¼Œ    editorä¼šå‘é€ä¸€ä¸ªå®ƒæ‰€èƒ½æ¥å—çš„ <strong>EditorInfo.contentMimeTypes</strong> MIME å†…å®¹ç±»å‹çš„åˆ—è¡¨ã€‚</p>
</li>
<li><p>IMEè¯»å–è¿™ä¸ªåœ¨è½¯é”®ç›˜ä¸­æ”¯æŒç±»å‹å’Œå±•ç¤ºå†…å®¹çš„åˆ—è¡¨ã€‚</p>
</li>
<li><p>å½“ç”¨æˆ·é€‰æ‹©ä¸€å¼ å›¾ç‰‡åï¼ŒIMEè°ƒç”¨ <strong>commitContent()</strong> å¹¶å‘editorå‘é€ä¸€ä¸ªInputContentInfoã€‚ <strong>commitContent()</strong> æ–¹æ³•æ˜¯ä¸€ä¸ªç±»ä¼¼äº <strong>commitText()</strong> çš„æ–¹æ³•ï¼Œä½†æ˜¯æ˜¯rich contentçš„ã€‚ <strong>InputContentInfo</strong> åŒ…å«ç€ä¸€ä¸ªè¡¨ç¤ºcontent providerä¸­å†…å®¹çš„URIã€‚ç„¶åæˆ‘ä»¬çš„åº”ç”¨å°±å¯ä»¥è¯·æ±‚ç›¸åº”çš„æƒé™å¹¶è¯»å–URIä¸­çš„å†…å®¹ã€‚</p>
</li>
</ol>
<img src="/2016/12/29/é€‚é…Android-7-1-Nougatæ–°ç‰¹æ€§/image-keyboard-diagram.png" alt="image keyboard diagram" title="image keyboard diagram">
<h4 id="Adding-Image-Support-to-Apps"><a href="#Adding-Image-Support-to-Apps" class="headerlink" title="Adding Image Support to Apps"></a>Adding Image Support to Apps</h4><p>ä¸ºäº†æ¥æ”¶æ¥è‡ªIMEçš„rich contentï¼Œåº”ç”¨å¿…é¡»å‘Šè¯‰IMEå®ƒæ‰€èƒ½æ¥æ”¶çš„å†…å®¹ç±»å‹å¹¶ä¹‹æŒ‡å®šå½“æ¥æ”¶åˆ°å†…å®¹åçš„å›è°ƒæ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ€æ ·åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿæ¥æ”¶PNGå›¾ç‰‡çš„ <strong>EditText</strong> çš„æ¼”ç¤ºä»£ç ã€‚</p>
<pre><code class="java">EditText editText = new EditText(this) {
    @Override
    public InputConnection onCreateInputConnection(EditorInfo editorInfo) {
        final InputConnection ic = super.onCreateInputConnection(editorInfo);
        EditorInfoCompat.setContentMimeTypes(editorInfo,
                new String [] {&quot;image/png&quot;});

        final InputConnectionCompat.OnCommitContentListener callback =
            new InputConnectionCompat.OnCommitContentListener() {
                @Override
                public boolean onCommitContent(InputContentInfoCompat inputContentInfo,
                        int flags, Bundle opts) {
                    // read and display inputContentInfo asynchronously
                    if (BuildCompat.isAtLeastNMR1() &amp;&amp; (flags &amp;
                        InputConnectionCompat.INPUT_CONTENT_GRANT_READ_URI_PERMISSION) != 0) {
                        try {
                            inputContentInfo.requestPermission();
                        }
                        catch (Exception e) {
                            return false; // return false if failed
                        }
                    }

                    // read and display inputContentInfo asynchronously.
                    // call inputContentInfo.releasePermission() as needed.

                    return true;  // return true if succeeded
                }
            };
        return InputConnectionCompat.createWrapper(ic, editorInfo, callback);
    }
};
</code></pre>
<p>ä»£ç è¿˜æ˜¯è›®å¤šçš„ï¼Œè§£é‡Šä¸€ä¸‹ã€‚</p>
<ul>
<li><p>ä¾‹å­ä½¿ç”¨äº†support libraryï¼Œå¹¶ä¸”å¼•ç”¨çš„æ˜¯ <strong>android.support.v13.view.inputmethod</strong> è€Œä¸æ˜¯ <strong>android.view.inputmethod</strong> ã€‚</p>
</li>
<li><p>ä¾‹å­åˆ›å»ºäº†ä¸€ä¸ª <strong>EditText</strong> å¹¶å¤å†™äº†å®ƒæ”¹å˜ <strong>InputConnection</strong> çš„ <strong>onCreateInputConnection(EditorInfo)</strong> æ–¹æ³•. <strong>InputConnection</strong> æ˜¯IMEå’Œæ­£åœ¨æ¥æ”¶è¾“å…¥çš„æ²Ÿé€šç®¡é“ã€‚</p>
</li>
<li><p>è°ƒç”¨ <strong>super.onCreateInputConnection()</strong> ä¿ç•™äº†å†…å»ºçš„è¡Œä¸º(åŒ…æ‹¬å‘é€å’Œæ¥æ”¶æ–‡æœ¬)ï¼Œå¹¶æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ª <strong>InputConnection</strong> çš„å¼•ç”¨ã€‚</p>
</li>
<li><p><strong>setContentMimeTypes()</strong> å‘ <strong>EditorInfo</strong> æ·»åŠ äº†ä¸€ä¸ªæ‰€æ”¯æŒçš„MIMEç±»å‹çš„åˆ—è¡¨ã€‚ éœ€è¦ä¿è¯åœ¨ <strong>setContentMimeTypes()</strong> ä¹‹å‰è°ƒç”¨ <strong>super.onCreateInputConnection()</strong> ã€‚</p>
</li>
<li><p>å›è°ƒåœ¨IMEæäº¤å†…å®¹æ˜¯è¢«æ‰§è¡Œã€‚ <strong>onCommitContent()</strong> æ–¹æ³•æœ‰ä¸€ä¸ªå¯¹åŒ…å«äº†å†…å®¹URIçš„ <strong>InputContentInfoCompat</strong> çš„å¼•ç”¨ã€‚</p>
<ul>
<li>å½“æˆ‘ä»¬çš„åº”ç”¨è¿è¡Œåœ¨API Level 25æˆ–è€…æ›´é«˜å¹¶ä¸”IMEè®¾ç½®äº† <strong>INPUT_CONTENT_GRANT_READ_URI_PERMISSION</strong> flagæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è¯·æ±‚å¹¶ä¸”é‡Šæ”¾æƒé™ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ­¤ä¹‹å‰å°±æ‹¥æœ‰content URIçš„è®¿é—®æƒé™ï¼Œä¸€æ˜¯å› ä¸ºæƒé™æ˜¯ç”±IMEæˆæƒçš„ï¼ŒäºŒæ˜¯content providerä¸å¯¹è®¿é—®è¿›è¡Œçº¦æŸã€‚æ›´å¤šçš„ä¿¡æ¯å¯ä»¥è®¿é—®<a href="https://developer.android.com/guide/topics/text/image-keyboard.html#adding_image_support_to_imes" target="_blank" rel="external">Adding Image Support to IMEs</a></li>
</ul>
</li>
<li><p><strong>createWrapper()</strong> åŒ…è£…äº†inputConnectionå’Œå·²ä¿®æ”¹çš„editorInfoï¼Œæ–°çš„InputConnectionçš„å›è°ƒå¹¶ä¸”è¿”å›ã€‚</p>
</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€äº›å®è·µå°æŠ€å·§ã€‚</p>
<ul>
<li><p>ä¸æ”¯æŒrich contentçš„Editorä¸åº”è¯¥è°ƒç”¨ <strong>setContentTypes()</strong> å¹¶æŠŠ <strong>EditorInfo.contentMimeTypes</strong> è®¾ç½®ä¸ºnullã€‚</p>
</li>
<li><p>Editoråº”è¯¥å¿½ç•¥æ‰åœ¨ <strong>InputConnectionInfo</strong> ä¸­æŒ‡å®šçš„MIMEç±»å‹å’Œæ‰€æ¥æ”¶ç±»å‹ä¸é€šçš„å†…å®¹ã€‚</p>
</li>
<li><p>rich contentä¸å½±å“ä¹Ÿä¸è¢«æ–‡æœ¬æŒ‡é’ˆçš„ä½ç½®æ‰€å½±å“ã€‚editoråœ¨è¿›è¡Œå†…å®¹å¤„ç†æ˜¯å¯ä»¥ç›´æ¥å¿½ç•¥æ‰å…‰æ ‡çš„ä½ç½®ã€‚</p>
</li>
<li><p>åœ¨editorçš„ <strong>OnCommitContentListener.onCommitContent()</strong> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¼‚æ­¥çš„è¿”å›trueï¼Œç”šè‡³æ˜¯åœ¨åŠ è½½å†…å®¹ä¹‹å‰ã€‚</p>
</li>
<li><p>ä¸åŒäºæ–‡æœ¬å†…å®¹åœ¨è¢«æäº¤ä¹‹å‰å¯ä»¥åœ¨IMEä¸­è¢«ç¼–è¾‘ï¼Œrich contentä¼šè¢«ç«‹å³æäº¤ã€‚éœ€è¦æ³¨æ„ç‰¹æ€§ï¼Œå¦‚æœæƒ³è¦æä¾›ç¼–è¾‘æˆ–è€…åˆ é™¤å†…å®¹çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±æä¾›å¤„ç†é€»è¾‘ã€‚</p>
</li>
</ul>
<p>ä¸ºäº†æµ‹è¯•APPï¼Œéœ€è¦ç¡®ä¿ä½ çš„è®¾å¤‡æˆ–è€…è™šæ‹Ÿæœºçš„é”®ç›˜èƒ½å¤Ÿå‘é€rich contentã€‚ä½ å¯ä»¥åœ¨Android 7.1æˆ–è€…æ›´é«˜çš„ç³»ç»Ÿä¸­ä½¿ç”¨Google Keyboardï¼Œæˆ–è€…æ˜¯å®‰è£…<a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME sample</a>.</p>
<p>ä½ å¯ä»¥åœ¨<a href="https://developer.android.com/samples/CommitContentSampleApp/index.html" target="_blank" rel="external">CommitContent App sample</a>è·å–åˆ°å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚</p>
<h4 id="Adding-Image-Support-to-IMEs"><a href="#Adding-Image-Support-to-IMEs" class="headerlink" title="Adding Image Support to IMEs"></a>Adding Image Support to IMEs</h4><p>æƒ³è¦IMEæ”¯æŒå‘é€rich contentï¼Œéœ€è¦å¼•å…¥ä¸‹é¢æ‰€å±•ç¤ºçš„Commit Content APIã€‚</p>
<ul>
<li><p>å¤å†™ <strong>onStartInput()</strong> æˆ–è€… <strong>onStartInputView()</strong> ï¼Œå¹¶è¯»å–æ¥è‡ªç›®æ ‡editorçš„æ”¯æŒå†…å®¹ç±»å‹åˆ—è¡¨ã€‚</p>
<pre><code class="java">  @Override
  public void onStartInputView(EditorInfo info, boolean restarting) {
      String[] mimeTypes = EditorInfoCompat.getContentMimeTypes(editorInfo);

      boolean gifSupported = false;
      for (String mimeType : mimeTypes) {
          if (ClipDescription.compareMimeTypes(mimeType, &quot;image/gif&quot;)) {
              gifSupported = true;
          }
      }

      if (gifSupported) {
          // the target editor supports GIFs. enable corresponding content
      } else {
          // the target editor does not support GIFs. disable corresponding content
      }
  }
</code></pre>
</li>
<li><p>å½“ç”¨æˆ·é€‰æ‹©äº†ä¸€å¼ å›¾ç‰‡æ—¶ï¼Œå°†å†…å®¹æäº¤ç»™APPã€‚å½“IMEæœ‰æ­£åœ¨ç¼–è¾‘çš„æ–‡æœ¬æ—¶ï¼Œåº”è¯¥é¿å…è°ƒç”¨ <strong>commitContent()</strong> ï¼Œå› ä¸ºè¿™æ ·å¯èƒ½å¯¼è‡´editorå¤±å»ç„¦ç‚¹ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µå±•ç¤ºäº†æ€æ ·æäº¤ä¸€å¼ GIFå›¾ç‰‡ã€‚</p>
<pre><code class="java">  /**
   * Commits a GIF image
   *
   * @param contentUri Content URI of the GIF image to be sent
   * @param imageDescription Description of the GIF image to be sent
   */
  public static void commitGifImage(Uri contentUri, String imageDescription) {
      InputContentInfoCompat inputContentInfo = new InputContentInfoCompat(
              contentUri,
              new ClipDescription(imageDescription, new String[]{&quot;image/gif&quot;}));
      InputConnection inputConnection = getCurrentInputConnection();
      EditorInfo editorInfo = getCurrentInputEditorInfo();
      Int flags = 0;
      If (android.os.Build.VERSION.SDK_INT &gt;= 25) {
          flags |= InputConnectionCompat.INPUT_CONTENT_GRANT_READ_URI_PERMISSION;
      }
      InputConnectionCompat.commitContent(
              inputConnection, editorInfo, inputContentInfo, flags, opts);
  }
</code></pre>
</li>
<li><p>ä½œä¸ºä¸€ä¸ªIMEå¼€å‘è€…ï¼Œæœ‰å¾ˆå¤§å¯èƒ½ä½ éœ€è¦å¼•å…¥ä½ è‡ªå·±çš„content provideræ¥å“åº”content URIè¯·æ±‚ã€‚å¦‚æœä½ çš„IMEæ”¯æŒæ¥è‡ªåƒ <strong>MediaStore</strong> è¿™æ ·å·²ç»å­˜åœ¨çš„content providerå€’æ˜¯å¯ä»¥ä¾‹å¤–ã€‚å…³äºåˆ›å»ºcontent providerçš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è§ <a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME sample</a>, [Content Provider] (<a href="https://developer.android.com/guide%20/topics/providers/content-providers.html)æ–‡æ¡£" target="_blank" rel="external">https://developer.android.com/guide%20/topics/providers/content-providers.html)æ–‡æ¡£</a>, <a href="https://developer.android.com/training/secure-file-sharing/setup-sharing.html" target="_blank" rel="external">File Provider</a>æ–‡æ¡£ã€‚</p>
</li>
<li><p>å¦‚æœæ­£åœ¨åˆ›å»ºè‡ªå·±çš„content providerï¼Œå»ºè®®ä¸è¦export(å°† android:export è®¾ç½®ä¸ºfalse)ã€‚é€šè¿‡è®¾ç½® <strong>android:grandUriPermission</strong> ä¸ºtrueå…è®¸åœ¨providerå†…éƒ¨è¿›è¡Œæƒé™æˆäºˆæ›¿ä»£ã€‚ç„¶åï¼Œä½ çš„IMEåœ¨å†…å®¹æäº¤æ—¶å¯ä»¥æˆäºˆè®¿é—®content URIçš„æƒé™ã€‚æœ‰ä¸¤ç§å®ç°çš„æ–¹æ³•ï¼š</p>
<ul>
<li><p>åœ¨Android 7.1(API Level 25)æˆ–æ›´é«˜çš„ç³»ç»Ÿä¸­ï¼Œå½“è°ƒç”¨ <strong>commitContent</strong> æ–¹æ³•æ—¶ï¼Œå°†flagå‚æ•°è®¾ç½®ä¸º <strong>INPUT_CONTENT_GRANT_READ_URI_PERMISSION</strong> ã€‚ç„¶åï¼ŒAPPæ”¶åˆ°çš„ <strong>InputContentInfo</strong> å¯¹è±¡å¯ä»¥é€šè¿‡è°ƒç”¨ <strong>requestPermission()</strong> æ–¹æ³•å’Œ <strong>releasePermission()</strong> è¯·æ±‚å’Œé‡Šæ”¾ä¸´æ—¶è®¿é—®æƒé™ã€‚</p>
</li>
<li><p>åœ¨Android 7.0(API Level 24)æˆ–è€…æ›´ä½çš„ç³»ç»Ÿä¸­ï¼Œ <strong>INPUT_CONTENT_GRANT_READ_URI_PERMISSION</strong> ç›´æ¥è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨çš„æˆäºˆå†…å®¹è®¿é—®æƒé™ã€‚æ–¹æ³•å°±æ˜¯ <strong>grantUriPermission()</strong> ,ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å¼•å…¥æ»¡è¶³è‡ªå·±è¦æ±‚çš„æœºåˆ¶ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>æƒé™æˆäºˆçš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME sample</a>ä¸­çš„doCommitContent()æ–¹æ³•ã€‚</p>
<p>ä¸ºäº†æµ‹è¯•IMEï¼Œç¡®ä¿æˆ‘ä»¬çš„è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨æ‹¥æœ‰æ¥æ”¶rich contentçš„çš„åº”ç”¨ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Android 7.1æˆ–è€…æ›´é«˜çš„ç³»ç»Ÿä¸­ä½¿ç”¨Google Messengeråº”ç”¨æˆ–è€…å®‰è£…<a href="https://developer.android.com/samples/CommitContentSampleApp/index.html" target="_blank" rel="external">CommitContent App Sample</a>ã€‚</p>
<p>è·å–å®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥è®¿é—®<a href="https://developer.android.com/samples/CommitContentSampleIME/index.html" target="_blank" rel="external">CommitContent IME Sample</a>ã€‚</p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>Googleåœ¨åˆ·æ–°ç‰ˆæœ¬å·çš„è·¯ä¸Šç®€ç›´æ˜¯åœ¨ç­–é©¬å¥”è…¾äº†ï¼Œå˜šå„¿é©¾ã€‚æˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿçœ‹åˆ°Googleçš„åŠªåŠ›ï¼ŒAndroidä¹Ÿåœ¨å˜çš„è¶Šæ¥è¶Šå¥½ï¼ŒåŠ æ²¹å§ï¼Œå°æœºå™¨äººã€‚</p>
<p>æœ¬æ¬¡Shortcutséƒ¨åˆ†çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„GitHubä»“åº“<a href="https://github.com/TonnyL/ZhiHuDaily" target="_blank" rel="external">ZhiHuDaily</a>ä¸­çœ‹åˆ°ã€‚æ¬¢è¿starå“Ÿã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†]]></title>
      <url>http://tonnyl.github.io/2016/11/05/JAVA%E6%B7%B1%E5%85%8B%E9%9A%86%E4%B8%8E%E6%B5%85%E5%85%8B%E9%9A%86/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨å…‹éš†å¯ä»¥å¿«é€Ÿæ„é€ ä¸€ä¸ªå’Œå·²æœ‰å¯¹è±¡ç›¸åŒçš„å‰¯æœ¬</p>
<a id="more"></a>
<p>æ‰€æœ‰çš„Javaç±»éƒ½ç»§æ‰¿è‡ªjava.lang.Object,è€ŒObjectç±»æä¾›äº†ä¸€ä¸ªcloneæ–¹æ³•ï¼Œå¯ä»¥å°†ä¸€ä¸ªJavaå¯¹è±¡å¤åˆ¶ä¸€ä»½ã€‚éœ€è¦æ³¨æ„çš„æ˜¯èƒ½å¤Ÿå®ç°å…‹éš†çš„Javaç±»å¿…é¡»å®ç°ä¸€ä¸ªæ ‡ç¤ºæ¥å£Cloneableï¼Œè¡¨ç¤ºè¿™ä¸ªJavaç±»æ”¯æŒå¤åˆ¶ã€‚å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£ä½†æ˜¯è°ƒç”¨äº†clone()æ–¹æ³•ï¼ŒJavaç¼–è¯‘å™¨å°†æŠ›å‡ºä¸€ä¸ªCloneNotSupportedExceptionå¼‚å¸¸ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†"><a href="#ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†" class="headerlink" title="ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†"></a>ä»€ä¹ˆæ˜¯æµ…å…‹éš†å’Œæ·±å…‹éš†</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç±»åŒ…å«ä¸€äº›æˆå‘˜å¯¹è±¡ï¼Œåœ¨å…‹éš†å¯¹è±¡æ—¶ï¼Œæ ¹æ®å…¶æˆå‘˜å¯¹è±¡æ˜¯å¦ä¹Ÿå…‹éš†ï¼Œå…‹éš†åˆ†ä¸ºä¸¤ç§å½¢å¼ï¼šæ·±å…‹éš†å’Œæµ…å…‹éš†ã€‚</p>
<h4 id="æµ…å…‹éš†"><a href="#æµ…å…‹éš†" class="headerlink" title="æµ…å…‹éš†"></a>æµ…å…‹éš†</h4><p>åœ¨æµ…å…‹éš†ä¸­ï¼Œè¢«å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰æ™®é€šæˆå‘˜å˜é‡éƒ½å…·æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œè€Œæ‰€æœ‰çš„å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæµ…å…‹éš†ä»…ä»…å¤åˆ¶æ‰€è€ƒè™‘çš„å¯¹è±¡ï¼Œè€Œä¸å¤åˆ¶å®ƒæ‰€å¼•ç”¨çš„æˆå‘˜å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å…¶ä¸­çš„æˆå‘˜å¯¹è±¡å¹¶ä¸å¤åˆ¶ã€‚åœ¨æµ…å…‹éš†ä¸­ï¼Œå½“å¯¹è±¡è¢«å¤åˆ¶æ—¶å®ƒæ‰€åŒ…å«çš„æˆå‘˜å¯¹è±¡å´æ²¡æœ‰è¢«å¤åˆ¶ã€‚</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/shadow_copy.png" alt="æµ…å…‹éš†" title="æµ…å…‹éš†">
<p>å›¾ä¸­obj1ä¸ºåŸå‹å¯¹è±¡ï¼Œobj2ä¸ºå¤åˆ¶åçš„å¯¹è±¡ï¼ŒcontainedObj1å’ŒcontainedObj2ä¸ºæˆå‘˜å¯¹è±¡ã€‚</p>
<h4 id="æ·±å…‹éš†"><a href="#æ·±å…‹éš†" class="headerlink" title="æ·±å…‹éš†"></a>æ·±å…‹éš†</h4><p>åœ¨æ·±å…‹éš†ä¸­è¢«å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰æ™®é€šæˆå‘˜å˜é‡ä¹Ÿéƒ½å«æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œé™¤å»é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡ã€‚é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡å°†æŒ‡å‘è¢«å¤åˆ¶è¿‡æ¥çš„æ–°å¯¹è±¡ï¼Œè€Œä¸å†æ˜¯åŸæœ‰çš„é‚£äº›è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæ·±å…‹éš†æŠŠè¦å¤åˆ¶çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½å¤åˆ¶äº†ä¸€éã€‚åœ¨æ·±å…‹éš†ä¸­ï¼Œé™¤äº†å¯¹è±¡æœ¬èº«è¢«å¤åˆ¶å¤–ï¼Œå¯¹è±¡åŒ…å«çš„å¼•ç”¨ä¹Ÿè¢«å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯å…¶ä¸­çš„æˆå‘˜å¯¹è±¡ä¹Ÿè¢«å¤åˆ¶ã€‚</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/deep_copy.png" alt="æ·±å…‹éš†" title="æ·±å…‹éš†">
<h3 id="Javaä¸­clone-æ–¹æ³•è§£æ"><a href="#Javaä¸­clone-æ–¹æ³•è§£æ" class="headerlink" title="Javaä¸­clone()æ–¹æ³•è§£æ"></a>Javaä¸­clone()æ–¹æ³•è§£æ</h3><p>Javaè¯­è¨€æä¾›çš„clone()æ–¹æ³•å°†å¯¹è±¡å¤åˆ¶äº†ä¸€ä»½å¹¶è¿”å›ç»™è°ƒç”¨è€…ã€‚ä¸€èˆ¬è€Œè¨€,clone()æ–¹æ³•æ»¡è¶³ï¼š</p>
<ol>
<li>å¯¹ä»»ä½•çš„å¯¹è±¡xï¼Œéƒ½æœ‰x.clone() != xï¼Œå³å…‹éš†å¯¹è±¡ä¸åŸå¯¹è±¡ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</li>
<li>å¯¹ä»»ä½•å¯¹å¯¹è±¡xï¼Œéƒ½æœ‰x.clone().getClass() == x.getClass()ï¼Œå³å…‹éš†å¯¹è±¡ä¸åŸå¯¹è±¡çš„ç±»å‹ä¸€æ ·ã€‚</li>
<li>å¦‚æœå¯¹è±¡xçš„equals()æ–¹æ³•å®šä¹‰æ°å½“ï¼Œé‚£ä¹ˆx.clone().equals(x)åº”è¯¥æˆç«‹ã€‚</li>
</ol>
<p>ä¸ºäº†è·å–å¯¹è±¡çš„ä¸€ä»½æ‹·è´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Objectç±»çš„clone()æ–¹æ³•ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>åœ¨æ´¾ç”Ÿç±»ä¸­è¦†ç›–åŸºç±»çš„clone()æ–¹æ³•ï¼Œå¹¶å£°æ˜ä¸ºpublicã€‚</li>
<li>åœ¨æ´¾ç”Ÿç±»çš„clone()æ–¹æ³•ä¸­ï¼Œè°ƒç”¨super.clone()ã€‚</li>
<li>åœ¨æ´¾ç”Ÿç±»ä¸­å®ç°Cloneableæ¥å£ã€‚</li>
</ol>
<p>åœ¨Javaä¸­ï¼Œé€šè¿‡è¦†ç›–Objectç±»çš„clone()æ–¹æ³•å¯ä»¥å®ç°æµ…å…‹éš†ï¼Œå¦‚æœéœ€è¦å®ç°æ·±å…‹éš†ï¼Œå¯ä»¥é€šè¿‡åºåˆ—åŒ–ç­‰æ–¹å¼å®ç°ã€‚</p>
<p>åºåˆ—åŒ–(Serialization)å°±æ˜¯å°†å¯¹è±¡å†™åˆ°æµçš„è¿‡ç¨‹ï¼Œå†™åˆ°æµä¸­çš„å¯¹è±¡æ˜¯åŸå¯¹è±¡çš„ä¸€ä¸ªæ‹·è´ï¼Œè€ŒåŸå¯¹è±¡ä»ç„¶å­˜åœ¨ä¸å†…å­˜ä¸­ã€‚é€šè¿‡åºåˆ—åŒ–å®ç°çš„æ‹·è´ä¸ä»…å¯ä»¥å¤åˆ¶å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸”å¯ä»¥å¤åˆ¶å…¶å¼•ç”¨çš„æˆå‘˜å¯¹è±¡ï¼Œå› æ­¤é€šè¿‡åºåˆ—åŒ–å°†å¯¹è±¡å†™åˆ°ä¸€ä¸ªæµä¸­ï¼Œå†ä»æµé‡Œå°†å…¶è¯»å‡ºæ¥ï¼Œä»è€Œå®ç°å…‹éš†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯èƒ½å¤Ÿå®ç°åºåˆ—åŒ–çš„å¯¹è±¡å…¶ç±»å¿…é¡»å®ç°Serializableæ¥å£ï¼Œå¦åˆ™æ— æ³•å®ç°åºåˆ—åŒ–æ“ä½œã€‚</p>
<p>Javaæä¾›çš„Cloneableæ¥å£å’ŒSerializableæ¥å£å…¶ä»£ç éƒ½éå¸¸ç®€å•ï¼Œå®ƒä»¬æ˜¯ç©ºæ¥å£ï¼Œè¿™ç§ç©ºæ¥å£ä¹Ÿç§°ä¸ºæ ‡ç¤ºæ¥å£ï¼Œæ ‡ç¤ºæ¥å£ä¸­æ²¡æœ‰ä»»ä½•æ–¹æ³•å®šä¹‰ï¼Œå…¶ä½œç”¨å°±æ˜¯å‘Šè¯‰JREè¿™äº›æ¥å£çš„å®ç°ç±»æ˜¯å¦å…·æœ‰æŸä¸ªåŠŸèƒ½ï¼Œå¦‚æ˜¯å¦æ”¯æŒå…‹éš†ï¼Œæ˜¯å¦æ”¯æŒåºåˆ—åŒ–ç­‰ã€‚</p>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>ä¸‹é¢é€šè¿‡ä¸¤ä¸ªå®ä¾‹åˆ†åˆ«å®ç°æµ…å…‹éš†å’Œæ·±å…‹éš†ã€‚</p>
<h4 id="é‚®ä»¶æµ…å…‹éš†"><a href="#é‚®ä»¶æµ…å…‹éš†" class="headerlink" title="é‚®ä»¶æµ…å…‹éš†"></a>é‚®ä»¶æµ…å…‹éš†</h4><p>1.å®ä¾‹è¯´æ˜</p>
<p>ç”±äºé‚®ä»¶å¯¹è±¡åŒ…å«çš„å†…å®¹è¾ƒå¤š(å¦‚å‘é€è€…ã€æ¥æ”¶è€…ã€æ ‡é¢˜ã€å†…å®¹ã€ä¸»é¢˜ã€æ—¥æœŸã€é™„ä»¶ç­‰)ï¼ŒæŸç³»ç»Ÿç°éœ€è¦æä¾›ä¸€ä¸ªé‚®ä»¶å¤åˆ¶åŠŸèƒ½ï¼Œå¯¹äºå·²ç»åˆ›å»ºå¥½çš„é‚®ä»¶å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªæ–°çš„é‚®ä»¶å¯¹è±¡ï¼Œå¦‚æœè¦ä¿®æ”¹æŸéƒ¨åˆ†å†…å®¹ï¼Œæ— é¡»ä¿®æ”¹åŸå§‹çš„é‚®ä»¶å¯¹è±¡ï¼Œåªéœ€è¦ä¿®æ”¹å¤åˆ¶å¾—åˆ°çš„é‚®ä»¶å¯¹è±¡å³å¯ã€‚åœ¨æœ¬å®ä¾‹ä¸­ä½¿ç”¨æµ…å…‹éš†å®ç°é‚®ä»¶å¤åˆ¶ï¼Œå¤åˆ¶é‚®ä»¶(E_mail)çš„åŒæ—¶ä¸å¤åˆ¶é™„ä»¶(Attachment)ã€‚</p>
<p>2.å®ä¾‹ç±»å›¾</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/shadow_clone_class_diagram.png" alt="æµ…å…‹éš†ç±»å›¾" title="æµ…å…‹éš†ç±»å›¾">
<p>3.å®ä¾‹ä»£ç åŠè§£é‡Š</p>
<p>(1) æŠ½è±¡åŸå‹ç±»Object</p>
<pre><code class="Java">package java.lang
    ...
    protected native Object clone() throws CloneNotSupportedExceptioni;
    ...
</code></pre>
<p>Objectä½œä¸ºæŠ½è±¡åŸå‹ç±»ï¼Œåœ¨Javaä¸­ï¼Œæ‰€æœ‰çš„ç±»éƒ½æ˜¯Objectçš„å­ç±»ï¼Œåœ¨Objectä¸­æä¾›å…‹éš†æ–¹æ³•clone()ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå…¶clone()æ–¹æ³•å…·ä½“å®ç°ç”±JVMå®Œæˆï¼Œç”¨æˆ·ä½¿ç”¨æ—¶æ— é¡»å…³å¿ƒã€‚</p>
<p>(2) å…·ä½“åŸå‹ç±»Email(é‚®ä»¶ç±»)</p>
<pre><code class="Java">public class Email implements Cloneable {

    private Attachment attachment = null;

    public Email() {
        this.attachment = new Attachment();
    }

    public Object clone() {
        Email clone = null;
        try {
            clone = (Email) super.clone();
        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
        return  clone;
    }

    public Attachment getAttachment() {
        return this.attachment;
    }

    public void display() {
        System.out.println(&quot;æŸ¥çœ‹é‚®ä»¶&quot;);
    }

}
</code></pre>
<p>Emailç±»æ˜¯å…·ä½“åŸå‹ç±»ï¼Œä¹Ÿæ˜¯Objectç±»çš„å­ç±»ï¼Œåœ¨Javaä¸­ï¼Œåªæœ‰å®ç°äº†Cloneableæ¥å£çš„ç±»æ‰èƒ½ä½¿ç”¨clone()æ–¹æ³•æ¥è¿›è¡Œå¤åˆ¶ï¼Œå› æ­¤Emailç±»å®ç°äº†Cloneableæ¥å£ã€‚åœ¨Emailç±»ä¸­è¦†ç›–äº†Objectçš„clone()æ–¹æ³•ï¼ŒåŠŸè¿‡ç›´æ¥æˆ–é—´æ¥è°ƒç”¨Objectçš„clone()æ–¹æ³•è¿”å›ä¸€ä¸ªå…‹éš†çš„åŸå‹å¯¹è±¡ã€‚åœ¨Emailç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæˆå‘˜å¯¹è±¡attachmentï¼Œç±»å‹ä¸ºAttachmentã€‚</p>
<p>4.è¾…åŠ©ä»£ç </p>
<p>(1) é™„ä»¶ç±»Attachment</p>
<pre><code class="Java">public class Attachment {

    public void download() {
        System.out.println(&quot;ä¸‹è½½é™„ä»¶&quot;);
    }

}
</code></pre>
<p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜æ·±å…‹éš†å’Œæµ…å…‹éš†çš„åŒºåˆ«ï¼Œåœ¨æœ¬å®ä¾‹ä¸­å¼•å…¥äº†é™„ä»¶ç±»Attachment,é‚®ä»¶ç±»Emailä¸é™„ä»¶ç±»æ˜¯ç»„åˆå…³è”å…³ç³»ï¼Œåœ¨é‚®ä»¶ç±»ä¸­å®šä¹‰ä¸€ä¸ªé™„ä»¶ç±»å¯¹è±¡ä½œä¸ºå…¶æˆå‘˜å¯¹è±¡ã€‚</p>
<p>(2) å®¢æˆ·ç«¯æµ‹è¯•ç±»Client</p>
<pre><code class="Java">public class Client {

    public static void main(String[] args) {
        Email email, copyEmail;
        email = new Email();
        copyEmail = (Email) email.clone();

        System.out.println(&quot;email == copyEmail?&quot;);
        System.out.println(email == copyEmail);

        System.out.println(&quot;email.getAttachment == copyEmail.getAttachment?&quot;);
        System.out.println(email.getAttachment() == copyEmail.getAttachment());

    }

}
</code></pre>
<p>åœ¨Clientå®¢æˆ·ç«¯æµ‹è¯•ç±»ä¸­ï¼Œæ¯”è¾ƒåŸå‹å¯¹è±¡å’Œå¤åˆ¶å¯¹è±¡æ˜¯å¦ä¸€è‡´ï¼Œå¹¶æ¯”è¾ƒå…¶æˆå‘˜å¯¹è±¡attachmentçš„å¼•ç”¨æ˜¯å¦ä¸€è‡´ã€‚</p>
<p>5.ç»“æœåˆ†æ</p>
<p>ç¼–è¯‘å¹¶è¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•ç±»ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>email == copyEmail?
false
email.getAttachment == copyEmail.getAttachment?
true
</code></pre><h4 id="é‚®ä»¶æ·±å…‹éš†"><a href="#é‚®ä»¶æ·±å…‹éš†" class="headerlink" title="é‚®ä»¶æ·±å…‹éš†"></a>é‚®ä»¶æ·±å…‹éš†</h4><p>1.å®ä¾‹è¯´æ˜</p>
<p>ä½¿ç”¨æ·±å…‹éš†å®ç°é‚®ä»¶å¤åˆ¶ï¼Œå³å¤åˆ¶é‚®ä»¶çš„åŒæ—¶å¤åˆ¶é™„ä»¶ã€‚</p>
<p>2.å®ä¾‹ç±»å›¾</p>
<img src="/2016/11/05/JAVAæ·±å…‹éš†ä¸æµ…å…‹éš†/deep_clone_class_diagram.png" alt="æ·±å…‹éš†ç±»å›¾" title="æ·±å…‹éš†ç±»å›¾">
<p>3.å®ä¾‹ä»£ç ä¸è§£é‡Š</p>
<pre><code class="Java">import java.io.*;

public class Email implements Serializable {

    private Attachment attachment = null;

    public Email() {
        this.attachment = new Attachment();
    }

    public Object deepClone() throws IOException, ClassNotFoundException, OptionalDataException {

        // å°†å¯¹è±¡å†™å…¥æµä¸­
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(baos);
        oos.writeObject(this);

        // å°†å¯¹è±¡ä»æµä¸­è¯»å‡º
        ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
        ObjectInputStream ois = new ObjectInputStream(bais);

        return ois.readObject();

    }

    public Attachment getAttachment() {
        return this.attachment;
    }

    public void display() {
        System.out.println(&quot;æŸ¥çœ‹é‚®ä»¶&quot;);
    }

}
</code></pre>
<p>Emailä½œä¸ºå…·ä½“åŸå‹ç±»ï¼Œç”±äºå®ç°çš„æ˜¯æ·±å…‹éš†ï¼Œæ— é¡»ä½¿ç”¨Objectçš„clone()æ–¹æ³•ï¼Œå› æ­¤æ— é¡»å®ç°Cloneableæ¥å£ï¼›é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼å®ç°æ·±å…‹éš†ï¼Œç”±äºè¦å°†Emailç±»å‹çš„å¯¹è±¡å†™å…¥æµä¸­ï¼Œå› æ­¤Emailç±»éœ€è¦å®ç°Serializiableæ¥å£ã€‚</p>
<p>4.è¾…åŠ©ä»£ç </p>
<p>(1)é™„ä»¶ç±»</p>
<pre><code class="Java">import java.io.Serializable;

public class Attachment implements Serializable {

    public void download() {
        System.out.println(&quot;ä¸‹è½½é™„ä»¶&quot;);
    }

}
</code></pre>
<p>ä½œä¸ºEmailç±»çš„å¯¹è±¡æˆå‘˜ï¼Œåœ¨æ·±å…‹éš†ä¸­ï¼ŒAttachmentç±»å‹çš„å¯¹è±¡ä¹Ÿå°†è¢«å†™å…¥æµä¸­ï¼Œå› æ­¤Attachmentç±»ä¹Ÿéœ€è¦å®ç°Serializiableæ¥å£ã€‚</p>
<p>(2)å®¢æˆ·ç«¯æµ‹è¯•ç±»Client</p>
<pre><code class="Java">public class Client {

    public static void main(String[] args) {
        Email email, copyEmail = null;
        email = new Email();

        try {
            copyEmail = (Email) email.deepClone();
        } catch (Exception e) {
            e.printStackTrace();
        }

        System.out.println(&quot;email == copyEmail?&quot;);
        System.out.println(email == copyEmail);

        System.out.println(&quot;email.getAttachment == copyEmail.getAttachment?&quot;);
        System.out.println(email.getAttachment() == copyEmail.getAttachment());

    }

}
</code></pre>
<p>5.ç»“æœåŠåˆ†æ</p>
<p>ç¼–è¯‘è¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•ç±»ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>email == copyEmail?
false
email.getAttachment == copyEmail.getAttachment?
false
</code></pre><p>é€šè¿‡ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè¡¨è¾¾å¼(email == copyEmail)ç»“æœä¸ºfalseï¼Œå³é€šè¿‡å¤åˆ¶å¾—åˆ°çš„å¯¹è±¡ä¸åŸå‹å¯¹è±¡çš„å¼•ç”¨ä¸ä¸€è‡´ï¼Œè¡¨è¾¾å¼(email.getAttachment() == copyEmail.getAttachment())ç»“æœä¸ºfalseï¼ŒåŸå‹å¯¹è±¡ä¸å…‹éš†å¯¹è±¡æˆå‘˜å¯¹è±¡çš„å¼•ç”¨ä¸ç›¸åŒï¼Œè¯´æ˜å…¶æˆå‘˜å¯¹è±¡ä¹Ÿå¤åˆ¶äº†ä¸€ä»½ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[macOSå®‰è£…gccæ•™ç¨‹]]></title>
      <url>http://tonnyl.github.io/2016/10/31/macOS%E5%AE%89%E8%A3%85gcc%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>ç®€å•å‡ æ­¥å°±å¯ä»¥åœ¨macä¸ŠæˆåŠŸå®‰è£…gcc<br><a id="more"></a></p>
<p>ç½‘ä¸Šçš„æ•™ç¨‹å¤§å¤šæ˜¯é€šè¿‡å®‰è£…Xcodeå®ç°å®‰è£…gccçš„ï¼Œè¿™ç§æ–¹å¼çš„èŠ±è´¹æœ‰ç‚¹å¤ªå¾—ä¸å¿å¤±ï¼ŒXcodeå æ®çš„ç©ºé—´æ˜¯åœ¨å¤ªå¤§ï¼Œè¿™å¯¹äº128gç”¨æˆ·ç®€ç›´å°±æ˜¯å™©æ¢¦ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯é€šè¿‡homebrewå®‰è£…ï¼Œå‰ææ˜¯ä½ ç”µè„‘ä¸Šè¦å®‰è£…äº†homebrewã€‚</p>
<p>è¿™é‡Œä»‹ç»ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚</p>
<p>1.åˆ°<a href="https://sourceforge.net/projects/hpc/files/hpc/gcc/" target="_blank" rel="external">è¿™é‡Œ</a>ä¸‹è½½æ‰€éœ€è¦çš„çš„gccå‹ç¼©åŒ…ã€‚<br><img src="/2016/10/31/macOSå®‰è£…gccæ•™ç¨‹/website.png" alt="ä¸‹è½½åœ°å€" title="ä¸‹è½½åœ°å€"></p>
<p>2.ä¸‹è½½å®Œæˆåï¼Œé€šè¿‡terminalè¿›å…¥ä¸‹è½½ç›®å½•ï¼Œå³gcc-4.8-bin.tar.gzæ‰€åœ¨çš„ç›®å½•ã€‚è¾“å…¥å‘½ä»¤ï¼š</p>
<pre><code>gunzip gcc-4.8-bin.tar.gz
</code></pre><p>è§£å‹gcc-4.8-bin.tar.gzå‹ç¼©åŒ…ï¼Œæ³¨æ„åªéœ€è¦è§£å‹ä¸€æ¬¡ï¼Œåœ¨åŒä¸€ç›®å½•ä¸‹å¾—åˆ°gcc-4.8-bin.taræ–‡ä»¶ã€‚</p>
<p>3.ç»§ç»­åœ¨terminalä¸­è¾“å…¥å‘½ä»¤ï¼š</p>
<pre><code>sudo tar -xvf gcc-4.8-bin.tar
</code></pre><p>è¾“å…¥å¯†ç åï¼Œè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆäº†usrç›®å½•ã€‚cd /user/local/binå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„gccç›¸å…³çš„å‘½ä»¤äº†ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥å°†æ•´ä¸ªç›®å½•ç§»åŠ¨åˆ°ä½ éœ€è¦çš„ç›®å½•ã€‚<br><img src="/2016/10/31/macOSå®‰è£…gccæ•™ç¨‹/directory.png" alt="è§£å‹åçš„ç›®å½•" title="è§£å‹åçš„ç›®å½•"></p>
<p>4.æ·»åŠ gccè·¯å¾„ã€‚å…³æ‰å½“å‰terminalï¼Œé‡æ–°æ–°å»ºä¸€ä¸ªterminalã€‚è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š<code>touch ï½/.bash_profile</code>æ–°å»ºä¸€ä¸ªbash_profileæ–‡ä»¶ï¼Œä½¿ç”¨viæˆ–è€…å…¶ä»–ç¼–è¾‘å™¨å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<code>export PATH=&quot;/Users/lizhaotailang/Gcc/usr/local/bin:$PATH&quot;</code>,å½“ç„¶è¿™æ˜¯æˆ‘çš„è·¯å¾„ï¼Œå…·ä½“çš„è·¯å¾„æ ¹æ®ä½ çš„å®é™…æƒ…å†µè€Œå®šã€‚å†™å…¥å®Œæˆåå…³é—­æ–‡ä»¶ã€‚ä¸ºäº†ä½¿æ–‡ä»¶ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦åœ¨terminalè¾“å…¥<code>source ï½ï¼.bash_profile</code>ã€‚</p>
<p>5.æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆã€‚åœ¨terminalä¸­è¾“å…¥ï¼š<code>echo $PATH</code>,å¦‚æœèƒ½å¤Ÿåœ¨è¾“å‡ºä¸­çœ‹åˆ°åˆšåˆšæ·»åŠ çš„è·¯å¾„å°±è¯´æ˜æ·»åŠ æˆåŠŸäº†ã€‚æˆ–è€…ç›´æ¥è¾“å…¥gccå‘½ä»¤ï¼Œå¦‚æœèƒ½å¤Ÿçœ‹åˆ°gccçš„clangé”™è¯¯è€Œä¸æ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶çš„è¯ï¼Œå°±è¯´æ˜é…ç½®æˆåŠŸäº†ã€‚<br><img src="/2016/10/31/macOSå®‰è£…gccæ•™ç¨‹/terminal.png" alt="è·¯å¾„é…ç½®" title="è·¯å¾„é…ç½®"></p>
<p>6.ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨gccäº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter]]></title>
      <url>http://tonnyl.github.io/2016/10/21/Android-Studio%E6%96%B0%E5%BB%BALibrary%E5%B9%B6%E4%B8%8A%E4%BC%A0%E5%88%B0JCenter/</url>
      <content type="html"><![CDATA[<p>ç®€å•å®ç”¨çš„æ•™ç¨‹ï¼Œæ•™ä½ å¦‚ä½•ä¸€æ­¥ä¸€æ­¥ä»æ–°å»ºLibraryåˆ°ä¸Šä¼ è‡³JCenter<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨å¼€å‘appçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çš„æƒ…å†µï¼Œä¾‹å¦‚å¸¸ç”¨çš„<a href="https://github.com/square/okhttp" target="_blank" rel="external">Okhttp</a>ï¼Œåªéœ€è¦æ·»åŠ ä¸€è¡Œä»£ç åˆ°appä¸‹åˆ°gradleæ–‡ä»¶ä¸­å°±å¯ä»¥å®ç°ã€‚</p>
<pre><code>compile &#39;com.squareup.okhttp3:okhttp:3.4.1&#39;
</code></pre><p>è¿™ç§æ–¹å¼ä½¿ç”¨çš„å°±æ˜¯squareupä¸Šä¼ åˆ°JCenterçš„Libraryã€‚é‚£ä¹ˆè¿™ç§æ–¹å¼æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</p>
<h3 id="Mavenä¸JCenter"><a href="#Mavenä¸JCenter" class="headerlink" title="Mavenä¸JCenter"></a>Mavenä¸JCenter</h3><p>JCenteræ˜¯ç”±<a href="https://bintray.com/" target="_blank" rel="external">bintray.com</a>ç»´æŠ¤çš„Mavenåº“ã€‚åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­å®šä¹‰å¦‚ä¸‹ï¼Œå°±å¯ä»¥ä½¿ç”¨JCenteräº†ã€‚</p>
<pre><code>allprojects {
    repositories {
        jcenter()
    }
}
</code></pre><p>Maven Central<br>Mavenæ˜¯ç”±<a href="https://sonatype.org/" target="_blank" rel="external">sonatype.org</a>ç»´æŠ¤çš„Mavenä»“åº“ã€‚<br>åœ¨ä½¿ç”¨ä¸€äº›å¼€æºåº“çš„æ—¶å€™å¯èƒ½ä¼šè¦æ±‚ä½ åœ¨æ ¹ç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code>allprojects {
    repositories {
        mavenCentral()
    }
}
</code></pre><p>è¿™æ ·å°±èƒ½ä½¿ç”¨mavenCentraläº†ã€‚</p>
<p>è¿™ä¸¤è€…æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p>
<p>å•Šå“ˆå“ˆå“ˆå“ˆï¼Œæ²¡æœ‰å…³ç³»ï¼ˆçŸ¥é“çœŸç›¸çš„æˆ‘è¡¨æƒ…æ˜¯è¿™æ ·çš„ï¼šä½ tmåœ¨é€—æˆ‘.jpgï¼‰ã€‚éƒ½æ˜¯Mavenä»“åº“ï¼Œåªæ˜¯å­˜æ”¾çš„åœ°æ–¹ä¸ä¸€æ ·ç½¢äº†ã€‚åœ¨è¾ƒè€ç‰ˆæœ¬çš„Android Studioä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ Maven Centralï¼Œä¸è¿‡ç”±äºå®ƒå¯¹å¼€å‘è€…ä¸é‚£ä¹ˆçš„å‹å¥½ï¼Œåæ¥å°±é»˜è®¤ä½¿ç”¨JCenteräº†ã€‚</p>
<h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><h4 id="1-æ³¨å†Œbintrayå¸å·"><a href="#1-æ³¨å†Œbintrayå¸å·" class="headerlink" title="1. æ³¨å†Œbintrayå¸å·"></a>1. æ³¨å†Œbintrayå¸å·</h4><p>è¿™æ˜¯å½“ç„¶äº†ï¼Œè¦åœ¨äººå®¶çš„å¹³å°ä¸Šå‘å¸ƒLibraryå½“ç„¶é¦–å…ˆå¾—æœ‰ä¸€ä¸ªå¸å·äº†ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨GitHubç™»å½•ã€‚</p>
<p>ä¼ é€é—¨â€”&gt;<a href="https://bintray.com/" target="_blank" rel="external">bintrayå®˜æ–¹ç½‘ç«™</a></p>
<p>æ³¨å†ŒæˆåŠŸåå°±èƒ½çœ‹åˆ°é…±çš„é¡µé¢äº†ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_personal_centre.png" alt="bintrayä¸ªäººä¸­å¿ƒ" title="bintrayä¸ªäººä¸­å¿ƒ">
<h4 id="2-åˆ›å»ºæ–°çš„ä»“åº“"><a href="#2-åˆ›å»ºæ–°çš„ä»“åº“" class="headerlink" title="2. åˆ›å»ºæ–°çš„ä»“åº“"></a>2. åˆ›å»ºæ–°çš„ä»“åº“</h4><p>ç‚¹å‡»Add New Repository, åˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œtypeé€‰æ‹©Mavenã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_create_new_repository.png" alt="åˆ›å»ºæ–°çš„ä»“åº“" title="åˆ›å»ºæ–°çš„ä»“åº“">
<h4 id="3-åˆ›å»ºpackage"><a href="#3-åˆ›å»ºpackage" class="headerlink" title="3. åˆ›å»ºpackage"></a>3. åˆ›å»ºpackage</h4><p>ä»“åº“åˆ›å»ºæˆåŠŸä¹‹åå°±å¯ä»¥æ·»åŠ åŒ…äº†ã€‚è¿›å…¥ä»“åº“è¯¦æƒ…é¡µï¼Œç‚¹å‡»å³ä¸‹è§’ï¼ŒAdd New Packageã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_add_new_package.png" alt="åˆ›å»ºpackage" title="åˆ›å»ºpackage">
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_add_new_package1.png" alt="åˆ›å»ºpackage" title="åˆ›å»ºpackage">
<p>åˆ°è¿™é‡Œï¼Œå‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ï¼Œç°åœ¨è¦å¼€å§‹å†™ä»£ç äº†ã€‚</p>
<h3 id="åˆ›å»ºLibrary"><a href="#åˆ›å»ºLibrary" class="headerlink" title="åˆ›å»ºLibrary"></a>åˆ›å»ºLibrary</h3><ol>
<li><p>æ–°å»ºä¸€ä¸ªAndroid Projectï¼Œè¿™é‡Œå’Œæˆ‘ä»¬å¹³æ—¶åˆ›å»ºå·¥ç¨‹æ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>åœ¨é¡¹ç›®æ ¹æ–‡ä»¶å¤¹ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œnew -&gt; module -&gt; Android Libraryã€‚</p>
</li>
</ol>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/AndroidStudio_create_new_module.png" alt="åˆ›å»ºLibrary" title="åˆ›å»ºLibrary">
<p>åˆ›å»ºæˆåŠŸåï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/AndroidStudio_project_structure.png" alt="é¡¹ç›®ç»“æ„" title="é¡¹ç›®ç»“æ„">
<ol>
<li>ç°åœ¨å°±å¯ä»¥åœ¨åº“ç›®å½•(æˆ‘è¿™é‡Œæ˜¯CircleProgressBar)ä¸‹ç¼–å†™ä»£ç äº†ã€‚</li>
</ol>
<h3 id="æ‰“åŒ…æ–‡ä»¶"><a href="#æ‰“åŒ…æ–‡ä»¶" class="headerlink" title="æ‰“åŒ…æ–‡ä»¶"></a>æ‰“åŒ…æ–‡ä»¶</h3><p>ä¹‹å‰çœ‹çš„æ•™ç¨‹éƒ½æ˜¯é€šè¿‡é…ç½®ç‚’é¸¡å¤æ‚(å¥½å§ï¼Œå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼Œé…ç½®äº†å¾ˆä¹…éƒ½æ²¡æœ‰æˆåŠŸâ€¦)çš„build.gradleçš„æ–¹æ³•æ¥å®ç°çš„ã€‚è¿™é‡Œä»‹ç»ä¸€ç§ç‚’é¸¡ç‚’é¸¡ç®€å•çš„æ–¹æ³•ã€‚</p>
<p>1.æ‰¾åˆ°Libraryä¸‹çš„build.gradleæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code>ext {
    PUBLISH_GROUP_ID = &#39;io.github.marktony&#39;
    PUBLISH_ARTIFACT_ID = &#39;circle-progress-bar&#39;
    PUBLISH_VERSION = &#39;1.1&#39;
}
</code></pre><p>æ–‡ä»¶æœ«å°¾æ·»åŠ </p>
<pre><code>apply from: &#39;https://raw.githubusercontent.com/blundell/release-android-library/master/android-release-aar.gradle&#39;
</code></pre><img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/AndroidStudio_set_gradle.png" alt="é…ç½®gradleæ–‡ä»¶" title="é…ç½®gradleæ–‡ä»¶">
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>PUBLISH_GROUP_ID</td>
<td>å¼€å‘è€…åç§°</td>
</tr>
<tr>
<td>PUBLISH_ARTIFACT_ID</td>
<td>é¡¹ç›®åç§°</td>
</tr>
<tr>
<td>PUBLISH_VERSION</td>
<td>ç‰ˆæœ¬</td>
</tr>
</tbody>
</table>
<p>å¯¹æ¯”compileåœ°å€ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç†è§£ï¼š</p>
<pre><code>compile &#39;io.github.marktony:circle-progress-bar:1.1&#39;
</code></pre><p>2.æ‰“åŒ…<br>åœ¨Android Studioçš„terminalä¸­æ‰§è¡Œï¼š</p>
<p>Windows:</p>
<pre><code>gradlew clean build generateRelease
</code></pre><p>MacOS:</p>
<pre><code>./gradlew clean build generateRelease
</code></pre><p>ç»è¿‡ä¸€ç³»åˆ—çš„ä¸‹è½½ï¼‹å„ç§ç¼–è¯‘ä¹‹å(ç¬¬ä¸€æ¬¡ç¼–è¯‘çš„è¯ï¼Œå»ºè®®ä½ åƒä¸ªé¥­æˆ–è€…ç»“ä¸ªå©šç”Ÿä¸ªå¨ƒä»€ä¹ˆçš„å†å›æ¥(ç¬‘ï¼Œå¤§æ¦‚30åˆ†é’Ÿå·¦å³)ï¼Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œè¦ä¸‹è½½æ–‡ä»¶è¶…çº§å¤šï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯åªæœ‰æˆ‘ä¸€ä¸ªäººæ˜¯è¿™æ ·ã€‚ä»¥åå†ç¼–è¯‘å°±ç‚’é¸¡å¿«äº†ã€‚)å°±ä¼šæç¤ºä½ BUILD SUCCESS,è¿˜æœ‰zipåŒ…çš„å­˜æ”¾è·¯å¾„ï¼Œæ‰¾åˆ°è¿™ä¸ªzipï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p>
<h3 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h3><p>å›åˆ°ä¹‹å‰bintrayçš„ç½‘ç«™ï¼Œè¿›å…¥packageçš„è¯¦æƒ…ï¼Œå°±ä¼šçœ‹åˆ°ä¸‹é¢çš„ç•Œé¢ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_package_detail.png" alt="packageè¯¦æƒ…" title="packageè¯¦æƒ…">
<p>ç‚¹å‡»versionï¼Œæ–°å»ºä¸€ä¸ªç‰ˆæœ¬ã€‚å®Œæˆåç‚¹å‡»åˆšåˆšæ–°å»ºçš„ç‰ˆæœ¬ï¼Œç‚¹å‡»Upload Filesï¼Œä¸Šä¼ ä¹‹å‰ç”Ÿæˆçš„zipæ–‡ä»¶ï¼Œæ³¨æ„è¦é€‰ä¸­exploding the archiveé€‰é¡¹ã€‚</p>
<p>ç‚¹å‡»Save Changesï¼Œå°±ä¼šæœ‰æç¤ºä½ æ˜¯å¦å‘å¸ƒï¼Œç‚¹å‡»å‘å¸ƒå°±å¥½äº†ã€‚</p>
<p>å¦‚ä½•å‘å¸ƒåˆ°JCenterå‘¢ï¼Ÿ</p>
<p>å›åˆ°packageï¼Œçœ‹åˆ°å³ä¸‹è§’Add to JCenterï¼Œç‚¹å‡»å°±å¯ä»¥ç”³è¯·å‘å¸ƒåˆ°JCenteräº†ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_add_to_jcenter.png" alt="æ·»åŠ åˆ°JCenter" title="æ·»åŠ åˆ°JCenter">
<p>åé¢å°±æ˜¯ç­‰å¾…å®¡æ ¸ï¼Œä¸€èˆ¬ç­‰å¾…å‡ ä¸ªå°æ—¶å°±ä¼šå®¡æ ¸é€šè¿‡äº†ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦è®©åˆ«äººçŸ¥é“ä½ çš„compileåœ°å€ï¼Œå¯ä»¥åœ¨Generalæ ç›®ä¸‹åˆ†åˆ«çœ‹åˆ°Mavenå’ŒGradleçš„åœ°å€äº†ã€‚</p>
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_compile_addr_maven.png" alt="Mavenåœ°å€" title="Mavenåœ°å€">
<img src="/2016/10/21/Android-Studioæ–°å»ºLibraryå¹¶ä¸Šä¼ åˆ°JCenter/bintray_compile_addr_gradle.png" alt="Gradle" title="Gradle">
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åœ¨æˆ‘çœ‹æ¥ï¼Œé€šè¿‡ä¸Šè¿°æ–¹æ³•å®ç°ä¸Šä¼ Libraryåˆ°JCenterçš„æ–¹æ³•ç›¸è¾ƒäºé…ç½®å¤æ‚gradleæ–‡ä»¶çš„æ–¹å¼è¦ç®€ä¾¿è®¸å¤šï¼Œä½†åŒæ—¶ä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿå°±æ„å‘³è¿™æ¯æ¬¡æœ‰äº†æ–°çš„ç‰ˆæœ¬éƒ½è¦æ‰‹åŠ¨ä¸Šä¼ ï¼Œä¸èƒ½é€šè¿‡terminalç›´æ¥ä¸Šä¼ ã€‚</p>
<p>å¦‚æœä½ å¯¹æˆ‘å¯¹CirlceProgressBaré¡¹ç›®æ„Ÿå…´è¶£æˆ–è€…å¯¹é…ç½®æ–‡ä»¶æœ‰ä¸è§£å¯¹åœ°æ–¹ï¼Œå¯ä»¥å‚è€ƒæºä»£ç </p>
<p><a href="https://github.com/marktony/CircleProgressBar" target="_blank" rel="external">https://github.com/marktony/CircleProgressBar</a></p>
<p>é¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œé‡Œé¢ä¹Ÿæœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œå¦‚æœä½ è§‰å¾—æœ‰ç”¨çš„è¯å°±ç»™ä¸ªstarå§ï¼Œå½“ç„¶é¡µæ¬¢è¿ä½ çœ‹ä¸€çœ‹æˆ‘å¯¹å…¶ä»–é¡¹ç›®å“¦ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[é‡æ„ï¼å°†Google MVPåº”ç”¨äºå·²æœ‰é¡¹ç›®]]></title>
      <url>http://tonnyl.github.io/2016/09/27/%E9%87%8D%E6%9E%84%EF%BC%81%E5%B0%86Google-MVP%E5%BA%94%E7%94%A8%E4%BA%8E%E5%B7%B2%E6%9C%89%E9%A1%B9%E7%9B%AE/</url>
      <content type="html"><![CDATA[<p>å°†Googleå®˜æ–¹çš„Android MVPæ¶æ„å¼•å…¥åˆ°å·²æœ‰çš„é¡¹ç›®ä¸­ã€‚<br><a id="more"></a></p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨æœ¬æ¬¡é¡¹ç›®é‡æ„ä¹‹å‰ï¼Œæˆ‘çš„é¡¹ç›®é‡‡ç”¨çš„æ˜¯ä»€ä¹ˆæ¶æ„å‘¢ï¼Ÿ</p>
<p>é¢ï¼Œæ²¡æœ‰æ¶æ„â€¦æˆ–è€…è¯´ï¼Œä¸é‚£ä¹ˆæ ‡å‡†çš„MVCï¼Œä¸€ä¸ªé¡µé¢å°±æ˜¯ä¸€ä¸ªActivityæˆ–è€…Fragmentï¼Œå„ç§æ•°æ®ï¼Œç½‘ç»œè¯·æ±‚ï¼Œå“åº”éƒ½å†™åœ¨Activityæˆ–è€…Fragmentâ€“è¿™ä¸¤ä¸ªä¸æ€ä¹ˆæ ‡å‡†çš„Controllerä¸­ï¼Œä»£ç æ··ä¹±ï¼Œè€Œä¸”é•¿é•¿é•¿é•¿é•¿é•¿ï¼Œå†™ä»£ç çš„æ—¶å€™ä¸€æ—¶çˆ½ï¼Œåˆ°äº†ç»´æŠ¤é˜¶æ®µï¼Œé‚£é…¸çˆ½ï¼Œä¸æ•¢ç›¸ä¿¡ã€‚é‡‡ç”¨æ–°çš„æ¶æ„è¿«åœ¨çœ‰ç«ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå·²ç»æœ‰å¾ˆå¤šçš„Appé¡¹ç›®é‡‡ç”¨äº†MVPæˆ–è€…MVVMç­‰æ¶æ„ã€‚ç”±äºå¹¶æ²¡æœ‰é‚£ä¹ˆæƒå¨çš„å®ç°ï¼Œå¾ˆå¤šå¼€å‘è€…ä¹Ÿé™·å…¥äº†é€‰æ‹©å›°éš¾ç—‡ï¼Œåœ¨å„ç§æ¶æ„ç›´æ¥æ‘‡æ‘†ä¸å®šï¼Œæ‰¾ä¸åˆ°é€‚åˆè‡ªå·±é¡¹ç›®æ¶æ„ã€‚è€ŒGoogleä¹Ÿé€‚æ—¶çš„æ¨å‡ºäº†ä¸€ç³»åˆ—å®˜æ–¹ç¤ºä¾‹ç”¨äºå‚è€ƒã€‚</p>
<h3 id="Googleç¤ºä¾‹é¡¹ç›®"><a href="#Googleç¤ºä¾‹é¡¹ç›®" class="headerlink" title="Googleç¤ºä¾‹é¡¹ç›®"></a>Googleç¤ºä¾‹é¡¹ç›®</h3><blockquote>
<p><a href="https://github.com/googlesamples/android-architecture" target="_blank" rel="external">Android Architecture Blueprints [beta]</a></p>
</blockquote>
<p>ç¤ºä¾‹é¡¹ç›®ä»¥ä¸€ä¸ªTODO APPä¸ºä¾‹ï¼Œç›®å‰ä»ç„¶åœ¨è¿›è¡Œä¸­ã€‚æœ¬æ¬¡é¡¹ç›®é‡æ„é‡‡ç”¨çš„æ˜¯åŸºç¡€ç‰ˆ <a href="https://github.com/googlesamples/android-architecture/tree/todo-mvp/" target="_blank" rel="external">todo-mvp</a></p>
<p>ç¤ºä¾‹é¡¹ç›®çš„ä»£ç ç»„ç»‡æ–¹å¼å’Œæˆ‘ä¹‹å‰ä»¥adapter, activity, fragmentç­‰ç»„ç»‡æ–¹å¼ä¸åŒï¼Œé‡‡ç”¨çš„æ˜¯æŒ‰ç…§åŠŸèƒ½åˆ’åˆ†ï¼Œä¸€ç§åŠŸèƒ½å°±æ˜¯ä¸€ä¸ªåŒ…ï¼ŒåŒ…å†…æ–‡ä»¶ä»¥xxxactivity, xxxfragment, xxxcontract, xxxpresenterå‘½åï¼Œxxxä»£è¡¨ç€æ‰€è¦å®ç°çš„åŠŸèƒ½ã€‚æœ¬æ¬¡é¡¹ç›®é‡æ„ä¸¤ç§æ–¹å¼å‡æœ‰é‡‡ç”¨ã€‚</p>
<h3 id="é‡æ„"><a href="#é‡æ„" class="headerlink" title="é‡æ„"></a>é‡æ„</h3><p>é¦–å…ˆæ˜¯ä»¿ç…§TODO MVPï¼Œå»ºç«‹ä¸¤ä¸ªBaseæ¥å£ï¼ŒBaseViewå’ŒBasePresenterï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬æ¥å£æ˜¯æ‰€æœ‰çš„Viewå’ŒPresenterçš„åŸºç±»ã€‚</p>
<pre><code class="Java">public interface BasePresenter {

    void start();

}
</code></pre>
<p>BasePresenterä¸­æœ‰æ–¹æ³•start()ï¼Œä½œç”¨æ˜¯Presenterå¼€å§‹è·å–æ•°æ®å¹¶æ”¹å˜ç•Œé¢æ˜¾ç¤ºï¼Œè°ƒç”¨æ—¶æœºä¸ºFragmentçš„onResume()æ–¹æ³•ä¸­ã€‚</p>
<pre><code class="Java">public interface BaseView&lt;T&gt; {

    void setPresenter(T presenter);

    void initViews(View view);

}
</code></pre>
<p>BaseViewä¸­æœ‰æ–¹æ³•setPresenter(),å°†Presenterç¤ºä¾‹ä¼ å…¥viewï¼Œè°ƒç”¨æ—¶æœºä¸ºPresenterå®ç°ç±»çš„æ„é€ æ–¹æ³•ä¸­ï¼ŒinitViews()ä¼ å…¥Viewå®ä¾‹ï¼Œç”¨äºåˆå§‹åŒ–ç•Œé¢å…ƒç´ ï¼Œè°ƒç”¨æ—¶æœºä¸ºFragmentçš„onCreate()æ–¹æ³•ä¸­ã€‚</p>
<p>æ¥ç€åˆ›å»ºå¥‘çº¦ç±»ï¼Œç”¨äºç»Ÿä¸€ç®¡ç†Viewå’ŒPresenterçš„æ‰€æœ‰æ¥å£ã€‚è¿™é‡Œä»¥çŸ¥ä¹æ—¥æŠ¥çš„éƒ¨åˆ†ä¸ºä¾‹ã€‚</p>
<pre><code class="Java">public interface ZhihuDailyContract {

    interface View extends BaseView&lt;Presenter&gt; {

        void showError();

        void showLoading();

        void stopLoading();

        void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; list);

        void showNetworkError();

    }

    interface Presenter extends BasePresenter {

        void loadPosts(long date, boolean clearing);

        void refresh();

        void loadMore(long date);

        void startReading(int position);

        void goToSettings();

    }

}
</code></pre>
<p>ç„¶ååˆ›å»ºç›¸åº”çš„Activityï¼Œåœ¨å®˜æ–¹çš„ç¤ºä¾‹é¡¹ç›®ä¸­ï¼ŒActivityæ˜¯ä½œä¸ºViewå’ŒPresenterçš„æ¡¥æ¢ä½¿ç”¨ï¼Œç”¨äºåˆ›å»ºViewå’ŒPresenterå®ä¾‹ã€‚æœ¬é¡¹ç›®ç”±äºæ¶‰åŠäº†TabLayoutå’ŒViewPagerçš„ä½¿ç”¨ï¼Œæ‰€ä»¥åˆ›å»ºViewå’ŒPresenterçš„éƒ¨åˆ†æˆ‘æ”¾åˆ°äº†ViewPagerçš„Adapterä¸­å®ç°ã€‚</p>
<pre><code class="Java">public class MainPagerAdapter extends FragmentPagerAdapter {

    private String[] titles;
    private final Context context;

    public MainPagerAdapter(FragmentManager fm, Context context) {
        super(fm);
        this.context = context;
        titles = context.getResources().getStringArray(R.array.page_titles);
    }

    @Override
    public Fragment getItem(int position) {
        if (position == 1){
            GuokrFragment fragment = GuokrFragment.newInstance();
            new GuokrPresenter(context, fragment);
            return fragment;
        } else if (position == 2){
            DoubanMomentFragment fragment = DoubanMomentFragment.newInstance();
            new DoubanMomentPresenter(context, fragment);
            return fragment;
        }
        ZhihuDailyFragment fragment = ZhihuDailyFragment.newInstance();
        new ZhihuDailyPresenter(context, fragment);
        return fragment;
    }

    @Override
    public int getCount() {
        return titles.length;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return titles[position];
    }

}
</code></pre>
<p>Fragmentåœ¨ç¤ºä¾‹é¡¹ç›®ä¸­çš„è§’è‰²ä¸ºViewçš„å…·ä½“å®ç°ç±»ã€‚</p>
<pre><code class="Java">public class ZhihuDailyFragment extends Fragment
        implements ZhihuDailyContract.View{

    private RecyclerView recyclerView;
    private SwipeRefreshLayout refresh;
    private FloatingActionButton fab;

    private ZhihuDailyNewsAdapter adapter;

    private ZhihuDailyContract.Presenter presenter;

    public ZhihuDailyFragment() {

    }

    public static ZhihuDailyFragment newInstance() {
        return new ZhihuDailyFragment();
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_douban_zhihu_daily,container,false);

        initViews(view);

        presenter.loadPosts(Calendar.getInstance().getTimeInMillis(), false);

        refresh.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {

            @Override
            public void onRefresh() {
                presenter.refresh();
            }

        });

        fab.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                ...
            }
        });

        return view;
    }


    @Override
    public void setPresenter(ZhihuDailyContract.Presenter presenter) {
        if (presenter != null) {
            this.presenter = presenter;
        }
    }

    @Override
    public void initViews(View view) {
        recyclerView = (RecyclerView) view.findViewById(R.id.rv_main);
        recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));
        recyclerView.addItemDecoration(new DividerItemDecoration(getActivity(),LinearLayoutManager.VERTICAL));
        refresh = (SwipeRefreshLayout) view.findViewById(R.id.refresh);
        fab = (FloatingActionButton) view.findViewById(R.id.fab);
        fab.setRippleColor(getResources().getColor(R.color.colorPrimaryDark));

    }

    @Override
    public void showError() {
        Snackbar.make(fab, R.string.loaded_failed,Snackbar.LENGTH_SHORT).show();
    }

    @Override
    public void showLoading() {
        refresh.post(new Runnable() {
            @Override
            public void run() {
                refresh.setRefreshing(true);
            }
        });
    }

    @Override
    public void stopLoading() {
        refresh.post(new Runnable() {
            @Override
            public void run() {
                refresh.setRefreshing(false);
            }
        });
    }

    @Override
    public void showResults(ArrayList&lt;ZhihuDailyNews.Question&gt; list) {
        if (adapter == null) {
            adapter = new ZhihuDailyNewsAdapter(getContext(), list);
            adapter.setItemClickListener(new OnRecyclerViewOnClickListener() {
                @Override
                public void OnItemClick(View v, int position) {
                    presenter.startReading(position);
                }
            });
            recyclerView.setAdapter(adapter);
        } else {
            adapter.notifyDataSetChanged();
        }
    }

    @Override
    public void showNetworkError() {
        Snackbar.make(fab,R.string.no_network_connected,Snackbar.LENGTH_INDEFINITE)
                .setAction(R.string.go_to_set, new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        presenter.goToSettings();
                    }
                }).show();
    }

}
</code></pre>
<p>åˆ›å»ºPresenterã€‚</p>
<pre><code class="Java">public class ZhihuDailyPresenter implements ZhihuDailyContract.Presenter, OnStringListener {

    private ZhihuDailyContract.View view;
    private Context context;
    private StringModelImpl model;

    private ArrayList&lt;ZhihuDailyNews.Question&gt; list = new ArrayList&lt;ZhihuDailyNews.Question&gt;();

    public ZhihuDailyPresenter(Context context, ZhihuDailyContract.View view) {
        this.context = context;
        this.view = view;
        this.view.setPresenter(this);
        model = new StringModelImpl(context);
    }

    @Override
    public void loadPosts(long date, boolean clearing) {
        view.showLoading();
        if (clearing) {
            list.clear();
        }
        model.load(Api.ZHIHU_HISTORY + formatter.ZhihuDailyDateFormat(date), this);
    }

    @Override
    public void refresh() {
        list.clear();
        loadPosts(Calendar.getInstance().getTimeInMillis(), true);
    }

    @Override
    public void loadMore(long date) {
        if (NetworkState.networkConnected(context)) {
            model.load(Api.ZHIHU_HISTORY + formatter.ZhihuDailyDateFormat(date), this);
        } else {
            view.showNetworkError();
        }
    }

    @Override
    public void startReading(int position) {
        context.startActivity(new Intent(context, ZhihuDetailActivity.class)
                .putExtra(&quot;id&quot;,list.get(position).getId())
        );
    }

    @Override
    public void goToSettings() {
        context.startActivity(new Intent(Settings.ACTION_SETTINGS));
    }

    @Override
    public void start() {

    }

    @Override
    public void onSuccess(String result) {
        Gson gson = new Gson();
        ZhihuDailyNews post = gson.fromJson(result, ZhihuDailyNews.class);

        for (ZhihuDailyNews.Question item : post.getStories()) {
            list.add(item);
        }
        view.showResults(list);
        view.stopLoading();

    }

    @Override
    public void onError(VolleyError error) {
        view.stopLoading();
        view.showError();
    }

}
</code></pre>
<p>Presenterè·å–åˆ°äº†Viewï¼Œå¹¶é€šè¿‡è°ƒç”¨setPresenter()æ–¹æ³•å°†è‡ªèº«ä¼ å…¥ï¼Œå¦‚æœéœ€è¦å¯¹æ”¹å˜ç•Œé¢æ˜¾ç¤ºï¼Œç›´æ¥è°ƒç”¨Viewå±‚çš„æ–¹æ³•å³å¯ã€‚è¿™æ ·Presenterå°±äºViewå±‚å®ç°äº†åˆ†ç¦»ã€‚</p>
<p>æœ€åæ˜¯Modelå±‚çš„å®ç°ã€‚ç”±äºä½¿ç”¨äº†Gsonï¼Œæ•°æ®çš„è¿”å›ç±»å‹åªéœ€è¦ä¸ºStringç±»å‹å³å¯ã€‚</p>
<pre><code class="Java">public interface OnStringListener {

    /**
     * è¯·æ±‚æˆåŠŸæ—¶å›è°ƒ
     * @param result
     */
    void onSuccess(String result);

    /**
     * è¯·æ±‚å¤±è´¥æ—¶å›è°ƒ
     * @param error
     */
    void onError(VolleyError error);

}
</code></pre>
<p>å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºè¯·æ±‚æˆåŠŸæ—¶å’Œè¯·æ±‚å¤±è´¥æ—¶çš„å›è°ƒã€‚</p>
<p>ç„¶åéœ€è¦ä¸€ä¸ªStringModelçš„å®ç°ç±»â€“StringModelImplã€‚</p>
<pre><code class="Java">public class StringModelImpl {

    private Context context;

    public StringModelImpl(Context context) {
        this.context = context;
    }

    public void load(String url, final OnStringListener listener) {
        StringRequest request = new StringRequest(url, new Response.Listener&lt;String&gt;() {
            @Override
            public void onResponse(String s) {
                listener.onSuccess(s);
            }
        }, new Response.ErrorListener() {
            @Override
            public void onErrorResponse(VolleyError volleyError) {
                listener.onError(volleyError);
            }
        });
        VolleySingleton.getVolleySingleton(context).addToRequestQueue(request);
    }

}
</code></pre>
<p>è¿™æ ·ï¼ŒModel, View, Presenterå‡å·²å®ç°ï¼Œå®ç°äº†å„ä¸ªå±‚æ¬¡çš„åˆ†ç¦»ã€‚</p>
<p>é‡‡ç”¨MVPæ¶æ„è¿›è¡Œé‡æ„ï¼Œä»£ç é‡ä¸Šç›¸å¯¹äºåŸé¡¹ç›®æ—¶æœ‰æ‰€å¢åŠ çš„ï¼Œä½†è¿™ç§æ•°é‡çš„å¢åŠ ç›¸å¯¹äºMVPæ¶æ„å¸¦æ¥çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚å½“ç„¶è¿™æ˜¯å¯¹äºä»£ç é‡æ¯”è¾ƒå¤§çš„é¡¹ç›®è€Œè¨€ï¼Œå¹³æ—¶ç”¨äºç»ƒæ‰‹çš„å°é¡¹ç›®å°±æ²¡æœ‰å¿…è¦å¼ºé¡¹ç›®æ‰€éš¾ï¼Œå‹‰å¼ºçš„å®ç°MVPäº†ï¼Œè¿™æ ·åªä¼šå¢åŠ ä»£ç é‡è€Œå·²ã€‚</p>
<h3 id="æœ¬é¡¹ç›®åœ°å€"><a href="#æœ¬é¡¹ç›®åœ°å€" class="headerlink" title="æœ¬é¡¹ç›®åœ°å€"></a>æœ¬é¡¹ç›®åœ°å€</h3><blockquote>
<p><a href="https://github.com/marktony/ZhihuDaily" target="_blank" rel="external">çº¸é£æœº-é‡‡ç”¨MVPæ¶æ„ï¼Œä¸€æ¬¾é›†åˆäº†çŸ¥ä¹æ—¥æŠ¥ã€æœå£³ç²¾é€‰å’Œè±†ç“£ä¸€åˆ»çš„ç»¼åˆæ€§é˜…è¯»å®¢æˆ·ç«¯</a></p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Javaä¸­çš„å•ä¾‹æ¨¡å¼]]></title>
      <url>http://tonnyl.github.io/2016/07/19/Java%E4%B8%AD%E7%9A%84%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h3 id="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ</h3><a id="more"></a>
<p>å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºæ¨¡å¼ï¼Œç”¨äºäº§ç”Ÿå¯¹è±¡çš„ä¸€ä¸ªå…·ä½“å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥ç¡®ä¿ç³»ç»Ÿä¸­ä¸€ä¸ªç±»åªèƒ½äº§ç”Ÿå”¯ä¸€çš„ä¸€ä¸ªå®ä¾‹ã€‚</p>
<p>è¿™æ ·çš„æ–¹å¼èƒ½å¤Ÿå¸¦æ¥ä¸¤å¤§å¥½å¤„ï¼š</p>
<ol>
<li>å¯¹äºé¢‘ç¹ä½¿ç”¨çš„å¯¹è±¡ï¼Œå¯ä»¥çœç•¥åˆ›å»ºå¯¹è±¡æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå¯¹äºå¤åˆ¶çš„å¯¹è±¡ï¼Œè¿™æ ·çš„åˆ›å»ºæ–¹å¼çš„å¼€é”€æ˜¯ååˆ†å€¼å¾—çš„ã€‚</li>
<li>newçš„æ¬¡æ•°å°‘äº†ï¼Œå¯¹å†…å­˜çš„ä½¿ç”¨é¢‘ç‡ä¹Ÿå°±ä¸‹é™äº†ï¼Œå½“ç„¶ä¹Ÿå°±å‡è½»äº†GCçš„å‹åŠ›ã€‚</li>
</ol>
<h3 id="è®¾è®¡æ€æƒ³"><a href="#è®¾è®¡æ€æƒ³" class="headerlink" title="è®¾è®¡æ€æƒ³"></a>è®¾è®¡æ€æƒ³</h3><p>è¿™ç§æ¨¡å¼è¦è§£å†³çš„é—®é¢˜å°±æ˜¯è¦ä¿è¯åº”ç”¨ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ã€‚é‚£æ€æ ·å®ç°å‘¢ï¼Ÿ</p>
<ol>
<li>ä¸å…è®¸å…¶ä»–ç¨‹åºnewå¯¹è±¡</li>
<li>åœ¨è¯¥ç±»ä¸­åˆ›å»ºå¯¹è±¡</li>
<li>å¯¹å¤–éœ€è¦æš´éœ²ä¸€ä¸ªæ–¹æ³•ï¼Œè®©å…¶ä»–è·å–è¿™ä¸ªå¯¹è±¡</li>
</ol>
<p>ä½“ç°åˆ°ä»£ç ä¸­ï¼Œè§£å†³åŠæ³•ä¸ºï¼š</p>
<ol>
<li>ç§æœ‰åŒ–æ„é€ å‡½æ•°</li>
<li>åœ¨æœ¬ç±»ä¸­åˆ›å»ºä¸€ä¸ªæœ¬ç±»å¯¹è±¡</li>
<li>å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œèƒ½å¤Ÿè®©å…¶ä»–çš„ç±»è·å–è¿™ä¸ªå¯¹è±¡</li>
</ol>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><p>1.æœ€ç®€å•çš„å†™æ³•ä¸º</p>
<pre><code class="Java">public class Singleton {

    private Singleton(){}

    private static Singleton instance = new Singleton();

    public static Singleton getInstance(){
        return instance;
    }

}
</code></pre>
<p>è¿™ç§æ–¹å¼ç§°ä¸ºé¥¿æ±‰å¼ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ç®€å•æ˜äº†</li>
<li>åœ¨ç±»åŠ è½½æ—¶å³å®Œæˆäº†å®ä¾‹åŒ–ï¼Œé¿å…äº†çº¿ç¨‹åŒæ­¥çš„é—®é¢˜</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>æ²¡æœ‰ä½¿ç”¨æ‡’åŠ è½½</li>
<li>å¯èƒ½é€ æˆå†…å­˜æµªè´¹</li>
</ul>
</li>
</ul>
<p>2.å˜ç§æ–¹å¼</p>
<pre><code class="Java">public class Singleton {

    private static Singleton instance;

    private Singleton(){}

    static {
        instance = new Singleton();
    }

    public static Singleton getInstance(){
        return instance;
    }

}
</code></pre>
<p>ç›¸æ¯”äºç¬¬ä¸€ç§å†™æ³•ï¼Œæœ¬ç±»ä¸­å°†å®ä¾‹åŒ–å¯¹è±¡çš„ä»£ç æ”¾åˆ°äº†staticä»£ç å—ä¸­ã€‚ä¸¤ç§æ–¹æ³•çš„æ•ˆæœå…¶å®æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥ä¼˜ç¼ºç‚¹ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>3.æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨)</p>
<pre><code class="Java">public class Singleton {  
    private static Singleton instance;    
    private Singleton (){}    
    public static Singleton getInstance() {    
    if (instance == null) {        
        instance = new Singleton();    
    }
        return instance;
    }
}
</code></pre>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ä½¿ç”¨äº†æ‡’åŠ è½½</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>å½“æœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œè°ƒç”¨ getInstance() çš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºå¤šä¸ªå®    ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨å¤šçº¿ç¨‹ä¸‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚</li>
</ul>
</li>
</ul>
<p>4.æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨)</p>
<pre><code class="Java">public class Singleton {  
    private static Singleton instance;    
    private Singleton (){}    
    public static synchronized Singleton getInstance(){    
      if (instance == null) {
           instance = new Singleton();    
      }
      return instance;
    }
}
</code></pre>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>çº¿ç¨‹å®‰å…¨ï¼Œè§£å†³äº†å¤šå®ä¾‹é—®é¢˜</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>ä¸é«˜æ•ˆã€‚å› ä¸ºåœ¨ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ getInstance() æ–¹    æ³•ã€‚ä½†æ˜¯åŒæ­¥æ“ä½œåªéœ€è¦åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰è¢«éœ€è¦ï¼Œå³ç¬¬ä¸€æ¬¡åˆ›å»ºå•ä¾‹å®ä¾‹å¯¹è±¡æ—¶ã€‚</li>
</ul>
</li>
</ul>
<p>5.åŒé‡æ ¡éªŒé”</p>
<pre><code class="Java">public class Singleton {

    private static Singleton instance = null;

    private Singleton(){}

    public static Singleton getInstance(){
        if (instance == null){
            synchronized (Singleton.class){
                if (instance == null){
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }

}
</code></pre>
<p>è¿›è¡Œä¸¤æ¬¡if(instance == null)(Double-Check)çš„æ£€æŸ¥å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>å¹¶å‘åº¦é«˜ï¼Œæå‡äº†æ€§èƒ½ã€‚</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>å¹¶ä¸æ˜¯ç»å¯¹å®‰å…¨</li>
</ul>
</li>
</ul>
<p>6.å†…éƒ¨ç±»</p>
<pre><code class="Java">public class Singleton{  

    private Singleton() {};  

    private static class SingletonHolder{  
        private static Singleton instance=new Singleton();  
    }   

    public static Singleton getInstance(){  
        return SingletonHolder.instance;  
    }

}
</code></pre>
<p>è¿™æ˜¯Googleå…¬å¸çš„å·¥ç¨‹å¸ˆBob Leeå†™çš„æ–°çš„æ‡’æ±‰å•ä¾‹æ¨¡å¼ã€‚</p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ä½¿ç”¨JVMæœ¬èº«æœºåˆ¶ä¿è¯äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</li>
<li>ç”±äº SingletonHolder æ˜¯ç§æœ‰çš„ï¼Œé™¤äº† getInstance() ä¹‹å¤–æ²¡æœ‰åŠæ³•è®¿é—®å®ƒï¼Œå› æ­¤å®ƒæ˜¯æ‡’æ±‰å¼çš„ã€‚</li>
<li>åŒæ—¶è¯»å–å®ä¾‹çš„æ—¶å€™ä¸ä¼šè¿›è¡ŒåŒæ­¥ï¼Œæ²¡æœ‰æ€§èƒ½ç¼ºé™·ã€‚</li>
<li>ä¸ä¾èµ–jdkç‰ˆæœ¬ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ã€ŠEffective Javaã€‹æ¨èçš„å†™æ³•ã€‚</p>
<p>7.æšä¸¾</p>
<pre><code class="java">public enum EasySingleton{
    INSTANCE;
}
</code></pre>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ç®€å•æ˜äº†</li>
<li>è°ƒç”¨ç®€å•ï¼Œä½¿ç”¨EasySingleton.INSTANCEè®¿é—®å®ä¾‹ï¼Œæ¯”getInstance()ç®€å•</li>
<li>åˆ›å»ºæšä¸¾æœ¬èº«å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸ç”¨æ‹…å¿ƒå­˜åœ¨å¤šä¸ªå®ä¾‹çš„é—®é¢˜</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>æšä¸¾ç±»å‹enumåœ¨jdk1.5æ—¶æ‰å¼•å…¥ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•å¹¶ä¸é€‚ç”¨äºjdk1.5ä¹‹å‰çš„ç‰ˆæœ¬</li>
</ul>
</li>
</ul>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘æµ‹è¯•ã€‚</p>
<pre><code class="Java">public class SingletonPatternTest {

    public static void main(String[] args){

        CountDownLatch latch = new CountDownLatch(1);

        int threadCount = 1000;

        for (int i = 0; i &lt; threadCount; i++){
            new Thread(){
                @Override
                public void run() {
                    try {
                        // all thread to wait
                        latch.await();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }

                    // test get instance
                    System.out.println(Singleton.getInstance().hashCode());
                }
            }.start();
        }

        // release lock, let all thread excute Singleton.getInstance() at the same time
        latch.countDown();

    }

}
</code></pre>
<p>å…¶ä¸­CountDownLatch latchä¸ºé—­é”ï¼Œæ‰€æœ‰çº¿ç¨‹ä¸­éƒ½ç”¨latch.await();ç­‰å¾…é”é‡Šæ”¾ï¼Œå¾…æ‰€æœ‰çº¿ç¨‹åˆå§‹åŒ–å®Œæˆä½¿ç”¨latch.countDown();é‡Šæ”¾é”ï¼Œä»è€Œè¾¾åˆ°çº¿ç¨‹å¹¶å‘æ‰§è¡ŒSingleton.getInstance()çš„æ•ˆæœã€‚</p>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>2016228077
2016228077
2016228077
2016228077
...
</code></pre><p>Reference:</p>
<p><a href="http://blog.csdn.net/dmk877/article/details/50311791" target="_blank" rel="external">http://blog.csdn.net/dmk877/article/details/50311791</a></p>
<p><a href="http://www.trinea.cn/java/singleton/" target="_blank" rel="external">http://www.trinea.cn/java/singleton/</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Get start with Kotlin on Android]]></title>
      <url>http://tonnyl.github.io/2016/07/10/Get-start-with-Kotlin-on-Android/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»æ€æ ·å…¥é—¨ç”¨Kotlinå¼€å‘Androidé¡¹ç›®ã€‚ç¤ºä¾‹é¡¹ç›®åœ°å€ä¸ºï¼š<a href="https://github.com/marktony/FanfouHandpick" target="_blank" rel="external">GitHub:é¥­å¦ç²¾é€‰</a></p>
<h3 id="ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ</h3><p>Kotlinæ˜¯ç”±<a href="https://www.jetbrains.com/" target="_blank" rel="external">JetBrains</a>å¼€å‘ï¼ŒåŸºäºJVMçš„ä¸€é—¨æ–°çš„ç¼–ç¨‹è¯­è¨€ã€‚å¼€å‘è¿‡Androidçš„ç«¥é‹åº”è¯¥éƒ½çŸ¥é“Android Studioï¼Œå®ƒå°±æ˜¯åŸºäºIntellij IDEAå¼€å‘çš„ï¼Œè€ŒIntellij IDEAæ­£æ˜¯ç”±JetBrainså‡ºå“ã€‚</p>
<p>å¯¹äºAndroidå¼€å‘è€…è€Œè¨€ï¼ŒKotlinæœ‰ä¸¤ä¸ªæœ‰è¶£çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å¯¹äºJavaç†Ÿæ‚‰çš„å¼€å‘è€…ï¼Œä¸Šæ‰‹Kotlinä¼šå¾ˆå¿«ï¼Œå› ä¸ºKotlinéå¸¸ç›´è§‰åŒ–ã€‚</li>
<li>å¼ºå¤§çš„IDEæ”¯æŒã€‚</li>
</ul>
<p>ç›¸æ¯”äºJava7,Kotlinçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li>æ˜“äºè¡¨ç°ã€‚èƒ½å®å®åœ¨åœ¨çš„å°‘å†™å¾ˆå¤šä»£ç ã€‚</li>
<li>ç±»å‹å®‰å…¨ã€‚æˆ‘ä»¬åœ¨Javaä¸­ç»å¸¸è¦é˜²æ­¢äº§ç”Ÿ<strong>NullPointerException</strong>ï¼Œè€Œä½¿ç”¨Kotlinæ˜¯ç©ºå®‰å…¨çš„ã€‚æˆ‘ä»¬å¯ä»¥èŠ‚çº¦å¾ˆå¤šè°ƒè¯•ç©ºå¼‚å¸¸çš„æ—¶é—´ã€‚</li>
<li>å‡½æ•°å¼ã€‚Kotlinæ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä½†æ˜¯å¥¹ä½¿ç”¨å¾ˆå¤šå‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µã€‚ä¾‹å¦‚lambdaè¡¨è¾¾å¼ã€‚</li>
<li>æ‰©å±•å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥æ‰©å±•ç±»æ›´å¤šçš„ç‰¹æ€§ã€‚</li>
<li>ä¸Javaçš„å®Œç¾äº’æ“ä½œã€‚æˆ‘ä»¬ç”šè‡³åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨Kotlinå’ŒJavaä¸¤ç§è¯­è¨€æ··åˆç¼–ç¨‹ã€‚</li>
</ul>
<h3 id="åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin"><a href="#åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin" class="headerlink" title="åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin"></a>åœ¨Androidé¡¹ç›®ä¸­ä½¿ç”¨Kotlin</h3><p>é¦–å…ˆå½“ç„¶æ˜¯è¦é…ç½®å¼€å‘ç¯å¢ƒäº†ã€‚ä»Intellij 15å¼€å§‹ï¼ŒKotlinæ’ä»¶æ˜¯é»˜è®¤å®‰è£…çš„ã€‚ä½†æ˜¯Android Studioä¸­å¯èƒ½å°±è¦æˆ‘ä»¬æ‰‹åŠ¨é…ç½®äº†ã€‚</p>
<p>æ‰“å¼€ <strong>Android Studio</strong> è¿›å…¥ <strong>Preferences</strong> çš„ <strong>plugin</strong> æ ï¼Œé€‰æ‹© <strong>Install JetBrains Plugin</strong>,åœ¨æœç´¢æ¡†ä¸­è¾“å…¥ <strong>Kotlin</strong>,ç„¶åå°±èƒ½çœ‹åˆ°Kotlinæ’ä»¶äº†ï¼Œç‚¹å‡»å®‰è£…å³å¯ã€‚</p>
<p>ç¯å¢ƒé…ç½®å¥½åï¼Œå°±å¯ä»¥åŠ¨æ‰‹å†™é¡¹ç›®äº†ã€‚æŒ‰ç…§å¹³æ—¶æˆ‘ä»¬æ–°å»ºAndroidé¡¹ç›®çš„æ­¥éª¤ï¼Œæ–°å»ºä¸€ä¸ªé¡¹ç›®ã€‚ç„¶åç‚¹å‡»Android Studioçš„èœå• <strong>Code</strong> çš„ <strong>Convert Java File to Kotlin File</strong>,javaæ–‡ä»¶å°±è‡ªåŠ¨çš„è½¬æ¢ä¸ºäº†Kotlinæ–‡ä»¶ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ã€‚</p>
<h3 id="å°è±¡"><a href="#å°è±¡" class="headerlink" title="å°è±¡"></a>å°è±¡</h3><p>æˆ‘å¹¶æ²¡æœ‰ç”¨Kotlinè¿›è¡ŒAndroidå¼€å‘çš„ç»éªŒï¼Œè¿™æ¬¡çš„é¡¹ç›®ä¹Ÿä¸»è¦æ˜¯ä½œä¸ºç»ƒæ‰‹ä½¿ç”¨ã€‚ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯çœäº‹å„¿ï¼Œèƒ½å‡å°‘å¾ˆå¤šä¸å¿…è¦çš„ä»£ç ã€‚å¯ä»¥ä¸ç”¨å†™å¾ˆå¤šçš„findViewByIdäº†ã€‚è®¾ç½®ç›‘å¬å™¨ä¹Ÿæ–¹ä¾¿äº†å¾ˆå¤šäº†ã€‚<br>Talk is cheap, show you the code.</p>
<pre><code class="Kotlin">class MainActivity : AppCompatActivity() {

  override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        textView.text = &quot;Hello Kotlin&quot;

        textView.setOnClickListener {
          Snackbar.make(fab,&quot;Hello Snackbar&quot;,Snackbar.LENGTH_SHORT)
        }

  }

}
</code></pre>
<p>ä¸Šæ‰‹å°è±¡ä¸é”™ï¼Œä»¥åæœ‰æœºä¼šä¼šå°è¯•ä½¿ç”¨Kotlinï¼</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Fragmentç”Ÿå‘½å‘¨æœŸæ¢ç´¢]]></title>
      <url>http://tonnyl.github.io/2016/06/13/Fragment%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%8E%A2%E7%B4%A2/</url>
      <content type="html"><![CDATA[<p>Fragmentå’ŒActivityç±»ä¼¼ï¼Œä¹Ÿæœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”fragmentçš„ç”Ÿå‘½å‘¨æœŸå’Œactivityçš„ç”Ÿå‘½å‘¨æœŸç‰¹åˆ«ç›¸ä¼¼ã€‚<br><a id="more"></a></p>
<p>Activityçš„ç”Ÿå‘½å‘¨æœŸç”±å››ç§çŠ¶æ€ï¼Œè¿è¡Œã€æš‚åœã€åœæ­¢ã€å’Œé”€æ¯ï¼Œç±»ä¼¼çš„ï¼ŒFragmentä¹Ÿæœ‰è¿™å››ç§çŠ¶æ€ï¼Œåªæ˜¯åœ¨ä¸€äº›ç»†å°çš„åœ°æ–¹æœ‰æ‰€ä¸åŒã€‚</p>
<p>Fragmentç”Ÿå‘½å‘¨æœŸå›¾(æ¥è‡ªAndroidå®˜ç½‘)</p>
<img src="/2016/06/13/Fragmentç”Ÿå‘½å‘¨æœŸæ¢ç´¢/fragment_lifecycle.png" alt="fragment_lifecycle" title="fragment_lifecycle">
<p>ä¸‹é¢ç›´æ¥é€šè¿‡å·¥ç¨‹æ¥è®¤è¯†Fragmentçš„ç”Ÿå‘½å‘¨æœŸ</p>
<p>é¦–å…ˆæ–°å»ºFragmentDemoå·¥ç¨‹ã€‚</p>
<p>MainActivity.java</p>
<pre><code class="java">
package com.marktony.fragmentdemo;

import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentTransaction;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class MainActivity extends AppCompatActivity {

    private Button btnAddFragment;

    private FragmentManager fragmentManager;
    private FragmentTransaction fragmentTransaction;

    public static final String TAG = &quot;MainActivity&quot;;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        initViews();

        initData();

        btnAddFragment.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                MyFragment fragment = new MyFragment();
                fragmentTransaction.replace(R.id.container,fragment);
                fragmentTransaction.commit();
            }
        });

        Log.d(TAG,&quot;onCreate&quot;);
    }

    private void initData() {

        fragmentManager = getSupportFragmentManager();
        fragmentTransaction = fragmentManager.beginTransaction();

    }

    private void initViews() {

        btnAddFragment = (Button) findViewById(R.id.btn_add_fragment);

    }
}
</code></pre>
<p>ä»£ç å¾ˆç®€å•ï¼ŒåŠ è½½ç›¸åº”çš„å¸ƒå±€ï¼Œé€šè¿‡ç›‘å¬buttonçš„ç‚¹å‡»äº‹ä»¶ï¼ŒåŠ è½½fragmentã€‚</p>
<p>activity_main.xml</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/container&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:paddingBottom=&quot;@dimen/activity_vertical_margin&quot;
    android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingTop=&quot;@dimen/activity_vertical_margin&quot;
    tools:context=&quot;com.marktony.fragmentdemo.MainActivity&quot;&gt;

    &lt;Button
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:id=&quot;@+id/btn_add_fragment&quot;
        android:text=&quot;add_fragment&quot;/&gt;

&lt;/RelativeLayout&gt;
</code></pre>
<p>MyFragment.java</p>
<pre><code class="java">package com.marktony.fragmentdemo;

import android.content.Context;
import android.os.Bundle;
import android.support.annotation.Nullable;
import android.support.v4.app.Fragment;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

/**
 * Created by lizhaotailang on 2016/6/13.
 */
public class MyFragment extends Fragment {

    public static final String TAG = &quot;MY_FRAGMENT&quot;;

    // empty constructor
    public MyFragment(){

    }

    @Override
    public void onAttach(Context context) {
        super.onAttach(context);

        Log.d(TAG,&quot;onAttach&quot;);
    }

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Log.d(TAG,&quot;onCreate&quot;);
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {

        Log.d(TAG,&quot;onCreateView&quot;);

        return inflater.inflate(R.layout.fragment_my,container,false);

    }

    @Override
    public void onActivityCreated(@Nullable Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        Log.d(TAG,&quot;onActivityCreated&quot;);
    }

    @Override
    public void onStart() {
        super.onStart();

        Log.d(TAG,&quot;onStart&quot;);
    }

    @Override
    public void onResume() {
        super.onResume();

        Log.d(TAG,&quot;onResume&quot;);
    }

    @Override
    public void onPause() {
        super.onPause();

        Log.d(TAG,&quot;onPause&quot;);
    }

    @Override
    public void onStop() {
        super.onStop();

        Log.d(TAG,&quot;onStop&quot;);
    }

    @Override
    public void onDestroyView() {
        super.onDestroyView();

        Log.d(TAG,&quot;onDestroyView&quot;);
    }

    @Override
    public void onDestroy() {
        super.onDestroy();

        Log.d(TAG,&quot;onDestroy&quot;);
    }

    @Override
    public void onDetach() {
        super.onDetach();

        Log.d(TAG,&quot;onDetach&quot;);
    }

}
</code></pre>
<p>MyFragmentä¸­å¤å†™äº†ä¸€äº›æ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰“å°æ—¥å¿—ã€‚</p>
<p>okï¼Œå¤§åŠŸå‘Šæˆï¼Œç°åœ¨å°±è·‘åˆ°æ‰‹æœºä¸Šã€‚</p>
<p>è§‚å¯Ÿæ‰“å°æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°:</p>
<pre><code>com.marktony.fragmentdemo D/MainActivity: onCreate
</code></pre><p>æŒ‰ä¸‹æŒ‰é’®æ—¶</p>
<pre><code>com.marktony.fragmentdemo D/MY_FRAGMENT: onAttach
com.marktony.fragmentdemo D/MY_FRAGMENT: onCreate
com.marktony.fragmentdemo D/MY_FRAGMENT: onCreateView
com.marktony.fragmentdemo D/MY_FRAGMENT: onActivityCreated
com.marktony.fragmentdemo D/MY_FRAGMENT: onStart
com.marktony.fragmentdemo D/MY_FRAGMENT: onResume
</code></pre><p>æ­¤æ—¶æŒ‰ä¸‹homeé”®</p>
<pre><code>com.marktony.fragmentdemo D/MY_FRAGMENT: onPause
com.marktony.fragmentdemo D/MY_FRAGMENT: onStop
</code></pre><p>é‡æ–°å›åˆ°åº”ç”¨</p>
<pre><code>com.marktony.fragmentdemo D/MY_FRAGMENT: onStart
com.marktony.fragmentdemo D/MY_FRAGMENT: onResume
</code></pre><p>æŒ‰ä¸‹backé”®ï¼Œæ­¤æ—¶fragmentå’Œactivityå‡è¢«é”€æ¯ã€‚</p>
<pre><code>com.marktony.fragmentdemo D/MY_FRAGMENT: onPause
com.marktony.fragmentdemo D/MY_FRAGMENT: onStop
com.marktony.fragmentdemo D/MY_FRAGMENT: onDestroyView
com.marktony.fragmentdemo D/MY_FRAGMENT: onDestroy
com.marktony.fragmentdemo D/MY_FRAGMENT: onDetach
</code></pre><p>è§‚å¯Ÿæ—¥å¿—ï¼Œä¸éš¾å‘ç°ã€‚</p>
<p>å½“fragmentè¢«åˆ›å»ºæ—¶ï¼Œä¼šä¾æ¬¡ç»å†ä»¥ä¸‹çŠ¶æ€ï¼š</p>
<ul>
<li>onAttach()</li>
<li>onCreate()</li>
<li>onCreateView()</li>
<li>onActivityCreated()</li>
</ul>
<p>å½“fragmentå¤„äºå¯è§çŠ¶æ€æ—¶ï¼Œä¼šç»å†</p>
<ul>
<li>onStart()</li>
<li>onResume()</li>
</ul>
<p>ä¸å¯è§æ—¶ï¼Œç»å†äº†</p>
<ul>
<li>onPause()</li>
<li>onStop()</li>
</ul>
<p>å½“fragmentè¢«é”€æ¯æ—¶ï¼ˆæˆ–ç›¸åº”çš„activityè¢«é”€æ¯æ—¶ï¼‰</p>
<ul>
<li>onPause()</li>
<li>onStop()</li>
<li>onDestroyView()</li>
<li>onDestroy()</li>
<li>onDetach()</li>
</ul>
<p>ç”±æ­¤å¯è§ï¼Œfragmentçš„ç”Ÿå‘½å‘¨æœŸå’Œactivityçš„ç”Ÿå‘½å‘¨æœŸçœŸçš„éå¸¸çš„ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›æ–°çš„çŠ¶æ€ã€‚</p>
<p>åœ¨fragmentä¸­ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡onSaveInstanceState()æ–¹æ³•ä¿å­˜æ•°æ®çš„ï¼Œå› ä¸ºè¿›å…¥åœæ­¢çŠ¶æ€çš„fragmentå¯èƒ½ç”±äºç³»ç»Ÿå†…å­˜ä¸è¶³è€Œè¢«å›æ”¶ï¼Œä¿å­˜ä¸‹æ¥æ•°æ®å¯ä»¥åœ¨onCreate(),onCreateView(),onActivityCreate()ä¸‰ä¸ªæ–¹æ³•ä¸­é‡æ–°å¾—åˆ°ï¼Œä»–ä»¬éƒ½å«æœ‰ä¸€ä¸ªBundleç±»å‹çš„saveInstanceStateå‚æ•°ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[GitHub Pagesç°åœ¨æ”¯æŒHttpsäº†]]></title>
      <url>http://tonnyl.github.io/2016/06/10/GitHub-Pages%E7%8E%B0%E5%9C%A8%E6%94%AF%E6%8C%81Https%E4%BA%86/</url>
      <content type="html"><![CDATA[<p>HTTPS for GitHub Pages<br><a id="more"></a></p>
<p>æ•°ä»¥ç™¾ä¸‡è®¡çš„äººç”¨<a href="https://pages.github.com/" target="_blank" rel="external">GitHub Pages</a>æ¥æ”¯æŒä»–ä»¬çš„ç½‘ç«™ï¼Œè¿™äº›ç½‘ç«™æ¯å¤©ä¹Ÿä¼šæœ‰æ•°ä»¥ç™¾ä¸‡è®¡çš„è®¿é—®é‡ï¼Œä¸ºäº†æ›´å¥½çš„æ”¯æŒè¿™äº›GitHub Pagesç«™ç‚¹ï¼Œä¹Ÿä¸ºäº†åœ¨äº’è”ç½‘ä¸­å¢åŠ HTTPSçš„ä½¿ç”¨èŒƒå›´ï¼ŒGitHub Pagesç°åœ¨å®˜æ–¹æ”¯æŒæ‰€æœ‰   <code>&lt;username&gt;.github.io</code> ç«™ç‚¹äº†ã€‚HTTPSæä¾›çš„åŠ å¯†å±‚ï¼Œå¯ä»¥é˜²æ­¢ä»–äººçª¥æ¢æˆ–ç¯¡æ”¹æŒ‡å‘æ‚¨çš„Pagesç«™ç‚¹ã€‚</p>
<p>ä½ ç°åœ¨å°±å¯ä»¥è®¿é—® <code>*.github.io</code>ç«™ç‚¹ï¼Œå¼ºåˆ¶ä½ çš„ç«™ç‚¹ä½¿ç”¨HTTPSã€‚å¦‚æœä½ ä½¿ç”¨äº†HTTPSï¼Œä»»ä½•HTTPè¯·æ±‚éƒ½ä¼šè¢«ç›´æ¥é‡å®šå‘ä¸ºHTTPSè¯·æ±‚ã€‚</p>
<img src="/2016/06/10/GitHub-Pagesç°åœ¨æ”¯æŒHttpsäº†/github_pages_now_support_https.png" alt="github_pages_now_support_https" title="github_pages_now_support_https">
<p>ä»2016å¹´6æœˆ9æ—¥å¼€å§‹ï¼Œæ‰€æœ‰çš„æ–°å»ºGitHub Pagesç«™ç‚¹éƒ½ä¼šè¢«å¼ºåˆ¶ä½¿ç”¨HTTPSã€‚åŒæ—¶ä¸ºäº†ä½¿å·²ç»å­˜åœ¨çš„ç«™ç‚¹èƒ½å¤Ÿå¼ºåˆ¶ä½¿ç”¨HTTPSï¼Œä½ å¯ä»¥è®¿é—®ä½ çš„ç«™ç‚¹çš„ä»“åº“ï¼Œç‚¹å‡»<a href="https://help.github.com/articles/securing-your-github-pages-site-with-https/" target="_blank" rel="external">Pages HTTPS documentation</a>æ¥è·å–æ›´å¤šçš„ä¿¡æ¯ã€‚</p>
<p>å¼€å¯GitHub Pages HTTPSçš„æ–¹æ³•ï¼š</p>
<p>å¦‚ä¸Šé¢æ‰€è¯´ï¼Œå¯¹äºåœ¨2016å¹´6æœˆ9æ—¥ä¹‹åå¼€é€šçš„ï¼Œä»¥ <code>&lt;username&gt;.github.io</code> ä¸ºåŸŸåçš„ç«™ç‚¹ï¼Œå°†è‡ªåŠ¨å¼€å¯HTTPSã€‚</p>
<p>å¯¹äºåœ¨9æ—¥ä¹‹å‰å¼€é€šçš„ç«™ç‚¹ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•å¼€å¯ï¼š</p>
<p>step 1. åœ¨GitHubä¸»ç«™ï¼Œè¿›å…¥åˆ°pagesçš„åº“(repository)<br>step 2. åœ¨ä½ çš„ä»“åº“åç§°ä¸‹ï¼Œç‚¹å‡»Settings</p>
<img src="/2016/06/10/GitHub-Pagesç°åœ¨æ”¯æŒHttpsäº†/repo-actions-settings.png" alt="repo-actions-settings" title="repo-actions-settings">
<p>step 3. åœ¨â€œGitHub Pagesâ€ä¸‹ï¼Œé€‰æ‹©Enforce HTTPS</p>
<img src="/2016/06/10/GitHub-Pagesç°åœ¨æ”¯æŒHttpsäº†/enforce-https-checkbox.png" alt="enforce-https-checkbox" title="enforce-https-checkbox">
<p>å—¯ï¼Œå¬åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼Œæˆ‘ä¹Ÿæ˜¯åœ¨ç¬¬ä¸€æ—¶é—´æŠŠåšå®¢å‡çº§åˆ°äº†HTTPSï¼Œä¸ä¿¡ä½ çœ‹ï¼</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å®ç°RecyclerViewçš„itemçš„æ»‘åŠ¨åˆ é™¤]]></title>
      <url>http://tonnyl.github.io/2016/05/28/%E5%AE%9E%E7%8E%B0RecyclerView%E7%9A%84item%E7%9A%84%E6%BB%91%E5%8A%A8%E5%88%A0%E9%99%A4/</url>
      <content type="html"><![CDATA[<p>åˆ©ç”¨ItemTouchHelperå®ç°recycler view itemçš„ä¾§æ»‘åˆ é™¤<br><a id="more"></a></p>
<h3 id="å…³äºItemTouchHelper"><a href="#å…³äºItemTouchHelper" class="headerlink" title="å…³äºItemTouchHelper"></a>å…³äºItemTouchHelper</h3><p>å®˜æ–¹æ–‡æ¡£çš„è§£é‡Šï¼š</p>
<blockquote>
<p>This is a utility class to add swipe to dismiss and drag &amp; drop support to RecyclerView.</p>
</blockquote>
<p>ä»æ–‡æ¡£ä¸éš¾çœ‹å‡ºï¼ŒItemTouchHelperæ˜¯ä¸€ä¸ªç”¨äºåœ¨RecyclerViewä¸­å®ç°æ»‘åŠ¨åˆ é™¤å’Œæ‹–æ‹½çš„å·¥å…·ç±»ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ul>
<li>ä¿®æ”¹build.gradleæ–‡ä»¶ï¼Œæ·»åŠ ä¾èµ–ã€‚</li>
</ul>
<pre><code>compile &#39;com.android.support:recyclerview-v7:23.4.0&#39;
</code></pre><ul>
<li>æ„å»ºobjectä¸Adapter</li>
</ul>
<p>è¿™é‡Œå‡è®¾æˆ‘å·²ç»æ„å»ºå¥½äº†å®ä½“ç±»CodeLanguageå’Œadapterï¼Œåœ¨æ„å»ºadapteræ—¶ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<pre><code class="java">public void remove(int position) {
   mMovies.remove(position);
   notifyItemRemoved(position);
}
</code></pre>
<ul>
<li>åˆ›å»ºItemTouchHelper.SimpleCallbackå­ç±»</li>
</ul>
<p>ä¸ºäº†å¤„ç†æ‹–åŠ¨å’Œæ»‘åŠ¨äº‹ä»¶ï¼Œéœ€è¦åˆ›å»ºItemTouchHelper.SimpleCallbackçš„å®ç°ç±»ã€‚è¿™é‡Œï¼Œåªå¯¹æ»‘åŠ¨äº‹ä»¶æ„Ÿå…´è¶£ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„callback.</p>
<pre><code class="java">public class CodeLanguageItemTouchHelper extens ItemTouchHelper.SimpleCallback{

    private CodeLanguageAdapter adapter;

    public CodeLanguageItemTouchHelper(CodeLanguageAdapter adapter){
      super(ItemTouchHelper.UP | ItemTouchHelper.DOWN, ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT);
      this.adapter = adapter;
   }

    /**
    * If you don&#39;t support drag &amp; drop, this method will never be called.
    * å¦‚æœä¸æ”¯æŒæ‹–æ‹½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚
    * @param recyclerView The RecyclerView to which ItemTouchHelper is attached to. ItemTouchHelperéœ€è¦é™„åŠ åˆ°çš„RecyclerView
    * @param viewHolder The ViewHolder which is being dragged by the user. æ‹–åŠ¨çš„ViewHolder
    * @param target The ViewHolder over which the currently active item is being dragged. ç›®æ ‡ä½ç½®çš„ViewHolder
    * @return True if the viewHolder has been moved to the adapter position of target. viewHolderæ˜¯å¦è¢«ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®
    */
   @Override
   public boolean onMove(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder, RecyclerView.ViewHolder target) {
      return false;  
   }

    /**
    * Called when a ViewHolder is swiped by the user.
    * If you don&#39;t support swiping, this method will never be called.
    * å¦‚æœä¸æ”¯æŒæ»‘åŠ¨ï¼Œæ–¹æ³•ä¸ä¼šè¢«æ‰§è¡Œã€‚
    * @param viewHolder The ViewHolder which has been swiped by the user.
    * @param direction  The direction to which the ViewHolder is swiped.
    *                    It is one of UP, DOWN, LEFT or RIGHT.
    *                    If your getMovementFlags(RecyclerView, ViewHolder) method returned relative flags instead of LEFT / RIGHT;
    *                    `direction` will be relative as well. (START or END).
    */
   @Override
   public void onSwiped(RecyclerView.ViewHolder viewHolder, int direction) {
      //Remove item
      adapter.remove(viewHolder.getAdapterPosition());
   }

}
</code></pre>
<p>CodeLanguageItemTouchHelperé»˜è®¤çš„æ„é€ æ–¹æ³•éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ã€‚</p>
<pre><code class="java">
/**
* Creates a Callback for the given drag and swipe allowance.
* @param dragDirs è¡¨ç¤ºæ‹–æ‹½çš„æ–¹å‘ï¼Œæœ‰å…­ä¸ªç±»å‹çš„å€¼ï¼šLEFTã€RIGHTã€STARTã€ENDã€UPã€DOWN
* @param swipeDirs è¡¨ç¤ºæ»‘åŠ¨çš„æ–¹å‘ï¼Œæœ‰å…­ä¸ªç±»å‹çš„å€¼ï¼šLEFTã€RIGHTã€STARTã€ENDã€UPã€DOWN
*/
ItemTouchHelper.SimpleCallback(int dragDirs, int swipeDirs)
</code></pre>
<p>CodeLanguageItemTouchHelperé»˜è®¤éœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•onMove(),onSwiped()ï¼ŒonMove()æ˜¯å¯¹æ‹–æ‹½çš„å®ç°ï¼ŒonSwiped()æ˜¯å¯¹æ»‘åŠ¨çš„å®ç°ã€‚</p>
<ul>
<li>å°†ItemTouchHelperæ·»åŠ è‡³RecyclerView</li>
</ul>
<p>åˆ›å»ºå¥½è‡ªå·±çš„ItemTouchHelperç±»åï¼Œå°†å®ƒé™„åŠ åˆ°RecyclerViewå°±å¾ˆç®€å•äº†ã€‚åœ¨Activityæˆ–è€…Fragmentçš„onCreate()æ–¹æ³•ä¸­ï¼š</p>
<pre><code class="java">ItemTouchHelper.Callback callback = new MovieTouchHelper(adapter);
ItemTouchHelper helper = new ItemTouchHelper(callback);
helper.attachToRecyclerView(codeLanguageRecyclerView);
</code></pre>
<p>ç°åœ¨æ‰€æœ‰çš„å·¥ä½œå·²ç»å®Œæˆã€‚æˆ‘ä»¬ç°åœ¨è¿˜æ²¡æœ‰æ·»åŠ åŠ¨ç”»ï¼Œé»˜è®¤çš„åŠ¨ç”»ç³»ç»Ÿå·²ç»æ·»åŠ ã€‚ç°åœ¨å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p>
<p>ç¤ºä¾‹projectåœ¨è¿™é‡Œï¼š<a href="https://github.com/TonnyL/zhuanlan" target="_blank" rel="external">GitHub</a>ï¼Œä¸ä¸Šè¿°é¡¹ç›®ç¨æœ‰ä¸åŒã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜]]></title>
      <url>http://tonnyl.github.io/2016/05/27/%E5%85%B3%E4%BA%8E%E7%9F%A5%E4%B9%8E%E4%B8%93%E6%A0%8FID%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%B4%E6%98%8E/</url>
      <content type="html"><![CDATA[<p>å¯¹ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDä»¥åŠå¦‚ä½•åœ¨çŸ¥ä¹ä¸“æ Appä¸­æ·»åŠ å–œæ¬¢çš„ä¸“æ çš„ä¸€äº›æ–¹æ³•ã€‚<br><a id="more"></a></p>
<h3 id="ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çŸ¥ä¹ä¸“æ IDï¼Ÿ</h3><p>çŸ¥ä¹ä¸“æ idæ˜¯ç”±è‹¥å¹²å­—ç¬¦ç»„æˆï¼Œæ˜¯ä¸€ä¸ªçŸ¥ä¹ä¸“æ çš„å”¯ä¸€æ ‡è¯†ã€‚å¦‚ <strong>wooyun</strong> æ˜¯çŸ¥ä¹ç”¨æˆ· <strong>fenggou</strong> çš„ä¸“æ  <strong>ä¹Œäº‘å›</strong> çš„idã€‚</p>
<h3 id="æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ"><a href="#æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ" class="headerlink" title="æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ"></a>æ€æ ·è·å–çŸ¥ä¹ä¸“æ çš„IDï¼Ÿ</h3><ul>
<li>PCç”¨æˆ·é€šè¿‡æµè§ˆå™¨æµè§ˆç½‘ç«™æ—¶ï¼Œè¿›å…¥æŸç”¨æˆ·çš„ä¸»é¡µæ—¶ï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨æ˜¾ç¤ºçš„URLï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œçº¢è‰²çº¿æ¡æ‰€æŒ‡å¤„wooyunå³ä¸ºIDã€‚</li>
</ul>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_pc.png" alt="zhihu_id_pc.png" title="">
<ul>
<li>Androidå®¢æˆ·ç«¯éº»çƒ¦ä¸€äº›ï¼Œè¿›å…¥åˆ°ç”¨æˆ·çš„ä¸»é¡µåï¼Œå¦‚æœè¯¥ç”¨æˆ·æœ‰å¼€é€šçŸ¥ä¹ä¸“æ ï¼Œè¿›å…¥TAçš„ä¸“æ ã€‚</li>
</ul>
<p>ç‚¹å‡»TAçš„æ–‡ç« ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_0.png" alt="zhihu_id_android_0.png" title="">
<p>è¿›å…¥TAçš„ä¸“æ ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_1.png" alt="zhihu_id_android_1.png" title="">
<p>ç‚¹å‡»åˆ†äº«æŒ‰é’®ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_2.png" alt="zhihu_id_android_2.png" title="">
<p>ç„¶åé€‰æ‹©å¤åˆ¶åˆ°ç²˜è´´æ¿ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_3.png" alt="zhihu_id_android_3.png" title="">
<p>ç²˜è´´è‡³çŸ¥ä¹ä¸“æ Appçš„è‡ªå®šä¹‰é¡µé¢ã€‚ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œç²˜è´´è‡³dialogä¸­ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_4.png" alt="zhihu_id_android_4.png" title="">
<p>åˆ é™¤ä¸éœ€è¦çš„éƒ¨åˆ†ï¼Œåªç•™ä¸‹idéƒ¨åˆ†ã€‚ç°åœ¨å°±å¯ä»¥ç‚¹å‡»ç¡®å®šæ·»åŠ äº†ã€‚</p>
<img src="/2016/05/27/å…³äºçŸ¥ä¹ä¸“æ IDçš„ä¸€äº›è¯´æ˜/zhihu_id_android_5.png" alt="zhihu_id_android_5.png" title="">
<h3 id="ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ›´åŠ ç®€å•çš„æ·»åŠ IDï¼Ÿ</h3><p>å¥½å§ï¼Œç°åœ¨æ·»åŠ idçš„æ­¥éª¤ç¡®å®æœ‰ç‚¹éº»çƒ¦ï¼Œåé¢æˆ‘ä¼šæƒ³åŠæ³•æŠŠæ·»åŠ idçš„æ­¥éª¤ç²¾ç®€ä¸€äº›ã€‚é¢„è®¡ä¸‹ä¸€ç‰ˆä¼šå®ç°ã€‚</p>
<h3 id="éœ€è¦æ³¨æ„çš„äº‹é¡¹"><a href="#éœ€è¦æ³¨æ„çš„äº‹é¡¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„äº‹é¡¹"></a>éœ€è¦æ³¨æ„çš„äº‹é¡¹</h3><p>å»ºè®®æ€»æ·»åŠ IDä¸è¦è¶…è¿‡20ä¸ªï¼Œæ·»åŠ è¿‡å¤šçš„æ ç›®æ—¶å¯èƒ½é€ æˆåˆå§‹åŒ–é¡µé¢æ—¶ï¼ŒåŠ è½½æ—¶é—´è¿‡é•¿ã€‚</p>
<h3 id="æœ€åè¯´ä¸€å¥"><a href="#æœ€åè¯´ä¸€å¥" class="headerlink" title="æœ€åè¯´ä¸€å¥"></a>æœ€åè¯´ä¸€å¥</h3><p>é¡¹ç›®ç›®å‰å·²ç»å¼€æºåˆ°GitHub,é¡¹ç›®åœ°å€<a href="https://github.com/marktony/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ GitHub</a>,æ¬¢è¿æ„Ÿå…´è¶£çš„åŒå­¦fork+starï¼Œå®šåˆ¶å±äºè‡ªå·±çš„çŸ¥ä¹ä¸“æ Appã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Tips]]></title>
      <url>http://tonnyl.github.io/2016/05/19/Tips/</url>
      <content type="html"><![CDATA[<p>é‚£äº›æˆ‘è‡ªå·±è¸©è¿‡çš„å‘!</p>
<a id="more"></a>
<ul>
<li><p>SwipeRefreshLayout setRefreshing()æ–¹æ³•å¤±è´¥<br>è§£å†³æ–¹æ³•ï¼š</p>
<pre><code class="java">swipeRefreshLayout.post(new Runnable() {
  @Override
  public void run() {
      swipeRefreshLayout.setRefreshing(true);
  }
});
</code></pre>
</li>
<li><p>Recyclerviewä¸SwipeRefreshLayoutæ»‘åŠ¨äº‹ä»¶å†²çª<br>ç•Œé¢ä¸­åŒæ—¶æœ‰è¿™ä¸¤ç§viewæ—¶ï¼Œæ»‘åŠ¨æ—¶é—´ä¾¿å†²çªäº†ã€‚çŸ¥ä¹androidå®¢æˆ·ç«¯è®¾ç½®ç•Œé¢åœ¨æ— ç½‘ç»œè¿æ¥æ—¶ï¼Œä¹Ÿå­˜åœ¨åŒæ ·çš„æ»‘åŠ¨äº‹ä»¶å†²çªçš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒçš„å¸ƒå±€åº”è¯¥æ˜¯SwipeRefreshLayoutå’ŒScrollViewå†²çªã€‚<br>è§£å†³æ–¹æ³•ï¼š</p>
<pre><code class="java">recyclerView.setOnScrollListener(new RecyclerView.OnScrollListener() {
          @Override
          public void onScrolled(RecyclerView recyclerView, int dx, int dy) {
              super.onScrolled(recyclerView, dx, dy);

              // ç¡®ä¿åªæœ‰å½“RecyclerViewçš„itemæ»‘åŠ¨åˆ°æœ€ä¸Šé¢çš„ä¸€ä¸ªæ—¶RefreshLayoutæ‰èƒ½ä¸‹æ‹‰
              refreshLayout.setEnabled(linearLayoutManager.findFirstVisibleItemPosition() == 0);
          }
      });
</code></pre>
</li>
<li><p>åº”ç”¨é€€å‡ºæ—¶ç½‘ç»œè¯·æ±‚æœªå®Œæˆå¯¼è‡´å¤±å»context<br>è¿™ä¹ˆè¯´å¯èƒ½ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œå…·ä½“çš„æè¿°åº”è¯¥æ˜¯ï¼šå½“ç½‘ç»œè¯·æ±‚ä»åœ¨è¿›è¡Œæ—¶ï¼Œé€€å‡ºåº”ç”¨ï¼Œè¿™æ˜¯å¤±å»contextï¼ŒæŸäº›é€‚é…å™¨æ²¡æœ‰é€‚é…å®Œæˆï¼Œå¯¼è‡´åº”ç”¨ç›´æ¥å´©æºƒã€‚<br>åœ¨çŸ¥ä¹ä¸“æ çš„è¿‡ç¨‹ä¸­ï¼Œfragmentä¸­çš„å†…å®¹å…¨éƒ¨ä¸ºrecyclerviewï¼Œè€Œä¸”å…¨éƒ¨æ˜¯åœ¨ç½‘ç»œè¯·æ±‚ä¸‹å®Œæˆçš„ã€‚ç¬¬ä¸€ç‰ˆçš„æ—¶å€™æˆ‘é‡åˆ°çš„é—®é¢˜å°±æ˜¯ä¸Šè¿°æè¿°çš„è¿™æ ·ï¼Œåœ¨ç½‘ç»œè¯·æ±‚æ²¡æœ‰å®Œå…¨å®Œæˆæ—¶ï¼Œé€€å‡ºåº”ç”¨ï¼Œrecyclerviewçš„é€‚é…è¿˜æ²¡æœ‰å®Œæˆï¼Œä¹‹åç›´æ¥å¯¼è‡´set text on a null objectã€‚<br>æˆ‘çš„è§£å†³æ–¹æ³•æ˜¯ï¼šç»™æ‰€æœ‰volleyç½‘ç»œè¯·æ±‚è®¾ç½®TAGï¼Œç„¶ååœ¨fragmentçš„onStop()æ–¹æ³•ä¸­å–æ¶ˆè¯·æ±‚ã€‚<br>ç¤ºä¾‹ä»£ç :</p>
</li>
</ul>
<pre><code class="java">public class MyFragment extends Fragment{

    private RequestQueue queue;
    private static final String     TAG = &quot;TAG&quot;;

    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        queue = Volley.newRequestQueue(getActivity().getApplicationContext());
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.my_fragment,container,false);

        JsonObjectRequest request = new JsonObjectRequest(Request.Method.GET, &quot;my url&quot;, new Response.Listener&lt;JSONObject&gt;() {
            @Override
            public void onResponse(JSONObject jsonObject) {
                // code
        }, new Response.ErrorListener() {
            @Override
            public void onErrorResponse(VolleyError volleyError) {
               // code
            }
        });

        request.setTag(TAG);
        queue.add(request);

         @Override
        public void onStop() {
        super.onStop();

        if (queue != null){
            queue.cancelAll(TAG);
        }
    }
}
</code></pre>
<ul>
<li>å»é™¤å­—ç¬¦ä¸²ä¸­çš„htmléƒ¨åˆ†<br>åœ¨Androidä¸­é€šè¿‡ä¸€è¡Œä»£ç å³å¯æå®šã€‚<pre><code class="java">newString = android.text.Html.fromHtml(oldString).toString();
</code></pre>
åœ¨javaä¸­çš„è§£å†³æ–¹æ³•æ˜¯ï¼š<pre><code class="java">String newString = Jsoup.parse(html).text();
</code></pre>
</li>
</ul>
<p>moreâ€¦</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[çŸ¥ä¹ä¸“æ APIåˆ†æ]]></title>
      <url>http://tonnyl.github.io/2016/05/14/%E7%9F%A5%E4%B9%8E%E4%B8%93%E6%A0%8FAPI%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<p>çŸ¥ä¹ä¸“æ APIçš„ç®€å•åˆ†æ<br><a id="more"></a></p>
<p>æ„Ÿè°¢çŸ¥ä¹ï¼Œæä¾›å¦‚æ­¤å‡ºè‰²çš„å¹³å°ï¼Œæ›´è¦æ„Ÿè°¢è¾›è‹¦çš„ä¸“æ ä½œè€…ä»¬ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†è¿™ä¹ˆå¤šçš„å¹²è´§ï¼Œæœ€åæ„Ÿè°¢æ”¯æŒæˆ‘çš„äººä»¬ï¼Œè°¢è°¢ä½ ä»¬ï¼</p>
<h3 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h3><p>å£°æ˜ï¼šä»¥ä¸‹æ‰€æœ‰APIå‡ç”± <strong>çŸ¥ä¹(Zhihu.INC)</strong> æä¾›ï¼Œæœ¬äººé€šè¿‡éæ­£å¸¸æ‰‹æ®µè·å–ã€‚è·å–ä¸å…±äº«çš„è¡Œä¸ºæœ‰ä¾µçŠ¯çŸ¥ä¹æƒç›Šçš„å«Œç–‘ã€‚è‹¥è¢«å‘ŠçŸ¥åœæ­¢ä½¿ç”¨ä¸å…±äº«ï¼Œæœ¬äººå°†åŠæ—¶åˆ é™¤æ•´ä¸ªé¡¹ç›®ã€‚è¯·æ‚¨çŸ¥æ‚‰ç›¸å…³æƒ…å†µï¼Œéµå®ˆçŸ¥ä¹çš„åè®®ã€‚APIä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨ä½œå•†ä¸šç”¨é€”ã€‚</p>
<h3 id="ç¤ºä¾‹é¡¹ç›®"><a href="#ç¤ºä¾‹é¡¹ç›®" class="headerlink" title="ç¤ºä¾‹é¡¹ç›®"></a>ç¤ºä¾‹é¡¹ç›®</h3><p><a href="https://github.com/TonnyL/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ Android</a></p>
<h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><ul>
<li>ä¸“æ çš„æ¶ˆæ¯å‡ä»¥JSONæ ¼å¼è¾“å‡º</li>
<li>http methodå‡ä¸ºGET</li>
<li>JSON ARRAY ä¸­çš„æ•°æ®ï¼Œåªé€‰å–äº†å…·æœ‰ä»£è¡¨æ€§çš„éƒ¨åˆ†è¿›è¡Œå±•ç¤º</li>
</ul>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><h4 id="è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯"><a href="#è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯" class="headerlink" title="è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯"></a>è·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯</h4><pre><code>https://zhuanlan.zhihu.com/api/columns/ä¸“æ å
</code></pre><p>ä¾‹å¦‚è·å–çŸ¥ä¹å°ç®¡å®¶çš„ä¸“æ ä¿¡æ¯</p>
<pre><code>https://zhuanlan.zhihu.com/api/columns/zhihuadmin
</code></pre><p>å¾—åˆ°çš„ä¿¡æ¯ä¸ºï¼š</p>
<pre><code class="json">{
  &quot;followersCount&quot;: 7883,
  &quot;creator&quot;:
    {
      &quot;profileUrl&quot;: &quot;https://www.zhihu.com/people/zhihuadmin&quot;,
      &quot;bio&quot;: &quot;æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼&quot;,
      &quot;hash&quot;: &quot;3d198a56310c02c4a83efb9f4a4c027e&quot;,
      &quot;uid&quot;: 53253479858176,
      &quot;isOrg&quot;: false,
      &quot;description&quot;: &quot;&quot;,
      &quot;slug&quot;: &quot;zhihuadmin&quot;,
      &quot;avatar&quot;:
        {
          &quot;id&quot;: &quot;34bf96bf5584ac4b5264bd7ed4fdbc5a&quot;,
          &quot;template&quot;: &quot;https://pic3.zhimg.com/{id}_{size}.jpg&quot;
        },
      &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶&quot;
    },
    &quot;topics&quot;:
      [
        {
          &quot;url&quot;: &quot;https://www.zhihu.com/topic/19552112&quot;,
          &quot;id&quot;: &quot;19552112&quot;,
          &quot;name&quot;: &quot;çŸ¥ä¹å»ºè®®åé¦ˆ&quot;
        },
      ],
    &quot;activateState&quot;: &quot;activated&quot;,
    &quot;href&quot;: &quot;/api/columns/zhihuadmin&quot;,
    &quot;acceptSubmission&quot;: true,
    &quot;firstTime&quot;: false,
    &quot;postTopics&quot;:
      [
        {
          &quot;postsCount&quot;: 4,
          &quot;id&quot;: 2,
          &quot;name&quot;: &quot;çŸ¥ä¹&quot;
        },
      ],
    &quot;pendingName&quot;: &quot;&quot;,
    &quot;avatar&quot;:
      {
        &quot;id&quot;: &quot;5a1ec50171767c4fc856f430e46297db&quot;,
        &quot;template&quot;: &quot;https://pic4.zhimg.com/{id}_{size}.jpg&quot;
      },
    &quot;canManage&quot;: false,
    &quot;description&quot;: &quot;çŸ¥ä¹ç¤¾åŒºç®¡ç†å›¢é˜Ÿå®˜æ–¹ä¸“æ ï¼Œä¸å®šæœŸæ›´æ–°ç¤¾åŒºç®¡ç†å·¥ä½œç›¸å…³çš„æœ€æ–°æ¶ˆæ¯ã€‚&quot;,  
    &quot;pendingTopics&quot;: [],
    &quot;nameCanEditUntil&quot;: 0,
    &quot;reason&quot;: &quot;&quot;,
    &quot;banUntil&quot;: 0,
    &quot;slug&quot;: &quot;zhihuadmin&quot;,
    &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶è¯´&quot;,
    &quot;url&quot;: &quot;/zhihuadmin&quot;,
    &quot;intro&quot;: &quot;çŸ¥ä¹ç¤¾åŒºç®¡ç†å›¢é˜Ÿå®˜æ–¹ä¸“æ ï¼Œä¸å®šæœŸæ›´æ–°ç¤¾åŒºç®¡ç†å·¥ä½œâ€¦&quot;,  
    &quot;topicsCanEditUntil&quot;: 0,
    &quot;activateAuthorRequested&quot;: &quot;none&quot;,
    &quot;commentPermission&quot;: &quot;anyone&quot;,
    &quot;following&quot;: false,
    &quot;postsCount&quot;: 19,  
    &quot;canPost&quot;: false
  }
</code></pre>
<ul>
<li>followersCount: å…³æ³¨è¯¥ä¸“æ çš„äººæ•°</li>
<li>creator: è¯¥ä¸“æ çš„åˆ›å»ºè€…ä¿¡æ¯<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>topics: ä¸“æ è¯é¢˜ä¿¡æ¯<ul>
<li>url: è¯é¢˜åœ¨çŸ¥ä¹å®˜ç½‘ä¸­çš„åœ°å€</li>
<li>id: è¯é¢˜id</li>
<li>name: è¯é¢˜åç§°</li>
</ul>
</li>
<li>activateState: çŠ¶æ€ä¿¡æ¯ï¼Œæ˜¯å¦æ¿€æ´»</li>
<li>href: apiè¯·æ±‚åœ°å€</li>
<li>acceptSubmission: æ˜¯å¦æ¥å—æäº¤æ–‡ç« </li>
<li>firstTime: æ˜¯å¦ä¸ºé¦–æ¬¡æäº¤ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>postTopics: æ–‡ç« è¯é¢˜ä¿¡æ¯<ul>
<li>postsCount: è¯¥è¯é¢˜ä¸‹æ–‡ç« æ•°</li>
<li>id: id</li>
<li>name: è¯é¢˜åç§°</li>
</ul>
</li>
<li>pendingName: ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>avatar: ä¸“æ å¤´åƒä¿¡æ¯<ul>
<li>id: å¤´åƒid</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>canManage: æ˜¯å¦å¯ä»¥è¿›è¡Œç®¡ç†</li>
<li>description: ä¸“æ ä¿¡æ¯æè¿°</li>
<li>pendingTopics: ???è¯é¢˜</li>
<li>nameCanEditUntil: è·ä¸‹ä¸€æ¬¡ä¿®æ”¹åç§°çš„æ—¶é—´</li>
<li>reason: è¢«å°ç¦çš„åŸå› </li>
<li>banUntil: è¢«å°ç¦çš„æ—¶é—´</li>
<li>slug: ä¸“æ slug</li>
<li>url: url</li>
<li>intro: ä¸“æ ä»‹ç»ä¿¡æ¯</li>
<li>topicsCanEditUntil: è·ä¸‹ä¸€æ¬¡ä¿®æ”¹è¯é¢˜çš„æ—¶é—´</li>
<li>activateAuthorRequested: ???</li>
<li>commentPermission: è¯„è®ºæƒé™</li>
<li>following: æ˜¯å¦å…³æ³¨æ”¹ä¸“æ </li>
<li>postsCount: ä¸“æ æ–‡ç« æ•°</li>
<li>canPost: å½“å‰å¸å·æ˜¯å¦æœ‰å‘è¡¨æ–‡ç« çš„æƒé™</li>
</ul>
<p>åœ¨è·å–å›¾ç‰‡urlæ—¶ï¼Œå¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„å°ºå¯¸ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œå›¾ç‰‡è´¨é‡ä¾æ¬¡å¢åŠ ã€‚ä¹Ÿå¯ä»¥ä¸æ·»åŠ å°ºå¯¸å‚æ•°ï¼Œé»˜è®¤è·å–æœ€å¤§ç±»å‹ã€‚</p>
<pre><code>https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_s.jpg
https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_m.jpg
https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_l.jpg
https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_b.jpg
https://pic3.zhimg.com/34bf96bf5584ac4b5264bd7ed4fdbc5a_r.jpg
</code></pre><h4 id="è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨"><a href="#è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨" class="headerlink" title="è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨"></a>è·å–æŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨</h4><pre><code>https://zhuanlan.zhihu.com/api/columns/ä¸“æ å/posts?limit=æ•°é‡&amp;offset=ä»å“ªé‡Œå¼€å§‹
</code></pre><p>ä¾‹å¦‚ï¼Œè·å–çŸ¥ä¹å°ç®¡å®¶çš„æœ€æ–°çš„10ç¯‡æ–‡ç« </p>
<pre><code>https://zhuanlan.zhihu.com/api/columns/zhihuadmin/posts?limit=10&amp;offset=0
</code></pre><p>å…¶ä¸­ï¼Œlimitä¸ºè·å–çš„æ•°é‡é™åˆ¶ï¼Œoffsetä¸ºåç§»é‡ï¼Œå³ä»å“ªé‡Œå¼€å§‹è·å–ã€‚<br>é»˜è®¤æ•°æ®ä¸ºlimit=10ï¼Œoffset=0ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦å®šä¹‰äºŒè€…çš„å€¼ã€‚<br>è·å¾—çš„æ•°æ®ä¸º:</p>
<pre><code class="JSON">[
  {  
    &quot;isTitleImageFullScreen&quot;: false,
    &quot;rating&quot;: &quot;none&quot;,
    &quot;sourceUrl&quot;: &quot;&quot;,
    &quot;publishedTime&quot;: &quot;2016-10-13T14:00:49+08:00&quot;,
    &quot;links&quot;:
      {
        &quot;comments&quot;: &quot;/api/posts/22921645/comments&quot;
      },
    &quot;author&quot;:
      {
        &quot;profileUrl&quot;: &quot;https://www.zhihu.com/people/zhihuadmin&quot;,
        &quot;bio&quot;: &quot;æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼&quot;,
        &quot;hash&quot;: &quot;3d198a56310c02c4a83efb9f4a4c027e&quot;,
        &quot;uid&quot;: 53253479858176,
        &quot;isOrg&quot;: false,
        &quot;description&quot;: &quot;&quot;,  
        &quot;slug&quot;: &quot;zhihuadmin&quot;,
        &quot;avatar&quot;:
          {
            &quot;id&quot;: &quot;34bf96bf5584ac4b5264bd7ed4fdbc5a&quot;,
            &quot;template&quot;: &quot;https://pic3.zhimg.com/{id}_{size}.jpg&quot;
          },
        &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶&quot;
      },
    &quot;url&quot;: &quot;/p/22921645&quot;,
    &quot;title&quot;: &quot;æ–°ç‰ˆç¤¾åŒºç®¡ç†è§„å®šäº 2016 å¹´ 10 æœˆ 13 æ—¥æ­£å¼è¿è¡Œ&quot;,
    &quot;titleImage&quot;: &quot;https://pic2.zhimg.com/v2-517f47cc5269b57f26ea4a25f29d8505_r.jpg&quot;,
    &quot;summary&quot;: &quot;&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;2016 å¹´ 9 æœˆ 13 æ—¥å°ç®¡å®¶å‘å¸ƒäº†æ–°ç‰ˆç¤¾åŒºç®¡ç†è§„å®šï¼Œæ˜ç¡®äº†ã€Œæ¶æ„è¡Œä¸ºã€çš„å®šä¹‰å’Œè¿è§„ç±»å‹ï¼ŒåŒæ—¶å¢åŠ äº†ã€Œå‘å¸ƒåƒåœ¾å¹¿å‘Šä¿¡æ¯ã€çš„ 3 ç§è¿è§„ç±»å‹ã€‚åœ¨å®Œæˆäº†ä¸ºæœŸ 1 ä¸ªæœˆçš„è¯•è¿è¡Œå&lt;b&gt;ï¼Œ&lt;/b&gt;&lt;b&gt;&lt;a href=\&quot;https://www.zhihu.com/question/19790711/answer/36685915\&quot; class=\&quot;\&quot; data-editable=\&quot;true\&quot; data-title=\&quot;\u65b0\u7248\u793e\u533a\u7ba1\u7406\u89c4\u5b9a\&quot;&gt;\u65b0\u7248\u793e\u533a\u7ba1\u7406\u89c4\u5b9a&lt;/a&gt;&quot;,
    &quot;state&quot;: &quot;published&quot;,
    &quot;href&quot;: &quot;/api/posts/22921645&quot;,
    &quot;meta&quot;:
      {
        &quot;previous&quot;: null,
        &quot;next&quot;: null
      },
    &quot;commentPermission&quot;: &quot;anyone&quot;,
    &quot;snapshotUrl&quot;: &quot;&quot;,
    &quot;canComment&quot;: false,
    &quot;slug&quot;: 22921645,
    &quot;commentsCount&quot;: 76,
    &quot;likesCount&quot;: 436
  },
]
</code></pre>
<ul>
<li>isTitleImageFullScreen: æ–‡ç« æ ‡é¢˜å¤§å›¾æ˜¯å¦å…¨å±</li>
<li>rating: ???è¯„çº§</li>
<li>sourceUrl: æºè·¯å¾„</li>
<li>publishedTime: å‘è¡¨æ—¶é—´</li>
<li>links: é“¾æ¥ä¿¡æ¯<ul>
<li>comments: è¯„è®ºåœ°å€</li>
</ul>
</li>
<li>creator: è¯¥ä¸“æ çš„åˆ›å»ºè€…ä¿¡æ¯<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>url: æ–‡ç« ç½‘é¡µå†…å®¹è·å–(<a href="https://zhuanlan.zhihu.com" target="_blank" rel="external">https://zhuanlan.zhihu.com</a> + url)</li>
<li>title: æ–‡ç« æ ‡é¢˜</li>
<li>titleImage: æ–‡ç« æ ‡é¢˜å¤§å›¾url(éœ€è¦æ³¨æ„çš„æ˜¯,titleImageçš„å€¼æœ‰å¯èƒ½ä¸ºç©º)ï¼Œå’Œå¤´åƒä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»„åˆä¸åŒçš„å°ºå¯¸å‚æ•°è·å–ä¸åŒå°ºå¯¸çš„å›¾ç‰‡</li>
<li>summary: æ–‡ç« ç®€è¦ä¿¡æ¯</li>
<li>content: HTMLæ ¼å¼çš„æ–‡ç« å†…å®¹è¯¦æƒ…ï¼Œå¯ä»¥é€šè¿‡WebViewæˆ–è€…UIWebViewå±•ç¤ºå†…å®¹</li>
<li>state: æ–‡ç« çŠ¶æ€(æ˜¯å¦å‘è¡¨)</li>
<li>href: apiè¯·æ±‚åœ°å€</li>
</ul>
<h4 id="è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯"><a href="#è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯" class="headerlink" title="è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯"></a>è·å–ç‰¹å®šçš„æ–‡ç« ä¿¡æ¯</h4><pre><code>https://zhuanlan.zhihu.com/api/posts/SLUG
</code></pre><p>ä¾‹å¦‚ï¼Œè·å–çŸ¥ä¹å°ç®¡å®¶çš„æœ€æ–°ä¸€ç¯‡æ–‡ç« ï¼Œé€šè¿‡å·²ç»è·å¾—çš„ä¿¡æ¯ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ç»„åˆurlè¿›è¡Œè·å–ï¼Œä¸€æ˜¯é€šè¿‡hrefå€¼ï¼Œå¦ä¸€ç§å°±æ˜¯slugå€¼ï¼Œå½“ç„¶ï¼Œè¿™ä¸¤ç§æ–¹å¼æ®Šé€”åŒå½’ã€‚</p>
<pre><code>https://zhuanlan.zhihu.com/api/posts/22921645
</code></pre><p>è·å–åˆ°çš„ä¿¡æ¯ä¸º:</p>
<pre><code class="JSON">{
  &quot;isTitleImageFullScreen&quot;: false,
  &quot;rating&quot;: &quot;none&quot;,
  &quot;titleImage&quot;: &quot;https://pic2.zhimg.com/v2-cab0719fdec0816c475d7b70e016cbb1_r.jpg&quot;,
  &quot;links&quot;:
    {
      &quot;comments&quot;: &quot;/api/posts/22591792/comments&quot;
    },
  &quot;reviewers&quot;: [],
  &quot;topics&quot;:
    [
      {
        &quot;url&quot;: &quot;https://www.zhihu.com/topic/19550887&quot;,
        &quot;id&quot;: &quot;19550887&quot;,
        &quot;name&quot;: &quot;çŸ¥ä¹ç¤¾åŒº&quot;
      },
    ],
  &quot;titleImageSize&quot;:
    {
      &quot;width&quot;: 0,
      &quot;height&quot;: 0
    },
  &quot;href&quot;: &quot;/api/posts/22591792&quot;,
  &quot;excerptTitle&quot;: &quot;&quot;,
  &quot;author&quot;:
    {
      &quot;profileUrl&quot;: &quot;https://www.zhihu.com/people/zhihuadmin&quot;,
      &quot;bio&quot;: &quot;æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼&quot;,
      &quot;hash&quot;: &quot;3d198a56310c02c4a83efb9f4a4c027e&quot;,
      &quot;uid&quot;: 53253479858176,
      &quot;isOrg&quot;: false,
      &quot;description&quot;: &quot;&quot;,
      &quot;badge&quot;:
        {
          &quot;identity&quot;:
            {
              &quot;description&quot;: &quot;çŸ¥ä¹å®˜æ–¹å¸å·&quot;
            },
          &quot;best_answerer&quot;: null
        },
      &quot;slug&quot;: &quot;zhihuadmin&quot;,
      &quot;avatar&quot;:
        {
          &quot;id&quot;: &quot;34bf96bf5584ac4b5264bd7ed4fdbc5a&quot;,
          &quot;template&quot;: &quot;https://pic3.zhimg.com/{id}_{size}.jpg&quot;
        },
      &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶&quot;
    },
  &quot;column&quot;:
    {
      &quot;slug&quot;: &quot;zhihuadmin&quot;,
      &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶è¯´&quot;
    },
  &quot;tipjarState&quot;: &quot;inactivated&quot;,
  &quot;content&quot;: &quot;&lt;p&gt;ä»Šå¤©ï¼Œå°ç®¡å®¶å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ç«™å†…ã€Œä¸è§„èŒƒè½¬è½½ã€è¡Œä¸ºçš„å¤„ç†æƒ…å†µã€‚&lt;/p&gt;&lt;br&gt;&quot;,
  &quot;state&quot;: &quot;published&quot;,
  &quot;sourceUrl&quot;: &quot;&quot;,
  &quot;pageCommentsCount&quot;: 34,
  &quot;canComment&quot;: true,
  &quot;snapshotUrl&quot;: &quot;&quot;,
  &quot;slug&quot;: 22591792,
  &quot;publishedTime&quot;: &quot;2016-09-23T17:33:56+08:00&quot;,
  &quot;url&quot;: &quot;/p/22591792&quot;,
  &quot;title&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶å·¥ä½œç¬”è®°ï¼šä¸è§„èŒƒè½¬è½½ï¼Ÿä¸å¯ä»¥ï¼&quot;,
  &quot;lastestLikers&quot;:
    [
      {
        &quot;profileUrl&quot;: &quot;https://www.zhihu.com/people/su-shu-95-98&quot;,
        &quot;bio&quot;: &quot;ä¸€ä¸ªæ— æ³•ç”¨ä¸€å¥è¯æè¿°çš„äºº&quot;,
        &quot;hash&quot;: &quot;a6975d974fb22609a31dbbdec6f375e3&quot;,
        &quot;uid&quot;: 657690756534505472,
        &quot;isOrg&quot;: false,
        &quot;description&quot;: &quot;ä½ è¯´ä»€ä¹ˆéƒ½å¯¹ã€‚&quot;,
        &quot;slug&quot;: &quot;su-shu-95-98&quot;,
        &quot;avatar&quot;:
          {
            &quot;id&quot;: &quot;888129f4afd91083c0cfd156e6889438&quot;,
            &quot;template&quot;: &quot;https://pic1.zhimg.com/{id}_{size}.jpg&quot;
          },
        &quot;name&quot;: &quot;è‹èˆ’&quot;
      },
    ],
  &quot;summary&quot;: &quot;&lt;img src=\&quot;https://pic1.zhimg.com/v2-4f2228e8f8292ec30c373488afa2bd48_200x112.jpg\&quot; data-rawwidth=\&quot;920\&quot; data-rawheight=\&quot;638\&quot; class=\&quot;origin_image inline-img zh-lightbox-thumb\&quot; data-original=\&quot;https://pic1.zhimg.com/v2-4f2228e8f8292ec30c373488afa2bd48_r.jpg\&quot;&gt;ä»Šå¤©ï¼Œå°ç®¡å®¶å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ç«™å†…ã€Œä¸è§„èŒƒè½¬è½½ã€è¡Œä¸ºçš„å¤„ç†æƒ…å†µã€‚ å¹´åˆæˆ‘ä»¬å‘å¸ƒäº†...&quot;,
  &quot;reviewingCommentsCount&quot;: 0,
  &quot;meta&quot;:
    {
      &quot;previous&quot;:
        {
          &quot;isTitleImageFullScreen&quot;: false,
          &quot;rating&quot;: &quot;none&quot;,
          &quot;titleImage&quot;: &quot;https://pic2.zhimg.com/517f47cc5269b57f26ea4a25f29d8505_r.jpg&quot;,
          &quot;links&quot;:
            {
              &quot;comments&quot;: &quot;/api/posts/22434253/comments&quot;
            },
          &quot;topics&quot;:
            [
              {
                &quot;url&quot;: &quot;https://www.zhihu.com/topic/19550887&quot;,
                &quot;id&quot;: &quot;19550887&quot;,
                &quot;name&quot;: &quot;çŸ¥ä¹ç¤¾åŒº&quot;
              },            
            ],
          &quot;href&quot;: &quot;/api/posts/22434253&quot;,
          &quot;excerptTitle&quot;: &quot;&quot;,
          &quot;author&quot;:
            {
              &quot;profileUrl&quot;: &quot;https://www.zhihu.com/people/zhihuadmin&quot;,
              &quot;bio&quot;: &quot;æ¬¢è¿åé¦ˆé—®é¢˜å’Œå»ºè®®ï¼&quot;,
              &quot;hash&quot;: &quot;3d198a56310c02c4a83efb9f4a4c027e&quot;,
              &quot;uid&quot;: 53253479858176,
              &quot;isOrg&quot;: false,
              &quot;description&quot;: &quot;&quot;,
              &quot;slug&quot;: &quot;zhihuadmin&quot;,
              &quot;avatar&quot;:
                {
                  &quot;id&quot;: &quot;34bf96bf5584ac4b5264bd7ed4fdbc5a&quot;,
                  &quot;template&quot;: &quot;https://pic3.zhimg.com/{id}_{size}.jpg&quot;
                },
              &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶&quot;
            },
          &quot;column&quot;:
            {
              &quot;slug&quot;: &quot;zhihuadmin&quot;,
              &quot;name&quot;: &quot;çŸ¥ä¹å°ç®¡å®¶è¯´&quot;
            },
          &quot;content&quot;: &quot;é¢˜ä¸‹å‘å¸ƒç›¸åŒå›ç­”ï¼›&lt;/p&gt;&lt;img src=\&quot;https://pic2.zhimg.com/a86dbedbeb67a26b33252ee4e8e886a9_b.png\&quot; data-rawwidth=\&quot;469\&quot; data-rawheight=\&quot;348\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;469\&quot; data-original=\&quot;https://pic2.zhimg.com/a86dbedbeb67a26b33252ee4e8e886a9_r.png\&quot;&gt;&lt;br&gt;&quot;,
          &quot;state&quot;: &quot;published&quot;,
          &quot;sourceUrl&quot;: &quot;&quot;,
          &quot;pageCommentsCount&quot;: 0,
          &quot;canComment&quot;: true,
          &quot;snapshotUrl&quot;: &quot;&quot;,
          &quot;slug&quot;: 22434253,
          &quot;publishedTime&quot;: &quot;2016-09-13T17:34:29+08:00&quot;,
          &quot;url&quot;: &quot;/p/22434253&quot;,
          &quot;title&quot;: &quot;æ–°ç‰ˆç¤¾åŒºç®¡ç†è§„èŒƒäºä»Šæ—¥è¯•è¿è¡Œ&quot;,
          &quot;summary&quot;: &quot;ç¤¾åŒºç®¡ç†è§„èŒƒæ˜¯çŸ¥å‹å…±è¯†çš„æ€»ç»“ï¼Œä¹Ÿæ˜¯ç¤¾åŒºå¥åº·å‘å±•çš„åŸºçŸ³ã€‚è¿‘æœŸï¼Œæˆ‘ä»¬ä¸æ–­æ”¶åˆ°çŸ¥å‹ä»¬åé¦ˆæ–°çš„æ‰°ä¹±ç¤¾åŒºç§©åºçš„è¡Œä¸ºï¼Œå¦‚é›†èµçˆ†ç…§ã€ç‚¹èµæŠ½å¥–ã€è¯„è®ºåŒºå‘å¸ƒä¹±ç ã€åˆ·èµåˆ·ç²‰ã€æ¶æ„è¥é”€ã€å›ç­”éšè—æ·˜å®é“¾æ¥...&quot;,
          &quot;reviewingCommentsCount&quot;: 0,
          &quot;meta&quot;:
            {
              &quot;previous&quot;: null,
              &quot;next&quot;: null
            },
          &quot;commentPermission&quot;: &quot;anyone&quot;,
          &quot;commentsCount&quot;: 0,
          &quot;likesCount&quot;: 0
        },
      &quot;next&quot;: null
    },
  &quot;commentPermission&quot;: &quot;anyone&quot;,
  &quot;commentsCount&quot;: 34,
  &quot;likesCount&quot;: 241
}
</code></pre>
<ul>
<li>isTitleImageFullScreen: æ–‡ç« æ ‡é¢˜å¤§å›¾æ˜¯å¦å…¨å±</li>
<li>rating: ???è¯„çº§</li>
<li>titleImage: æ–‡ç« æ ‡é¢˜å¤§å›¾url(éœ€è¦æ³¨æ„çš„æ˜¯,titleImageçš„å€¼æœ‰å¯èƒ½ä¸ºç©º)ï¼Œå’Œå¤´åƒä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»„åˆä¸åŒçš„å°ºå¯¸å‚æ•°è·å–ä¸åŒå°ºå¯¸çš„å›¾ç‰‡</li>
<li>links: é“¾æ¥ä¿¡æ¯<ul>
<li>comments: è¯„è®ºè·å–åœ°å€</li>
</ul>
</li>
<li>reviewers: å¤å®¡äºº(åœ¨æˆ‘è¯·æ±‚çš„è¿™ä¹ˆå¤šæ¬¡ä¸­ï¼Œå¹¶æ²¡æœ‰æˆåŠŸè·å¾—è¿‡æ­¤é¡¹å¯¹åº”çš„å€¼ã€‚ä¸æ’é™¤æ­¤é¡¹è¿”å›å…·ä½“å€¼çš„å¯èƒ½æ€§ã€‚æ¨æµ‹ä¸ºcreatorç±»å‹ã€‚)</li>
<li>topics: ä¸“æ è¯é¢˜ä¿¡æ¯<ul>
<li>url: è¯é¢˜åœ¨çŸ¥ä¹å®˜ç½‘ä¸­çš„åœ°å€</li>
<li>id: è¯é¢˜id</li>
<li>name: è¯é¢˜åç§°</li>
</ul>
</li>
<li>titleImageSize:<ul>
<li>width å®½åº¦</li>
<li>height é«˜åº¦</li>
</ul>
</li>
<li>href: apiè¯·æ±‚åœ°å€</li>
<li>excerptTitle: å¼•ç”¨(æ‘˜å½•)æ ‡é¢˜</li>
<li>author:<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>badge å¾½ç« ï¼Œå³è®¤è¯ä¿¡æ¯<ul>
<li>identity å®˜æ–¹å¸å·<ul>
<li>description è®¤è¯è¯¦æƒ…æè¿°</li>
</ul>
</li>
<li>best_answerer ä¼˜ç§€å›ç­”è€…</li>
</ul>
</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>column: æ‰€å±ä¸“æ <ul>
<li>slug slug</li>
<li>name ä¸“æ åç§°</li>
</ul>
</li>
<li>tipjarState: æ‰“èµä¿¡æ¯</li>
<li>content: HTMLæ ¼å¼çš„å†…å®¹ä¿¡æ¯è¯¦æƒ…</li>
<li>state: æ–‡ç« çŠ¶æ€ï¼Œæ˜¯å¦å‘å¸ƒ</li>
<li>sourceUrl: æºåœ°å€</li>
<li>pageCommentsCount: è¯„è®ºæ•°</li>
<li>canComment: æ˜¯å¦å¯ä»¥è¯„è®º</li>
<li>snapshotUrl: çŸ­ç½‘å€?</li>
<li>slug: æ–‡ç« çš„slug</li>
<li>publishedTime: æ–‡ç« å‘è¡¨æ—¶é—´</li>
<li>url: urlåœ°å€</li>
<li>title: æ–‡ç« æ ‡é¢˜</li>
<li>lastestLikers: æœ€è¿‘ç‚¹èµçš„ç”¨æˆ·<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>summaryâ€: æ–‡ç« ç®€è¦ä¿¡æ¯</li>
<li>reviewingCommentsCount: å®¡æŸ¥ä¸­çš„è¯„è®ºæ•°é‡</li>
<li>meta: meta<ul>
<li>previous ä¸Šä¸€ç¯‡æ–‡ç« çš„ä¿¡æ¯ï¼Œjsonç»“æ„å’Œä¸Šé¢çš„å†…å®¹ç›¸åŒ</li>
<li>next ä¸‹ä¸€ç¯‡æ–‡ç« çš„ä¿¡æ¯</li>
</ul>
</li>
<li>commentPermission: è¯„è®ºæƒé™</li>
<li>commentsCount: è¯„è®ºæ•°é‡</li>
<li>likesCount: èµçš„æ•°é‡</li>
</ul>
<p>åœ¨è®¤è¯ä¿¡æ¯ä¸­ï¼Œç›®å‰åªå‘ç°æœ‰ä¸¤ç§ç±»å‹ï¼Œidentityå®˜æ–¹å¸å·å’Œbest_answererä¼˜ç§€å›ç­”è€…ï¼Œç”±äºçŸ¥ä¹å°ç®¡å®¶åªæ˜¯å®˜æ–¹å¸å·ï¼Œå¹¶ä¸æ˜¯ä¼˜ç§€å›ç­”è€…ï¼Œè¿™é‡Œé€‰å–ä¼˜ç§€å›ç­”è€…<a href="https://www.zhihu.com/people/aton" target="_blank" rel="external">è‹è‰å®‰</a>çš„ä¿¡æ¯è¿›è¡Œåˆ†æã€‚</p>
<pre><code class="JSON">&quot;badge&quot;:
  {
    &quot;identity&quot;: null,
    &quot;best_answerer&quot;:
      {
        &quot;topics&quot;: [],
        &quot;description&quot;: &quot;ä¼˜ç§€å›ç­”è€…&quot;
      }
  }
</code></pre>
<ul>
<li>identity å®˜æ–¹å¸å·</li>
<li>best_answerer ä¼˜ç§€å›ç­”è€…<ul>
<li>topics è¯é¢˜</li>
<li>description æè¿°ä¿¡æ¯</li>
</ul>
</li>
</ul>
<h4 id="è·å–è¯„è®ºåˆ—è¡¨"><a href="#è·å–è¯„è®ºåˆ—è¡¨" class="headerlink" title="è·å–è¯„è®ºåˆ—è¡¨"></a>è·å–è¯„è®ºåˆ—è¡¨</h4><pre><code>https://zhuanlan.zhihu.com/api/posts/æ–‡ç« slug/comments?limit=æ•°é‡é™åˆ¶&amp;offset=åç§»é‡
</code></pre><p>è¿™é‡Œæ‹¼æ¥urlçš„æ–¹æ³•å’Œè·å–æ–‡ç« åˆ—è¡¨æ—¶çš„æ–¹æ³•æ—¶ä¸€æ ·çš„ï¼Œä¸å†èµ˜è¿°ã€‚ä¾‹å¦‚è·å–æ–‡ç« slugä¸º22591792çš„å‰30æ¡è¯„è®ºã€‚</p>
<pre><code>https://zhuanlan.zhihu.com/api/posts/22591792/comments?limit=30&amp;offset=0
</code></pre><p>è·å–åˆ°çš„ä¿¡æ¯ä¸º</p>
<pre><code class="JSON">[
  {
    &quot;content&quot;: &quot;å°ç®¡å®¶æ£’æ£’å“’ï¼æ”¯æŒ~&quot;,
    &quot;liked&quot;: false,
    &quot;href&quot;: &quot;/api/posts/22591792/comments/169039008&quot;,
    &quot;inReplyToCommentId&quot;: 0,
    &quot;reviewing&quot;: false,
    &quot;author&quot;:
      {
        &quot;profileUrl&quot;: &quot;https://www.zhihu.com/people/fei-xiao-gui&quot;, &quot;bio&quot;: &quot;å¿ƒä¸­æœ‰çˆ± è„šä¸‹æœ‰é£ æ‰€ä»¥æˆ‘è·‘å¾—å¿«~&quot;,
        &quot;hash&quot;: &quot;41cd5c7249081389da3a523b3cb0629b&quot;, &quot;uid&quot;: 28048833380352,
        &quot;isOrg&quot;: false,
        &quot;description&quot;: &quot;å“å­¦å…¼ä¼˜~&quot;,
        &quot;slug&quot;: &quot;fei-xiao-gui&quot;,
        &quot;avatar&quot;:
          {
            &quot;id&quot;: &quot;a061ebdd61bb57c81b3206dda51418fc&quot;, &quot;template&quot;: &quot;https://pic1.zhimg.com/{id}_{size}.jpg&quot;
          },
        &quot;name&quot;: &quot;è²å°æ¡‚&quot;
      },
    &quot;createdTime&quot;: &quot;2016-09-23T17:35:54+08:00&quot;,
    &quot;featured&quot;: false,
    &quot;id&quot;: 169039008,
    &quot;likesCount&quot;: 1
  }
]
</code></pre>
<ul>
<li>content: è¯„è®ºå†…å®¹</li>
<li>liked: æ˜¯å¦ç»™è¿™æ¡è¯„è®ºç‚¹è¿‡èµ</li>
<li>href: è¯¥æ¡è¯„è®ºçš„è¯¦æƒ…åœ°å€</li>
<li>inReplyToCommentId: æ‰€å›å¤çš„è¯„è®ºçš„id</li>
<li>reviewing: æ˜¯å¦æ­£åœ¨è¢«å®¡æŸ¥ä¸­</li>
<li>author: è¯„è®ºçš„ä½œè€…<ul>
<li>profileUrl: çŸ¥ä¹ç½‘çš„ä¸ªäººä¸»é¡µurl</li>
<li>bio: å®˜ç½‘ä¿¡æ¯ä¸­çš„ä¸€å¥è¯æè¿°</li>
<li>hash: hashå€¼</li>
<li>uid: uid</li>
<li>isOrg: æ˜¯å¦ä¸ºæœºæ„å¸å·</li>
<li>description: æè¿°</li>
<li>slug: slug</li>
<li>avatar: å¤´åƒä¿¡æ¯<ul>
<li>id: idå€¼ï¼Œåœ¨æ‹¼æ¥urlæ—¶ç”¨åˆ°</li>
<li>template: urlæ‹¼æ¥æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>name: ä½œè€…åç§°</li>
</ul>
</li>
<li>createdTime: è¯„è®ºåˆ›å»ºæ—¶é—´</li>
<li>featured: ???æ˜¯å¦ä¸ºç²¾å½©è¯„è®º</li>
<li>id: è¯¥æ¡è¯„è®ºçš„id</li>
<li>likesCount: è·å¾—çš„èµçš„æ•°é‡</li>
</ul>
<p>å¯¹ä»–äººè¯„è®ºçš„å›å¤æ•°æ®æœ‰äº›è®¸çš„ä¸åŒï¼ŒinReplyToCommentIdçš„å€¼ä¸ä¸º0ï¼Œjsonæ•°æ®ä¸­å¢åŠ äº†inReplyToUserå­—æ®µï¼Œå†…å®¹ä¸ºauthorç±»å‹ã€‚è¿™é‡Œä¸å†å…·ä½“åˆ†æã€‚</p>
<h4 id="è·å–ç‚¹èµä¿¡æ¯"><a href="#è·å–ç‚¹èµä¿¡æ¯" class="headerlink" title="è·å–ç‚¹èµä¿¡æ¯"></a>è·å–ç‚¹èµä¿¡æ¯</h4><pre><code>https://zhuanlan.zhihu.com/api/posts/22591792/likers?limit=è·å–æ•°é‡&amp;offset=åç§»é‡
</code></pre><p>ä¾‹å¦‚ï¼Œè·å–æ–‡ç« slugä¸º22591792çš„æœ€æ–°20ä¸ªç‚¹èµçš„äººçš„ä¿¡æ¯ï¼Œauthorç±»å‹ã€‚</p>
<pre><code>https://zhuanlan.zhihu.com/api/posts/22591792/likers?limit=20&amp;offset=0
</code></pre><p>urlçš„æ‹¼æ¥æ–¹æ³•å’Œä¸Šé¢è·å–æ–‡ç« ä¿¡æ¯æ—¶æ–¹æ³•ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>æœ€åè¿˜æ˜¯æ”¾ä¸Šè‡ªå·±çš„ç¤ºä¾‹é¡¹ç›®åœ°å€ï¼š<br><a href="https://github.com/TonnyL/zhuanlan" target="_blank" rel="external">çŸ¥ä¹ä¸“æ Android</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Javaä¸­ç±»æˆå‘˜çš„åˆå§‹åŒ–]]></title>
      <url>http://tonnyl.github.io/2016/05/12/Java%E4%B8%AD%E7%B1%BB%E6%88%90%E5%91%98%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>å¦‚æœä¸€ä¸ªç±»çš„åŸºæœ¬æˆå‘˜å˜é‡ï¼Œåœ¨æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆå®ƒçš„é»˜è®¤å€¼æ˜¯å¤šå°‘å‘¢ï¼Ÿ<br><a id="more"></a></p>
<p>åœ¨Javaä¸­ï¼Œç±»çš„æŸä¸ªæˆå‘˜å˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå³ä½¿æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼ŒJavaä¹Ÿä¼šç¡®ä¿å®ƒè·å¾—ä¸€ä¸ªé»˜è®¤å€¼ã€‚OK, talk is cheap, show me the code:</p>
<pre><code>public class InitialTest {

    private int anInt;
    private long aLong;
    private short aShort;
    private char aChar;
    private float aFloat;
    private double aDouble;
    private boolean aBoolean;
    private byte aByte;
    private InitialTest reference;

    public static void main(String args[]){

        InitialTest initialTest = new InitialTest();
        System.out.println(&quot;Boolean &quot; + initialTest.aBoolean);
        System.out.println(&quot;Byte &quot; + initialTest.aByte);
        System.out.println(&quot;Char &quot; + initialTest.aChar);
        System.out.println(&quot;Short &quot; +initialTest.aShort);
        System.out.println(&quot;Int &quot; + initialTest.anInt);
        System.out.println(&quot;Long &quot; + initialTest.aLong);
        System.out.println(&quot;Float &quot; + initialTest.aFloat);
        System.out.println(&quot;Double &quot; + initialTest.aDouble);
        System.out.print(&quot;Reference &quot; + initialTest.reference);

    }

}
</code></pre><p>æˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç±»ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„çœ‹å‡ºä½œç”¨æ˜¯ä»€ä¹ˆã€‚ä¸‹é¢æ˜¯è¿è¡Œç»“æœ</p>
<pre><code>Boolean false
Byte 0
Char  
Short 0
Int 0
Long 0
Float 0.0
Double 0.0
Reference null
</code></pre><p>ç»“æœå·²ç»å¾ˆæ˜æ˜¾äº†ã€‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">åŸºæœ¬ç±»å‹</th>
<th style="text-align:left">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">boolean</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td style="text-align:left">char</td>
<td style="text-align:left">â€˜\u0000â€™(null)</td>
</tr>
<tr>
<td style="text-align:left">byte</td>
<td style="text-align:left">(byte)0</td>
</tr>
<tr>
<td style="text-align:left">short</td>
<td style="text-align:left">(short)0</td>
</tr>
<tr>
<td style="text-align:left">int</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">long</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">float</td>
<td style="text-align:left">0.0</td>
</tr>
<tr>
<td style="text-align:left">double</td>
<td style="text-align:left">0.0</td>
</tr>
<tr>
<td style="text-align:left">reference</td>
<td style="text-align:left">null</td>
</tr>
</tbody>
</table>
<p>å½“å˜é‡ä½œä¸ºç±»çš„æˆå‘˜ä½¿ç”¨æ—¶ï¼ŒJavaæ‰ä¼šç¡®ä¿ç»™å®šé»˜è®¤å€¼ï¼Œä»¥ç¡®ä¿é‚£äº›åŸºæœ¬æˆå‘˜å˜é‡å¾—åˆ°åˆå§‹åŒ–(C++ä¸­æ²¡æœ‰æ­¤åŠŸèƒ½),é˜²æ­¢ç¨‹åºäº§ç”Ÿé”™è¯¯ã€‚ä½†æ˜¯ï¼Œè¿™äº›åˆå§‹å€¼å¯¹äºä½ çš„ç¨‹åºå¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ï¼Œæ‰€ä»¥æœ€å¥½æ˜ç¡®çš„å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<p>ä½†æ˜¯ä¸Šè¿°ç¡®ä¿åˆå§‹åŒ–çš„æ–¹æ³•å¹¶ä¸é€‚ç”¨äºâ€œå±€éƒ¨å˜é‡â€(å³éç±»æˆå‘˜)ï¼Œå› æ­¤å½“æˆ‘æŠŠä»£ç æ”¹æˆä¸‹é¢çš„æ ·å­æ—¶ï¼ŒIDEå°±ä¼šæç¤ºé”™è¯¯äº†ï¼š</p>
<pre><code>public static void main(String args[]){
    InitialTest initialTest = new InitialTest();
    System.out.println(&quot;Boolean &quot; + initialTest.aBoolean);
    System.out.println(&quot;Byte &quot; + initialTest.aByte);
    System.out.println(&quot;Short &quot; +initialTest.aShort);
    System.out.println(&quot;Char &quot; + initialTest.aChar);
    System.out.println(&quot;Int &quot; + initialTest.anInt);
    System.out.println(&quot;Long &quot; + initialTest.aLong);
    System.out.println(&quot;Float &quot; + initialTest.aFloat);
    System.out.println(&quot;Double &quot; + initialTest.aDouble);
    System.out.print(&quot;Reference &quot; + initialTest.reference);
    int i;
    System.out.println(&quot;another int is &quot; + i);
}
</code></pre><p>IDEAæç¤ºé”™è¯¯ï¼š</p>
<pre><code>Variable &#39;i&#39; might not have been initialized
</code></pre><p>å¦‚æœä¸æ˜¯åœ¨IDEä¸­ç¼–è¾‘çš„ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘çš„æ—¶å€™ä¹Ÿä¼šæç¤ºä½ è¿™ä¸ªé”™è¯¯ï¼Œå‘Šè¯‰ä½ è¿™ä¸ªå˜é‡æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ã€‚C++ç¼–è¾‘å™¨ä¼šå¯¹æœªåˆå§‹åŒ–å˜é‡ç»™äºˆä¸€ä¸ªè­¦å‘Šï¼Œè€Œéé”™è¯¯ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Activityçš„å››ç§å¯åŠ¨æ¨¡å¼]]></title>
      <url>http://tonnyl.github.io/2016/05/11/Activity%E7%9A%84%E5%9B%9B%E7%A7%8D%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>æµ…æAndroidä¸­Activityçš„å››ç§å¯åŠ¨æ¨¡å¼:standard,singleTop,singleTask,singleInstance<br><a id="more"></a></p>
<p>å¯åŠ¨æ¨¡å¼ä¸€å…±æœ‰ä¸Šè¿°çš„å››ç§ï¼Œå¯ä»¥åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­é€šè¿‡ç»™<ctivity>æ ‡ç­¾æŒ‡å®šandroid:launchModeå±æ€§æ¥é€‰æ‹©å¯åŠ¨æ¨¡å¼ã€‚</ctivity></p>
<h3 id="standard"><a href="#standard" class="headerlink" title="standard"></a>standard</h3><p>standardæ˜¯Activityé»˜è®¤çš„å¯åŠ¨æ¨¡å¼ï¼Œåœ¨ä¸è¿›è¡Œæ˜¾ç¤ºæŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰Activityéƒ½ä¼šè‡ªåŠ¨çš„ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚Androidä½¿ç”¨è¿”å›æ ˆæ¥ç®¡ç†Activity,åœ¨standardæ¨¡å¼ä¸‹ï¼Œæ¯å½“å¯åŠ¨ä¸€ä¸ªæ–°çš„Activity,å®ƒå°±ä¼šåœ¨è¿”å›æ ˆä¸­å…¥æ ˆï¼Œå¹¶å¤„äºæ ˆé¡¶çš„ä½ç½®ã€‚å¯¹äºä½¿ç”¨standardæ¨¡å¼çš„Activity,ç³»ç»Ÿä¸ä¼šåœ¨ä¹è¿™ä¸ªActivityæ˜¯å¦å·²ç»åœ¨è¿”å›æ ˆä¸­ï¼Œæ¯æ¬¡å¯åŠ¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Activityå®ä¾‹ã€‚</p>
<p>ç°åœ¨é€šè¿‡å®è·µæ¥ä½“ä¼šä¸€ä¸‹standardæ¨¡å¼ï¼Œé¦–å…ˆæ˜¯æ–°å»ºä¸€ä¸ªActivityTesté¡¹ç›®ï¼Œä¿®æ”¹MainActivityçš„onCreate()ä¸­ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Log.d(&quot;Mainactivity&quot;,this.toString());

    Button btn1 = (Button) findViewById(R.id.btn1);

    btn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(MainActivity.this,MainActivity.class);
            startActivity(intent);
        }
    });

}
</code></pre><p>ä»£ç å¾ˆç®€å•ï¼Œåœ¨MainActivityçš„åŸºç¡€ä¸Šå¯åŠ¨MainActivityï¼Œä»é€»è¾‘ä¸Šè®²æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä¸è¿‡æˆ‘ä»¬åœ¨äºç ”ç©¶standardæ¨¡å¼ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå°±ä¸å»è¿½ç©¶å®é™…çš„ç”¨é€”äº†ã€‚å¦å¤–æˆ‘ä»¬è¿˜åœ¨onCreate()ä¸­æ·»åŠ äº†ä¸€å¥æ‰“å°æ—¥å¿—ä¿¡æ¯ï¼Œæ‰“å°å½“å‰Activityçš„å®ä¾‹ã€‚</p>
<p>ç°åœ¨è¿è¡Œç¨‹åºï¼Œç„¶åå†MainActivityç•Œé¢è¿ç»­ç‚¹å‡»ä¸¤æ¬¡æŒ‰é’®ï¼Œè§‚å¯ŸLogCatä¸­æ‰“å°çš„æ—¥å¿—ä¿¡æ¯ã€‚</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@5e658bb
MainActivity: com.marktony.applicationtest.MainActivity@cfae411
MainActivity: com.marktony.applicationtest.MainActivity@b0e0bac
</code></pre><p>ä»æ‰“å°ä¿¡æ¯ä¸­å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ï¼Œæ¯æ¬¡ç‚¹å‡»æŒ‰é’®å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„MainActivityçš„å®ä¾‹ï¼Œæ­¤æ—¶è¿”å›æ ˆä¸­ä¹Ÿä¼šå­˜åœ¨ä¸‰ä¸ªMainActivityçš„å®ä¾‹ï¼Œå› æ­¤æƒ³è¦å®Œå…¨é€€å‡ºåº”ç”¨ï¼Œå¿…é¡»ç‚¹å‡»ä¸‰æ¬¡è¿”å›é”®ã€‚</p>
<h3 id="singleTop"><a href="#singleTop" class="headerlink" title="singleTop"></a>singleTop</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—standardæ¨¡å¼ä¸å¤ªåˆç†ã€‚activityæ˜æ˜å·²ç»åœ¨æ ˆé¡¶äº†ï¼Œä¸ºä»€ä¹ˆå†æ¬¡å¯åŠ¨æ—¶è¿˜è¦åˆ›å»ºä¸€ä¸ªæ–°çš„Activityå®ä¾‹å‘¢ï¼Ÿè¿™æ—¶singleTopæ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å½“Activityçš„å¯åŠ¨æ¨¡å¼è¢«æŒ‡å®šä¸ºsingleTopæ—¶ï¼Œåœ¨å¯åŠ¨Activityæ—¶å¦‚æœå‘ç°è¿”å›æ ˆçš„æ ˆé¡¶å·²ç»æ˜¯è¯¥Activityï¼Œåˆ™å¯ä»¥è®¤ä¸ºç›´æ¥ä½¿ç”¨å®ƒï¼Œä¸åˆ›å»ºæ–°çš„å®ä¾‹ã€‚</p>
<p>ä¸‹é¢çœ‹å®ä¾‹,ä¿®æ”¹AndroidManifest.xmlä¸­çš„MainActivityçš„å¯åŠ¨æ¨¡å¼ä¸ºsingleTop:</p>
<pre><code>&lt;activity android:name=&quot;.MainActivity&quot;
    android:launchMode=&quot;singleTop&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre><p>é‡æ–°è¿è¡Œç¨‹åºï¼Œé€šè¿‡LogCatæŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Activityå®ä¾‹ã€‚</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@5e658bb
</code></pre><p>ä¹‹åä¸ç®¡ç‚¹å‡»å¤šå°‘æ¬¡æŒ‰é’®ï¼Œéƒ½ä¸ä¼šæœ‰æ–°çš„æ‰“å°ä¿¡æ¯å‡ºç°ï¼Œå› ä¸ºç›®å‰Activityå·²ç»å¤„äºè¿”å›æ ˆçš„æ ˆé¡¶ï¼Œæ¯å½“æƒ³è¦å†å¯åŠ¨ä¸€ä¸ªMainActivityæ—¶éƒ½ä¼šç›´æ¥ä½¿ç”¨æ ˆé¡¶çš„Activityï¼Œå› æ­¤MainActivityä¹Ÿåªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œä»…æŒ‰ä¸€æ¬¡è¿”å›é”®å³å¯é€€å‡ºç¨‹åºã€‚</p>
<p>ä¸è¿‡å½“MainActivityä¸åœ¨æ ˆé¡¶æ—¶ï¼Œè¿™æ˜¯å†å¯åŠ¨MainActivityï¼Œè¿˜æ˜¯ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼Œä¸‹é¢æ¥å®éªŒä¸€ä¸‹ã€‚ä¿®æ”¹MainActivityä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Log.d(&quot;MainActivity&quot;,this.toString());

    Button btn1 = (Button) findViewById(R.id.btn1);

    btn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(MainActivity.this,SecondActivity.class);
            startActivity(intent);
        }
    });
}
</code></pre><p>è¿™æ¬¡æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®å¯åŠ¨çš„æ˜¯SecondActivityã€‚ç„¶åä¿®æ”¹SecondActivityä¸­onCreate()æ–¹æ³•ä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);

    Button btn2 = (Button) findViewById(R.id.btn2);
    btn2.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new
            Intent(SecondActivity.this,MainActivity.class);
            startActivity(intent);
        }
    });
}
</code></pre><p>æˆ‘ä»¬åœ¨SecondActivityä¸­çš„æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ä¸­åˆåŠ å…¥äº†å¯åŠ¨MainActivityçš„ä»£ç ã€‚ç°åœ¨é‡æ–°è¿è¡Œç¨‹åºï¼Œåœ¨MainActivityç•Œé¢ç‚¹å‡»æŒ‰é’®è¿›å…¥SecondActivityï¼Œç„¶ååœ¨SecondActivityç•Œé¢ç‚¹å‡»æŒ‰é’®ï¼Œåˆä¼šé‡æ–°è¿›å…¥åˆ°MainActivityã€‚æŸ¥çœ‹LogCatä¸­çš„ä¿¡æ¯ï¼š</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@eb60bcf
SecondActivity: com.marktony.applicationtest.SecondActivity@5cf7342
MainActivity: com.marktony.applicationtest.MainActivity@a360333
</code></pre><p>å¯ä»¥çœ‹åˆ°ç³»ç»Ÿåˆ›å»ºäº†ä¸¤ä¸ªä¸åŒçš„MainActivity,è¿™æ˜¯ç”±äºåœ¨SecondActivityä¸­å†æ¬¡å¯åŠ¨Activityæ—¶ï¼Œæ ˆé¡¶çš„Activityå·²ç»å˜æˆäº†SecondActivityï¼Œå› æ­¤ä¼šæ–°å»ºä¸€ä¸ªæ–°çš„MainActivityã€‚ç°åœ¨æŒ‰ä¸‹backé”®å°±ä¼šè¿”å›åˆ°SecondActivity,å†æ¬¡æŒ‰ä¸‹backé”®ï¼Œåˆä¼šå›åˆ°MainActivity,å†æŒ‰ä¸€æ¬¡backé”®æ‰ä¼šé€€å‡ºç¨‹åºã€‚</p>
<h3 id="singleTask"><a href="#singleTask" class="headerlink" title="singleTask"></a>singleTask</h3><p>ä½¿ç”¨singleTaskæ¨¡å¼å¯ä»¥å¾ˆå¥½çš„è§£å†³é‡å¤åˆ›å»ºæ ˆé¡¶Activityçš„é—®é¢˜ï¼Œä½†æ˜¯æ­£å¦‚ä½ çœ‹åˆ°çš„ï¼Œå¦‚æœè¯¥Activityå¹¶æ²¡æœ‰å¤„äºæ ˆé¡¶çš„ä½ç½®ï¼Œè¿˜æ˜¯å¯èƒ½åˆ›å»ºå¤šä¸ªActivityå®ä¾‹çš„ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰æ–¹æ³•å¯ä»¥è®©Activityåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­æŒ‡å­˜åœ¨ä¸€ä¸ªå®ä¾‹å‘¢ï¼Ÿ<br>è¿™å°±è¦å€ŸåŠ©singleTaskæ¨¡å¼æ¥å®ç°äº†ã€‚å½“Activityçš„å¯åŠ¨æ¨¡å¼æŒ‡å®šä¸ºsingleTaskï¼Œæ¯æ¬¡å¯åŠ¨è¯¥Activityæ—¶ç³»ç»Ÿé¦–å…ˆä¼šåœ¨è¿”å›æ ˆä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥Activityçš„å®ä¾‹ï¼Œå¦‚æœå‘ç°å·²ç»å­˜åœ¨åˆ™ç›´æ¥ä½¿ç”¨è¯¥å®ä¾‹ï¼Œå¹¶æŠŠåœ¨è¿™ä¸ªActivityä¹‹ä¸Šçš„æ‰€æœ‰Activityç»Ÿç»Ÿå‡ºæ ˆï¼Œå¦‚æœæ²¡æœ‰å‘ç°å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚<br>ä¸‹é¢é€šè¿‡ä»£ç æ¥ç›´è§‚çš„ç†è§£ä¸€ä¸‹ã€‚ä¿®æ”¹AndroidManifest.xmlæ–‡ä»¶ä¸­MainActivityçš„å¯åŠ¨æ¨¡å¼ï¼š</p>
<pre><code>&lt;activity android:name=&quot;.MainActivity&quot;
    android:launchMode=&quot;singleTask&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

        &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre><p>ç„¶ååœ¨MainActivityä¸­æ·»åŠ onRestart()æ–¹æ³•ï¼Œå¹¶æ‰“å°æ—¥å¿—ï¼š</p>
<pre><code>@Override
protected void onRestart() {
    super.onRestart();
    Log.d(&quot;MainActivity&quot;,&quot;onStart&quot;);
}
</code></pre><p>æœ€ååœ¨SecondActivityä¸­æ·»åŠ onDestroy()æ–¹æ³•ï¼Œå¹¶æ‰“å°æ—¥å¿—ï¼š</p>
<pre><code>@Override
protected void onDestroy() {
    super.onDestroy();
    Log.d(&quot;SecondActivity&quot;,&quot;onDestroy&quot;);
}
</code></pre><p>ç°åœ¨é‡æ–°è¿è¡Œç¨‹åºï¼Œåœ¨MainActivityç•Œé¢ç‚¹å‡»æŒ‰é’®è¿›å…¥SecondActivityï¼Œç„¶ååœ¨SecondActivityç•Œé¢ç‚¹æŒ‰é’®ï¼Œåˆä¼šé‡æ–°è¿›å…¥åˆ°MainActivityã€‚æŸ¥çœ‹LogCatä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼š</p>
<pre><code>MainActivity: com.marktony.applicationtest.MainActivity@f2c42cf
SecondActivity: com.marktony.applicationtest.SecondActivity@81ea653
MainActivity: onStart
SecondActivity: onDestroy
</code></pre><p>ä»æ‰“å°ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨SecondActivityä¸­å¯åŠ¨MainActivityæ—¶ï¼Œä¼šå‘ç°è¿”å›æ ˆé‡Œå·²ç»å­˜åœ¨ä¸€ä¸ªMainActivityçš„å®ä¾‹ï¼Œå¹¶ä¸”æ˜¯åœ¨SecondActivityçš„ä¸‹é¢ï¼Œäºæ˜¯SecondActivityä¼šä»è¿”å›æ ˆä¸­å‡ºæ ˆï¼Œè€ŒMainActivityé‡æ–°æˆä¸ºäº†æ ˆé¡¶Activityï¼Œå› æ­¤MainActivityçš„onRestart()æ–¹æ³•å’ŒSecondActivityçš„onDestroy()æ–¹æ³•ä¼šå¾—åˆ°æ‰§è¡Œã€‚ç°åœ¨è¿”å›æ ˆä¸­åªå‰©ä¸‹ä¸€ä¸ªMainActivityçš„å®ä¾‹äº†ï¼ŒæŒ‰ä¸€ä¸‹backé”®å°±å¯ä»¥é€€å‡ºç¨‹åºã€‚</p>
<h3 id="singleInstance"><a href="#singleInstance" class="headerlink" title="singleInstance"></a>singleInstance</h3><p>singleInstanceåº”è¯¥æ˜¯å››ç§å¯åŠ¨æ¨¡å¼ä¸­æœ€ç‰¹æ®Šä¹Ÿæœ€å¤æ‚çš„ä¸€ç§äº†ã€‚ä¸åŒäºä»¥ä¸Šä¸‰ç§å¯åŠ¨æ¨¡å¼ï¼ŒæŒ‡å®šä¸ºsingleInstanceçš„Activityä¼šå¯ç”¨ä¸€ä¸ªæ–°çš„è¿”å›æ ˆæ¥ç®¡ç†è¿™ä¸ªActivity(å…¶å®å¦‚æœsingleTaskæ¨¡å¼æŒ‡å®šäº†ä¸åŒçš„taskAffinityï¼Œä¹Ÿä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„è¿”å›æ ˆ)ã€‚é‚£ä¹ˆè¿™ä¹ˆåšæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬çš„ç¨‹åºä¸­æœ‰ä¸€ä¸ªActivityæ˜¯å…è®¸å…¶ä»–ç¨‹åºè°ƒç”¨çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å®ç°å…¶ä»–ç¨‹åºå’Œæˆ‘ä»¬çš„ç¨‹åºå¯ä»¥å…±äº«è¿™ä¸ªActivityçš„å®ä¾‹ï¼Œåº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿä½¿ç”¨å‰é¢ä¸‰ç§å¯åŠ¨æ¨¡å¼è‚¯å®šæ˜¯æ— æ³•å®ç°çš„ï¼Œå› ä¸ºæ¯ä¸ªç¨‹åºéƒ½ä¼šæœ‰è‡ªå·±çš„è¿”å›æ ˆï¼ŒåŒä¸€ä¸ªActivityåœ¨ä¸åŒçš„è¿”å›æ ˆä¸­å…¥æ ˆæ—¶å¿…ç„¶æ˜¯åˆ›å»ºæ–°çš„å®ä¾‹ã€‚è€Œä½¿ç”¨singleInstanceæ¨¡å¼å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ä¼šæœ‰ä¸€ä¸ªå•ç‹¬çš„è¿”å›æ ˆæ¥ç®¡ç†è¿™ä¸ªActivityï¼Œä¸ç®¡æ˜¯é‚£ä¸ªåº”ç”¨ç¨‹åºæ¥è®¿é—®è¿™ä¸ªActivityï¼Œéƒ½å…±ç”¨çš„åŒä¸€ä¸ªè¿”å›æ ˆï¼Œä¹Ÿå°±è§£å†³äº†å…±äº«Activityå®ä¾‹çš„é—®é¢˜ã€‚</p>
<p>OK,talk is cheap,show me the code,æˆ‘ä»¬è¿˜æ˜¯æ¥å®è·µä¸€ä¸‹ã€‚ä¿®æ”¹AndroidManifest.xmlä¸­SecondActivityçš„å¯åŠ¨æ¨¡å¼:</p>
<pre><code>&lt;activity android:name=&quot;.SecondActivity&quot;
    android:launchMode=&quot;singleInstance&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;com.marktony.applicatiointest.ACTION_START&quot; /&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
        &lt;category android:name=&quot;com.marktony.applicationtest.MY_CATEGORY&quot; /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre><p>æˆ‘ä»¬å…ˆå°†SecondActivityçš„å¯åŠ¨æ¨¡å¼æŒ‡å®šä¸ºsingleInstanceï¼Œç„¶åä¿®æ”¹MainActivityä¸­onCreate()æ–¹æ³•çš„ä»£ç :</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Log.d(&quot;MainActivity&quot;,&quot;task id is &quot; + getTaskId());

    Button btn1 = (Button) findViewById(R.id.btn1);
    btn1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(MainActivity.this,SecondActivity.class);
            startActivity(intent);
        }
    });

}
</code></pre><p>åœ¨onCreate()æ–¹æ³•ä¸­æ‰“å°äº†å½“å‰è¿”å›æ ˆçš„idã€‚ç„¶åä¿®æ”¹SecondActivityä¸­onCreate()æ–¹æ³•çš„ä»£ç ï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);

    Log.d(&quot;SecondActivity&quot;,&quot;task id is &quot; + getTaskId());

    Button btn2 = (Button) findViewById(R.id.btn2);
    btn2.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent(SecondActivity.this,ThirdActivity.class);
            startActivity(intent);
        }
    });
}
</code></pre><p>åŒæ ·åœ¨onCreate()æ–¹æ³•ä¸­æ‰“å°äº†å½“å‰è¿”å›æ ˆçš„idï¼Œç„¶ååˆä¿®æ”¹äº†æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„ä»£ç ï¼Œç”¨äºå¯åŠ¨ThirdActivityã€‚æœ€åä¿®æ”¹ThirdActivityä¸­onCreate()æ–¹æ³•çš„ä»£ç ï¼š</p>
<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_third);

    Log.d(&quot;ThirdActivity&quot;,&quot;task id is &quot; + getTaskId());
}
</code></pre><p>ä»ç„¶æ˜¯åœ¨onCreate()æ–¹æ³•ä¸­æ‰“å°äº†å½“å‰è¿”å›æ ˆçš„idã€‚ç°åœ¨é‡æ–°è¿è¡Œç¨‹åºï¼Œåœ¨MainActivityç•Œé¢ä¸­ç‚¹å‡»æŒ‰é’®è¿›å…¥åˆ°SecondActivityï¼Œç„¶ååœ¨SecondActivityä¸­ç‚¹å‡»æŒ‰é’®è¿›å…¥åˆ°ThirdActivityã€‚æŸ¥çœ‹LogCatä¸­çš„æ‰“å°ä¿¡æ¯ï¼š</p>
<pre><code>MainActivity: task id is 403
SecondActivity: task id is 404
ThirdActivity: task id is 403
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒSecondActivityçš„task idä¸åŒäºMainActivityå’ŒThirdActivityï¼Œè¿™è¯´æ˜SecondActivityç¡®å®æ˜¯å­˜æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„è¿”å›æ ˆä¸­çš„ï¼Œè€Œä¸”è¿™ä¸ªæ ˆä¸­åªæœ‰SecondActivityè¿™ä¸€ä¸ªActivityã€‚</p>
<p>ç„¶åæˆ‘ä»¬æŒ‰ä¸‹backé”®è¿›è¡Œè¿”å›ï¼Œä½ ä¼šå‘ç°ThirdActivityç«Ÿç„¶è¿”å›äº†MainActivityï¼Œå†æŒ‰ä¸‹backé”®åˆä¼šè¿”å›åˆ°SecondActivityï¼Œå†æŒ‰ä¸‹è¿”å›é”®ä¼šé€€å‡ºç¨‹åºï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>å…¶å®åŸç†å¾ˆç®€å•ï¼Œç”±äºMainActivityå’ŒThirdActivityæ˜¯å­˜æ”¾åœ¨åŒä¸€ä¸ªè¿”å›æ ˆé‡Œçš„ï¼Œå½“åœ¨ThirdActivityçš„ç•Œé¢æŒ‰ä¸‹è¿”å›é”®ï¼ŒThirdActivityä¼šä»è¿”å›æ ˆä¸­å‡ºæ ˆï¼Œé‚£ä¹ˆMainActivityå°±æˆä¸ºäº†æ ˆé¡¶Activityæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šï¼Œå› æ­¤ä¹Ÿå°±å‡ºç°äº†ä»ThirdActivityç›´æ¥è¿”å›åˆ°MainActivityçš„æƒ…å†µã€‚ç„¶ååœ¨MainActivityå†æ¬¡æŒ‰ä¸‹è¿”å›é”®ï¼Œè¿™æ˜¯å½“å‰çš„è¿”å›æ ˆå·²ç»ç©ºäº†ï¼Œäºæ˜¯å°±æ˜¾ç¤ºäº†å¦ä¸€ä¸ªè¿”å›æ ˆçš„æ ˆé¡¶Activityï¼ŒåŠSecondActivityã€‚æœ€åå†æ¬¡æŒ‰ä¸‹backé”®ï¼Œè¿™æ˜¯æ‰€æœ‰çš„è¿”å›æ ˆå‡è¢«æ¸…ç©ºäº†ï¼Œä¹Ÿå°±è‡ªç„¶çš„é€€å‡ºäº†ç¨‹åºã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[è¿›ç¨‹ä¸çº¿ç¨‹]]></title>
      <url>http://tonnyl.github.io/2016/05/02/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h2 id="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»"></a>è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»</h2><a id="more"></a>
<h4 id="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿ</h4><p>è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ç‹¬ç«‹å•ä½ã€‚è¿›ç¨‹æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„è™šæ‹Ÿç©ºé—´åœ°å€ï¼Œå¹¶ä¸ä¾èµ–çº¿ç¨‹è€Œç‹¬ç«‹å­˜åœ¨ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ</h4><p>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯cpuè°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ã€‚å®ƒæ˜¯è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹æœ¬èº«å¹¶ä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æºï¼Œè¿è¡Œæ˜¯åªæ˜¯æš‚ç”¨ä¸€äº›è®¡æ•°å™¨ã€å¯„å­˜å™¨å’Œæ ˆã€‚</p>
<h4 id="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»-1"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»-1" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»"></a>è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»</h4><p>ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªç¨‹åºè‡³å°‘æ‹¥æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚<br>ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åˆ›å»ºå’Œæ’¤é”€å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹å¹¶å‘çš„æ‰§è¡Œã€‚</p>
<p>çº¿ç¨‹æ›´åŠ æ¥è¿‘äºæ‰§è¡Œä½“çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥åŒè¿›ç¨‹ä¸­çš„å…¶ä»–çº¿ç¨‹å…±äº«æ•°æ®ï¼Œä½†æ˜¯æ‹¥æœ‰ç‹¬ç«‹çš„æ ˆç©ºé—´ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„æ‰§è¡Œåºåˆ—ã€‚</p>
<h4 id="è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«"></a>è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«</h4><p>è¿›ç¨‹ä¸çº¿ç¨‹çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬æ˜¯ä¸åŒçš„æ“ä½œç³»ç»Ÿèµ„æºç®¡ç†æ–¹å¼ã€‚è¿›ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒä¹‹åï¼Œåœ¨ä¿æŠ¤æ¨¡å¼å¯¹å…¶ä»–è¿›ç¨‹æ²¡æœ‰å½±å“ï¼Œçº¿ç¨‹åªæ˜¯è¿›ç¨‹çš„ä¸åŒæ‰§è¡Œè·¯å¾„ã€‚çº¿ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„å †æ ˆå’Œå±€éƒ¨å˜é‡ï¼Œä½†æ˜¯æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªçº¿ç¨‹æ­»æ‰é‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¹Ÿå°±æ­»æ‰äº†ï¼Œæ‰€ä»¥å¤šè¿›ç¨‹çš„åº”ç”¨è¦æ¯”å¤šçº¿ç¨‹çš„åº”ç”¨æ›´åŠ å¥å£®ã€‚ä½†æ˜¯è¿›ç¨‹åœ¨åˆ‡æ¢æ—¶è€—è´¹çš„èµ„æºä¹Ÿæ¯”è¾ƒå¤šï¼Œæ•ˆç‡ä¹Ÿè¦æ›´å·®ï¼Œæ‰€ä»¥åœ¨å¹¶å‘æ€§è¦æ±‚é«˜åˆè¦å…±äº«å˜é‡æ•°æ®ï¼Œåªèƒ½é çº¿ç¨‹ï¼Œè€Œä¸æ˜¯è¿›ç¨‹ã€‚</p>
<p>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£ã€‚ä½†æ˜¯çº¿ç¨‹ä¸èƒ½ç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šçº¿ç¨‹æ‰§è¡Œæ§åˆ¶ã€‚</p>
<p>ä»é€»è¾‘ä¸Šçœ‹ï¼Œå¤šçº¿ç¨‹çš„æ„ä¹‰åœ¨äºåœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºå½“ä¸­ï¼Œæœ‰å¤šä¸ªæ‰§è¡Œéƒ¨åˆ†å¯ä»¥åŒæ—¶æ‰§è¡Œã€‚ä½†æ˜¯æ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰å°†å¤šä¸ªçº¿ç¨‹çœ‹ä½œå¤šä¸ªç‹¬ç«‹çš„åº”ç”¨ï¼Œæ¥å®ç°è¿›ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ä»¥åŠèµ„æºåˆ†é…ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ANR]]></title>
      <url>http://tonnyl.github.io/2016/05/01/ANR/</url>
      <content type="html"><![CDATA[<p>æµ…è°ˆAndroidå¼€å‘ä¸­çš„ANRç°è±¡<br><a id="more"></a></p>
<h3 id="ä»€ä¹ˆæ˜¯ANR"><a href="#ä»€ä¹ˆæ˜¯ANR" class="headerlink" title="ä»€ä¹ˆæ˜¯ANR"></a>ä»€ä¹ˆæ˜¯ANR</h3><p>ANR,Application Not Responding,å³ç¨‹åºæœªå“åº”ã€‚å‘ç”ŸANRæ—¶ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºä¸€ä¸ªdialogï¼Œæç¤ºç”¨æˆ·å‡ºç°äº†ANRï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©â€œç­‰å¾…â€ï¼Œæˆ–è€…æ˜¯â€œå¼ºåˆ¶å…³é—­â€ï¼Œç»“æŸåº”ç”¨ã€‚ANRåŒå´©æºƒä¸€æ ·ï¼Œæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­åº”è¯¥é¿å…çš„ã€‚</p>
<h3 id="ä»€ä¹ˆä¼šè§¦å‘ANRï¼š"><a href="#ä»€ä¹ˆä¼šè§¦å‘ANRï¼š" class="headerlink" title="ä»€ä¹ˆä¼šè§¦å‘ANRï¼š"></a>ä»€ä¹ˆä¼šè§¦å‘ANRï¼š</h3><ul>
<li>ä¸»çº¿ç¨‹è¢«IOæ“ä½œé˜»å¡ã€‚ï¼ˆæ–‡æ¡£ä¸­ç‰¹åˆ«å¼ºè°ƒ:<strong>you should not perform the work on the UI thread(ä¸è¦åœ¨UIçº¿ç¨‹ä¸­è¿›è¡ŒIOæ“ä½œ)</strong>ï¼‰ã€‚</li>
<li>ä¸»çº¿ç¨‹ä¸­å­˜åœ¨è€—æ—¶çš„æ“ä½œã€‚</li>
<li>ä¸»çº¿ç¨‹ä¸­é”™è¯¯æ“ä½œã€‚å¦‚Thread.wait()æˆ–Thread.sleep()ç­‰ã€‚</li>
</ul>
<p>åœ¨Androidä¸­ï¼Œåº”ç”¨ç¨‹åºçš„å“åº”æ˜¯å—åˆ°Activity Manager å’Œ Window Manageerç³»ç»ŸæœåŠ¡çš„ã€‚ä¸€æ—¦å‡ºç°ä»¥ä¸‹æƒ…å†µï¼ŒAndroidç³»ç»Ÿå°±ä¼šå±•ç¤ºdialogï¼š</p>
<ul>
<li>5ç§’å†…æ²¡æœ‰ç›¸åº”è§¦æ‘¸æ“ä½œã€‚(No response to an input event (such as key press or screen touch events) within 5 seconds.)</li>
<li>å¹¿æ’­æ¥æ”¶å™¨åœ¨10å†…æ²¡æœ‰æ‰§è¡Œå®Œæˆã€‚(A BroadcastReceiver hasnâ€™t finished executing within 10 seconds.)</li>
</ul>
<h3 id="æ€æ ·é¿å…ANR"><a href="#æ€æ ·é¿å…ANR" class="headerlink" title="æ€æ ·é¿å…ANR"></a>æ€æ ·é¿å…ANR</h3><p>Androidåº”ç”¨é€šå¸¸æ˜¯å®Œå…¨è¿è¡Œåœ¨UIçº¿ç¨‹(<code>UI Thread</code>)æˆ–è€…è¯´ä¸»çº¿ç¨‹(<code>Main Thread</code>)ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ åœ¨UIçº¿ç¨‹ä¸­è¿›è¡Œçš„ä»»ä½•é•¿è€—æ—¶æ“ä½œéƒ½æœ‰å¯èƒ½è§¦å‘ANRã€‚å› æ­¤ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­çš„ä»»ä½•æ“ä½œéƒ½åº”è¯¥å°½å¯èƒ½å¿«çš„å®Œæˆã€‚</p>
<ul>
<li>åœ¨Activityç”Ÿå‘½å‘¨æœŸä¸­çš„å…³é”®æ–¹æ³•ï¼Œä¾‹å¦‚onCreate()å’ŒonResume()ä¸­ï¼Œå®Œæˆå°½å¯èƒ½å°‘çš„å·¥ä½œã€‚</li>
<li>ä½¿ç”¨AsyncTaskå¤„ç†è€—æ—¶æ“ä½œ(ç½‘ç»œè¯·æ±‚å’Œæ•°æ®æ“ä½œç­‰ã€‚)</li>
<li>å¦‚æœä½¿ç”¨äº†Threadæˆ–è€…HandlerThread,ç¡®ä¿ä¸»çº¿ç¨‹ä¸ä¼šåœ¨ç­‰å¾…å·¥ä½œçº¿ç¨‹å®Œæˆæ—¶è¢«é˜»å¡ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šè§¦å‘Thread.wait()æˆ–Thread.sleep()ï¼Œåº”è¯¥ä½¿ç”¨Handlerå¤„ç†å·¥ä½œçº¿ç¨‹çš„ç»“æœã€‚</li>
<li>åœ¨BroadcastReceiverä¸­å®Œæˆé‚£äº›å°è€Œæ•£(small,discrete)çš„å·¥ä½œï¼Œè€Œä¸æ˜¯é‚£äº›é•¿è€—æ—¶æ“ä½œæˆ–è®¡ç®—çš„å·¥ä½œï¼Œå¦‚æœéœ€è¦ï¼Œåº”è¯¥äº¤ç»™IntentServiceå»å®Œæˆã€‚</li>
</ul>
<h3 id="æŠ€å·§æé«˜"><a href="#æŠ€å·§æé«˜" class="headerlink" title="æŠ€å·§æé«˜"></a>æŠ€å·§æé«˜</h3><p>é€šå¸¸ï¼Œ100è‡³200msæ˜¯ç”¨æˆ·è®¤ä¸ºåº”ç”¨è¿è¡Œç¼“æ…¢çš„é˜€å€¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›é¢å¤–çš„tipsï¼Œå¯ä»¥ä½¿åº”ç”¨é¿å…ANRå’ŒåŠæ—¶å“åº”ç”¨æˆ·ï¼š</p>
<ul>
<li>å¦‚æœåº”ç”¨æ­£åœ¨åå°å¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œé‚£ä¹ˆï¼Œå¤„ç†çš„è¿›åº¦åº”è¯¥å‘ŠçŸ¥ç”¨æˆ·å¤„ç†çš„è¿›åº¦ã€‚å¯ä»¥åœ¨UIä¸­ä½¿ç”¨ <strong>ProgressBar</strong>ã€‚</li>
<li>ç‰¹åˆ«çš„ï¼Œå¦‚æœæ˜¯æ¸¸æˆåº”ç”¨çš„è¯ï¼Œè®¡ç®—å·¥ä½œåº”è¯¥åœ¨å·¥ä½œè¿›ç¨‹(Worker thread)ä¸­å®Œæˆã€‚</li>
<li>å¦‚æœåœ¨åˆå§‹åŒ–ä¸­éœ€è¦è¿›è¡Œè€—æ—¶æ“ä½œï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ¬¢è¿é¡µ(splash screen)æˆ–è€…æç¤ºç”¨æˆ·æ­£åœ¨å°½å¿«åŠ è½½ï¼ŒåŒæ—¶æ˜¾ç¤ºåŠ è½½è¿›åº¦ä¿¡æ¯ã€‚è¿™æ ·ï¼Œç”¨æˆ·æ‰ä¸ä¼šè®¤ä¸ºä½ çš„åº”ç”¨åœæ»äº†(frozen)ã€</li>
<li>ä½¿ç”¨Systraceå’ŒTraceviewæ¥å®šä½åº”ç”¨ä¸­å“åº”ç”¨æˆ·çš„ç“¶é¢ˆçš„ä½ç½®ã€‚</li>
</ul>
<p>æ–‡æ¡£åœ°å€ï¼š<a href="!http://developer.android.com/training/articles/perf-anr.html">Android Developer</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“]]></title>
      <url>http://tonnyl.github.io/2016/04/28/zhihudaily/</url>
      <content type="html"><![CDATA[<p>æ€»ç»“åœ¨å¼€å‘çŸ¥ä¹å°æŠ¥çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œç›¸åº”çš„è§£å†³æ–¹æ³•,ä»¥åŠåˆ†äº«å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸€äº›å¿ƒå¾—ä½“ä¼š<br><a id="more"></a></p>
<h2 id="çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“"><a href="#çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“" class="headerlink" title="çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“"></a>çŸ¥ä¹å°æŠ¥å¼€å‘æ€»ç»“</h2><p>æ€»ç»“åœ¨çŸ¥ä¹å°æŠ¥å¼€å‘çš„å·¥ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠç›¸å…³çš„è§£å†³åŠæ³•ã€‚</p>
<p>1.Intentå¯¼è‡´çš„ActivityNotFoundException</p>
<p>æ— æ³•æ‰¾åˆ°å¯¹åº”çš„activityï¼Œè¿™ä¸ªå¼‚å¸¸åœ¨ä½¿ç”¨Intentå¯åŠ¨ä¸€äº›ç³»ç»Ÿçº§éšå¼çš„activityæ—¶å¯èƒ½ä¼šå‡ºç°ï¼Œä¾‹å¦‚çŸ­ä¿¡ã€é‚®ä»¶ã€æ‰“å¼€ç›¸æœºç­‰ï¼Œï¼ˆè¿˜æœ‰æ‰‹æœºæ²¡æœ‰é‚®ä»¶ã€çŸ­ä¿¡appï¼Ÿå½“ç„¶æœ‰äº†ï¼ï¼‰å¦‚æœä¸å¯¹è¿™ä¸ªå¼‚å¸¸è¿›è¡Œå¤„ç†çš„è¯ï¼Œåº”ç”¨å°±ä¼šç›´æ¥Crashã€‚</p>
<pre><code>Uri uri = Uri.parse(&quot;market://details?id=&quot;+getPackageName());
Intent intent = new Intent(Intent.ACTION_VIEW,uri);
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent);
</code></pre><p>è¿™ä¸ªå¼‚å¸¸åœ¨å¼€å‘ç®€å•ç¿»è¯‘çš„è¿‡ç¨‹å°±æ›¾ç»é‡åˆ°è¿‡ã€‚</p>
<ul>
<li><p>æ–¹æ³•1: æœ€ä½³è§£å†³æ–¹æ¡ˆâ€“&gt;åœ¨å‘å‡ºè¿™ä¸ªéšå¼Intentä¹‹å‰è°ƒç”¨resolveActivityåšæ£€æŸ¥</p>
<pre><code>Intent intent = new Intent(Intent.ACTION_XXX);
ComponentName componentName = intent.resolveActivity(getPackageManager());
if(componentName != null) {
String className = componentName.getClassName();
}
</code></pre></li>
<li><p>æ–¹æ³•2ï¼šä½¿ç”¨try-catchæ•è·è¿™ä¸ªå¼‚å¸¸ã€‚</p>
<pre><code>try{
// to start a mail activity code
} catch (android.content.ActivityNotFoundException ex){
// catch Exception
Snackbar.make(view, &quot;No mail app found&quot;,Snackbar.LENGTH_SHORT).show();
}
</code></pre></li>
</ul>
<p>2.WebViewæ— å›¾æ¨¡å¼çš„å®ç°</p>
<p>Android WebViewä¸­å®ç°äº†ä¸€ä¸ªæ–¹æ³•</p>
<pre><code>webView.getSettings().setBlockNetworkImage(boolean config)
</code></pre><p>å®˜æ–¹æ–‡æ¡£è§£é‡Šä¸ºï¼š</p>
<pre><code>Gets whether the WebView does not load image resources from the network.
</code></pre><p>å½“configä¸ºtrueæ—¶ï¼Œä¸åŠ è½½å›¾ç‰‡ï¼Œåä¹‹åŠ è½½å›¾ç‰‡ï¼Œè€Œä¸”æ˜¯å½“urlåŠ è½½å®Œæˆæ—¶æ‰å¼€å§‹åŠ è½½ã€‚</p>
<p>3.æ¥å£å®ç°RecyclerView itemçš„ç‚¹å‡»äº‹ä»¶<br>RecyclerViewæ˜¯Googleåœ¨v7åŒ…ä¸­æ–°å¢çš„ä¸€ç§æ§ä»¶ï¼Œç”¨äºä»£æ›¿ListView,ä¸è¿‡å®ƒå¹¶æ²¡æœ‰åŸºæœ¬çš„ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±ä¸ºitemå®šä¹‰ç‚¹å‡»äº‹ä»¶ã€‚</p>
<p>é¦–å…ˆéœ€è¦è‡ªå®šä¹‰æ¥å£</p>
<pre><code>public interface OnRecyclerViewOnClickListener {
    void OnItemClick(View v,int position);
}
</code></pre><p>åœ¨é€‚é…å™¨ä¸­å®šä¹‰æ¥å£å˜é‡</p>
<pre><code>private OnRecyclerViewOnClickListener mListener;
</code></pre><p>æš´éœ²æ¥å£</p>
<pre><code>public void setItemClickListener(OnRecyclerViewOnClickListener listener){
    this.mListener = listener;
}
</code></pre><p>ç„¶ååœ¨onCreateViewHolderä¸­æ³¨å†Œç‚¹å‡»äº‹ä»¶</p>
<pre><code>@Override
public LatestItemViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
    View view = inflater.inflate(R.layout.latest_item_layout,parent,false);
    LatestItemViewHolder holder = new LatestItemViewHolder(view,mListener);
    return holder;
}
</code></pre><p>åœ¨ViewHolderä¸­è®¾ç½®</p>
<pre><code>public class LatestItemViewHolder extends RecyclerView.ViewHolder implements View.OnClickListener {
    private OnRecyclerViewOnClickListener listener;
    private CardView item;

    public LatestItemViewHolder(View itemView,OnRecyclerViewOnClickListener listener) {
        super(itemView);

        item = (CardView) itemView.findViewById(R.id.card_view_item);
        this.listener = listener;
        itemView.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) {
        if (listener != null){
            listener.OnItemClick(v,getLayoutPosition());
        }
    }
}
</code></pre><p>åœ¨Activityæˆ–è€…Fragmentä¸­ä½¿ç”¨</p>
<pre><code>adapter = new LatestPostAdapter(getActivity(),list);
rvLatestNews.setAdapter(adapter);
adapter.setItemClickListener(new OnRecyclerViewOnClickListener() {
    @Override
    public void OnItemClick(View v, int position) {
        // write code
    }
});
</code></pre><p>4.æ¨ªå±ä¸‹Crash<br>ç”±äºåœ¨fragmentä¸­ä½¿ç”¨äº†RecyclerViewï¼Œå½“ç„¶ä¹Ÿå°±æ¶‰åŠåˆ°äº†Adapoterçš„ä½¿ç”¨ã€‚ç”±äºæˆ‘åœ¨Adapterçš„æ„é€ å‡½æ•°ä¸­ä¼ å…¥äº†Context,è¿™ç›´æ¥å¯¼è‡´äº†æ¨ªå±ä¸‹ç›´æ¥å´©æºƒã€‚</p>
<pre><code>public class LatestPostAdapter extends RecyclerView.Adapter&lt;LatestPostAdapter.LatestItemViewHolder&gt; {
// some code
public LatestPostAdapter(Context context, List&lt;LatestPost&gt; list){
      this.context = context;
      this.list = list;
      this.inflater = LayoutInflater.from(context);
  }
}
</code></pre><p>æˆ‘ä»¬ä¸åº”è¯¥ä¿å­˜é‚£äº›ä¾èµ–Activityçš„æ•°æ®ï¼Œæ¯”å¦‚Drawableï¼ŒAdapterï¼ŒViewæˆ–è€…ä»»ä½•ä¸Contextç›¸å…³è”çš„æ•°æ®ã€‚å› ä¸ºä¸Šä¸€ä¸ªActivityå·²ç»æ²¡æœ‰äº†ï¼Œå¦‚æœä½ è¿˜è¦ä¿æŒè¿™äº›èµ„æºçš„å¼•ç”¨ï¼Œå¯èƒ½å¯¼è‡´èµ„æºæ³„éœ²ã€‚</p>
<p>è§£å†³çš„æ–¹æ³•</p>
<ul>
<li>1.ç®€å•ç²—æš´å‹ ç›´æ¥ç¦æ­¢æ¨ªå±ï¼Œå½“ç„¶è¿™åªæ˜¯é€‚ç”¨äºæå°‘æ•°çš„æƒ…å†µã€‚å¯ä»¥åœ¨manifestæ–‡ä»¶ä¸­å¯¹åº”çš„activityé…ç½®ï¼š</li>
</ul>
<pre><code class="xml">android:screenOrientation=&quot;portrait&quot;
android:screenOrientation=&quot;landscape&quot;
</code></pre>
<p>æˆ–è€…åœ¨Javaä»£ç ä¸­å¤„ç†</p>
<pre><code>setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);  
</code></pre><ul>
<li><p>2.åœ¨æ¨ªå±æ—¶åšç›¸åº”çš„å¤„ç†ã€‚<br>é¦–å…ˆåœ¨manifest.xmlæ–‡ä»¶ä¸­é…ç½®å±å¹•æ–¹å‘æ”¹å˜æ—¶ä¸éœ€è¦é‡æ–°è½½å…¥ã€‚</p>
  <!--configChangeså‚æ•°çš„ä½œç”¨æ˜¯ä¸è®©activityé‡å¯
  3.2ä¹‹å‰çš„sdkåªéœ€è¦é…ç½®å‰é¢ä¸¤ä¸ªå€¼:keyboardHidden|orientation
  3.2ä¹‹åçš„sdkå¿…é¡»é…ç½®ä¸‰ä¸ªå€¼keyboardHidden|orientation|screensize
  -->
  <activity android:name=".UI.Activities.MainActivity" android:label="@string/app_name" android:configchanges="keyboardHidden|orientation|screenSize" android:theme="@style/AppTheme.NoActionBar">

</activity></li>
</ul>
<p>ç„¶ååœ¨activityä¸­é‡å†™æ–¹æ³•</p>
<pre><code>@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
}
</code></pre><p>5.toolbarä¸­å°ç®­å¤´(è¿”å›ä¸Šçº§activity)<br>å¥½å§ï¼Œè¿™æ˜¯ä¸ªä¸ç®—é«˜çº§çš„é—®é¢˜ï¼Œä½†æ˜¯ç¡®å®å›°æ‰°äº†æˆ‘ä¸€æ®µæ—¶é—´ã€‚é¦–å…ˆæ˜¯æ€æ ·æ˜¾ç¤ºè¿™ä¸ªç®­å¤´ã€‚</p>
<pre><code>private Toolbar toolbar;
toolbar = (Toolbar) findViewById(R.id.toolbar);
setSupportActionBar(toolbar);
// å…³é”®
getSupportActionBar().setDisplayHomeAsUpEnabled(true);
</code></pre><p>æ€æ ·ç›‘å¬å°ç®­å¤´çš„ç‚¹å‡»äº‹ä»¶å‘¢ï¼Ÿ</p>
<p>ç”±äºç®­å¤´æ˜¯ä½äºtoolbarä¸­çš„æ§ä»¶ï¼Œå¯ä»¥è”æƒ³åˆ°åº”è¯¥æ˜¯å’ŒonOptionsItemSelectedæ–¹æ³•æœ‰å…³ã€‚</p>
<pre><code>@Override
public boolean onOptionsItemSelected(MenuItem item) {

   int id = item.getItemId();

   // å°ç®­å¤´çš„idä¸ºandroid.R.id.home
   if (id == android.R.id.home){
       onBackPressed();
   }

   return super.onOptionsItemSelected(item);
 }
</code></pre>]]></content>
    </entry>
    
  
  
</search>
